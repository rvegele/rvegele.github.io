!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;b="undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this,b.Application=a()}}(function(){var b;return function c(a,b,d){function e(g,h){if(!b[g]){if(!a[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=b[g]={exports:{}};a[g][0].call(k.exports,function(b){var c=a[g][1][b];return e(c?c:b)},k,k.exports,c,a,b,d)}return b[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){var d="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(a){"use strict";function b(a){var b=a.charCodeAt(0);return b===g||b===l?62:b===h||b===m?63:i>b?-1:i+10>b?b-i+26+26:k+26>b?b-k:j+26>b?b-j+26:void 0}function c(a){function c(a){j[l++]=a}var d,e,g,h,i,j;if(a.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=a.length;i="="===a.charAt(k-2)?2:"="===a.charAt(k-1)?1:0,j=new f(3*a.length/4-i),g=i>0?a.length-4:a.length;var l=0;for(d=0,e=0;g>d;d+=4,e+=3)h=b(a.charAt(d))<<18|b(a.charAt(d+1))<<12|b(a.charAt(d+2))<<6|b(a.charAt(d+3)),c((16711680&h)>>16),c((65280&h)>>8),c(255&h);return 2===i?(h=b(a.charAt(d))<<2|b(a.charAt(d+1))>>4,c(255&h)):1===i&&(h=b(a.charAt(d))<<10|b(a.charAt(d+1))<<4|b(a.charAt(d+2))>>2,c(h>>8&255),c(255&h)),j}function e(a){function b(a){return d.charAt(a)}function c(a){return b(a>>18&63)+b(a>>12&63)+b(a>>6&63)+b(63&a)}var e,f,g,h=a.length%3,i="";for(e=0,g=a.length-h;g>e;e+=3)f=(a[e]<<16)+(a[e+1]<<8)+a[e+2],i+=c(f);switch(h){case 1:f=a[a.length-1],i+=b(f>>2),i+=b(f<<4&63),i+="==";break;case 2:f=(a[a.length-2]<<8)+a[a.length-1],i+=b(f>>10),i+=b(f>>4&63),i+=b(f<<2&63),i+="="}return i}var f="undefined"!=typeof Uint8Array?Uint8Array:Array,g="+".charCodeAt(0),h="/".charCodeAt(0),i="0".charCodeAt(0),j="a".charCodeAt(0),k="A".charCodeAt(0),l="-".charCodeAt(0),m="_".charCodeAt(0);a.toByteArray=c,a.fromByteArray=e}("undefined"==typeof c?this.base64js={}:c)},{}],2:[function(a,b,c){function d(a,b){return 1-3*b+3*a}function e(a,b){return 3*b-6*a}function f(a){return 3*a}function g(a,b,c){return((d(b,c)*a+e(b,c))*a+f(b))*a}function h(a,b,c){return 3*d(b,c)*a*a+2*e(b,c)*a+f(b)}function i(a,b,c,d,e){var f,h,i=0;do h=b+(c-b)/2,f=g(h,d,e)-a,f>0?c=h:b=h;while(Math.abs(f)>n&&++i<o);return h}function j(a,b,c,d){for(var e=0;l>e;++e){var f=h(b,c,d);if(0===f)return b;var i=g(b,c,d)-a;b-=i/f}return b}function k(a,b,c,d){if(4===arguments.length)return new k([a,b,c,d]);if(!(this instanceof k))return new k(a);if(!a||4!==a.length)throw new Error("BezierEasing: points must contains 4 values");for(var e=0;4>e;++e)if("number"!=typeof a[e]||isNaN(a[e])||!isFinite(a[e]))throw new Error("BezierEasing: points should be integers.");if(a[0]<0||a[0]>1||a[2]<0||a[2]>1)throw new Error("BezierEasing x values must be in [0, 1] range.");this._str="BezierEasing("+a+")",this._css="cubic-bezier("+a+")",this._p=a,this._mSampleValues=r?new Float32Array(p):new Array(p),this._precomputed=!1,this.get=this.get.bind(this)}var l=4,m=.001,n=1e-7,o=10,p=11,q=1/(p-1),r="function"==typeof Float32Array;k.prototype={get:function(a){var b=this._p[0],c=this._p[1],d=this._p[2],e=this._p[3];return this._precomputed||this._precompute(),b===c&&d===e?a:0===a?0:1===a?1:g(this._getTForX(a),c,e)},getPoints:function(){return this._p},toString:function(){return this._str},toCSS:function(){return this._css},_precompute:function(){var a=this._p[0],b=this._p[1],c=this._p[2],d=this._p[3];this._precomputed=!0,(a!==b||c!==d)&&this._calcSampleValues()},_calcSampleValues:function(){for(var a=this._p[0],b=this._p[2],c=0;p>c;++c)this._mSampleValues[c]=g(c*q,a,b)},_getTForX:function(a){for(var b=this._p[0],c=this._p[2],d=this._mSampleValues,e=0,f=1,g=p-1;f!==g&&d[f]<=a;++f)e+=q;--f;var k=(a-d[f])/(d[f+1]-d[f]),l=e+k*q,n=h(l,b,c);return n>=m?j(a,l,b,c):0===n?l:i(a,e,e+q,b,c)}},k.css={ease:k.ease=k(.25,.1,.25,1),linear:k.linear=k(0,0,1,1),"ease-in":k.easeIn=k(.42,0,1,1),"ease-out":k.easeOut=k(0,0,.58,1),"ease-in-out":k.easeInOut=k(.42,0,.58,1)},b.exports=k},{}],3:[function(a,b,c){},{}],4:[function(a,b,c){(function(b){function d(){return e.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function e(a){return this instanceof e?(this.length=0,this.parent=void 0,"number"==typeof a?f(this,a):"string"==typeof a?g(this,a,arguments.length>1?arguments[1]:"utf8"):h(this,a)):arguments.length>1?new e(a,arguments[1]):new e(a)}function f(a,b){if(a=o(a,0>b?0:0|p(b)),!e.TYPED_ARRAY_SUPPORT)for(var c=0;b>c;c++)a[c]=0;return a}function g(a,b,c){("string"!=typeof c||""===c)&&(c="utf8");var d=0|r(b,c);return a=o(a,d),a.write(b,c),a}function h(a,b){if(e.isBuffer(b))return i(a,b);if(X(b))return j(a,b);if(null==b)throw new TypeError("must start with number, buffer, array or string");if("undefined"!=typeof ArrayBuffer){if(b.buffer instanceof ArrayBuffer)return k(a,b);if(b instanceof ArrayBuffer)return l(a,b)}return b.length?m(a,b):n(a,b)}function i(a,b){var c=0|p(b.length);return a=o(a,c),b.copy(a,0,0,c),a}function j(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function k(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function l(a,b){return e.TYPED_ARRAY_SUPPORT?(b.byteLength,a=e._augment(new Uint8Array(b))):a=k(a,new Uint8Array(b)),a}function m(a,b){var c=0|p(b.length);a=o(a,c);for(var d=0;c>d;d+=1)a[d]=255&b[d];return a}function n(a,b){var c,d=0;"Buffer"===b.type&&X(b.data)&&(c=b.data,d=0|p(c.length)),a=o(a,d);for(var e=0;d>e;e+=1)a[e]=255&c[e];return a}function o(a,b){e.TYPED_ARRAY_SUPPORT?(a=e._augment(new Uint8Array(b)),a.__proto__=e.prototype):(a.length=b,a._isBuffer=!0);var c=0!==b&&b<=e.poolSize>>>1;return c&&(a.parent=Y),a}function p(a){if(a>=d())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+d().toString(16)+" bytes");return 0|a}function q(a,b){if(!(this instanceof q))return new q(a,b);var c=new e(a,b);return delete c.parent,c}function r(a,b){"string"!=typeof a&&(a=""+a);var c=a.length;if(0===c)return 0;for(var d=!1;;)switch(b){case"ascii":case"binary":case"raw":case"raws":return c;case"utf8":case"utf-8":return Q(a).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*c;case"hex":return c>>>1;case"base64":return T(a).length;default:if(d)return Q(a).length;b=(""+b).toLowerCase(),d=!0}}function s(a,b,c){var d=!1;if(b=0|b,c=void 0===c||c===1/0?this.length:0|c,a||(a="utf8"),0>b&&(b=0),c>this.length&&(c=this.length),b>=c)return"";for(;;)switch(a){case"hex":return E(this,b,c);case"utf8":case"utf-8":return A(this,b,c);case"ascii":return C(this,b,c);case"binary":return D(this,b,c);case"base64":return z(this,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return F(this,b,c);default:if(d)throw new TypeError("Unknown encoding: "+a);a=(a+"").toLowerCase(),d=!0}}function t(a,b,c,d){c=Number(c)||0;var e=a.length-c;d?(d=Number(d),d>e&&(d=e)):d=e;var f=b.length;if(f%2!==0)throw new Error("Invalid hex string");d>f/2&&(d=f/2);for(var g=0;d>g;g++){var h=parseInt(b.substr(2*g,2),16);if(isNaN(h))throw new Error("Invalid hex string");a[c+g]=h}return g}function u(a,b,c,d){return U(Q(b,a.length-c),a,c,d)}function v(a,b,c,d){return U(R(b),a,c,d)}function w(a,b,c,d){return v(a,b,c,d)}function x(a,b,c,d){return U(T(b),a,c,d)}function y(a,b,c,d){return U(S(b,a.length-c),a,c,d)}function z(a,b,c){return 0===b&&c===a.length?V.fromByteArray(a):V.fromByteArray(a.slice(b,c))}function A(a,b,c){c=Math.min(a.length,c);for(var d=[],e=b;c>e;){var f=a[e],g=null,h=f>239?4:f>223?3:f>191?2:1;if(c>=e+h){var i,j,k,l;switch(h){case 1:128>f&&(g=f);break;case 2:i=a[e+1],128===(192&i)&&(l=(31&f)<<6|63&i,l>127&&(g=l));break;case 3:i=a[e+1],j=a[e+2],128===(192&i)&&128===(192&j)&&(l=(15&f)<<12|(63&i)<<6|63&j,l>2047&&(55296>l||l>57343)&&(g=l));break;case 4:i=a[e+1],j=a[e+2],k=a[e+3],128===(192&i)&&128===(192&j)&&128===(192&k)&&(l=(15&f)<<18|(63&i)<<12|(63&j)<<6|63&k,l>65535&&1114112>l&&(g=l))}}null===g?(g=65533,h=1):g>65535&&(g-=65536,d.push(g>>>10&1023|55296),g=56320|1023&g),d.push(g),e+=h}return B(d)}function B(a){var b=a.length;if(Z>=b)return String.fromCharCode.apply(String,a);for(var c="",d=0;b>d;)c+=String.fromCharCode.apply(String,a.slice(d,d+=Z));return c}function C(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(127&a[e]);return d}function D(a,b,c){var d="";c=Math.min(a.length,c);for(var e=b;c>e;e++)d+=String.fromCharCode(a[e]);return d}function E(a,b,c){var d=a.length;(!b||0>b)&&(b=0),(!c||0>c||c>d)&&(c=d);for(var e="",f=b;c>f;f++)e+=P(a[f]);return e}function F(a,b,c){for(var d=a.slice(b,c),e="",f=0;f<d.length;f+=2)e+=String.fromCharCode(d[f]+256*d[f+1]);return e}function G(a,b,c){if(a%1!==0||0>a)throw new RangeError("offset is not uint");if(a+b>c)throw new RangeError("Trying to access beyond buffer length")}function H(a,b,c,d,f,g){if(!e.isBuffer(a))throw new TypeError("buffer must be a Buffer instance");if(b>f||g>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range")}function I(a,b,c,d){0>b&&(b=65535+b+1);for(var e=0,f=Math.min(a.length-c,2);f>e;e++)a[c+e]=(b&255<<8*(d?e:1-e))>>>8*(d?e:1-e)}function J(a,b,c,d){0>b&&(b=4294967295+b+1);for(var e=0,f=Math.min(a.length-c,4);f>e;e++)a[c+e]=b>>>8*(d?e:3-e)&255}function K(a,b,c,d,e,f){if(b>e||f>b)throw new RangeError("value is out of bounds");if(c+d>a.length)throw new RangeError("index out of range");if(0>c)throw new RangeError("index out of range")}function L(a,b,c,d,e){return e||K(a,b,c,4,3.4028234663852886e38,-3.4028234663852886e38),W.write(a,b,c,d,23,4),c+4}function M(a,b,c,d,e){return e||K(a,b,c,8,1.7976931348623157e308,-1.7976931348623157e308),W.write(a,b,c,d,52,8),c+8}function N(a){if(a=O(a).replace(_,""),a.length<2)return"";for(;a.length%4!==0;)a+="=";return a}function O(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function P(a){return 16>a?"0"+a.toString(16):a.toString(16)}function Q(a,b){b=b||1/0;for(var c,d=a.length,e=null,f=[],g=0;d>g;g++){if(c=a.charCodeAt(g),c>55295&&57344>c){if(!e){if(c>56319){(b-=3)>-1&&f.push(239,191,189);continue}if(g+1===d){(b-=3)>-1&&f.push(239,191,189);continue}e=c;continue}if(56320>c){(b-=3)>-1&&f.push(239,191,189),e=c;continue}c=e-55296<<10|c-56320|65536}else e&&(b-=3)>-1&&f.push(239,191,189);if(e=null,128>c){if((b-=1)<0)break;f.push(c)}else if(2048>c){if((b-=2)<0)break;f.push(c>>6|192,63&c|128)}else if(65536>c){if((b-=3)<0)break;f.push(c>>12|224,c>>6&63|128,63&c|128)}else{if(!(1114112>c))throw new Error("Invalid code point");if((b-=4)<0)break;f.push(c>>18|240,c>>12&63|128,c>>6&63|128,63&c|128)}}return f}function R(a){for(var b=[],c=0;c<a.length;c++)b.push(255&a.charCodeAt(c));return b}function S(a,b){for(var c,d,e,f=[],g=0;g<a.length&&!((b-=2)<0);g++)c=a.charCodeAt(g),d=c>>8,e=c%256,f.push(e),f.push(d);return f}function T(a){return V.toByteArray(N(a))}function U(a,b,c,d){for(var e=0;d>e&&!(e+c>=b.length||e>=a.length);e++)b[e+c]=a[e];return e}var V=a("base64-js"),W=a("ieee754"),X=a("is-array");c.Buffer=e,c.SlowBuffer=q,c.INSPECT_MAX_BYTES=50,e.poolSize=8192;var Y={};e.TYPED_ARRAY_SUPPORT=void 0!==b.TYPED_ARRAY_SUPPORT?b.TYPED_ARRAY_SUPPORT:function(){function a(){}try{var b=new Uint8Array(1);return b.foo=function(){return 42},b.constructor=a,42===b.foo()&&b.constructor===a&&"function"==typeof b.subarray&&0===b.subarray(1,1).byteLength}catch(c){return!1}}(),e.TYPED_ARRAY_SUPPORT&&(e.prototype.__proto__=Uint8Array.prototype,e.__proto__=Uint8Array),e.isBuffer=function(a){return!(null==a||!a._isBuffer)},e.compare=function(a,b){if(!e.isBuffer(a)||!e.isBuffer(b))throw new TypeError("Arguments must be Buffers");if(a===b)return 0;for(var c=a.length,d=b.length,f=0,g=Math.min(c,d);g>f&&a[f]===b[f];)++f;return f!==g&&(c=a[f],d=b[f]),d>c?-1:c>d?1:0},e.isEncoding=function(a){switch(String(a).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},e.concat=function(a,b){if(!X(a))throw new TypeError("list argument must be an Array of Buffers.");if(0===a.length)return new e(0);var c;if(void 0===b)for(b=0,c=0;c<a.length;c++)b+=a[c].length;var d=new e(b),f=0;for(c=0;c<a.length;c++){var g=a[c];g.copy(d,f),f+=g.length}return d},e.byteLength=r,e.prototype.length=void 0,e.prototype.parent=void 0,e.prototype.toString=function(){var a=0|this.length;return 0===a?"":0===arguments.length?A(this,0,a):s.apply(this,arguments)},e.prototype.equals=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?!0:0===e.compare(this,a)},e.prototype.inspect=function(){var a="",b=c.INSPECT_MAX_BYTES;return this.length>0&&(a=this.toString("hex",0,b).match(/.{2}/g).join(" "),this.length>b&&(a+=" ... ")),"<Buffer "+a+">"},e.prototype.compare=function(a){if(!e.isBuffer(a))throw new TypeError("Argument must be a Buffer");return this===a?0:e.compare(this,a)},e.prototype.indexOf=function(a,b){function c(a,b,c){for(var d=-1,e=0;c+e<a.length;e++)if(a[c+e]===b[-1===d?0:e-d]){if(-1===d&&(d=e),e-d+1===b.length)return c+d}else d=-1;return-1}if(b>2147483647?b=2147483647:-2147483648>b&&(b=-2147483648),b>>=0,0===this.length)return-1;if(b>=this.length)return-1;if(0>b&&(b=Math.max(this.length+b,0)),"string"==typeof a)return 0===a.length?-1:String.prototype.indexOf.call(this,a,b);if(e.isBuffer(a))return c(this,a,b);if("number"==typeof a)return e.TYPED_ARRAY_SUPPORT&&"function"===Uint8Array.prototype.indexOf?Uint8Array.prototype.indexOf.call(this,a,b):c(this,[a],b);throw new TypeError("val must be string, number or Buffer")},e.prototype.get=function(a){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(a)},e.prototype.set=function(a,b){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(a,b)},e.prototype.write=function(a,b,c,d){if(void 0===b)d="utf8",c=this.length,b=0;else if(void 0===c&&"string"==typeof b)d=b,c=this.length,b=0;else if(isFinite(b))b=0|b,isFinite(c)?(c=0|c,void 0===d&&(d="utf8")):(d=c,c=void 0);else{var e=d;d=b,b=0|c,c=e}var f=this.length-b;if((void 0===c||c>f)&&(c=f),a.length>0&&(0>c||0>b)||b>this.length)throw new RangeError("attempt to write outside buffer bounds");d||(d="utf8");for(var g=!1;;)switch(d){case"hex":return t(this,a,b,c);case"utf8":case"utf-8":return u(this,a,b,c);case"ascii":return v(this,a,b,c);case"binary":return w(this,a,b,c);case"base64":return x(this,a,b,c);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return y(this,a,b,c);default:if(g)throw new TypeError("Unknown encoding: "+d);d=(""+d).toLowerCase(),g=!0}},e.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var Z=4096;e.prototype.slice=function(a,b){var c=this.length;a=~~a,b=void 0===b?c:~~b,0>a?(a+=c,0>a&&(a=0)):a>c&&(a=c),0>b?(b+=c,0>b&&(b=0)):b>c&&(b=c),a>b&&(b=a);var d;if(e.TYPED_ARRAY_SUPPORT)d=e._augment(this.subarray(a,b));else{var f=b-a;d=new e(f,void 0);for(var g=0;f>g;g++)d[g]=this[g+a]}return d.length&&(d.parent=this.parent||this),d},e.prototype.readUIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return d},e.prototype.readUIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a+--b],e=1;b>0&&(e*=256);)d+=this[a+--b]*e;return d},e.prototype.readUInt8=function(a,b){return b||G(a,1,this.length),this[a]},e.prototype.readUInt16LE=function(a,b){return b||G(a,2,this.length),this[a]|this[a+1]<<8},e.prototype.readUInt16BE=function(a,b){return b||G(a,2,this.length),this[a]<<8|this[a+1]},e.prototype.readUInt32LE=function(a,b){return b||G(a,4,this.length),(this[a]|this[a+1]<<8|this[a+2]<<16)+16777216*this[a+3]},e.prototype.readUInt32BE=function(a,b){return b||G(a,4,this.length),16777216*this[a]+(this[a+1]<<16|this[a+2]<<8|this[a+3])},e.prototype.readIntLE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=this[a],e=1,f=0;++f<b&&(e*=256);)d+=this[a+f]*e;return e*=128,d>=e&&(d-=Math.pow(2,8*b)),d},e.prototype.readIntBE=function(a,b,c){a=0|a,b=0|b,c||G(a,b,this.length);for(var d=b,e=1,f=this[a+--d];d>0&&(e*=256);)f+=this[a+--d]*e;return e*=128,f>=e&&(f-=Math.pow(2,8*b)),f},e.prototype.readInt8=function(a,b){return b||G(a,1,this.length),128&this[a]?-1*(255-this[a]+1):this[a]},e.prototype.readInt16LE=function(a,b){b||G(a,2,this.length);var c=this[a]|this[a+1]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt16BE=function(a,b){b||G(a,2,this.length);var c=this[a+1]|this[a]<<8;return 32768&c?4294901760|c:c},e.prototype.readInt32LE=function(a,b){return b||G(a,4,this.length),this[a]|this[a+1]<<8|this[a+2]<<16|this[a+3]<<24},e.prototype.readInt32BE=function(a,b){return b||G(a,4,this.length),this[a]<<24|this[a+1]<<16|this[a+2]<<8|this[a+3]},e.prototype.readFloatLE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!0,23,4)},e.prototype.readFloatBE=function(a,b){return b||G(a,4,this.length),W.read(this,a,!1,23,4)},e.prototype.readDoubleLE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!0,52,8)},e.prototype.readDoubleBE=function(a,b){return b||G(a,8,this.length),W.read(this,a,!1,52,8)},e.prototype.writeUIntLE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=1,f=0;for(this[b]=255&a;++f<c&&(e*=256);)this[b+f]=a/e&255;return b+c},e.prototype.writeUIntBE=function(a,b,c,d){a=+a,b=0|b,c=0|c,d||H(this,a,b,c,Math.pow(2,8*c),0);var e=c-1,f=1;for(this[b+e]=255&a;--e>=0&&(f*=256);)this[b+e]=a/f&255;return b+c},e.prototype.writeUInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,255,0),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),this[b]=a,b+1},e.prototype.writeUInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeUInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,65535,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeUInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b+3]=a>>>24,this[b+2]=a>>>16,this[b+1]=a>>>8,this[b]=a):J(this,a,b,!0),b+4},e.prototype.writeUInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,4294967295,0),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeIntLE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=0,g=1,h=0>a?1:0;for(this[b]=255&a;++f<c&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeIntBE=function(a,b,c,d){if(a=+a,b=0|b,!d){var e=Math.pow(2,8*c-1);H(this,a,b,c,e-1,-e)}var f=c-1,g=1,h=0>a?1:0;for(this[b+f]=255&a;--f>=0&&(g*=256);)this[b+f]=(a/g>>0)-h&255;return b+c},e.prototype.writeInt8=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,1,127,-128),e.TYPED_ARRAY_SUPPORT||(a=Math.floor(a)),0>a&&(a=255+a+1),this[b]=a,b+1},e.prototype.writeInt16LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8):I(this,a,b,!0),b+2},e.prototype.writeInt16BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,2,32767,-32768),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>8,this[b+1]=a):I(this,a,b,!1),b+2},e.prototype.writeInt32LE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),e.TYPED_ARRAY_SUPPORT?(this[b]=a,this[b+1]=a>>>8,this[b+2]=a>>>16,this[b+3]=a>>>24):J(this,a,b,!0),b+4},e.prototype.writeInt32BE=function(a,b,c){return a=+a,b=0|b,c||H(this,a,b,4,2147483647,-2147483648),0>a&&(a=4294967295+a+1),e.TYPED_ARRAY_SUPPORT?(this[b]=a>>>24,this[b+1]=a>>>16,this[b+2]=a>>>8,this[b+3]=a):J(this,a,b,!1),b+4},e.prototype.writeFloatLE=function(a,b,c){return L(this,a,b,!0,c)},e.prototype.writeFloatBE=function(a,b,c){return L(this,a,b,!1,c)},e.prototype.writeDoubleLE=function(a,b,c){return M(this,a,b,!0,c)},e.prototype.writeDoubleBE=function(a,b,c){return M(this,a,b,!1,c)},e.prototype.copy=function(a,b,c,d){if(c||(c=0),d||0===d||(d=this.length),b>=a.length&&(b=a.length),b||(b=0),d>0&&c>d&&(d=c),d===c)return 0;if(0===a.length||0===this.length)return 0;if(0>b)throw new RangeError("targetStart out of bounds");if(0>c||c>=this.length)throw new RangeError("sourceStart out of bounds");if(0>d)throw new RangeError("sourceEnd out of bounds");d>this.length&&(d=this.length),a.length-b<d-c&&(d=a.length-b+c);var f,g=d-c;if(this===a&&b>c&&d>b)for(f=g-1;f>=0;f--)a[f+b]=this[f+c];else if(1e3>g||!e.TYPED_ARRAY_SUPPORT)for(f=0;g>f;f++)a[f+b]=this[f+c];else a._set(this.subarray(c,c+g),b);return g},e.prototype.fill=function(a,b,c){if(a||(a=0),b||(b=0),c||(c=this.length),b>c)throw new RangeError("end < start");if(c!==b&&0!==this.length){if(0>b||b>=this.length)throw new RangeError("start out of bounds");if(0>c||c>this.length)throw new RangeError("end out of bounds");var d;if("number"==typeof a)for(d=b;c>d;d++)this[d]=a;else{var e=Q(a.toString()),f=e.length;for(d=b;c>d;d++)this[d]=e[d%f]}return this}},e.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(e.TYPED_ARRAY_SUPPORT)return new e(this).buffer;for(var a=new Uint8Array(this.length),b=0,c=a.length;c>b;b+=1)a[b]=this[b];return a.buffer}throw new TypeError("Buffer.toArrayBuffer not supported in this browser")};var $=e.prototype;e._augment=function(a){return a.constructor=e,a._isBuffer=!0,a._set=a.set,a.get=$.get,a.set=$.set,a.write=$.write,a.toString=$.toString,a.toLocaleString=$.toString,a.toJSON=$.toJSON,a.equals=$.equals,a.compare=$.compare,a.indexOf=$.indexOf,a.copy=$.copy,a.slice=$.slice,a.readUIntLE=$.readUIntLE,a.readUIntBE=$.readUIntBE,a.readUInt8=$.readUInt8,a.readUInt16LE=$.readUInt16LE,a.readUInt16BE=$.readUInt16BE,a.readUInt32LE=$.readUInt32LE,a.readUInt32BE=$.readUInt32BE,a.readIntLE=$.readIntLE,a.readIntBE=$.readIntBE,a.readInt8=$.readInt8,a.readInt16LE=$.readInt16LE,a.readInt16BE=$.readInt16BE,a.readInt32LE=$.readInt32LE,a.readInt32BE=$.readInt32BE,a.readFloatLE=$.readFloatLE,a.readFloatBE=$.readFloatBE,a.readDoubleLE=$.readDoubleLE,a.readDoubleBE=$.readDoubleBE,a.writeUInt8=$.writeUInt8,a.writeUIntLE=$.writeUIntLE,a.writeUIntBE=$.writeUIntBE,a.writeUInt16LE=$.writeUInt16LE,a.writeUInt16BE=$.writeUInt16BE,a.writeUInt32LE=$.writeUInt32LE,a.writeUInt32BE=$.writeUInt32BE,a.writeIntLE=$.writeIntLE,a.writeIntBE=$.writeIntBE,a.writeInt8=$.writeInt8,a.writeInt16LE=$.writeInt16LE,a.writeInt16BE=$.writeInt16BE,a.writeInt32LE=$.writeInt32LE,a.writeInt32BE=$.writeInt32BE,a.writeFloatLE=$.writeFloatLE,a.writeFloatBE=$.writeFloatBE,a.writeDoubleLE=$.writeDoubleLE,a.writeDoubleBE=$.writeDoubleBE,a.fill=$.fill,a.inspect=$.inspect,a.toArrayBuffer=$.toArrayBuffer,a};var _=/[^+\/0-9A-Za-z-_]/g}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"base64-js":1,ieee754:7,"is-array":9}],5:[function(a,b,c){(function(a){function b(a){return Array.isArray?Array.isArray(a):"[object Array]"===q(a)}function d(a){return"boolean"==typeof a}function e(a){return null===a}function f(a){return null==a}function g(a){return"number"==typeof a}function h(a){return"string"==typeof a}function i(a){return"symbol"==typeof a}function j(a){return void 0===a}function k(a){return"[object RegExp]"===q(a)}function l(a){return"object"==typeof a&&null!==a}function m(a){return"[object Date]"===q(a)}function n(a){return"[object Error]"===q(a)||a instanceof Error}function o(a){return"function"==typeof a}function p(a){return null===a||"boolean"==typeof a||"number"==typeof a||"string"==typeof a||"symbol"==typeof a||"undefined"==typeof a}function q(a){return Object.prototype.toString.call(a)}c.isArray=b,c.isBoolean=d,c.isNull=e,c.isNullOrUndefined=f,c.isNumber=g,c.isString=h,c.isSymbol=i,c.isUndefined=j,c.isRegExp=k,c.isObject=l,c.isDate=m,c.isError=n,c.isFunction=o,c.isPrimitive=p,c.isBuffer=a.isBuffer}).call(this,{isBuffer:a("/Users/micke/development/noodl/noodl-viewer/node_modules/is-buffer/index.js")})},{"/Users/micke/development/noodl/noodl-viewer/node_modules/is-buffer/index.js":10}],6:[function(a,b,c){function d(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function e(a){return"function"==typeof a}function f(a){return"number"==typeof a}function g(a){return"object"==typeof a&&null!==a}function h(a){return void 0===a}b.exports=d,d.EventEmitter=d,d.prototype._events=void 0,d.prototype._maxListeners=void 0,d.defaultMaxListeners=10,d.prototype.setMaxListeners=function(a){if(!f(a)||0>a||isNaN(a))throw TypeError("n must be a positive number");return this._maxListeners=a,this},d.prototype.emit=function(a){var b,c,d,f,i,j;if(this._events||(this._events={}),"error"===a&&(!this._events.error||g(this._events.error)&&!this._events.error.length)){if(b=arguments[1],b instanceof Error)throw b;throw TypeError('Uncaught, unspecified "error" event.')}if(c=this._events[a],h(c))return!1;if(e(c))switch(arguments.length){case 1:c.call(this);break;case 2:c.call(this,arguments[1]);break;case 3:c.call(this,arguments[1],arguments[2]);break;default:for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];c.apply(this,f)}else if(g(c)){for(d=arguments.length,f=new Array(d-1),i=1;d>i;i++)f[i-1]=arguments[i];for(j=c.slice(),d=j.length,i=0;d>i;i++)j[i].apply(this,f)}return!0},d.prototype.addListener=function(a,b){var c;if(!e(b))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",a,e(b.listener)?b.listener:b),this._events[a]?g(this._events[a])?this._events[a].push(b):this._events[a]=[this._events[a],b]:this._events[a]=b,g(this._events[a])&&!this._events[a].warned){var c;c=h(this._maxListeners)?d.defaultMaxListeners:this._maxListeners,c&&c>0&&this._events[a].length>c&&(this._events[a].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[a].length),"function"==typeof console.trace&&console.trace())}return this},d.prototype.on=d.prototype.addListener,d.prototype.once=function(a,b){function c(){this.removeListener(a,c),d||(d=!0,b.apply(this,arguments))}if(!e(b))throw TypeError("listener must be a function");var d=!1;return c.listener=b,this.on(a,c),this},d.prototype.removeListener=function(a,b){var c,d,f,h;if(!e(b))throw TypeError("listener must be a function");if(!this._events||!this._events[a])return this;if(c=this._events[a],f=c.length,d=-1,c===b||e(c.listener)&&c.listener===b)delete this._events[a],this._events.removeListener&&this.emit("removeListener",a,b);else if(g(c)){for(h=f;h-- >0;)if(c[h]===b||c[h].listener&&c[h].listener===b){d=h;break}if(0>d)return this;1===c.length?(c.length=0,delete this._events[a]):c.splice(d,1),this._events.removeListener&&this.emit("removeListener",a,b)}return this},d.prototype.removeAllListeners=function(a){var b,c;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[a]&&delete this._events[a],this;if(0===arguments.length){for(b in this._events)"removeListener"!==b&&this.removeAllListeners(b);return this.removeAllListeners("removeListener"),this._events={},this}if(c=this._events[a],e(c))this.removeListener(a,c);else for(;c.length;)this.removeListener(a,c[c.length-1]);return delete this._events[a],this},d.prototype.listeners=function(a){var b;return b=this._events&&this._events[a]?e(this._events[a])?[this._events[a]]:this._events[a].slice():[]},d.listenerCount=function(a,b){var c;return c=a._events&&a._events[b]?e(a._events[b])?1:a._events[b].length:0}},{}],7:[function(a,b,c){c.read=function(a,b,c,d,e){var f,g,h=8*e-d-1,i=(1<<h)-1,j=i>>1,k=-7,l=c?e-1:0,m=c?-1:1,n=a[b+l];for(l+=m,f=n&(1<<-k)-1,n>>=-k,k+=h;k>0;f=256*f+a[b+l],l+=m,k-=8);for(g=f&(1<<-k)-1,f>>=-k,k+=d;k>0;g=256*g+a[b+l],l+=m,k-=8);if(0===f)f=1-j;else{if(f===i)return g?NaN:(n?-1:1)*(1/0);g+=Math.pow(2,d),f-=j}return(n?-1:1)*g*Math.pow(2,f-d)},c.write=function(a,b,c,d,e,f){var g,h,i,j=8*f-e-1,k=(1<<j)-1,l=k>>1,m=23===e?Math.pow(2,-24)-Math.pow(2,-77):0,n=d?0:f-1,o=d?1:-1,p=0>b||0===b&&0>1/b?1:0;for(b=Math.abs(b),isNaN(b)||b===1/0?(h=isNaN(b)?1:0,g=k):(g=Math.floor(Math.log(b)/Math.LN2),b*(i=Math.pow(2,-g))<1&&(g--,i*=2),b+=g+l>=1?m/i:m*Math.pow(2,1-l),b*i>=2&&(g++,i/=2),g+l>=k?(h=0,g=k):g+l>=1?(h=(b*i-1)*Math.pow(2,e),g+=l):(h=b*Math.pow(2,l-1)*Math.pow(2,e),g=0));e>=8;a[c+n]=255&h,n+=o,h/=256,e-=8);for(g=g<<e|h,j+=e;j>0;a[c+n]=255&g,n+=o,g/=256,j-=8);a[c+n-o]|=128*p}},{}],8:[function(a,b,c){"function"==typeof Object.create?b.exports=function(a,b){a.super_=b,a.prototype=Object.create(b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}})}:b.exports=function(a,b){a.super_=b;var c=function(){};c.prototype=b.prototype,a.prototype=new c,a.prototype.constructor=a}},{}],9:[function(a,b,c){var d=Array.isArray,e=Object.prototype.toString;b.exports=d||function(a){return!!a&&"[object Array]"==e.call(a)}},{}],10:[function(a,b,c){b.exports=function(a){return!(null==a||!(a._isBuffer||a.constructor&&"function"==typeof a.constructor.isBuffer&&a.constructor.isBuffer(a)))}},{}],11:[function(a,b,c){b.exports=Array.isArray||function(a){return"[object Array]"==Object.prototype.toString.call(a)}},{}],12:[function(a,b,c){!function(a){"use strict";var d="Compound",e="Identifier",f="MemberExpression",g="Literal",h="ThisExpression",i="CallExpression",j="UnaryExpression",k="BinaryExpression",l="LogicalExpression",m="ConditionalExpression",n="ArrayExpression",o=46,p=44,q=39,r=34,s=40,t=41,u=91,v=93,w=63,x=59,y=58,z=function(a,b){var c=new Error(a+" at character "+b);throw c.index=b,c.description=a,c},A=!0,B={"-":A,"!":A,"~":A,"+":A},C={"||":1,"&&":2,"|":3,"^":4,"&":5,"==":6,"!=":6,"===":6,"!==":6,"<":7,">":7,"<=":7,">=":7,"<<":8,">>":8,">>>":8,"+":9,"-":9,"*":10,"/":10,"%":10},D=function(a){var b,c=0;for(var d in a)(b=d.length)>c&&a.hasOwnProperty(d)&&(c=b);return c},E=D(B),F=D(C),G={"true":!0,"false":!1,"null":null},H="this",I=function(a){return C[a]||0},J=function(a,b,c){var d="||"===a||"&&"===a?l:k;return{type:d,operator:a,left:b,right:c}},K=function(a){return a>=48&&57>=a},L=function(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a},M=function(a){return 36===a||95===a||a>=65&&90>=a||a>=97&&122>=a||a>=48&&57>=a},N=function(a){for(var b,c,k=0,l=a.charAt,A=a.charCodeAt,D=function(b){return l.call(a,b)},N=function(b){return A.call(a,b)},O=a.length,P=function(){for(var a=N(k);32===a||9===a;)a=N(++k)},Q=function(){var a,b,c=S();return P(),N(k)!==w?c:(k++,a=Q(),a||z("Expected expression",k),P(),N(k)===y?(k++,b=Q(),b||z("Expected expression",k),{type:m,test:c,consequent:a,alternate:b}):void z("Expected :",k))},R=function(){P();for(var b=a.substr(k,F),c=b.length;c>0;){if(C.hasOwnProperty(b))return k+=c,b;b=b.substr(0,--c)}return!1},S=function(){var a,b,c,d,e,f,g,h;if(f=T(),b=R(),!b)return f;for(e={value:b,prec:I(b)},g=T(),g||z("Expected expression after "+b,k),d=[f,e,g];(b=R())&&(c=I(b),0!==c);){for(e={value:b,prec:c};d.length>2&&c<=d[d.length-2].prec;)g=d.pop(),b=d.pop().value,f=d.pop(),a=J(b,f,g),d.push(a);a=T(),a||z("Expected expression after "+b,k),d.push(e,a)}for(h=d.length-1,a=d[h];h>1;)a=J(d[h-1].value,d[h-2],a),h-=2;return a},T=function(){var b,c,d;if(P(),b=N(k),K(b)||b===o)return U();if(b===q||b===r)return V();if(L(b)||b===s)return Y();if(b===u)return $();for(c=a.substr(k,E),d=c.length;d>0;){if(B.hasOwnProperty(c))return k+=d,{type:j,operator:c,argument:T(),prefix:!0};c=c.substr(0,--d)}return!1},U=function(){for(var a,b,c="";K(N(k));)c+=D(k++);if(N(k)===o)for(c+=D(k++);K(N(k));)c+=D(k++);if(a=D(k),"e"===a||"E"===a){for(c+=D(k++),a=D(k),("+"===a||"-"===a)&&(c+=D(k++));K(N(k));)c+=D(k++);K(N(k-1))||z("Expected exponent ("+c+D(k)+")",k)}return b=N(k),L(b)?z("Variable names cannot start with a number ("+c+D(k)+")",k):b===o&&z("Unexpected period",k),{type:g,value:parseFloat(c),raw:c}},V=function(){for(var a,b="",c=D(k++),d=!1;O>k;){if(a=D(k++),
a===c){d=!0;break}if("\\"===a)switch(a=D(k++)){case"n":b+="\n";break;case"r":b+="\r";break;case"t":b+="	";break;case"b":b+="\b";break;case"f":b+="\f";break;case"v":b+="\x0B"}else b+=a}return d||z('Unclosed quote after "'+b+'"',k),{type:g,value:b,raw:c+b+c}},W=function(){var b,c=N(k),d=k;for(L(c)?k++:z("Unexpected "+D(k),k);O>k&&(c=N(k),M(c));)k++;return b=a.slice(d,k),G.hasOwnProperty(b)?{type:g,value:G[b],raw:b}:b===H?{type:h}:{type:e,name:b}},X=function(a){for(var b,c,e=[];O>k;){if(P(),b=N(k),b===a){k++;break}b===p?k++:(c=Q(),c&&c.type!==d||z("Expected comma",k),e.push(c))}return e},Y=function(){var a,b;for(a=N(k),b=a===s?Z():W(),P(),a=N(k);a===o||a===u||a===s;)k++,a===o?(P(),b={type:f,computed:!1,object:b,property:W()}):a===u?(b={type:f,computed:!0,object:b,property:Q()},P(),a=N(k),a!==v&&z("Unclosed [",k),k++):a===s&&(b={type:i,arguments:X(t),callee:b}),P(),a=N(k);return b},Z=function(){k++;var a=Q();return P(),N(k)===t?(k++,a):void z("Unclosed (",k)},$=function(){return k++,{type:n,elements:X(v)}},_=[];O>k;)b=N(k),b===x||b===p?k++:(c=Q())?_.push(c):O>k&&z('Unexpected "'+D(k)+'"',k);return 1===_.length?_[0]:{type:d,body:_}};if(N.version="0.3.0",N.toString=function(){return"JavaScript Expression Parser (JSEP) v"+N.version},N.addUnaryOp=function(a){return B[a]=A,this},N.addBinaryOp=function(a,b){return F=Math.max(a.length,F),C[a]=b,this},N.removeUnaryOp=function(a){return delete B[a],a.length===E&&(E=D(B)),this},N.removeBinaryOp=function(a){return delete C[a],a.length===F&&(F=D(C)),this},"undefined"==typeof c){var O=a.jsep;a.jsep=N,N.noConflict=function(){return a.jsep===N&&(a.jsep=O),N}}else"undefined"!=typeof b&&b.exports?c=b.exports=N:c.parse=N}(this)},{}],13:[function(a,b,c){function d(){}var e=a("./_nativeCreate"),f=Object.prototype;d.prototype=e?e(null):f,b.exports=d},{"./_nativeCreate":85}],14:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Map");b.exports=f},{"./_getNative":64,"./_root":87}],15:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_mapClear"),f=a("./_mapDelete"),g=a("./_mapGet"),h=a("./_mapHas"),i=a("./_mapSet");d.prototype.clear=e,d.prototype["delete"]=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_mapClear":79,"./_mapDelete":80,"./_mapGet":81,"./_mapHas":82,"./_mapSet":83}],16:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"Set");b.exports=f},{"./_getNative":64,"./_root":87}],17:[function(a,b,c){function d(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}var e=a("./_stackClear"),f=a("./_stackDelete"),g=a("./_stackGet"),h=a("./_stackHas"),i=a("./_stackSet");d.prototype.clear=e,d.prototype["delete"]=f,d.prototype.get=g,d.prototype.has=h,d.prototype.set=i,b.exports=d},{"./_stackClear":89,"./_stackDelete":90,"./_stackGet":91,"./_stackHas":92,"./_stackSet":93}],18:[function(a,b,c){var d=a("./_root"),e=d.Symbol;b.exports=e},{"./_root":87}],19:[function(a,b,c){var d=a("./_root"),e=d.Uint8Array;b.exports=e},{"./_root":87}],20:[function(a,b,c){var d=a("./_getNative"),e=a("./_root"),f=d(e,"WeakMap");b.exports=f},{"./_getNative":64,"./_root":87}],21:[function(a,b,c){function d(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}b.exports=d},{}],22:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}b.exports=d},{}],23:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}b.exports=d},{}],24:[function(a,b,c){function d(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}b.exports=d},{}],25:[function(a,b,c){function d(a,b,c){var d=a[b];g.call(a,b)&&e(d,c)&&(void 0!==c||b in a)||(a[b]=c)}var e=a("./eq"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./eq":97}],26:[function(a,b,c){function d(a,b){var c=e(a,b);if(0>c)return!1;var d=a.length-1;return c==d?a.pop():g.call(a,c,1),!0}var e=a("./_assocIndexOf"),f=Array.prototype,g=f.splice;b.exports=d},{"./_assocIndexOf":29}],27:[function(a,b,c){function d(a,b){var c=e(a,b);return 0>c?void 0:a[c][1]}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":29}],28:[function(a,b,c){function d(a,b){return e(a,b)>-1}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":29}],29:[function(a,b,c){function d(a,b){for(var c=a.length;c--;)if(e(a[c][0],b))return c;return-1}var e=a("./eq");b.exports=d},{"./eq":97}],30:[function(a,b,c){function d(a,b,c){var d=e(a,b);0>d?a.push([b,c]):a[d][1]=c}var e=a("./_assocIndexOf");b.exports=d},{"./_assocIndexOf":29}],31:[function(a,b,c){function d(a,b){return a&&e(b,f(b),a)}var e=a("./_copyObject"),f=a("./keys");b.exports=d},{"./_copyObject":54,"./keys":115}],32:[function(a,b,c){function d(a){return e(a)?a:f(a)}var e=a("./isArray"),f=a("./_stringToPath");b.exports=d},{"./_stringToPath":94,"./isArray":103}],33:[function(a,b,c){function d(a){return e(a)?f(a):{}}var e=a("./isObject"),f=Object.create;b.exports=d},{"./isObject":110}],34:[function(a,b,c){var d=a("./_baseForOwn"),e=a("./_createBaseEach"),f=e(d);b.exports=f},{"./_baseForOwn":37,"./_createBaseEach":57}],35:[function(a,b,c){function d(a,b){var c=!0;return e(a,function(a,d,e){return c=!!b(a,d,e)}),c}var e=a("./_baseEach");b.exports=d},{"./_baseEach":34}],36:[function(a,b,c){var d=a("./_createBaseFor"),e=d();b.exports=e},{"./_createBaseFor":58}],37:[function(a,b,c){function d(a,b){return a&&e(a,b,f)}var e=a("./_baseFor"),f=a("./keys");b.exports=d},{"./_baseFor":36,"./keys":115}],38:[function(a,b,c){function d(a,b){b=f(b,a)?[b+""]:e(b);for(var c=0,d=b.length;null!=a&&d>c;)a=a[b[c++]];return c&&c==d?a:void 0}var e=a("./_baseCastPath"),f=a("./_isKey");b.exports=d},{"./_baseCastPath":32,"./_isKey":75}],39:[function(a,b,c){function d(a,b){return f.call(a,b)||"object"==typeof a&&b in a&&null===g(a)}var e=Object.prototype,f=e.hasOwnProperty,g=Object.getPrototypeOf;b.exports=d},{}],40:[function(a,b,c){function d(a,b){return b in Object(a)}b.exports=d},{}],41:[function(a,b,c){function d(a,b,c,h,i){return a===b?!0:null==a||null==b||!f(a)&&!g(b)?a!==a&&b!==b:e(a,b,d,c,h,i)}var e=a("./_baseIsEqualDeep"),f=a("./isObject"),g=a("./isObjectLike");b.exports=d},{"./_baseIsEqualDeep":42,"./isObject":110,"./isObjectLike":111}],42:[function(a,b,c){function d(a,b,c,d,q,s){var t=j(a),u=j(b),v=o,w=o;t||(v=i(a),v==n?v=p:v!=p&&(t=l(a))),u||(w=i(b),w==n?w=p:w!=p&&(u=l(b)));var x=v==p&&!k(a),y=w==p&&!k(b),z=v==w;if(z&&!t&&!x)return g(a,b,v,c,d,q);var A=q&m;if(!A){var B=x&&r.call(a,"__wrapped__"),C=y&&r.call(b,"__wrapped__");if(B||C)return c(B?a.value():a,C?b.value():b,d,q,s)}return z?(s||(s=new e),(t?f:h)(a,b,c,d,q,s)):!1}var e=a("./_Stack"),f=a("./_equalArrays"),g=a("./_equalByTag"),h=a("./_equalObjects"),i=a("./_getTag"),j=a("./isArray"),k=a("./_isHostObject"),l=a("./isTypedArray"),m=2,n="[object Arguments]",o="[object Array]",p="[object Object]",q=Object.prototype,r=q.hasOwnProperty;b.exports=d},{"./_Stack":17,"./_equalArrays":59,"./_equalByTag":60,"./_equalObjects":61,"./_getTag":65,"./_isHostObject":72,"./isArray":103,"./isTypedArray":114}],43:[function(a,b,c){function d(a,b,c,d){var i=c.length,j=i,k=!d;if(null==a)return!j;for(a=Object(a);i--;){var l=c[i];if(k&&l[2]?l[1]!==a[l[0]]:!(l[0]in a))return!1}for(;++i<j;){l=c[i];var m=l[0],n=a[m],o=l[1];if(k&&l[2]){if(void 0===n&&!(m in a))return!1}else{var p=new e,q=d?d(n,o,m,a,b,p):void 0;if(!(void 0===q?f(o,n,d,g|h,p):q))return!1}}return!0}var e=a("./_Stack"),f=a("./_baseIsEqual"),g=1,h=2;b.exports=d},{"./_Stack":17,"./_baseIsEqual":41}],44:[function(a,b,c){function d(a){var b=typeof a;return"function"==b?a:null==a?g:"object"==b?h(a)?f(a[0],a[1]):e(a):i(a)}var e=a("./_baseMatches"),f=a("./_baseMatchesProperty"),g=a("./identity"),h=a("./isArray"),i=a("./property");b.exports=d},{"./_baseMatches":46,"./_baseMatchesProperty":47,"./identity":101,"./isArray":103,"./property":118}],45:[function(a,b,c){function d(a){return e(Object(a))}var e=Object.keys;b.exports=d},{}],46:[function(a,b,c){function d(a){var b=f(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(void 0!==d||c in Object(a))}}return function(c){return c===a||e(c,a,b)}}var e=a("./_baseIsMatch"),f=a("./_getMatchData");b.exports=d},{"./_baseIsMatch":43,"./_getMatchData":63}],47:[function(a,b,c){function d(a,b){return function(c){var d=f(c,a);return void 0===d&&d===b?g(c,a):e(b,d,void 0,h|i)}}var e=a("./_baseIsEqual"),f=a("./get"),g=a("./hasIn"),h=1,i=2;b.exports=d},{"./_baseIsEqual":41,"./get":99,"./hasIn":100}],48:[function(a,b,c){function d(a){return function(b){return null==b?void 0:b[a]}}b.exports=d},{}],49:[function(a,b,c){function d(a){return function(b){return e(b,a)}}var e=a("./_baseGet");b.exports=d},{"./_baseGet":38}],50:[function(a,b,c){function d(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}b.exports=d},{}],51:[function(a,b,c){function d(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}b.exports=d},{}],52:[function(a,b,c){function d(a,b){return e(b,function(b){return[b,a[b]]})}var e=a("./_arrayMap");b.exports=d},{"./_arrayMap":23}],53:[function(a,b,c){function d(a){return a&&a.Object===Object?a:null}b.exports=d},{}],54:[function(a,b,c){function d(a,b,c){return e(a,b,c)}var e=a("./_copyObjectWith");b.exports=d},{"./_copyObjectWith":55}],55:[function(a,b,c){function d(a,b,c,d){c||(c={});for(var f=-1,g=b.length;++f<g;){var h=b[f],i=d?d(c[h],a[h],h,c,a):a[h];e(c,h,i)}return c}var e=a("./_assignValue");b.exports=d},{"./_assignValue":25}],56:[function(a,b,c){function d(a){return f(function(b,c){var d=-1,f=c.length,g=f>1?c[f-1]:void 0,h=f>2?c[2]:void 0;for(g="function"==typeof g?(f--,g):void 0,h&&e(c[0],c[1],h)&&(g=3>f?void 0:g,f=1),b=Object(b);++d<f;){var i=c[d];i&&a(b,i,d,g)}return b})}var e=a("./_isIterateeCall"),f=a("./rest");b.exports=d},{"./_isIterateeCall":74,"./rest":119}],57:[function(a,b,c){function d(a,b){return function(c,d){if(null==c)return c;if(!e(c))return a(c,d);for(var f=c.length,g=b?f:-1,h=Object(c);(b?g--:++g<f)&&d(h[g],g,h)!==!1;);return c}}var e=a("./isArrayLike");b.exports=d},{"./isArrayLike":104}],58:[function(a,b,c){function d(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}b.exports=d},{}],59:[function(a,b,c){function d(a,b,c,d,h,i){var j=-1,k=h&g,l=h&f,m=a.length,n=b.length;if(m!=n&&!(k&&n>m))return!1;var o=i.get(a);if(o)return o==b;var p=!0;for(i.set(a,b);++j<m;){var q=a[j],r=b[j];if(d)var s=k?d(r,q,j,b,a,i):d(q,r,j,a,b,i);if(void 0!==s){if(s)continue;p=!1;break}if(l){if(!e(b,function(a){return q===a||c(q,a,d,h,i)})){p=!1;break}}else if(q!==r&&!c(q,r,d,h,i)){p=!1;break}}return i["delete"](a),p}var e=a("./_arraySome"),f=1,g=2;b.exports=d},{"./_arraySome":24}],60:[function(a,b,c){function d(a,b,c,d,u,w){switch(c){case t:return a.byteLength==b.byteLength&&d(new f(a),new f(b))?!0:!1;case k:case l:return+a==+b;case m:return a.name==b.name&&a.message==b.message;case o:return a!=+a?b!=+b:a==+b;case p:case r:return a==b+"";case n:var x=g;case q:var y=w&j;return x||(x=h),(y||a.size==b.size)&&d(x(a),x(b),u,w|i);case s:return!!e&&v.call(a)==v.call(b)}return!1}var e=a("./_Symbol"),f=a("./_Uint8Array"),g=a("./_mapToArray"),h=a("./_setToArray"),i=1,j=2,k="[object Boolean]",l="[object Date]",m="[object Error]",n="[object Map]",o="[object Number]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object Symbol]",t="[object ArrayBuffer]",u=e?e.prototype:void 0,v=e?u.valueOf:void 0;b.exports=d},{"./_Symbol":18,"./_Uint8Array":19,"./_mapToArray":84,"./_setToArray":88}],61:[function(a,b,c){function d(a,b,c,d,h,i){var j=h&g,k=f(a),l=k.length,m=f(b),n=m.length;if(l!=n&&!j)return!1;for(var o=l;o--;){var p=k[o];if(!(j?p in b:e(b,p)))return!1}var q=i.get(a);if(q)return q==b;var r=!0;i.set(a,b);for(var s=j;++o<l;){p=k[o];var t=a[p],u=b[p];if(d)var v=j?d(u,t,p,b,a,i):d(t,u,p,a,b,i);if(!(void 0===v?t===u||c(t,u,d,h,i):v)){r=!1;break}s||(s="constructor"==p)}if(r&&!s){var w=a.constructor,x=b.constructor;w!=x&&"constructor"in a&&"constructor"in b&&!("function"==typeof w&&w instanceof w&&"function"==typeof x&&x instanceof x)&&(r=!1)}return i["delete"](a),r}var e=a("./_baseHas"),f=a("./keys"),g=2;b.exports=d},{"./_baseHas":39,"./keys":115}],62:[function(a,b,c){var d=a("./_baseProperty"),e=d("length");b.exports=e},{"./_baseProperty":48}],63:[function(a,b,c){function d(a){for(var b=f(a),c=b.length;c--;)b[c][2]=e(b[c][1]);return b}var e=a("./_isStrictComparable"),f=a("./toPairs");b.exports=d},{"./_isStrictComparable":78,"./toPairs":122}],64:[function(a,b,c){function d(a,b){var c=null==a?void 0:a[b];return e(c)?c:void 0}var e=a("./isNative");b.exports=d},{"./isNative":109}],65:[function(a,b,c){function d(a){return n.call(a)}var e=a("./_Map"),f=a("./_Set"),g=a("./_WeakMap"),h="[object Map]",i="[object Object]",j="[object Set]",k="[object WeakMap]",l=Object.prototype,m=Function.prototype.toString,n=l.toString,o=e?m.call(e):"",p=f?m.call(f):"",q=g?m.call(g):"";(e&&d(new e)!=h||f&&d(new f)!=j||g&&d(new g)!=k)&&(d=function(a){var b=n.call(a),c=b==i?a.constructor:null,d="function"==typeof c?m.call(c):"";if(d)switch(d){case o:return h;case p:return j;case q:return k}return b}),b.exports=d},{"./_Map":14,"./_Set":16,"./_WeakMap":20}],66:[function(a,b,c){function d(a,b,c){if(null==a)return!1;var d=c(a,b);d||i(b)||(b=e(b),a=m(a,b),null!=a&&(b=l(b),d=c(a,b)));var n=a?a.length:void 0;return d||!!n&&j(n)&&h(b,n)&&(g(a)||k(a)||f(a))}var e=a("./_baseCastPath"),f=a("./isArguments"),g=a("./isArray"),h=a("./_isIndex"),i=a("./_isKey"),j=a("./isLength"),k=a("./isString"),l=a("./last"),m=a("./_parent");b.exports=d},{"./_baseCastPath":32,"./_isIndex":73,"./_isKey":75,"./_parent":86,"./isArguments":102,"./isArray":103,"./isLength":108,"./isString":112,"./last":116}],67:[function(a,b,c){function d(a,b){return e(a,b)&&delete a[b]}var e=a("./_hashHas");b.exports=d},{"./_hashHas":69}],68:[function(a,b,c){function d(a,b){if(e){var c=a[b];return c===f?void 0:c}return h.call(a,b)?a[b]:void 0}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__",g=Object.prototype,h=g.hasOwnProperty;b.exports=d},{"./_nativeCreate":85}],69:[function(a,b,c){function d(a,b){return e?void 0!==a[b]:g.call(a,b)}var e=a("./_nativeCreate"),f=Object.prototype,g=f.hasOwnProperty;b.exports=d},{"./_nativeCreate":85}],70:[function(a,b,c){function d(a,b,c){a[b]=e&&void 0===c?f:c}var e=a("./_nativeCreate"),f="__lodash_hash_undefined__";b.exports=d},{"./_nativeCreate":85}],71:[function(a,b,c){function d(a){var b=a?a.length:void 0;return h(b)&&(g(a)||i(a)||f(a))?e(b,String):null}var e=a("./_baseTimes"),f=a("./isArguments"),g=a("./isArray"),h=a("./isLength"),i=a("./isString");b.exports=d},{"./_baseTimes":51,"./isArguments":102,"./isArray":103,"./isLength":108,"./isString":112}],72:[function(a,b,c){function d(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}b.exports=d},{}],73:[function(a,b,c){function d(a,b){return a="number"==typeof a||f.test(a)?+a:-1,b=null==b?e:b,a>-1&&a%1==0&&b>a}var e=9007199254740991,f=/^(?:0|[1-9]\d*)$/;b.exports=d},{}],74:[function(a,b,c){function d(a,b,c){if(!h(c))return!1;var d=typeof b;return("number"==d?f(c)&&g(b,c.length):"string"==d&&b in c)?e(c[b],a):!1}var e=a("./eq"),f=a("./isArrayLike"),g=a("./_isIndex"),h=a("./isObject");b.exports=d},{"./_isIndex":73,"./eq":97,"./isArrayLike":104,"./isObject":110}],75:[function(a,b,c){function d(a,b){return"number"==typeof a?!0:!e(a)&&(g.test(a)||!f.test(a)||null!=b&&a in Object(b))}var e=a("./isArray"),f=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,g=/^\w*$/;b.exports=d},{"./isArray":103}],76:[function(a,b,c){function d(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!=a||null==a}b.exports=d},{}],77:[function(a,b,c){function d(a){var b=a&&a.constructor,c=e(b)&&b.prototype||f;return a===c}var e=a("./isFunction"),f=Object.prototype;b.exports=d},{"./isFunction":107}],78:[function(a,b,c){function d(a){return a===a&&!e(a)}var e=a("./isObject");b.exports=d},{"./isObject":110}],79:[function(a,b,c){function d(){this.__data__={hash:new e,map:f?new f:[],string:new e}}var e=a("./_Hash"),f=a("./_Map");b.exports=d},{"./_Hash":13,"./_Map":14}],80:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map["delete"](a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocDelete"),g=a("./_hashDelete"),h=a("./_isKeyable");b.exports=d},{"./_Map":14,"./_assocDelete":26,"./_hashDelete":67,"./_isKeyable":76}],81:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map.get(a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocGet"),g=a("./_hashGet"),h=a("./_isKeyable");b.exports=d},{"./_Map":14,"./_assocGet":27,"./_hashGet":68,"./_isKeyable":76}],82:[function(a,b,c){function d(a){var b=this.__data__;return h(a)?g("string"==typeof a?b.string:b.hash,a):e?b.map.has(a):f(b.map,a)}var e=a("./_Map"),f=a("./_assocHas"),g=a("./_hashHas"),h=a("./_isKeyable");b.exports=d},{"./_Map":14,"./_assocHas":28,"./_hashHas":69,"./_isKeyable":76}],83:[function(a,b,c){function d(a,b){var c=this.__data__;return h(a)?g("string"==typeof a?c.string:c.hash,a,b):e?c.map.set(a,b):f(c.map,a,b),this}var e=a("./_Map"),f=a("./_assocSet"),g=a("./_hashSet"),h=a("./_isKeyable");b.exports=d},{"./_Map":14,"./_assocSet":30,"./_hashSet":70,"./_isKeyable":76}],84:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}b.exports=d},{}],85:[function(a,b,c){var d=a("./_getNative"),e=d(Object,"create");b.exports=e},{"./_getNative":64}],86:[function(a,b,c){function d(a,b){return 1==b.length?a:f(a,e(b,0,-1))}var e=a("./_baseSlice"),f=a("./get");b.exports=d},{"./_baseSlice":50,"./get":99}],87:[function(a,b,c){(function(d){var e=a("./_checkGlobal"),f={"function":!0,object:!0},g=f[typeof c]&&c&&!c.nodeType?c:void 0,h=f[typeof b]&&b&&!b.nodeType?b:void 0,i=e(g&&h&&"object"==typeof d&&d),j=e(f[typeof self]&&self),k=e(f[typeof window]&&window),l=e(f[typeof this]&&this),m=i||k!==(l&&l.window)&&k||j||l||Function("return this")();b.exports=m}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./_checkGlobal":53}],88:[function(a,b,c){function d(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}b.exports=d},{}],89:[function(a,b,c){function d(){this.__data__={array:[],map:null}}b.exports=d},{}],90:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map["delete"](a)}var e=a("./_assocDelete");b.exports=d},{"./_assocDelete":26}],91:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map.get(a)}var e=a("./_assocGet");b.exports=d},{"./_assocGet":27}],92:[function(a,b,c){function d(a){var b=this.__data__,c=b.array;return c?e(c,a):b.map.has(a)}var e=a("./_assocHas");b.exports=d},{"./_assocHas":28}],93:[function(a,b,c){function d(a,b){var c=this.__data__,d=c.array;d&&(d.length<g-1?f(d,a,b):(c.array=null,c.map=new e(d)));var h=c.map;return h&&h.set(a,b),this}var e=a("./_MapCache"),f=a("./_assocSet"),g=200;b.exports=d},{"./_MapCache":15,"./_assocSet":30}],94:[function(a,b,c){function d(a){var b=[];return e(a).replace(f,function(a,c,d,e){b.push(d?e.replace(g,"$1"):c||a)}),b}var e=a("./toString"),f=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,g=/\\(\\)?/g;b.exports=d},{"./toString":123}],95:[function(a,b,c){var d=a("./_copyObject"),e=a("./_createAssigner"),f=a("./keys"),g=e(function(a,b){d(b,f(b),a)});b.exports=g},{"./_copyObject":54,"./_createAssigner":56,"./keys":115}],96:[function(a,b,c){function d(a,b){var c=f(a);return b?e(c,b):c}var e=a("./_baseAssign"),f=a("./_baseCreate");b.exports=d},{"./_baseAssign":31,"./_baseCreate":33}],97:[function(a,b,c){function d(a,b){return a===b||a!==a&&b!==b}b.exports=d},{}],98:[function(a,b,c){function d(a,b,c){var d=h(a)?e:f;return c&&i(a,b,c)&&(b=void 0),d(a,g(b,3))}var e=a("./_arrayEvery"),f=a("./_baseEvery"),g=a("./_baseIteratee"),h=a("./isArray"),i=a("./_isIterateeCall");b.exports=d},{"./_arrayEvery":22,"./_baseEvery":35,"./_baseIteratee":44,"./_isIterateeCall":74,"./isArray":103}],99:[function(a,b,c){function d(a,b,c){var d=null==a?void 0:e(a,b);return void 0===d?c:d}var e=a("./_baseGet");b.exports=d},{"./_baseGet":38}],100:[function(a,b,c){function d(a,b){return f(a,b,e)}var e=a("./_baseHasIn"),f=a("./_hasPath");b.exports=d},{"./_baseHasIn":40,"./_hasPath":66}],101:[function(a,b,c){function d(a){return a}b.exports=d},{}],102:[function(a,b,c){function d(a){return e(a)&&h.call(a,"callee")&&(!j.call(a,"callee")||i.call(a)==f)}var e=a("./isArrayLikeObject"),f="[object Arguments]",g=Object.prototype,h=g.hasOwnProperty,i=g.toString,j=g.propertyIsEnumerable;b.exports=d},{"./isArrayLikeObject":105}],103:[function(a,b,c){var d=Array.isArray;b.exports=d},{}],104:[function(a,b,c){function d(a){return null!=a&&!("function"==typeof a&&f(a))&&g(e(a))}var e=a("./_getLength"),f=a("./isFunction"),g=a("./isLength");b.exports=d},{"./_getLength":62,"./isFunction":107,"./isLength":108}],105:[function(a,b,c){function d(a){return f(a)&&e(a)}var e=a("./isArrayLike"),f=a("./isObjectLike");b.exports=d},{"./isArrayLike":104,"./isObjectLike":111}],106:[function(a,b,c){function d(a){if(g(a)&&(f(a)||i(a)||h(a.splice)||e(a)))return!a.length;for(var b in a)if(k.call(a,b))return!1;return!0}var e=a("./isArguments"),f=a("./isArray"),g=a("./isArrayLike"),h=a("./isFunction"),i=a("./isString"),j=Object.prototype,k=j.hasOwnProperty;b.exports=d},{"./isArguments":102,"./isArray":103,"./isArrayLike":104,"./isFunction":107,"./isString":112}],107:[function(a,b,c){function d(a){var b=e(a)?i.call(a):"";return b==f||b==g}var e=a("./isObject"),f="[object Function]",g="[object GeneratorFunction]",h=Object.prototype,i=h.toString;b.exports=d},{"./isObject":110}],108:[function(a,b,c){function d(a){return"number"==typeof a&&a>-1&&a%1==0&&e>=a}var e=9007199254740991;b.exports=d},{}],109:[function(a,b,c){function d(a){return null==a?!1:e(a)?m.test(k.call(a)):g(a)&&(f(a)?m:i).test(a)}var e=a("./isFunction"),f=a("./_isHostObject"),g=a("./isObjectLike"),h=/[\\^$.*+?()[\]{}|]/g,i=/^\[object .+?Constructor\]$/,j=Object.prototype,k=Function.prototype.toString,l=j.hasOwnProperty,m=RegExp("^"+k.call(l).replace(h,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");b.exports=d},{"./_isHostObject":72,"./isFunction":107,"./isObjectLike":111}],110:[function(a,b,c){function d(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}b.exports=d},{}],111:[function(a,b,c){function d(a){return!!a&&"object"==typeof a}b.exports=d},{}],112:[function(a,b,c){function d(a){return"string"==typeof a||!e(a)&&f(a)&&i.call(a)==g}var e=a("./isArray"),f=a("./isObjectLike"),g="[object String]",h=Object.prototype,i=h.toString;b.exports=d},{"./isArray":103,"./isObjectLike":111}],113:[function(a,b,c){function d(a){return"symbol"==typeof a||e(a)&&h.call(a)==f}var e=a("./isObjectLike"),f="[object Symbol]",g=Object.prototype,h=g.toString;b.exports=d},{"./isObjectLike":111}],114:[function(a,b,c){function d(a){return f(a)&&e(a.length)&&!!D[F.call(a)]}var e=a("./isLength"),f=a("./isObjectLike"),g="[object Arguments]",h="[object Array]",i="[object Boolean]",j="[object Date]",k="[object Error]",l="[object Function]",m="[object Map]",n="[object Number]",o="[object Object]",p="[object RegExp]",q="[object Set]",r="[object String]",s="[object WeakMap]",t="[object ArrayBuffer]",u="[object Float32Array]",v="[object Float64Array]",w="[object Int8Array]",x="[object Int16Array]",y="[object Int32Array]",z="[object Uint8Array]",A="[object Uint8ClampedArray]",B="[object Uint16Array]",C="[object Uint32Array]",D={};D[u]=D[v]=D[w]=D[x]=D[y]=D[z]=D[A]=D[B]=D[C]=!0,D[g]=D[h]=D[t]=D[i]=D[j]=D[k]=D[l]=D[m]=D[n]=D[o]=D[p]=D[q]=D[r]=D[s]=!1;var E=Object.prototype,F=E.toString;b.exports=d},{"./isLength":108,"./isObjectLike":111}],115:[function(a,b,c){function d(a){var b=j(a);if(!b&&!h(a))return f(a);var c=g(a),d=!!c,k=c||[],l=k.length;for(var m in a)!e(a,m)||d&&("length"==m||i(m,l))||b&&"constructor"==m||k.push(m);return k}var e=a("./_baseHas"),f=a("./_baseKeys"),g=a("./_indexKeys"),h=a("./isArrayLike"),i=a("./_isIndex"),j=a("./_isPrototype");b.exports=d},{"./_baseHas":39,"./_baseKeys":45,"./_indexKeys":71,"./_isIndex":73,"./_isPrototype":77,"./isArrayLike":104}],116:[function(a,b,c){function d(a){var b=a?a.length:0;return b?a[b-1]:void 0}b.exports=d},{}],117:[function(a,c,d){(function(a){(function(){function e(a,b){return a.set(b[0],b[1]),a}function f(a,b){return a.add(b),a}function g(a,b,c){var d=c.length;switch(d){case 0:return a.call(b);case 1:return a.call(b,c[0]);case 2:return a.call(b,c[0],c[1]);case 3:return a.call(b,c[0],c[1],c[2])}return a.apply(b,c)}function h(a,b,c,d){for(var e=-1,f=a.length;++e<f;){var g=a[e];b(d,g,c(g),a)}return d}function i(a,b){for(var c=-1,d=a.length,e=-1,f=b.length,g=Array(d+f);++c<d;)g[c]=a[c];for(;++e<f;)g[c++]=b[e];return g}function j(a,b){for(var c=-1,d=a.length;++c<d&&b(a[c],c,a)!==!1;);return a}function k(a,b){for(var c=a.length;c--&&b(a[c],c,a)!==!1;);return a}function l(a,b){for(var c=-1,d=a.length;++c<d;)if(!b(a[c],c,a))return!1;return!0}function m(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];b(g,c,a)&&(f[++e]=g)}return f}function n(a,b){return!!a.length&&x(a,b,0)>-1}function o(a,b,c){for(var d=-1,e=a.length;++d<e;)if(c(b,a[d]))return!0;return!1}function p(a,b){for(var c=-1,d=a.length,e=Array(d);++c<d;)e[c]=b(a[c],c,a);return e}function q(a,b){for(var c=-1,d=b.length,e=a.length;++c<d;)a[e+c]=b[c];return a}function r(a,b,c,d){var e=-1,f=a.length;for(d&&f&&(c=a[++e]);++e<f;)c=b(c,a[e],e,a);return c}function s(a,b,c,d){var e=a.length;for(d&&e&&(c=a[--e]);e--;)c=b(c,a[e],e,a);return c}function t(a,b){for(var c=-1,d=a.length;++c<d;)if(b(a[c],c,a))return!0;return!1}function u(a,b,c){for(var d=-1,e=a.length;++d<e;){var f=a[d],g=b(f);if(null!=g&&(h===Z?g===g:c(g,h)))var h=g,i=f}return i}function v(a,b,c,d){var e;return c(a,function(a,c,f){return b(a,c,f)?(e=d?c:a,!1):void 0}),e}function w(a,b,c){for(var d=a.length,e=c?d:-1;c?e--:++e<d;)if(b(a[e],e,a))return e;return-1}function x(a,b,c){if(b!==b)return O(a,c);for(var d=c-1,e=a.length;++d<e;)if(a[d]===b)return d;return-1}function y(a,b,c,d,e){return e(a,function(a,e,f){c=d?(d=!1,a):b(c,a,e,f)}),c}function z(a,b){var c=a.length;for(a.sort(b);c--;)a[c]=a[c].value;return a}function A(a,b){for(var c,d=-1,e=a.length;++d<e;){var f=b(a[d]);f!==Z&&(c=c===Z?f:c+f)}return c}function B(a,b){for(var c=-1,d=Array(a);++c<a;)d[c]=b(c);return d}function C(a,b){return p(b,function(b){return[b,a[b]]})}function D(a){return function(b){return a(b)}}function E(a,b){return p(b,function(b){return a[b]})}function F(a,b){for(var c=-1,d=a.length;++c<d&&x(b,a[c],0)>-1;);return c}function G(a,b){for(var c=a.length;c--&&x(b,a[c],0)>-1;);return c}function H(a){return a&&a.Object===Object?a:null}function I(a,b){if(a!==b){var c=null===a,d=a===Z,e=a===a,f=null===b,g=b===Z,h=b===b;if(a>b&&!f||!e||c&&!g&&h||d&&h)return 1;if(b>a&&!c||!h||f&&!d&&e||g&&e)return-1}return 0}function J(a,b,c){for(var d=-1,e=a.criteria,f=b.criteria,g=e.length,h=c.length;++d<g;){var i=I(e[d],f[d]);if(i){if(d>=h)return i;var j=c[d];return i*("desc"==j?-1:1)}}return a.index-b.index}function K(a,b){for(var c=a.length,d=0;c--;)a[c]===b&&d++;return d}function L(a){return vc[a]}function M(a){return wc[a]}function N(a){return"\\"+zc[a]}function O(a,b,c){for(var d=a.length,e=b+(c?0:-1);c?e--:++e<d;){var f=a[e];if(f!==f)return e}return-1}function P(a){var b=!1;if(null!=a&&"function"!=typeof a.toString)try{b=!!(a+"")}catch(c){}return b}function Q(a,b){return a="number"==typeof a||Bb.test(a)?+a:-1,b=null==b?wa:b,a>-1&&a%1==0&&b>a}function R(a){for(var b,c=[];!(b=a.next()).done;)c.push(b.value);return c}function S(a){var b=-1,c=Array(a.size);return a.forEach(function(a,d){c[++b]=[d,a]}),c}function T(a,b){for(var c=-1,d=a.length,e=-1,f=[];++c<d;){var g=a[c];(g===b||g===Ca)&&(a[c]=Ca,f[++e]=c)}return f}function U(a){var b=-1,c=Array(a.size);return a.forEach(function(a){c[++b]=a}),c}function V(a){if(!a||!nc.test(a))return a.length;for(var b=mc.lastIndex=0;mc.test(a);)b++;return b}function W(a){return a.match(mc)}function X(a){return xc[a]}function Y(a){function b(a){if(Mg(a)&&!uk(a)&&!(a instanceof H)){if(a instanceof d)return a;if(Ri.call(a,"__wrapped__"))return Ge(a)}return new d(a)}function c(){}function d(a,b){this.__wrapped__=a,this.__actions__=[],this.__chain__=!!b,this.__index__=0,this.__values__=Z}function H(a){this.__wrapped__=a,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=za,this.__views__=[]}function Bb(){var a=new H(this.__wrapped__);return a.__actions__=Ld(this.__actions__),a.__dir__=this.__dir__,a.__filtered__=this.__filtered__,a.__iteratees__=Ld(this.__iteratees__),a.__takeCount__=this.__takeCount__,a.__views__=Ld(this.__views__),a}function Fb(){if(this.__filtered__){var a=new H(this);a.__dir__=-1,a.__filtered__=!0}else a=this.clone(),a.__dir__*=-1;return a}function Gb(){var a=this.__wrapped__.value(),b=this.__dir__,c=uk(a),d=0>b,e=c?a.length:0,f=pe(0,e,this.__views__),g=f.start,h=f.end,i=h-g,j=d?h:g-1,k=this.__iteratees__,l=k.length,m=0,n=oj(i,this.__takeCount__);if(!c||pa>e||e==i&&n==i)return zd(a,this.__actions__);var o=[];a:for(;i--&&n>m;){j+=b;for(var p=-1,q=a[j];++p<l;){var r=k[p],s=r.iteratee,t=r.type,u=s(q);if(t==ra)q=u;else if(!u){if(t==qa)continue a;break a}}o[m++]=q}return o}function Hb(){}function Ib(a,b){return Kb(a,b)&&delete a[b]}function Jb(a,b){if(vj){var c=a[b];return c===ua?Z:c}return Ri.call(a,b)?a[b]:Z}function Kb(a,b){return vj?a[b]!==Z:Ri.call(a,b)}function Lb(a,b,c){a[b]=vj&&c===Z?ua:c}function Mb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Nb(){this.__data__={hash:new Hb,map:sj?new sj:[],string:new Hb}}function Ob(a){var b=this.__data__;return xe(a)?Ib("string"==typeof a?b.string:b.hash,a):sj?b.map["delete"](a):_b(b.map,a)}function Pb(a){var b=this.__data__;return xe(a)?Jb("string"==typeof a?b.string:b.hash,a):sj?b.map.get(a):ac(b.map,a)}function Qb(a){var b=this.__data__;return xe(a)?Kb("string"==typeof a?b.string:b.hash,a):sj?b.map.has(a):bc(b.map,a)}function Rb(a,b){var c=this.__data__;return xe(a)?Lb("string"==typeof a?c.string:c.hash,a,b):sj?c.map.set(a,b):dc(c.map,a,b),this}function Sb(a){var b=-1,c=a?a.length:0;for(this.__data__=new Mb;++b<c;)this.push(a[b])}function Tb(a,b){var c=a.__data__;if(xe(b)){var d=c.__data__,e="string"==typeof b?d.string:d.hash;return e[b]===ua}return c.has(b)}function Ub(a){var b=this.__data__;if(xe(a)){var c=b.__data__,d="string"==typeof a?c.string:c.hash;d[a]=ua}else b.set(a,ua)}function Vb(a){var b=-1,c=a?a.length:0;for(this.clear();++b<c;){var d=a[b];this.set(d[0],d[1])}}function Wb(){this.__data__={array:[],map:null}}function Xb(a){var b=this.__data__,c=b.array;return c?_b(c,a):b.map["delete"](a)}function Yb(a){var b=this.__data__,c=b.array;return c?ac(c,a):b.map.get(a)}function Zb(a){var b=this.__data__,c=b.array;return c?bc(c,a):b.map.has(a)}function $b(a,b){var c=this.__data__,d=c.array;d&&(d.length<pa-1?dc(d,a,b):(c.array=null,c.map=new Mb(d)));var e=c.map;return e&&e.set(a,b),this}function _b(a,b){var c=cc(a,b);if(0>c)return!1;var d=a.length-1;return c==d?a.pop():hj.call(a,c,1),!0}function ac(a,b){var c=cc(a,b);return 0>c?Z:a[c][1]}function bc(a,b){return cc(a,b)>-1}function cc(a,b){for(var c=a.length;c--;)if(tg(a[c][0],b))return c;return-1}function dc(a,b,c){var d=cc(a,b);0>d?a.push([b,c]):a[d][1]=c}function ec(a,b,c,d){return a===Z||tg(a,Pi[c])&&!Ri.call(d,c)?b:a}function fc(a,b,c){(c!==Z&&!tg(a[b],c)||"number"==typeof b&&c===Z&&!(b in a))&&(a[b]=c)}function gc(a,b,c){var d=a[b];Ri.call(a,b)&&tg(d,c)&&(c!==Z||b in a)||(a[b]=c)}function hc(a,b,c,d){return Ej(a,function(a,e,f){b(d,a,c(a),f);
}),d}function ic(a,b){return a&&Md(b,yh(b),a)}function jc(a,b){for(var c=-1,d=null==a,e=b.length,f=Array(e);++c<e;)f[c]=d?Z:vh(a,b[c]);return f}function kc(a){return zg(a)?a:[]}function mc(a){return"function"==typeof a?a:ni}function vc(a){return uk(a)?a:Fe(a)}function wc(a,b,c){return a===a&&(c!==Z&&(a=c>=a?a:c),b!==Z&&(a=a>=b?a:b)),a}function xc(a,b,c,d,e,f){var g;if(c&&(g=e?c(a,d,e,f):c(a)),g!==Z)return g;if(!Lg(a))return a;var h=uk(a);if(h){if(g=re(a),!b)return Ld(a,g)}else{var i=oe(a),k=i==Ia||i==Ja;if(vk(a))return Cd(a,b);if(i==Ma||i==Da||k&&!e){if(P(a))return e?a:{};if(g=se(k?{}:a),!b)return Od(a,ic(g,a))}else{if(!uc[i])return e?a:{};g=te(a,i,b)}}f||(f=new Vb);var l=f.get(a);return l?l:(f.set(a,g),(h?j:Mc)(a,function(d,e){gc(g,e,xc(d,b,c,e,a,f))}),h?g:Od(a,g))}function yc(a){var b=yh(a),c=b.length;return function(d){if(null==d)return!c;for(var e=c;e--;){var f=b[e],g=a[f],h=d[f];if(h===Z&&!(f in Object(d))||!g(h))return!1}return!0}}function zc(a){return Lg(a)?ej(a):{}}function Cc(a,b,c){if("function"!=typeof a)throw new Ni(ta);return gj(function(){a.apply(Z,c)},b)}function Dc(a,b,c,d){var e=-1,f=n,g=!0,h=a.length,i=[],j=b.length;if(!h)return i;c&&(b=p(b,D(c))),d?(f=o,g=!1):b.length>=pa&&(f=Tb,g=!1,b=new Sb(b));a:for(;++e<h;){var k=a[e],l=c?c(k):k;if(g&&l===l){for(var m=j;m--;)if(b[m]===l)continue a;i.push(k)}else f(b,l,d)||i.push(k)}return i}function Fc(a,b){var c=!0;return Ej(a,function(a,d,e){return c=!!b(a,d,e)}),c}function Gc(a,b,c,d){var e=a.length;for(c=gh(c),0>c&&(c=-c>e?0:e+c),d=d===Z||d>e?e:gh(d),0>d&&(d+=e),d=c>d?0:hh(d);d>c;)a[c++]=b;return a}function Hc(a,b){var c=[];return Ej(a,function(a,d,e){b(a,d,e)&&c.push(a)}),c}function Ic(a,b,c,d){d||(d=[]);for(var e=-1,f=a.length;++e<f;){var g=a[e];b>0&&zg(g)&&(c||uk(g)||wg(g))?b>1?Ic(g,b-1,c,d):q(d,g):c||(d[d.length]=g)}return d}function Lc(a,b){return null==a?a:Gj(a,b,zh)}function Mc(a,b){return a&&Gj(a,b,yh)}function Nc(a,b){return a&&Hj(a,b,yh)}function Oc(a,b){return m(b,function(b){return Ig(a[b])})}function Pc(a,b){b=we(b,a)?[b+""]:vc(b);for(var c=0,d=b.length;null!=a&&d>c;)a=a[b[c++]];return c&&c==d?a:Z}function Qc(a,b){return Ri.call(a,b)||"object"==typeof a&&b in a&&null===bj(a)}function Rc(a,b){return b in Object(a)}function Sc(a,b,c){return a>=oj(b,c)&&a<nj(b,c)}function Tc(a,b,c){for(var d=c?o:n,e=a.length,f=e,g=Array(e),h=[];f--;){var i=a[f];f&&b&&(i=p(i,D(b))),g[f]=!c&&(b||i.length>=120)?new Sb(f&&i):Z}i=a[0];var j=-1,k=i.length,l=g[0];a:for(;++j<k;){var m=i[j],q=b?b(m):m;if(!(l?Tb(l,q):d(h,q,c))){for(var f=e;--f;){var r=g[f];if(!(r?Tb(r,q):d(a[f],q,c)))continue a}l&&l.push(q),h.push(m)}}return h}function Uc(a,b,c,d){return Mc(a,function(a,e,f){b(d,c(a),e,f)}),d}function Vc(a,b,c){we(b,a)||(b=vc(b),a=De(a,b),b=Ye(b));var d=null==a?a:a[b];return null==d?Z:g(d,a,c)}function Wc(a,b,c,d,e){return a===b?!0:null==a||null==b||!Lg(a)&&!Mg(b)?a!==a&&b!==b:Xc(a,b,Wc,c,d,e)}function Xc(a,b,c,d,e,f){var g=uk(a),h=uk(b),i=Ea,j=Ea;g||(i=oe(a),i==Da?i=Ma:i!=Ma&&(g=_g(a))),h||(j=oe(b),j==Da?j=Ma:j!=Ma&&(h=_g(b)));var k=i==Ma&&!P(a),l=j==Ma&&!P(b),m=i==j;if(m&&!g&&!k)return he(a,b,i,c,d,e);var n=e&ka;if(!n){var o=k&&Ri.call(a,"__wrapped__"),p=l&&Ri.call(b,"__wrapped__");if(o||p)return c(o?a.value():a,p?b.value():b,d,e,f)}return m?(f||(f=new Vb),(g?ge:ie)(a,b,c,d,e,f)):!1}function Yc(a,b,c,d){var e=c.length,f=e,g=!d;if(null==a)return!f;for(a=Object(a);e--;){var h=c[e];if(g&&h[2]?h[1]!==a[h[0]]:!(h[0]in a))return!1}for(;++e<f;){h=c[e];var i=h[0],j=a[i],k=h[1];if(g&&h[2]){if(j===Z&&!(i in a))return!1}else{var l=new Vb,m=d?d(j,k,i,a,b,l):Z;if(!(m===Z?Wc(k,j,d,ja|ka,l):m))return!1}}return!0}function Zc(a){var b=typeof a;return"function"==b?a:null==a?ni:"object"==b?uk(a)?cd(a[0],a[1]):bd(a):vi(a)}function $c(a){return mj(Object(a))}function _c(a){a=null==a?a:Object(a);var b=[];for(var c in a)b.push(c);return b}function ad(a,b){var c=-1,d=yg(a)?Array(a.length):[];return Ej(a,function(a,e,f){d[++c]=b(a,e,f)}),d}function bd(a){var b=le(a);if(1==b.length&&b[0][2]){var c=b[0][0],d=b[0][1];return function(a){return null==a?!1:a[c]===d&&(d!==Z||c in Object(a))}}return function(c){return c===a||Yc(c,a,b)}}function cd(a,b){return function(c){var d=vh(c,a);return d===Z&&d===b?xh(c,a):Wc(b,d,Z,ja|ka)}}function dd(a,b,c,d,e){if(a!==b){var f=uk(b)||_g(b)?Z:zh(b);j(f||b,function(g,h){if(f&&(h=g,g=b[h]),Lg(g))e||(e=new Vb),ed(a,b,h,c,dd,d,e);else{var i=d?d(a[h],g,h+"",a,b,e):Z;i===Z&&(i=g),fc(a,h,i)}})}}function ed(a,b,c,d,e,f,g){var h=a[c],i=b[c],j=g.get(i);if(j)return void fc(a,c,j);var k=f?f(h,i,c+"",a,b,g):Z,l=k===Z;l&&(k=i,uk(i)||_g(i)?uk(h)?k=h:zg(h)?k=Ld(h):(l=!1,k=xc(i,!0)):Vg(i)||wg(i)?wg(h)?k=jh(h):!Lg(h)||d&&Ig(h)?(l=!1,k=xc(i,!0)):k=h:l=!1),g.set(i,k),l&&e(k,i,d,f,g),fc(a,c,k)}function fd(a,b,c){var d=-1,e=ke();b=p(b.length?b:Array(1),function(a){return e(a)});var f=ad(a,function(a,c,e){var f=p(b,function(b){return b(a)});return{criteria:f,index:++d,value:a}});return z(f,function(a,b){return J(a,b,c)})}function gd(a,b){return a=Object(a),r(b,function(b,c){return c in a&&(b[c]=a[c]),b},{})}function hd(a,b){var c={};return Lc(a,function(a,d){b(a,d)&&(c[d]=a)}),c}function id(a){return function(b){return null==b?Z:b[a]}}function jd(a){return function(b){return Pc(b,a)}}function kd(a,b){return ld(a,b)}function ld(a,b,c){var d=-1,e=b.length,f=a;for(c&&(f=p(a,function(a){return c(a)}));++d<e;)for(var g=0,h=b[d],i=c?c(h):h;(g=x(f,i,g))>-1;)f!==a&&hj.call(f,g,1),hj.call(a,g,1);return a}function md(a,b){for(var c=a?b.length:0,d=c-1;c--;){var e=b[c];if(d==c||e!=f){var f=e;if(Q(e))hj.call(a,e,1);else if(we(e,a))delete a[e];else{var g=vc(e),h=De(a,g);null!=h&&delete h[Ye(g)]}}}return a}function nd(a,b){return a+jj(qj()*(b-a+1))}function od(a,b,c,d){for(var e=-1,f=nj(ij((b-a)/(c||1)),0),g=Array(f);f--;)g[d?f:++e]=a,a+=c;return g}function pd(a,b,c,d){b=we(b,a)?[b+""]:vc(b);for(var e=-1,f=b.length,g=f-1,h=a;null!=h&&++e<f;){var i=b[e];if(Lg(h)){var j=c;if(e!=g){var k=h[i];j=d?d(k,i,h):Z,j===Z&&(j=null==k?Q(b[e+1])?[]:{}:k)}gc(h,i,j)}h=h[i]}return a}function qd(a,b,c){var d=-1,e=a.length;0>b&&(b=-b>e?0:e+b),c=c>e?e:c,0>c&&(c+=e),e=b>c?0:c-b>>>0,b>>>=0;for(var f=Array(e);++d<e;)f[d]=a[d+b];return f}function rd(a,b){var c;return Ej(a,function(a,d,e){return c=b(a,d,e),!c}),!!c}function sd(a,b,c){var d=0,e=a?a.length:d;if("number"==typeof b&&b===b&&Ba>=e){for(;e>d;){var f=d+e>>>1,g=a[f];(c?b>=g:b>g)&&null!==g?d=f+1:e=f}return e}return td(a,b,ni,c)}function td(a,b,c,d){b=c(b);for(var e=0,f=a?a.length:0,g=b!==b,h=null===b,i=b===Z;f>e;){var j=jj((e+f)/2),k=c(a[j]),l=k!==Z,m=k===k;if(g)var n=m||d;else n=h?m&&l&&(d||null!=k):i?m&&(d||l):null==k?!1:d?b>=k:b>k;n?e=j+1:f=j}return oj(f,Aa)}function ud(a){return vd(a)}function vd(a,b){for(var c=0,d=a.length,e=a[0],f=b?b(e):e,g=f,h=0,i=[e];++c<d;)e=a[c],f=b?b(e):e,tg(f,g)||(g=f,i[++h]=e);return i}function wd(a,b,c){var d=-1,e=n,f=a.length,g=!0,h=[],i=h;if(c)g=!1,e=o;else if(f>=pa){var j=b?null:Jj(a);if(j)return U(j);g=!1,e=Tb,i=new Sb}else i=b?[]:h;a:for(;++d<f;){var k=a[d],l=b?b(k):k;if(g&&l===l){for(var m=i.length;m--;)if(i[m]===l)continue a;b&&i.push(l),h.push(k)}else e(i,l,c)||(i!==h&&i.push(l),h.push(k))}return h}function xd(a,b){b=we(b,a)?[b+""]:vc(b),a=De(a,b);var c=Ye(b);return null!=a&&wh(a,c)?delete a[c]:!0}function yd(a,b,c,d){for(var e=a.length,f=d?e:-1;(d?f--:++f<e)&&b(a[f],f,a););return c?qd(a,d?0:f,d?f+1:e):qd(a,d?f+1:0,d?e:f)}function zd(a,b){var c=a;return c instanceof H&&(c=c.value()),r(b,function(a,b){return b.func.apply(b.thisArg,q([a],b.args))},c)}function Ad(a,b,c){for(var d=-1,e=a.length;++d<e;)var f=f?q(Dc(f,a[d],b,c),Dc(a[d],f,b,c)):a[d];return f&&f.length?wd(f,b,c):[]}function Bd(a,b,c){for(var d=-1,e=a.length,f=b.length,g={};++d<e;)c(g,a[d],f>d?b[d]:Z);return g}function Cd(a,b){if(b)return a.slice();var c=a.constructor,d=new c(a.length);return a.copy(d),d}function Dd(a){var b=a.constructor,c=new b(a.byteLength),d=new $i(c);return d.set(new $i(a)),c}function Ed(a){var b=a.constructor;return r(S(a),e,new b)}function Fd(a){var b=a.constructor,c=new b(a.source,vb.exec(a));return c.lastIndex=a.lastIndex,c}function Gd(a){var b=a.constructor;return r(U(a),f,new b)}function Hd(a){return Zi?Object(Bj.call(a)):{}}function Id(a,b){var c=a.buffer,d=b?Dd(c):c,e=a.constructor;return new e(d,a.byteOffset,a.length)}function Jd(a,b,c,d){for(var e=-1,f=a.length,g=c.length,h=-1,i=b.length,j=nj(f-g,0),k=Array(i+j),l=!d;++h<i;)k[h]=b[h];for(;++e<g;)(l||f>e)&&(k[c[e]]=a[e]);for(;j--;)k[h++]=a[e++];return k}function Kd(a,b,c,d){for(var e=-1,f=a.length,g=-1,h=c.length,i=-1,j=b.length,k=nj(f-h,0),l=Array(k+j),m=!d;++e<k;)l[e]=a[e];for(var n=e;++i<j;)l[n+i]=b[i];for(;++g<h;)(m||f>e)&&(l[n+c[g]]=a[e++]);return l}function Ld(a,b){var c=-1,d=a.length;for(b||(b=Array(d));++c<d;)b[c]=a[c];return b}function Md(a,b,c){return Nd(a,b,c)}function Nd(a,b,c,d){c||(c={});for(var e=-1,f=b.length;++e<f;){var g=b[e],h=d?d(c[g],a[g],g,c,a):a[g];gc(c,g,h)}return c}function Od(a,b){return Md(a,Mj(a),b)}function Pd(a,b){return function(c,d){var e=uk(c)?h:hc,f=b?b():{};return e(c,a,ke(d),f)}}function Qd(a){return jg(function(b,c){var d=-1,e=c.length,f=e>1?c[e-1]:Z,g=e>2?c[2]:Z;for(f="function"==typeof f?(e--,f):Z,g&&ve(c[0],c[1],g)&&(f=3>e?Z:f,e=1),b=Object(b);++d<e;){var h=c[d];h&&a(b,h,d,f)}return b})}function Rd(a,b){return function(c,d){if(null==c)return c;if(!yg(c))return a(c,d);for(var e=c.length,f=b?e:-1,g=Object(c);(b?f--:++f<e)&&d(g[f],f,g)!==!1;);return c}}function Sd(a){return function(b,c,d){for(var e=-1,f=Object(b),g=d(b),h=g.length;h--;){var i=g[a?h:++e];if(c(f[i],i,f)===!1)break}return b}}function Td(a,b,c){function d(){var b=this&&this!==Jc&&this instanceof d?f:a;return b.apply(e?c:this,arguments)}var e=b&_,f=Wd(a);return d}function Ud(a){return function(b){b=lh(b);var c=nc.test(b)?W(b):Z,d=c?c[0]:b.charAt(0),e=c?c.slice(1).join(""):b.slice(1);return d[a]()+e}}function Vd(a){return function(b){return r(ji(Rh(b)),a,"")}}function Wd(a){return function(){var b=arguments;switch(b.length){case 0:return new a;case 1:return new a(b[0]);case 2:return new a(b[0],b[1]);case 3:return new a(b[0],b[1],b[2]);case 4:return new a(b[0],b[1],b[2],b[3]);case 5:return new a(b[0],b[1],b[2],b[3],b[4]);case 6:return new a(b[0],b[1],b[2],b[3],b[4],b[5]);case 7:return new a(b[0],b[1],b[2],b[3],b[4],b[5],b[6])}var c=zc(a.prototype),d=a.apply(c,b);return Lg(d)?d:c}}function Xd(a,b,c){function d(){for(var f=arguments.length,h=Array(f),i=f,j=ne(d);i--;)h[i]=arguments[i];var k=3>f&&h[0]!==j&&h[f-1]!==j?[]:T(h,j);if(f-=k.length,c>f)return de(a,b,Zd,d.placeholder,Z,h,k,Z,Z,c-f);var l=this&&this!==Jc&&this instanceof d?e:a;return g(l,this,h)}var e=Wd(a);return d}function Yd(a){return jg(function(b){b=Ic(b,1);var c=b.length,e=c,f=d.prototype.thru;for(a&&b.reverse();e--;){var g=b[e];if("function"!=typeof g)throw new Ni(ta);if(f&&!h&&"wrapper"==je(g))var h=new d([],!0)}for(e=h?e:c;++e<c;){g=b[e];var i=je(g),j="wrapper"==i?Kj(g):Z;h=j&&ye(j[0])&&j[1]==(ga|ca|ea|ha)&&!j[4].length&&1==j[9]?h[je(j[0])].apply(h,j[3]):1==g.length&&ye(g)?h[i]():h.thru(g)}return function(){var a=arguments,d=a[0];if(h&&1==a.length&&uk(d)&&d.length>=pa)return h.plant(d).value();for(var e=0,f=c?b[e].apply(this,a):d;++e<c;)f=b[e].call(this,f);return f}})}function Zd(a,b,c,d,e,f,g,h,i,j){function k(){for(var r=arguments.length,s=r,t=Array(r);s--;)t[s]=arguments[s];if(o)var u=ne(k),v=K(t,u);if(d&&(t=Jd(t,d,e,o)),f&&(t=Kd(t,f,g,o)),r-=v,o&&j>r){var w=T(t,u);return de(a,b,Zd,k.placeholder,c,t,w,h,i,j-r)}var x=m?c:this,y=n?x[a]:a;return r=t.length,h?t=Ee(t,h):p&&r>1&&t.reverse(),l&&r>i&&(t.length=i),this&&this!==Jc&&this instanceof k&&(y=q||Wd(y)),y.apply(x,t)}var l=b&ga,m=b&_,n=b&aa,o=b&(ca|da),p=b&ia,q=n?Z:Wd(a);return k}function $d(a,b){return function(c,d){return Uc(c,a,b(d),{})}}function _d(a){return jg(function(b){return b=p(Ic(b,1),ke()),jg(function(c){var d=this;return a(b,function(a){return g(a,d,c)})})})}function ae(a,b,c){b=gh(b);var d=V(a);if(!b||d>=b)return"";var e=b-d;c=c===Z?" ":c+"";var f=Zh(c,ij(e/V(c)));return nc.test(c)?W(f).slice(0,e).join(""):f.slice(0,e)}function be(a,b,c,d){function e(){for(var b=-1,i=arguments.length,j=-1,k=d.length,l=Array(k+i),m=this&&this!==Jc&&this instanceof e?h:a;++j<k;)l[j]=d[j];for(;i--;)l[j++]=arguments[++b];return g(m,f?c:this,l)}var f=b&_,h=Wd(a);return e}function ce(a){return function(b,c,d){return d&&"number"!=typeof d&&ve(b,c,d)&&(c=d=Z),b=ih(b),b=b===b?b:0,c===Z?(c=b,b=0):c=ih(c)||0,d=d===Z?c>b?1:-1:ih(d)||0,od(b,c,d,a)}}function de(a,b,c,d,e,f,g,h,i,j){var k=b&ca,l=h?Ld(h):Z,m=k?g:Z,n=k?Z:g,o=k?f:Z,p=k?Z:f;b|=k?ea:fa,b&=~(k?fa:ea),b&ba||(b&=~(_|aa));var q=[a,b,e,o,m,p,n,l,i,j],r=c.apply(Z,q);return ye(a)&&Nj(r,q),r.placeholder=d,r}function ee(a){var b=Li[a];return function(a,c){if(a=ih(a),c=gh(c)){var d=(lh(a)+"e").split("e"),e=b(d[0]+"e"+(+d[1]+c));return d=(lh(e)+"e").split("e"),+(d[0]+"e"+(+d[1]-c))}return b(a)}}function fe(a,b,c,d,e,f,g,h){var i=b&aa;if(!i&&"function"!=typeof a)throw new Ni(ta);var j=d?d.length:0;if(j||(b&=~(ea|fa),d=e=Z),g=g===Z?g:nj(gh(g),0),h=h===Z?h:gh(h),j-=e?e.length:0,b&fa){var k=d,l=e;d=e=Z}var m=i?Z:Kj(a),n=[a,b,c,d,e,k,l,f,g,h];if(m&&Be(n,m),a=n[0],b=n[1],c=n[2],d=n[3],e=n[4],h=n[9]=null==n[9]?i?0:a.length:nj(n[9]-j,0),!h&&b&(ca|da)&&(b&=~(ca|da)),b&&b!=_)o=b==ca||b==da?Xd(a,b,h):b!=ea&&b!=(_|ea)||e.length?Zd.apply(Z,n):be(a,b,c,d);else var o=Td(a,b,c);var p=m?Ij:Nj;return p(o,n)}function ge(a,b,c,d,e,f){var g=-1,h=e&ka,i=e&ja,j=a.length,k=b.length;if(j!=k&&!(h&&k>j))return!1;var l=f.get(a);if(l)return l==b;var m=!0;for(f.set(a,b);++g<j;){var n=a[g],o=b[g];if(d)var p=h?d(o,n,g,b,a,f):d(n,o,g,a,b,f);if(p!==Z){if(p)continue;m=!1;break}if(i){if(!t(b,function(a){return n===a||c(n,a,d,e,f)})){m=!1;break}}else if(n!==o&&!c(n,o,d,e,f)){m=!1;break}}return f["delete"](a),m}function he(a,b,c,d,e,f){switch(c){case Ta:return a.byteLength==b.byteLength&&d(new $i(a),new $i(b))?!0:!1;case Fa:case Ga:return+a==+b;case Ha:return a.name==b.name&&a.message==b.message;case La:return a!=+a?b!=+b:a==+b;case Na:case Pa:return a==b+"";case Ka:var g=S;case Oa:var h=f&ka;return g||(g=U),(h||a.size==b.size)&&d(g(a),g(b),e,f|ja);case Qa:return!!Zi&&Bj.call(a)==Bj.call(b)}return!1}function ie(a,b,c,d,e,f){var g=e&ka,h=yh(a),i=h.length,j=yh(b),k=j.length;if(i!=k&&!g)return!1;for(var l=i;l--;){var m=h[l];if(!(g?m in b:Qc(b,m)))return!1}var n=f.get(a);if(n)return n==b;var o=!0;f.set(a,b);for(var p=g;++l<i;){m=h[l];var q=a[m],r=b[m];if(d)var s=g?d(r,q,m,b,a,f):d(q,r,m,a,b,f);if(!(s===Z?q===r||c(q,r,d,e,f):s)){o=!1;break}p||(p="constructor"==m)}if(o&&!p){var t=a.constructor,u=b.constructor;t!=u&&"constructor"in a&&"constructor"in b&&!("function"==typeof t&&t instanceof t&&"function"==typeof u&&u instanceof u)&&(o=!1)}return f["delete"](a),o}function je(a){for(var b=a.name+"",c=Dj[b],d=Ri.call(Dj,b)?c.length:0;d--;){var e=c[d],f=e.func;if(null==f||f==a)return e.name}return b}function ke(){var a=b.iteratee||oi;return a=a===oi?Zc:a,arguments.length?a(arguments[0],arguments[1]):a}function le(a){for(var b=Hh(a),c=b.length;c--;)b[c][2]=Ae(b[c][1]);return b}function me(a,b){var c=null==a?Z:a[b];return Rg(c)?c:Z}function ne(a){var c=Ri.call(b,"placeholder")?b:a;return c.placeholder}function oe(a){return Ui.call(a)}function pe(a,b,c){for(var d=-1,e=c.length;++d<e;){var f=c[d],g=f.size;switch(f.type){case"drop":a+=g;break;case"dropRight":b-=g;break;case"take":b=oj(b,a+g);break;case"takeRight":a=nj(a,b-g)}}return{start:a,end:b}}function qe(a,b,c){if(null==a)return!1;var d=c(a,b);d||we(b)||(b=vc(b),a=De(a,b),null!=a&&(b=Ye(b),d=c(a,b)));var e=a?a.length:Z;return d||!!e&&Kg(e)&&Q(b,e)&&(uk(a)||Zg(a)||wg(a))}function re(a){var b=a.length,c=a.constructor(b);return b&&"string"==typeof a[0]&&Ri.call(a,"index")&&(c.index=a.index,c.input=a.input),c}function se(a){return Ig(a.constructor)&&!ze(a)?zc(bj(a)):{}}function te(a,b,c){var d=a.constructor;switch(b){case Ta:return Dd(a);case Fa:case Ga:return new d(+a);case Ua:case Va:case Wa:case Xa:case Ya:case Za:case $a:case _a:case ab:return Id(a,c);case Ka:return Ed(a);case La:case Pa:return new d(a);case Na:return Fd(a);case Oa:return Gd(a);case Qa:return Hd(a)}}function ue(a){var b=a?a.length:Z;return Kg(b)&&(uk(a)||Zg(a)||wg(a))?B(b,String):null}function ve(a,b,c){if(!Lg(c))return!1;var d=typeof b;return("number"==d?yg(c)&&Q(b,c.length):"string"==d&&b in c)?tg(c[b],a):!1}function we(a,b){return"number"==typeof a?!0:!uk(a)&&(mb.test(a)||!lb.test(a)||null!=b&&a in Object(b))}function xe(a){var b=typeof a;return"number"==b||"boolean"==b||"string"==b&&"__proto__"!=a||null==a}function ye(a){var c=je(a),d=b[c];if("function"!=typeof d||!(c in H.prototype))return!1;if(a===d)return!0;var e=Kj(d);return!!e&&a===e[0]}function ze(a){var b=a&&a.constructor,c=Ig(b)&&b.prototype||Pi;return a===c}function Ae(a){return a===a&&!Lg(a)}function Be(a,b){var c=a[1],d=b[1],e=c|d,f=(_|aa|ga)>e,g=d==ga&&c==ca||d==ga&&c==ha&&a[7].length<=b[8]||d==(ga|ha)&&b[7].length<=b[8]&&c==ca;if(!f&&!g)return a;d&_&&(a[2]=b[2],e|=c&_?0:ba);var h=b[3];if(h){var i=a[3];a[3]=i?Jd(i,h,b[4]):Ld(h),a[4]=i?T(a[3],Ca):Ld(b[4])}return h=b[5],h&&(i=a[5],a[5]=i?Kd(i,h,b[6]):Ld(h),a[6]=i?T(a[5],Ca):Ld(b[6])),h=b[7],h&&(a[7]=Ld(h)),d&ga&&(a[8]=null==a[8]?b[8]:oj(a[8],b[8])),null==a[9]&&(a[9]=b[9]),a[0]=b[0],a[1]=e,a}function Ce(a,b,c,d,e,f){return Lg(a)&&Lg(b)&&(f.set(b,a),dd(a,b,Z,Ce,f)),a}function De(a,b){return 1==b.length?a:vh(a,qd(b,0,-1))}function Ee(a,b){for(var c=a.length,d=oj(b.length,c),e=Ld(a);d--;){var f=b[d];a[d]=Q(f,c)?e[f]:Z}return a}function Fe(a){var b=[];return lh(a).replace(nb,function(a,c,d,e){b.push(d?e.replace(tb,"$1"):c||a)}),b}function Ge(a){if(a instanceof H)return a.clone();var b=new d(a.__wrapped__,a.__chain__);return b.__actions__=Ld(a.__actions__),b.__index__=a.__index__,b.__values__=a.__values__,b}function He(a,b){b=nj(gh(b),0);var c=a?a.length:0;if(!c||1>b)return[];for(var d=0,e=-1,f=Array(ij(c/b));c>d;)f[++e]=qd(a,d,d+=b);return f}function Ie(a){for(var b=-1,c=a?a.length:0,d=-1,e=[];++b<c;){var f=a[b];f&&(e[++d]=f)}return e}function Je(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),qd(a,0>b?0:b,d)):[]}function Ke(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),b=d-b,qd(a,0,0>b?0:b)):[]}function Le(a,b){return a&&a.length?yd(a,ke(b,3),!0,!0):[]}function Me(a,b){return a&&a.length?yd(a,ke(b,3),!0):[]}function Ne(a,b,c,d){var e=a?a.length:0;return e?(c&&"number"!=typeof c&&ve(a,b,c)&&(c=0,d=e),Gc(a,b,c,d)):[]}function Oe(a,b){return a&&a.length?w(a,ke(b,3)):-1}function Pe(a,b){return a&&a.length?w(a,ke(b,3),!0):-1}function Qe(a){var b=a?a.length:0;return b?Ic(a,1):[]}function Re(a){var b=a?a.length:0;return b?Ic(a,va):[]}function Se(a,b){var c=a?a.length:0;return c?(b=b===Z?1:gh(b),Ic(a,b)):[]}function Te(a){for(var b=-1,c=a?a.length:0,d={};++b<c;){var e=a[b];d[e[0]]=e[1]}return d}function Ue(a){return a?a[0]:Z}function Ve(a,b,c){var d=a?a.length:0;return d?(c=gh(c),0>c&&(c=nj(d+c,0)),x(a,b,c)):-1}function We(a){return Ke(a,1)}function Xe(a,b){return a?lj.call(a,b):""}function Ye(a){var b=a?a.length:0;return b?a[b-1]:Z}function Ze(a,b,c){var d=a?a.length:0;if(!d)return-1;var e=d;if(c!==Z&&(e=gh(c),e=(0>e?nj(d+e,0):oj(e,d-1))+1),b!==b)return O(a,e,!0);for(;e--;)if(a[e]===b)return e;return-1}function $e(a,b){return a&&a.length&&b&&b.length?kd(a,b):a}function _e(a,b,c){return a&&a.length&&b&&b.length?ld(a,b,ke(c)):a}function af(a,b){var c=[];if(!a||!a.length)return c;var d=-1,e=[],f=a.length;for(b=ke(b,3);++d<f;){var g=a[d];b(g,d,a)&&(c.push(g),e.push(d))}return md(a,e),c}function bf(a){return a?rj.call(a):a}function cf(a,b,c){var d=a?a.length:0;return d?(c&&"number"!=typeof c&&ve(a,b,c)?(b=0,c=d):(b=null==b?0:gh(b),c=c===Z?d:gh(c)),qd(a,b,c)):[]}function df(a,b){return sd(a,b)}function ef(a,b,c){return td(a,b,ke(c))}function ff(a,b){var c=a?a.length:0;if(c){var d=sd(a,b);if(c>d&&tg(a[d],b))return d}return-1}function gf(a,b){return sd(a,b,!0)}function hf(a,b,c){return td(a,b,ke(c),!0)}function jf(a,b){var c=a?a.length:0;if(c){var d=sd(a,b,!0)-1;if(tg(a[d],b))return d}return-1}function kf(a){return a&&a.length?ud(a):[]}function lf(a,b){return a&&a.length?vd(a,ke(b)):[]}function mf(a){return Je(a,1)}function nf(a,b,c){return a&&a.length?(b=c||b===Z?1:gh(b),qd(a,0,0>b?0:b)):[]}function of(a,b,c){var d=a?a.length:0;return d?(b=c||b===Z?1:gh(b),b=d-b,qd(a,0>b?0:b,d)):[]}function pf(a,b){return a&&a.length?yd(a,ke(b,3),!1,!0):[]}function qf(a,b){return a&&a.length?yd(a,ke(b,3)):[]}function rf(a){return a&&a.length?wd(a):[]}function sf(a,b){return a&&a.length?wd(a,ke(b)):[]}function tf(a,b){return a&&a.length?wd(a,Z,b):[]}function uf(a){if(!a||!a.length)return[];var b=0;return a=m(a,function(a){return zg(a)?(b=nj(a.length,b),!0):void 0}),B(b,function(b){return p(a,id(b))})}function vf(a,b){if(!a||!a.length)return[];var c=uf(a);return null==b?c:p(c,function(a){return g(b,Z,a)})}function wf(a,b){return Bd(a||[],b||[],gc)}function xf(a,b){return Bd(a||[],b||[],pd)}function yf(a){var c=b(a);return c.__chain__=!0,c}function zf(a,b){return b(a),a}function Af(a,b){return b(a)}function Bf(){return yf(this)}function Cf(){return new d(this.value(),this.__chain__)}function Df(a){return this.map(a).flatten()}function Ef(){this.__values__===Z&&(this.__values__=fh(this.value()));var a=this.__index__>=this.__values__.length,b=a?Z:this.__values__[this.__index__++];return{done:a,value:b}}function Ff(){return this}function Gf(a){for(var b,d=this;d instanceof c;){var e=Ge(d);e.__index__=0,e.__values__=Z,b?f.__wrapped__=e:b=e;var f=e;d=d.__wrapped__}return f.__wrapped__=a,b}function Hf(){var a=this.__wrapped__;if(a instanceof H){var b=a;return this.__actions__.length&&(b=new H(this)),b=b.reverse(),b.__actions__.push({func:Af,args:[bf],thisArg:Z}),new d(b,this.__chain__)}return this.thru(bf)}function If(){return zd(this.__wrapped__,this.__actions__)}function Jf(a,b,c){var d=uk(a)?l:Fc;return c&&ve(a,b,c)&&(b=Z),d(a,ke(b,3))}function Kf(a,b){var c=uk(a)?m:Hc;return c(a,ke(b,3))}function Lf(a,b){if(b=ke(b,3),uk(a)){var c=w(a,b);return c>-1?a[c]:Z}return v(a,b,Ej)}function Mf(a,b){if(b=ke(b,3),uk(a)){var c=w(a,b,!0);return c>-1?a[c]:Z}return v(a,b,Fj)}function Nf(a,b){return Ic(Rf(a,b),1)}function Of(a,b){return"function"==typeof b&&uk(a)?j(a,b):Ej(a,mc(b))}function Pf(a,b){return"function"==typeof b&&uk(a)?k(a,b):Fj(a,mc(b))}function Qf(a,b,c,d){a=yg(a)?a:Lh(a),c=c&&!d?gh(c):0;var e=a.length;return 0>c&&(c=nj(e+c,0)),Zg(a)?e>=c&&a.indexOf(b,c)>-1:!!e&&x(a,b,c)>-1}function Rf(a,b){var c=uk(a)?p:ad;return c(a,ke(b,3))}function Sf(a,b,c,d){return null==a?[]:(uk(b)||(b=null==b?[]:[b]),c=d?Z:c,uk(c)||(c=null==c?[]:[c]),fd(a,b,c))}function Tf(a,b,c){var d=uk(a)?r:y,e=arguments.length<3;return d(a,ke(b,4),c,e,Ej)}function Uf(a,b,c){var d=uk(a)?s:y,e=arguments.length<3;return d(a,ke(b,4),c,e,Fj)}function Vf(a,b){var c=uk(a)?m:Hc;return b=ke(b,3),c(a,function(a,c,d){return!b(a,c,d)})}function Wf(a){var b=yg(a)?a:Lh(a),c=b.length;return c>0?b[nd(0,c-1)]:Z}function Xf(a,b){var c=-1,d=fh(a),e=d.length,f=e-1;for(b=wc(gh(b),0,e);++c<b;){var g=nd(c,f),h=d[g];d[g]=d[c],d[c]=h}return d.length=b,d}function Yf(a){return Xf(a,za)}function Zf(a){if(null==a)return 0;if(yg(a)){var b=a.length;return b&&Zg(a)?V(a):b}return yh(a).length}function $f(a,b,c){var d=uk(a)?t:rd;return c&&ve(a,b,c)&&(b=Z),d(a,ke(b,3))}function _f(a,b){if("function"!=typeof b)throw new Ni(ta);return a=gh(a),function(){return--a<1?b.apply(this,arguments):void 0}}function ag(a,b,c){return b=c?Z:b,b=a&&null==b?a.length:b,fe(a,ga,Z,Z,Z,Z,b)}function bg(a,b){var c;if("function"!=typeof b)throw new Ni(ta);return a=gh(a),function(){return--a>0&&(c=b.apply(this,arguments)),1>=a&&(b=Z),c}}function cg(a,b,c){b=c?Z:b;var d=fe(a,ca,Z,Z,Z,Z,Z,b);return d.placeholder=cg.placeholder,d}function dg(a,b,c){b=c?Z:b;var d=fe(a,da,Z,Z,Z,Z,Z,b);return d.placeholder=dg.placeholder,d}function eg(a,b,c){function d(){o&&_i(o),k&&_i(k),q=0,j=k=n=o=p=Z}function e(b,c){c&&_i(c),k=o=p=Z,b&&(q=lk(),l=a.apply(n,j),o||k||(j=n=Z))}function f(){var a=b-(lk()-m);0>=a||a>b?e(p,k):o=gj(f,a)}function g(){return(o&&p||k&&t)&&(l=a.apply(n,j)),d(),l}function h(){e(t,o)}function i(){if(j=arguments,m=lk(),n=this,p=t&&(o||!r),s===!1)var c=r&&!o;else{q||k||r||(q=m);var d=s-(m-q),e=(0>=d||d>s)&&(r||k);e?(k&&(k=_i(k)),q=m,l=a.apply(n,j)):k||(k=gj(h,d))}return e&&o?o=_i(o):o||b===s||(o=gj(f,b)),c&&(e=!0,l=a.apply(n,j)),!e||o||k||(j=n=Z),l}var j,k,l,m,n,o,p,q=0,r=!1,s=!1,t=!0;if("function"!=typeof a)throw new Ni(ta);return b=ih(b)||0,Lg(c)&&(r=!!c.leading,s="maxWait"in c&&nj(ih(c.maxWait)||0,b),t="trailing"in c?!!c.trailing:t),i.cancel=d,i.flush=g,i}function fg(a){return fe(a,ia)}function gg(a,b){if("function"!=typeof a||b&&"function"!=typeof b)throw new Ni(ta);var c=function(){var d=arguments,e=b?b.apply(this,d):d[0],f=c.cache;if(f.has(e))return f.get(e);var g=a.apply(this,d);return c.cache=f.set(e,g),g};return c.cache=new gg.Cache,c}function hg(a){if("function"!=typeof a)throw new Ni(ta);return function(){return!a.apply(this,arguments)}}function ig(a){return bg(2,a)}function jg(a,b){if("function"!=typeof a)throw new Ni(ta);return b=nj(b===Z?a.length-1:gh(b),0),function(){for(var c=arguments,d=-1,e=nj(c.length-b,0),f=Array(e);++d<e;)f[d]=c[b+d];switch(b){case 0:return a.call(this,f);case 1:return a.call(this,c[0],f);case 2:return a.call(this,c[0],c[1],f)}var h=Array(b+1);for(d=-1;++d<b;)h[d]=c[d];return h[b]=f,g(a,this,h)}}function kg(a,b){if("function"!=typeof a)throw new Ni(ta);return b=b===Z?0:nj(gh(b),0),jg(function(c){var d=c[b],e=c.slice(0,b);return d&&q(e,d),g(a,this,e)})}function lg(a,b,c){var d=!0,e=!0;if("function"!=typeof a)throw new Ni(ta);return Lg(c)&&(d="leading"in c?!!c.leading:d,e="trailing"in c?!!c.trailing:e),eg(a,b,{leading:d,maxWait:b,trailing:e})}function mg(a){return ag(a,1)}function ng(a,b){return b=null==b?ni:b,rk(b,a)}function og(){if(!arguments.length)return[];var a=arguments[0];return uk(a)?a:[a]}function pg(a){return xc(a)}function qg(a,b){return xc(a,!1,b)}function rg(a){return xc(a,!0)}function sg(a,b){return xc(a,!0,b)}function tg(a,b){return a===b||a!==a&&b!==b}function ug(a,b){return a>b}function vg(a,b){return a>=b}function wg(a){return zg(a)&&Ri.call(a,"callee")&&(!fj.call(a,"callee")||Ui.call(a)==Da)}function xg(a){return Mg(a)&&Ui.call(a)==Ta}function yg(a){return null!=a&&!("function"==typeof a&&Ig(a))&&Kg(Lj(a))}function zg(a){return Mg(a)&&yg(a)}function Ag(a){return a===!0||a===!1||Mg(a)&&Ui.call(a)==Fa}function Bg(a){return Mg(a)&&Ui.call(a)==Ga}function Cg(a){return!!a&&1===a.nodeType&&Mg(a)&&!Vg(a)}function Dg(a){if(yg(a)&&(uk(a)||Zg(a)||Ig(a.splice)||wg(a)))return!a.length;for(var b in a)if(Ri.call(a,b))return!1;return!0}function Eg(a,b){return Wc(a,b)}function Fg(a,b,c){c="function"==typeof c?c:Z;var d=c?c(a,b):Z;return d===Z?Wc(a,b,c):!!d}function Gg(a){return Mg(a)?Ui.call(a)==Ha||"string"==typeof a.message&&"string"==typeof a.name:!1}function Hg(a){return"number"==typeof a&&kj(a)}function Ig(a){var b=Lg(a)?Ui.call(a):"";return b==Ia||b==Ja}function Jg(a){return"number"==typeof a&&a==gh(a)}function Kg(a){return"number"==typeof a&&a>-1&&a%1==0&&wa>=a}function Lg(a){var b=typeof a;return!!a&&("object"==b||"function"==b)}function Mg(a){return!!a&&"object"==typeof a}function Ng(a){return Mg(a)&&oe(a)==Ka}function Og(a,b){return a===b||Yc(a,b,le(b))}function Pg(a,b,c){return c="function"==typeof c?c:Z,Yc(a,b,le(b),c)}function Qg(a){return Ug(a)&&a!=+a}function Rg(a){return null==a?!1:Ig(a)?Wi.test(Qi.call(a)):Mg(a)&&(P(a)?Wi:zb).test(a)}function Sg(a){return null===a}function Tg(a){return null==a}function Ug(a){return"number"==typeof a||Mg(a)&&Ui.call(a)==La}function Vg(a){if(!Mg(a)||Ui.call(a)!=Ma||P(a))return!1;var b=bj(a);if(null===b)return!0;var c=b.constructor;return"function"==typeof c&&c instanceof c&&Qi.call(c)==Ti}function Wg(a){return Lg(a)&&Ui.call(a)==Na}function Xg(a){return Jg(a)&&a>=-wa&&wa>=a}function Yg(a){return Mg(a)&&oe(a)==Oa}function Zg(a){return"string"==typeof a||!uk(a)&&Mg(a)&&Ui.call(a)==Pa}function $g(a){return"symbol"==typeof a||Mg(a)&&Ui.call(a)==Qa}function _g(a){return Mg(a)&&Kg(a.length)&&!!tc[Ui.call(a)]}function ah(a){return a===Z}function bh(a){return Mg(a)&&oe(a)==Ra}function ch(a){return Mg(a)&&Ui.call(a)==Sa}function dh(a,b){return b>a}function eh(a,b){return b>=a}function fh(a){if(!a)return[];if(yg(a))return Zg(a)?W(a):Ld(a);if(dj&&a[dj])return R(a[dj]());var b=oe(a),c=b==Ka?S:b==Oa?U:Lh;return c(a)}function gh(a){if(!a)return 0===a?a:0;if(a=ih(a),a===va||a===-va){var b=0>a?-1:1;return b*xa}var c=a%1;return a===a?c?a-c:a:0}function hh(a){return a?wc(gh(a),0,za):0}function ih(a){if(Lg(a)){var b=Ig(a.valueOf)?a.valueOf():a;a=Lg(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(qb,"");var c=yb.test(a);return c||Ab.test(a)?Bc(a.slice(2),c?2:8):xb.test(a)?ya:+a}function jh(a){return Md(a,zh(a))}function kh(a){return wc(gh(a),-wa,wa)}function lh(a){if("string"==typeof a)return a;if(null==a)return"";if($g(a))return Zi?Cj.call(a):"";var b=a+"";return"0"==b&&1/a==-va?"-0":b}function mh(a,b){var c=zc(a);return b?ic(c,b):c}function nh(a,b){return v(a,ke(b,3),Mc,!0)}function oh(a,b){return v(a,ke(b,3),Nc,!0)}function ph(a,b){return null==a?a:Gj(a,mc(b),zh)}function qh(a,b){return null==a?a:Hj(a,mc(b),zh)}function rh(a,b){return a&&Mc(a,mc(b))}function sh(a,b){return a&&Nc(a,mc(b))}function th(a){return null==a?[]:Oc(a,yh(a))}function uh(a){return null==a?[]:Oc(a,zh(a))}function vh(a,b,c){var d=null==a?Z:Pc(a,b);return d===Z?c:d}function wh(a,b){return qe(a,b,Qc)}function xh(a,b){return qe(a,b,Rc)}function yh(a){var b=ze(a);if(!b&&!yg(a))return $c(a);var c=ue(a),d=!!c,e=c||[],f=e.length;for(var g in a)!Qc(a,g)||d&&("length"==g||Q(g,f))||b&&"constructor"==g||e.push(g);return e}function zh(a){for(var b=-1,c=ze(a),d=_c(a),e=d.length,f=ue(a),g=!!f,h=f||[],i=h.length;++b<e;){var j=d[b];g&&("length"==j||Q(j,i))||"constructor"==j&&(c||!Ri.call(a,j))||h.push(j)}return h}function Ah(a,b){var c={};return b=ke(b,3),Mc(a,function(a,d,e){c[b(a,d,e)]=a}),c}function Bh(a,b){var c={};return b=ke(b,3),Mc(a,function(a,d,e){c[d]=b(a,d,e)}),c}function Ch(a,b){return b=ke(b),hd(a,function(a,c){return!b(a,c)})}function Dh(a,b){return null==a?{}:hd(a,ke(b))}function Eh(a,b,c){if(we(b,a))d=null==a?Z:a[b];else{b=vc(b);var d=vh(a,b);a=De(a,b)}return d===Z&&(d=c),Ig(d)?d.call(a):d}function Fh(a,b,c){return null==a?a:pd(a,b,c)}function Gh(a,b,c,d){return d="function"==typeof d?d:Z,null==a?a:pd(a,b,c,d)}function Hh(a){return C(a,yh(a))}function Ih(a){return C(a,zh(a))}function Jh(a,b,c){var d=uk(a)||_g(a);if(b=ke(b,4),null==c)if(d||Lg(a)){var e=a.constructor;c=d?uk(a)?new e:[]:Ig(e)?zc(bj(a)):{}}else c={};return(d?j:Mc)(a,function(a,d,e){return b(c,a,d,e)}),c}function Kh(a,b){return null==a?!0:xd(a,b)}function Lh(a){return a?E(a,yh(a)):[]}function Mh(a){return null==a?[]:E(a,zh(a))}function Nh(a,b,c){return c===Z&&(c=b,b=Z),c!==Z&&(c=ih(c),c=c===c?c:0),b!==Z&&(b=ih(b),b=b===b?b:0),wc(ih(a),b,c)}function Oh(a,b,c){return b=ih(b)||0,c===Z?(c=b,b=0):c=ih(c)||0,a=ih(a),Sc(a,b,c)}function Ph(a,b,c){if(c&&"boolean"!=typeof c&&ve(a,b,c)&&(b=c=Z),c===Z&&("boolean"==typeof b?(c=b,b=Z):"boolean"==typeof a&&(c=a,a=Z)),a===Z&&b===Z?(a=0,b=1):(a=ih(a)||0,b===Z?(b=a,a=0):b=ih(b)||0),a>b){var d=a;a=b,b=d}if(c||a%1||b%1){var e=qj();return oj(a+e*(b-a+Ac("1e-"+((e+"").length-1))),b)}return nd(a,b)}function Qh(a){return Ok(lh(a).toLowerCase())}function Rh(a){return a=lh(a),a&&a.replace(Cb,L).replace(lc,"")}function Sh(a,b,c){a=lh(a),b="string"==typeof b?b:b+"";var d=a.length;return c=c===Z?d:wc(gh(c),0,d),c-=b.length,c>=0&&a.indexOf(b,c)==c}function Th(a){return a=lh(a),a&&hb.test(a)?a.replace(fb,M):a}function Uh(a){return a=lh(a),a&&pb.test(a)?a.replace(ob,"\\$&"):a}function Vh(a,b,c){a=lh(a),b=gh(b);var d=V(a);if(!b||d>=b)return a;var e=(b-d)/2,f=jj(e),g=ij(e);return ae("",f,c)+a+ae("",g,c)}function Wh(a,b,c){return a=lh(a),a+ae(a,b,c)}function Xh(a,b,c){return a=lh(a),ae(a,b,c)+a}function Yh(a,b,c){return c||null==b?b=0:b&&(b=+b),a=lh(a).replace(qb,""),pj(a,b||(wb.test(a)?16:10))}function Zh(a,b){a=lh(a),b=gh(b);var c="";if(!a||1>b||b>wa)return c;do b%2&&(c+=a),b=jj(b/2),a+=a;while(b);return c}function $h(){
var a=arguments,b=lh(a[0]);return a.length<3?b:b.replace(a[1],a[2])}function _h(a,b,c){return lh(a).split(b,c)}function ai(a,b,c){return a=lh(a),c=wc(gh(c),0,a.length),a.lastIndexOf(b,c)==c}function bi(a,c,d){var e=b.templateSettings;d&&ve(a,c,d)&&(c=Z),a=lh(a),c=yk({},c,e,ec);var f,g,h=yk({},c.imports,e.imports,ec),i=yh(h),j=E(h,i),k=0,l=c.interpolate||Db,m="__p += '",n=Mi((c.escape||Db).source+"|"+l.source+"|"+(l===kb?ub:Db).source+"|"+(c.evaluate||Db).source+"|$","g"),o="//# sourceURL="+("sourceURL"in c?c.sourceURL:"lodash.templateSources["+ ++sc+"]")+"\n";a.replace(n,function(b,c,d,e,h,i){return d||(d=e),m+=a.slice(k,i).replace(Eb,N),c&&(f=!0,m+="' +\n__e("+c+") +\n'"),h&&(g=!0,m+="';\n"+h+";\n__p += '"),d&&(m+="' +\n((__t = ("+d+")) == null ? '' : __t) +\n'"),k=i+b.length,b}),m+="';\n";var p=c.variable;p||(m="with (obj) {\n"+m+"\n}\n"),m=(g?m.replace(bb,""):m).replace(cb,"$1").replace(db,"$1;"),m="function("+(p||"obj")+") {\n"+(p?"":"obj || (obj = {});\n")+"var __t, __p = ''"+(f?", __e = _.escape":"")+(g?", __j = Array.prototype.join;\nfunction print() { __p += __j.call(arguments, '') }\n":";\n")+m+"return __p\n}";var q=Sk(function(){return Function(i,o+"return "+m).apply(Z,j)});if(q.source=m,Gg(q))throw q;return q}function ci(a){return lh(a).toLowerCase()}function di(a){return lh(a).toUpperCase()}function ei(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(qb,"");if(b+="",!b)return a;var d=W(a),e=W(b);return d.slice(F(d,e),G(d,e)+1).join("")}function fi(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(sb,"");if(b+="",!b)return a;var d=W(a);return d.slice(0,G(d,W(b))+1).join("")}function gi(a,b,c){if(a=lh(a),!a)return a;if(c||b===Z)return a.replace(rb,"");if(b+="",!b)return a;var d=W(a);return d.slice(F(d,W(b))).join("")}function hi(a,b){var c=la,d=ma;if(Lg(b)){var e="separator"in b?b.separator:e;c="length"in b?gh(b.length):c,d="omission"in b?lh(b.omission):d}a=lh(a);var f=a.length;if(nc.test(a)){var g=W(a);f=g.length}if(c>=f)return a;var h=c-V(d);if(1>h)return d;var i=g?g.slice(0,h).join(""):a.slice(0,h);if(e===Z)return i+d;if(g&&(h+=i.length-h),Wg(e)){if(a.slice(h).search(e)){var j,k=i;for(e.global||(e=Mi(e.source,lh(vb.exec(e))+"g")),e.lastIndex=0;j=e.exec(k);)var l=j.index;i=i.slice(0,l===Z?h:l)}}else if(a.indexOf(e,h)!=h){var m=i.lastIndexOf(e);m>-1&&(i=i.slice(0,m))}return i+d}function ii(a){return a=lh(a),a&&gb.test(a)?a.replace(eb,X):a}function ji(a,b,c){return a=lh(a),b=c?Z:b,b===Z&&(b=qc.test(a)?pc:oc),a.match(b)||[]}function ki(a){var b=a?a.length:0,c=ke();return a=b?p(a,function(a){if("function"!=typeof a[1])throw new Ni(ta);return[c(a[0]),a[1]]}):[],jg(function(c){for(var d=-1;++d<b;){var e=a[d];if(g(e[0],this,c))return g(e[1],this,c)}})}function li(a){return yc(xc(a,!0))}function mi(a){return function(){return a}}function ni(a){return a}function oi(a){return Zc("function"==typeof a?a:xc(a,!0))}function pi(a){return bd(xc(a,!0))}function qi(a,b){return cd(a,xc(b,!0))}function ri(a,b,c){var d=yh(b),e=Oc(b,d);null!=c||Lg(b)&&(e.length||!d.length)||(c=b,b=a,a=this,e=Oc(b,yh(b)));var f=Lg(c)&&"chain"in c?c.chain:!0,g=Ig(a);return j(e,function(c){var d=b[c];a[c]=d,g&&(a.prototype[c]=function(){var b=this.__chain__;if(f||b){var c=a(this.__wrapped__),e=c.__actions__=Ld(this.__actions__);return e.push({func:d,args:arguments,thisArg:a}),c.__chain__=b,c}return d.apply(a,q([this.value()],arguments))})}),a}function si(){return Jc._===this&&(Jc._=Vi),this}function ti(){}function ui(a){return a=gh(a),function(){return arguments[a]}}function vi(a){return we(a)?id(a):jd(a)}function wi(a){return function(b){return null==a?Z:Pc(a,b)}}function xi(a,b){if(a=gh(a),1>a||a>wa)return[];var c=za,d=oj(a,za);b=mc(b),a-=za;for(var e=B(d,b);++c<a;)b(c);return e}function yi(a){return uk(a)?p(a,String):Fe(a)}function zi(a){var b=++Si;return lh(a)+b}function Ai(a,b){var c;return a===Z&&b===Z?0:(a!==Z&&(c=a),b!==Z&&(c=c===Z?b:c+b),c)}function Bi(a){return a&&a.length?u(a,ni,ug):Z}function Ci(a,b){return a&&a.length?u(a,ke(b),ug):Z}function Di(a){return Hi(a)/(a?a.length:0)}function Ei(a){return a&&a.length?u(a,ni,dh):Z}function Fi(a,b){return a&&a.length?u(a,ke(b),dh):Z}function Gi(a,b){var c;return a===Z&&b===Z?0:(a!==Z&&(c=a),b!==Z&&(c=c===Z?b:c-b),c)}function Hi(a){return a&&a.length?A(a,ni):0}function Ii(a,b){return a&&a.length?A(a,ke(b)):0}a=a?Kc.defaults({},a,Kc.pick(Jc,rc)):Jc;var Ji=a.Date,Ki=a.Error,Li=a.Math,Mi=a.RegExp,Ni=a.TypeError,Oi=a.Array.prototype,Pi=a.Object.prototype,Qi=a.Function.prototype.toString,Ri=Pi.hasOwnProperty,Si=0,Ti=Qi.call(Object),Ui=Pi.toString,Vi=Jc._,Wi=Mi("^"+Qi.call(Ri).replace(ob,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Xi=Ec?a.Buffer:Z,Yi=a.Reflect,Zi=a.Symbol,$i=a.Uint8Array,_i=a.clearTimeout,aj=Yi?Yi.enumerate:Z,bj=Object.getPrototypeOf,cj=Object.getOwnPropertySymbols,dj="symbol"==typeof(dj=Zi&&Zi.iterator)?dj:Z,ej=Object.create,fj=Pi.propertyIsEnumerable,gj=a.setTimeout,hj=Oi.splice,ij=Li.ceil,jj=Li.floor,kj=a.isFinite,lj=Oi.join,mj=Object.keys,nj=Li.max,oj=Li.min,pj=a.parseInt,qj=Li.random,rj=Oi.reverse,sj=me(a,"Map"),tj=me(a,"Set"),uj=me(a,"WeakMap"),vj=me(Object,"create"),wj=uj&&new uj,xj=sj?Qi.call(sj):"",yj=tj?Qi.call(tj):"",zj=uj?Qi.call(uj):"",Aj=Zi?Zi.prototype:Z,Bj=Zi?Aj.valueOf:Z,Cj=Zi?Aj.toString:Z,Dj={};b.templateSettings={escape:ib,evaluate:jb,interpolate:kb,variable:"",imports:{_:b}};var Ej=Rd(Mc),Fj=Rd(Nc,!0),Gj=Sd(),Hj=Sd(!0);aj&&!fj.call({valueOf:1},"valueOf")&&(_c=function(a){return R(aj(a))});var Ij=wj?function(a,b){return wj.set(a,b),a}:ni,Jj=tj&&2===new tj([1,2]).size?function(a){return new tj(a)}:ti,Kj=wj?function(a){return wj.get(a)}:ti,Lj=id("length"),Mj=cj||function(){return[]};(sj&&oe(new sj)!=Ka||tj&&oe(new tj)!=Oa||uj&&oe(new uj)!=Ra)&&(oe=function(a){var b=Ui.call(a),c=b==Ma?a.constructor:null,d="function"==typeof c?Qi.call(c):"";if(d)switch(d){case xj:return Ka;case yj:return Oa;case zj:return Ra}return b});var Nj=function(){var a=0,b=0;return function(c,d){var e=lk(),f=oa-(e-b);if(b=e,f>0){if(++a>=na)return c}else a=0;return Ij(c,d)}}(),Oj=jg(function(a,b){return uk(a)||(a=null==a?[]:[Object(a)]),b=Ic(b,1),i(a,b)}),Pj=jg(function(a,b){return zg(a)?Dc(a,Ic(b,1,!0)):[]}),Qj=jg(function(a,b){var c=Ye(b);return zg(c)&&(c=Z),zg(a)?Dc(a,Ic(b,1,!0),ke(c)):[]}),Rj=jg(function(a,b){var c=Ye(b);return zg(c)&&(c=Z),zg(a)?Dc(a,Ic(b,1,!0),Z,c):[]}),Sj=jg(function(a){var b=p(a,kc);return b.length&&b[0]===a[0]?Tc(b):[]}),Tj=jg(function(a){var b=Ye(a),c=p(a,kc);return b===Ye(c)?b=Z:c.pop(),c.length&&c[0]===a[0]?Tc(c,ke(b)):[]}),Uj=jg(function(a){var b=Ye(a),c=p(a,kc);return b===Ye(c)?b=Z:c.pop(),c.length&&c[0]===a[0]?Tc(c,Z,b):[]}),Vj=jg($e),Wj=jg(function(a,b){b=p(Ic(b,1),String);var c=jc(a,b);return md(a,b.sort(I)),c}),Xj=jg(function(a){return wd(Ic(a,1,!0))}),Yj=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),wd(Ic(a,1,!0),ke(b))}),Zj=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),wd(Ic(a,1,!0),Z,b)}),$j=jg(function(a,b){return zg(a)?Dc(a,b):[]}),_j=jg(function(a){return Ad(m(a,zg))}),ak=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),Ad(m(a,zg),ke(b))}),bk=jg(function(a){var b=Ye(a);return zg(b)&&(b=Z),Ad(m(a,zg),Z,b)}),ck=jg(uf),dk=jg(function(a){var b=a.length,c=b>1?a[b-1]:Z;return c="function"==typeof c?(a.pop(),c):Z,vf(a,c)}),ek=jg(function(a){a=Ic(a,1);var b=a.length,c=b?a[0]:0,e=this.__wrapped__,f=function(b){return jc(b,a)};return!(b>1||this.__actions__.length)&&e instanceof H&&Q(c)?(e=e.slice(c,+c+(b?1:0)),e.__actions__.push({func:Af,args:[f],thisArg:Z}),new d(e,this.__chain__).thru(function(a){return b&&!a.length&&a.push(Z),a})):this.thru(f)}),fk=Pd(function(a,b,c){Ri.call(a,c)?++a[c]:a[c]=1}),gk=Pd(function(a,b,c){Ri.call(a,c)?a[c].push(b):a[c]=[b]}),hk=jg(function(a,b,c){var d=-1,e="function"==typeof b,f=we(b),h=yg(a)?Array(a.length):[];return Ej(a,function(a){var i=e?b:f&&null!=a?a[b]:Z;h[++d]=i?g(i,a,c):Vc(a,b,c)}),h}),ik=Pd(function(a,b,c){a[c]=b}),jk=Pd(function(a,b,c){a[c?0:1].push(b)},function(){return[[],[]]}),kk=jg(function(a,b){if(null==a)return[];var c=b.length;return c>1&&ve(a,b[0],b[1])?b=[]:c>2&&ve(b[0],b[1],b[2])&&(b.length=1),fd(a,Ic(b,1),[])}),lk=Ji.now,mk=jg(function(a,b,c){var d=_;if(c.length){var e=T(c,ne(mk));d|=ea}return fe(a,d,b,c,e)}),nk=jg(function(a,b,c){var d=_|aa;if(c.length){var e=T(c,ne(nk));d|=ea}return fe(b,d,a,c,e)}),ok=jg(function(a,b){return Cc(a,1,b)}),pk=jg(function(a,b,c){return Cc(a,ih(b)||0,c)}),qk=jg(function(a,b){b=p(Ic(b,1),ke());var c=b.length;return jg(function(d){for(var e=-1,f=oj(d.length,c);++e<f;)d[e]=b[e].call(this,d[e]);return g(a,this,d)})}),rk=jg(function(a,b){var c=T(b,ne(rk));return fe(a,ea,Z,b,c)}),sk=jg(function(a,b){var c=T(b,ne(sk));return fe(a,fa,Z,b,c)}),tk=jg(function(a,b){return fe(a,ha,Z,Z,Z,Ic(b,1))}),uk=Array.isArray,vk=Xi?function(a){return a instanceof Xi}:mi(!1),wk=Qd(function(a,b){Md(b,yh(b),a)}),xk=Qd(function(a,b){Md(b,zh(b),a)}),yk=Qd(function(a,b,c,d){Nd(b,zh(b),a,d)}),zk=Qd(function(a,b,c,d){Nd(b,yh(b),a,d)}),Ak=jg(function(a,b){return jc(a,Ic(b,1))}),Bk=jg(function(a){return a.push(Z,ec),g(yk,Z,a)}),Ck=jg(function(a){return a.push(Z,Ce),g(Hk,Z,a)}),Dk=$d(function(a,b,c){a[b]=c},mi(ni)),Ek=$d(function(a,b,c){Ri.call(a,b)?a[b].push(c):a[b]=[c]},ke),Fk=jg(Vc),Gk=Qd(function(a,b,c){dd(a,b,c)}),Hk=Qd(function(a,b,c,d){dd(a,b,c,d)}),Ik=jg(function(a,b){return null==a?{}:(b=p(Ic(b,1),String),gd(a,Dc(zh(a),b)))}),Jk=jg(function(a,b){return null==a?{}:gd(a,Ic(b,1))}),Kk=Vd(function(a,b,c){return b=b.toLowerCase(),a+(c?Qh(b):b)}),Lk=Vd(function(a,b,c){return a+(c?"-":"")+b.toLowerCase()}),Mk=Vd(function(a,b,c){return a+(c?" ":"")+b.toLowerCase()}),Nk=Ud("toLowerCase"),Ok=Ud("toUpperCase"),Pk=Vd(function(a,b,c){return a+(c?"_":"")+b.toLowerCase()}),Qk=Vd(function(a,b,c){return a+(c?" ":"")+Qh(b)}),Rk=Vd(function(a,b,c){return a+(c?" ":"")+b.toUpperCase()}),Sk=jg(function(a,b){try{return g(a,Z,b)}catch(c){return Gg(c)?c:new Ki(c)}}),Tk=jg(function(a,b){return j(Ic(b,1),function(b){a[b]=mk(a[b],a)}),a}),Uk=Yd(),Vk=Yd(!0),Wk=jg(function(a,b){return function(c){return Vc(c,a,b)}}),Xk=jg(function(a,b){return function(c){return Vc(a,c,b)}}),Yk=_d(p),Zk=_d(l),$k=_d(t),_k=ce(),al=ce(!0),bl=ee("ceil"),cl=ee("floor"),dl=ee("round");return b.prototype=c.prototype,d.prototype=zc(c.prototype),d.prototype.constructor=d,H.prototype=zc(c.prototype),H.prototype.constructor=H,Hb.prototype=vj?vj(null):Pi,Mb.prototype.clear=Nb,Mb.prototype["delete"]=Ob,Mb.prototype.get=Pb,Mb.prototype.has=Qb,Mb.prototype.set=Rb,Sb.prototype.push=Ub,Vb.prototype.clear=Wb,Vb.prototype["delete"]=Xb,Vb.prototype.get=Yb,Vb.prototype.has=Zb,Vb.prototype.set=$b,gg.Cache=Mb,b.after=_f,b.ary=ag,b.assign=wk,b.assignIn=xk,b.assignInWith=yk,b.assignWith=zk,b.at=Ak,b.before=bg,b.bind=mk,b.bindAll=Tk,b.bindKey=nk,b.castArray=og,b.chain=yf,b.chunk=He,b.compact=Ie,b.concat=Oj,b.cond=ki,b.conforms=li,b.constant=mi,b.countBy=fk,b.create=mh,b.curry=cg,b.curryRight=dg,b.debounce=eg,b.defaults=Bk,b.defaultsDeep=Ck,b.defer=ok,b.delay=pk,b.difference=Pj,b.differenceBy=Qj,b.differenceWith=Rj,b.drop=Je,b.dropRight=Ke,b.dropRightWhile=Le,b.dropWhile=Me,b.fill=Ne,b.filter=Kf,b.flatMap=Nf,b.flatten=Qe,b.flattenDeep=Re,b.flattenDepth=Se,b.flip=fg,b.flow=Uk,b.flowRight=Vk,b.fromPairs=Te,b.functions=th,b.functionsIn=uh,b.groupBy=gk,b.initial=We,b.intersection=Sj,b.intersectionBy=Tj,b.intersectionWith=Uj,b.invert=Dk,b.invertBy=Ek,b.invokeMap=hk,b.iteratee=oi,b.keyBy=ik,b.keys=yh,b.keysIn=zh,b.map=Rf,b.mapKeys=Ah,b.mapValues=Bh,b.matches=pi,b.matchesProperty=qi,b.memoize=gg,b.merge=Gk,b.mergeWith=Hk,b.method=Wk,b.methodOf=Xk,b.mixin=ri,b.negate=hg,b.nthArg=ui,b.omit=Ik,b.omitBy=Ch,b.once=ig,b.orderBy=Sf,b.over=Yk,b.overArgs=qk,b.overEvery=Zk,b.overSome=$k,b.partial=rk,b.partialRight=sk,b.partition=jk,b.pick=Jk,b.pickBy=Dh,b.property=vi,b.propertyOf=wi,b.pull=Vj,b.pullAll=$e,b.pullAllBy=_e,b.pullAt=Wj,b.range=_k,b.rangeRight=al,b.rearg=tk,b.reject=Vf,b.remove=af,b.rest=jg,b.reverse=bf,b.sampleSize=Xf,b.set=Fh,b.setWith=Gh,b.shuffle=Yf,b.slice=cf,b.sortBy=kk,b.sortedUniq=kf,b.sortedUniqBy=lf,b.split=_h,b.spread=kg,b.tail=mf,b.take=nf,b.takeRight=of,b.takeRightWhile=pf,b.takeWhile=qf,b.tap=zf,b.throttle=lg,b.thru=Af,b.toArray=fh,b.toPairs=Hh,b.toPairsIn=Ih,b.toPath=yi,b.toPlainObject=jh,b.transform=Jh,b.unary=mg,b.union=Xj,b.unionBy=Yj,b.unionWith=Zj,b.uniq=rf,b.uniqBy=sf,b.uniqWith=tf,b.unset=Kh,b.unzip=uf,b.unzipWith=vf,b.values=Lh,b.valuesIn=Mh,b.without=$j,b.words=ji,b.wrap=ng,b.xor=_j,b.xorBy=ak,b.xorWith=bk,b.zip=ck,b.zipObject=wf,b.zipObjectDeep=xf,b.zipWith=dk,b.extend=xk,b.extendWith=yk,ri(b,b),b.add=Ai,b.attempt=Sk,b.camelCase=Kk,b.capitalize=Qh,b.ceil=bl,b.clamp=Nh,b.clone=pg,b.cloneDeep=rg,b.cloneDeepWith=sg,b.cloneWith=qg,b.deburr=Rh,b.endsWith=Sh,b.eq=tg,b.escape=Th,b.escapeRegExp=Uh,b.every=Jf,b.find=Lf,b.findIndex=Oe,b.findKey=nh,b.findLast=Mf,b.findLastIndex=Pe,b.findLastKey=oh,b.floor=cl,b.forEach=Of,b.forEachRight=Pf,b.forIn=ph,b.forInRight=qh,b.forOwn=rh,b.forOwnRight=sh,b.get=vh,b.gt=ug,b.gte=vg,b.has=wh,b.hasIn=xh,b.head=Ue,b.identity=ni,b.includes=Qf,b.indexOf=Ve,b.inRange=Oh,b.invoke=Fk,b.isArguments=wg,b.isArray=uk,b.isArrayBuffer=xg,b.isArrayLike=yg,b.isArrayLikeObject=zg,b.isBoolean=Ag,b.isBuffer=vk,b.isDate=Bg,b.isElement=Cg,b.isEmpty=Dg,b.isEqual=Eg,b.isEqualWith=Fg,b.isError=Gg,b.isFinite=Hg,b.isFunction=Ig,b.isInteger=Jg,b.isLength=Kg,b.isMap=Ng,b.isMatch=Og,b.isMatchWith=Pg,b.isNaN=Qg,b.isNative=Rg,b.isNil=Tg,b.isNull=Sg,b.isNumber=Ug,b.isObject=Lg,b.isObjectLike=Mg,b.isPlainObject=Vg,b.isRegExp=Wg,b.isSafeInteger=Xg,b.isSet=Yg,b.isString=Zg,b.isSymbol=$g,b.isTypedArray=_g,b.isUndefined=ah,b.isWeakMap=bh,b.isWeakSet=ch,b.join=Xe,b.kebabCase=Lk,b.last=Ye,b.lastIndexOf=Ze,b.lowerCase=Mk,b.lowerFirst=Nk,b.lt=dh,b.lte=eh,b.max=Bi,b.maxBy=Ci,b.mean=Di,b.min=Ei,b.minBy=Fi,b.noConflict=si,b.noop=ti,b.now=lk,b.pad=Vh,b.padEnd=Wh,b.padStart=Xh,b.parseInt=Yh,b.random=Ph,b.reduce=Tf,b.reduceRight=Uf,b.repeat=Zh,b.replace=$h,b.result=Eh,b.round=dl,b.runInContext=Y,b.sample=Wf,b.size=Zf,b.snakeCase=Pk,b.some=$f,b.sortedIndex=df,b.sortedIndexBy=ef,b.sortedIndexOf=ff,b.sortedLastIndex=gf,b.sortedLastIndexBy=hf,b.sortedLastIndexOf=jf,b.startCase=Qk,b.startsWith=ai,b.subtract=Gi,b.sum=Hi,b.sumBy=Ii,b.template=bi,b.times=xi,b.toInteger=gh,b.toLength=hh,b.toLower=ci,b.toNumber=ih,b.toSafeInteger=kh,b.toString=lh,b.toUpper=di,b.trim=ei,b.trimEnd=fi,b.trimStart=gi,b.truncate=hi,b.unescape=ii,b.uniqueId=zi,b.upperCase=Rk,b.upperFirst=Ok,b.each=Of,b.eachRight=Pf,b.first=Ue,ri(b,function(){var a={};return Mc(b,function(c,d){Ri.call(b.prototype,d)||(a[d]=c)}),a}(),{chain:!1}),b.VERSION=$,j(["bind","bindKey","curry","curryRight","partial","partialRight"],function(a){b[a].placeholder=b}),j(["drop","take"],function(a,b){H.prototype[a]=function(c){var d=this.__filtered__;if(d&&!b)return new H(this);c=c===Z?1:nj(gh(c),0);var e=this.clone();return d?e.__takeCount__=oj(c,e.__takeCount__):e.__views__.push({size:oj(c,za),type:a+(e.__dir__<0?"Right":"")}),e},H.prototype[a+"Right"]=function(b){return this.reverse()[a](b).reverse()}}),j(["filter","map","takeWhile"],function(a,b){var c=b+1,d=c==qa||c==sa;H.prototype[a]=function(a){var b=this.clone();return b.__iteratees__.push({iteratee:ke(a,3),type:c}),b.__filtered__=b.__filtered__||d,b}}),j(["head","last"],function(a,b){var c="take"+(b?"Right":"");H.prototype[a]=function(){return this[c](1).value()[0]}}),j(["initial","tail"],function(a,b){var c="drop"+(b?"":"Right");H.prototype[a]=function(){return this.__filtered__?new H(this):this[c](1)}}),H.prototype.compact=function(){return this.filter(ni)},H.prototype.find=function(a){return this.filter(a).head()},H.prototype.findLast=function(a){return this.reverse().find(a)},H.prototype.invokeMap=jg(function(a,b){return"function"==typeof a?new H(this):this.map(function(c){return Vc(c,a,b)})}),H.prototype.reject=function(a){return a=ke(a,3),this.filter(function(b){return!a(b)})},H.prototype.slice=function(a,b){a=gh(a);var c=this;return c.__filtered__&&(a>0||0>b)?new H(c):(0>a?c=c.takeRight(-a):a&&(c=c.drop(a)),b!==Z&&(b=gh(b),c=0>b?c.dropRight(-b):c.take(b-a)),c)},H.prototype.takeRightWhile=function(a){return this.reverse().takeWhile(a).reverse()},H.prototype.toArray=function(){return this.take(za)},Mc(H.prototype,function(a,c){var e=/^(?:filter|find|map|reject)|While$/.test(c),f=/^(?:head|last)$/.test(c),g=b[f?"take"+("last"==c?"Right":""):c],h=f||/^find/.test(c);g&&(b.prototype[c]=function(){var c=this.__wrapped__,i=f?[1]:arguments,j=c instanceof H,k=i[0],l=j||uk(c),m=function(a){var c=g.apply(b,q([a],i));return f&&n?c[0]:c};l&&e&&"function"==typeof k&&1!=k.length&&(j=l=!1);var n=this.__chain__,o=!!this.__actions__.length,p=h&&!n,r=j&&!o;if(!h&&l){c=r?c:new H(this);var s=a.apply(c,i);return s.__actions__.push({func:Af,args:[m],thisArg:Z}),new d(s,n)}return p&&r?a.apply(this,i):(s=this.thru(m),p?f?s.value()[0]:s.value():s)})}),j(["pop","push","shift","sort","splice","unshift"],function(a){var c=Oi[a],d=/^(?:push|sort|unshift)$/.test(a)?"tap":"thru",e=/^(?:pop|shift)$/.test(a);b.prototype[a]=function(){var a=arguments;return e&&!this.__chain__?c.apply(this.value(),a):this[d](function(b){return c.apply(b,a)})}}),Mc(H.prototype,function(a,c){var d=b[c];if(d){var e=d.name+"",f=Dj[e]||(Dj[e]=[]);f.push({name:c,func:d})}}),Dj[Zd(Z,aa).name]=[{name:"wrapper",func:Z}],H.prototype.clone=Bb,H.prototype.reverse=Fb,H.prototype.value=Gb,b.prototype.at=ek,b.prototype.chain=Bf,b.prototype.commit=Cf,b.prototype.flatMap=Df,b.prototype.next=Ef,b.prototype.plant=Gf,b.prototype.reverse=Hf,b.prototype.toJSON=b.prototype.valueOf=b.prototype.value=If,dj&&(b.prototype[dj]=Ff),b}var Z,$="4.5.1",_=1,aa=2,ba=4,ca=8,da=16,ea=32,fa=64,ga=128,ha=256,ia=512,ja=1,ka=2,la=30,ma="...",na=150,oa=16,pa=200,qa=1,ra=2,sa=3,ta="Expected a function",ua="__lodash_hash_undefined__",va=1/0,wa=9007199254740991,xa=1.7976931348623157e308,ya=NaN,za=4294967295,Aa=za-1,Ba=za>>>1,Ca="__lodash_placeholder__",Da="[object Arguments]",Ea="[object Array]",Fa="[object Boolean]",Ga="[object Date]",Ha="[object Error]",Ia="[object Function]",Ja="[object GeneratorFunction]",Ka="[object Map]",La="[object Number]",Ma="[object Object]",Na="[object RegExp]",Oa="[object Set]",Pa="[object String]",Qa="[object Symbol]",Ra="[object WeakMap]",Sa="[object WeakSet]",Ta="[object ArrayBuffer]",Ua="[object Float32Array]",Va="[object Float64Array]",Wa="[object Int8Array]",Xa="[object Int16Array]",Ya="[object Int32Array]",Za="[object Uint8Array]",$a="[object Uint8ClampedArray]",_a="[object Uint16Array]",ab="[object Uint32Array]",bb=/\b__p \+= '';/g,cb=/\b(__p \+=) '' \+/g,db=/(__e\(.*?\)|\b__t\)) \+\n'';/g,eb=/&(?:amp|lt|gt|quot|#39|#96);/g,fb=/[&<>"'`]/g,gb=RegExp(eb.source),hb=RegExp(fb.source),ib=/<%-([\s\S]+?)%>/g,jb=/<%([\s\S]+?)%>/g,kb=/<%=([\s\S]+?)%>/g,lb=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,mb=/^\w*$/,nb=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]/g,ob=/[\\^$.*+?()[\]{}|]/g,pb=RegExp(ob.source),qb=/^\s+|\s+$/g,rb=/^\s+/,sb=/\s+$/,tb=/\\(\\)?/g,ub=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,vb=/\w*$/,wb=/^0x/i,xb=/^[-+]0x[0-9a-f]+$/i,yb=/^0b[01]+$/i,zb=/^\[object .+?Constructor\]$/,Ab=/^0o[0-7]+$/i,Bb=/^(?:0|[1-9]\d*)$/,Cb=/[\xc0-\xd6\xd8-\xde\xdf-\xf6\xf8-\xff]/g,Db=/($^)/,Eb=/['\n\r\u2028\u2029\\]/g,Fb="\\ud800-\\udfff",Gb="\\u0300-\\u036f\\ufe20-\\ufe23",Hb="\\u20d0-\\u20f0",Ib="\\u2700-\\u27bf",Jb="a-z\\xdf-\\xf6\\xf8-\\xff",Kb="\\xac\\xb1\\xd7\\xf7",Lb="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",Mb="\\u2018\\u2019\\u201c\\u201d",Nb=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ob="A-Z\\xc0-\\xd6\\xd8-\\xde",Pb="\\ufe0e\\ufe0f",Qb=Kb+Lb+Mb+Nb,Rb="["+Fb+"]",Sb="["+Qb+"]",Tb="["+Gb+Hb+"]",Ub="\\d+",Vb="["+Ib+"]",Wb="["+Jb+"]",Xb="[^"+Fb+Qb+Ub+Ib+Jb+Ob+"]",Yb="\\ud83c[\\udffb-\\udfff]",Zb="(?:"+Tb+"|"+Yb+")",$b="[^"+Fb+"]",_b="(?:\\ud83c[\\udde6-\\uddff]){2}",ac="[\\ud800-\\udbff][\\udc00-\\udfff]",bc="["+Ob+"]",cc="\\u200d",dc="(?:"+Wb+"|"+Xb+")",ec="(?:"+bc+"|"+Xb+")",fc=Zb+"?",gc="["+Pb+"]?",hc="(?:"+cc+"(?:"+[$b,_b,ac].join("|")+")"+gc+fc+")*",ic=gc+fc+hc,jc="(?:"+[Vb,_b,ac].join("|")+")"+ic,kc="(?:"+[$b+Tb+"?",Tb,_b,ac,Rb].join("|")+")",lc=RegExp(Tb,"g"),mc=RegExp(Yb+"(?="+Yb+")|"+kc+ic,"g"),nc=RegExp("["+cc+Fb+Gb+Hb+Pb+"]"),oc=/[a-zA-Z0-9]+/g,pc=RegExp([bc+"?"+Wb+"+(?="+[Sb,bc,"$"].join("|")+")",ec+"+(?="+[Sb,bc+dc,"$"].join("|")+")",bc+"?"+dc+"+",bc+"+",Ub,jc].join("|"),"g"),qc=/[a-z][A-Z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,rc=["Array","Buffer","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Reflect","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],sc=-1,tc={};tc[Ua]=tc[Va]=tc[Wa]=tc[Xa]=tc[Ya]=tc[Za]=tc[$a]=tc[_a]=tc[ab]=!0,tc[Da]=tc[Ea]=tc[Ta]=tc[Fa]=tc[Ga]=tc[Ha]=tc[Ia]=tc[Ka]=tc[La]=tc[Ma]=tc[Na]=tc[Oa]=tc[Pa]=tc[Ra]=!1;var uc={};uc[Da]=uc[Ea]=uc[Ta]=uc[Fa]=uc[Ga]=uc[Ua]=uc[Va]=uc[Wa]=uc[Xa]=uc[Ya]=uc[Ka]=uc[La]=uc[Ma]=uc[Na]=uc[Oa]=uc[Pa]=uc[Qa]=uc[Za]=uc[$a]=uc[_a]=uc[ab]=!0,uc[Ha]=uc[Ia]=uc[Ra]=!1;var vc={"À":"A","Á":"A","Â":"A","Ã":"A","Ä":"A","Å":"A","à":"a","á":"a","â":"a","ã":"a","ä":"a","å":"a","Ç":"C","ç":"c","Ð":"D","ð":"d","È":"E","É":"E","Ê":"E","Ë":"E","è":"e","é":"e","ê":"e","ë":"e","Ì":"I","Í":"I","Î":"I","Ï":"I","ì":"i","í":"i","î":"i","ï":"i","Ñ":"N","ñ":"n","Ò":"O","Ó":"O","Ô":"O","Õ":"O","Ö":"O","Ø":"O","ò":"o","ó":"o","ô":"o","õ":"o","ö":"o","ø":"o","Ù":"U","Ú":"U","Û":"U","Ü":"U","ù":"u","ú":"u","û":"u","ü":"u","Ý":"Y","ý":"y","ÿ":"y","Æ":"Ae","æ":"ae","Þ":"Th","þ":"th","ß":"ss"},wc={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","`":"&#96;"},xc={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'","&#96;":"`"},yc={"function":!0,object:!0},zc={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},Ac=parseFloat,Bc=parseInt,Cc=yc[typeof d]&&d&&!d.nodeType?d:Z,Dc=yc[typeof c]&&c&&!c.nodeType?c:Z,Ec=Dc&&Dc.exports===Cc?Cc:Z,Fc=H(Cc&&Dc&&"object"==typeof a&&a),Gc=H(yc[typeof self]&&self),Hc=H(yc[typeof window]&&window),Ic=H(yc[typeof this]&&this),Jc=Fc||Hc!==(Ic&&Ic.window)&&Hc||Gc||Ic||Function("return this")(),Kc=Y();(Hc||Gc||{})._=Kc,"function"==typeof b&&"object"==typeof b.amd&&b.amd?b(function(){return Kc}):Cc&&Dc?(Ec&&((Dc.exports=Kc)._=Kc),Cc._=Kc):Jc._=Kc}).call(this)}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],118:[function(a,b,c){function d(a){return g(a)?e(a):f(a)}var e=a("./_baseProperty"),f=a("./_basePropertyDeep"),g=a("./_isKey");b.exports=d},{"./_baseProperty":48,"./_basePropertyDeep":49,"./_isKey":75}],119:[function(a,b,c){function d(a,b){if("function"!=typeof a)throw new TypeError(g);return b=h(void 0===b?a.length-1:f(b),0),function(){for(var c=arguments,d=-1,f=h(c.length-b,0),g=Array(f);++d<f;)g[d]=c[b+d];switch(b){case 0:return a.call(this,g);case 1:return a.call(this,c[0],g);case 2:return a.call(this,c[0],c[1],g)}var i=Array(b+1);for(d=-1;++d<b;)i[d]=c[d];return i[b]=g,e(a,this,i)}}var e=a("./_apply"),f=a("./toInteger"),g="Expected a function",h=Math.max;b.exports=d},{"./_apply":21,"./toInteger":120}],120:[function(a,b,c){function d(a){if(!a)return 0===a?a:0;if(a=e(a),a===f||a===-f){var b=0>a?-1:1;return b*g}var c=a%1;return a===a?c?a-c:a:0}var e=a("./toNumber"),f=1/0,g=1.7976931348623157e308;b.exports=d},{"./toNumber":121}],121:[function(a,b,c){function d(a){if(f(a)){var b=e(a.valueOf)?a.valueOf():a;a=f(b)?b+"":b}if("string"!=typeof a)return 0===a?a:+a;a=a.replace(h,"");var c=j.test(a);return c||k.test(a)?l(a.slice(2),c?2:8):i.test(a)?g:+a}var e=a("./isFunction"),f=a("./isObject"),g=NaN,h=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,j=/^0b[01]+$/i,k=/^0o[0-7]+$/i,l=parseInt;b.exports=d},{"./isFunction":107,"./isObject":110}],122:[function(a,b,c){function d(a){return e(a,f(a))}var e=a("./_baseToPairs"),f=a("./keys");b.exports=d},{"./_baseToPairs":52,"./keys":115}],123:[function(a,b,c){function d(a){if("string"==typeof a)return a;if(null==a)return"";if(f(a))return e?i.call(a):"";var b=a+"";return"0"==b&&1/a==-g?"-0":b}var e=a("./_Symbol"),f=a("./isSymbol"),g=1/0,h=e?e.prototype:void 0,i=e?h.toString:void 0;b.exports=d},{"./_Symbol":18,"./isSymbol":113}],124:[function(a,b,c){"undefined"==typeof Paho&&(Paho={}),Paho.MQTT=function(a){function b(a,b,c){return b[c++]=a>>8,b[c++]=a%256,c}function c(a,c,d,f){return f=b(c,d,f),e(a,d,f),f+c}function d(a){for(var b=0,c=0;c<a.length;c++){var d=a.charCodeAt(c);d>2047?(d>=55296&&56319>=d&&(c++,b++),b+=3):d>127?b+=2:b++}return b}function e(a,b,c){for(var d=0;d<a.length;d++){var e=a.charCodeAt(d);if(e>=55296&&56319>=e){var f=a.charCodeAt(++d);if(isNaN(f))throw Error(k(i.MALFORMED_UNICODE,[e,f]));e=(e-55296<<10)+(f-56320)+65536}127>=e?b[c++]=e:(2047>=e?b[c++]=e>>6&31|192:(65535>=e?b[c++]=e>>12&15|224:(b[c++]=e>>18&7|240,b[c++]=e>>12&63|128),b[c++]=e>>6&63|128),b[c++]=63&e|128)}return b}function f(a,b,c){for(var d,e="",f=b;b+c>f;){if(d=a[f++],!(128>d)){var g=a[f++]-128;if(0>g)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),""]));if(224>d)d=64*(d-192)+g;else{var h=a[f++]-128;if(0>h)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16)]));if(240>d)d=4096*(d-224)+64*g+h;else{var j=a[f++]-128;if(0>j)throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16),j.toString(16)]));if(!(248>d))throw Error(k(i.MALFORMED_UTF,[d.toString(16),g.toString(16),h.toString(16),j.toString(16)]));d=262144*(d-240)+4096*g+64*h+j}}}d>65535&&(d-=65536,e+=String.fromCharCode(55296+(d>>10)),d=56320+(1023&d)),e+=String.fromCharCode(d)}return e}var g=function(a,b){for(var c in a)if(a.hasOwnProperty(c)){if(!b.hasOwnProperty(c)){var d="Unknown property, "+c+". Valid properties are:";for(c in b)b.hasOwnProperty(c)&&(d=d+" "+c);throw Error(d)}if(typeof a[c]!==b[c])throw Error(k(i.INVALID_TYPE,[typeof a[c],c]))}},h=function(a,b){return function(){return a.apply(b,arguments)}},i={OK:{code:0,text:"AMQJSC0000I OK."},CONNECT_TIMEOUT:{code:1,text:"AMQJSC0001E Connect timed out."},SUBSCRIBE_TIMEOUT:{code:2,text:"AMQJS0002E Subscribe timed out."},UNSUBSCRIBE_TIMEOUT:{code:3,text:"AMQJS0003E Unsubscribe timed out."},PING_TIMEOUT:{code:4,text:"AMQJS0004E Ping timed out."},INTERNAL_ERROR:{code:5,text:"AMQJS0005E Internal error. Error Message: {0}, Stack trace: {1}"},CONNACK_RETURNCODE:{code:6,text:"AMQJS0006E Bad Connack return code:{0} {1}."},SOCKET_ERROR:{code:7,text:"AMQJS0007E Socket error:{0}."},SOCKET_CLOSE:{code:8,text:"AMQJS0008I Socket closed."},MALFORMED_UTF:{code:9,text:"AMQJS0009E Malformed UTF data:{0} {1} {2}."},UNSUPPORTED:{code:10,text:"AMQJS0010E {0} is not supported by this browser."},INVALID_STATE:{code:11,text:"AMQJS0011E Invalid state {0}."},INVALID_TYPE:{code:12,text:"AMQJS0012E Invalid type {0} for {1}."},INVALID_ARGUMENT:{code:13,text:"AMQJS0013E Invalid argument {0} for {1}."},UNSUPPORTED_OPERATION:{code:14,text:"AMQJS0014E Unsupported operation."},INVALID_STORED_DATA:{code:15,text:"AMQJS0015E Invalid data in local storage key={0} value={1}."},INVALID_MQTT_MESSAGE_TYPE:{code:16,text:"AMQJS0016E Invalid MQTT message type {0}."},MALFORMED_UNICODE:{code:17,text:"AMQJS0017E Malformed Unicode string:{0} {1}."}},j={0:"Connection Accepted",1:"Connection Refused: unacceptable protocol version",2:"Connection Refused: identifier rejected",3:"Connection Refused: server unavailable",4:"Connection Refused: bad user name or password",5:"Connection Refused: not authorized"},k=function(a,b){var c=a.text;if(b)for(var d,e,f=0;f<b.length;f++)if(d="{"+f+"}",e=c.indexOf(d),e>0)var g=c.substring(0,e),c=c.substring(e+d.length),c=g+b[f]+c;return c},l=[0,6,77,81,73,115,100,112,3],m=[0,4,77,81,84,84,4],n=function(a,b){this.type=a;for(var c in b)b.hasOwnProperty(c)&&(this[c]=b[c])};n.prototype.encode=function(){var a=(15&this.type)<<4,e=0,f=[],g=0;switch(void 0!=this.messageIdentifier&&(e+=2),this.type){case 1:switch(this.mqttVersion){case 3:e+=l.length+3;break;case 4:e+=m.length+3}if(e+=d(this.clientId)+2,void 0!=this.willMessage){var e=e+(d(this.willMessage.destinationName)+2),h=this.willMessage.payloadBytes;h instanceof Uint8Array||(h=new Uint8Array(j)),e+=h.byteLength+2}void 0!=this.userName&&(e+=d(this.userName)+2),void 0!=this.password&&(e+=d(this.password)+2);break;case 8:for(var a=2|a,i=0;i<this.topics.length;i++)f[i]=d(this.topics[i]),e+=f[i]+2;e+=this.requestedQos.length;break;case 10:for(a|=2,i=0;i<this.topics.length;i++)f[i]=d(this.topics[i]),e+=f[i]+2;break;case 6:a|=2;break;case 3:this.payloadMessage.duplicate&&(a|=8),a=a|=this.payloadMessage.qos<<1,this.payloadMessage.retained&&(a|=1);var g=d(this.payloadMessage.destinationName),j=this.payloadMessage.payloadBytes,e=e+(g+2)+j.byteLength;j instanceof ArrayBuffer?j=new Uint8Array(j):j instanceof Uint8Array||(j=new Uint8Array(j.buffer))}var k=e,i=Array(1),n=0;do{var o=k%128,k=k>>7;k>0&&(o|=128),i[n++]=o}while(k>0&&4>n);if(k=i.length+1,e=new ArrayBuffer(e+k),n=new Uint8Array(e),n[0]=a,n.set(i,1),3==this.type)k=c(this.payloadMessage.destinationName,g,n,k);else if(1==this.type){switch(this.mqttVersion){case 3:n.set(l,k),k+=l.length;break;case 4:n.set(m,k),k+=m.length}a=0,this.cleanSession&&(a=2),void 0!=this.willMessage&&(a=4|a|this.willMessage.qos<<3,this.willMessage.retained&&(a|=32)),void 0!=this.userName&&(a|=128),void 0!=this.password&&(a|=64),n[k++]=a,k=b(this.keepAliveInterval,n,k)}switch(void 0!=this.messageIdentifier&&(k=b(this.messageIdentifier,n,k)),this.type){case 1:k=c(this.clientId,d(this.clientId),n,k),void 0!=this.willMessage&&(k=c(this.willMessage.destinationName,d(this.willMessage.destinationName),n,k),k=b(h.byteLength,n,k),n.set(h,k),k+=h.byteLength),void 0!=this.userName&&(k=c(this.userName,d(this.userName),n,k)),void 0!=this.password&&c(this.password,d(this.password),n,k);break;case 3:n.set(j,k);break;case 8:for(i=0;i<this.topics.length;i++)k=c(this.topics[i],f[i],n,k),n[k++]=this.requestedQos[i];break;case 10:for(i=0;i<this.topics.length;i++)k=c(this.topics[i],f[i],n,k)}return e};var o=function(a,b,c){this._client=a,this._window=b,this._keepAliveInterval=1e3*c,this.isReset=!1;var d=new n(12).encode(),e=function(a){return function(){return f.apply(a)}},f=function(){this.isReset?(this.isReset=!1,this._client._trace("Pinger.doPing","send PINGREQ"),this._client.socket.send(d),this.timeout=this._window.setTimeout(e(this),this._keepAliveInterval)):(this._client._trace("Pinger.doPing","Timed out"),this._client._disconnected(i.PING_TIMEOUT.code,k(i.PING_TIMEOUT)))};this.reset=function(){this.isReset=!0,this._window.clearTimeout(this.timeout),0<this._keepAliveInterval&&(this.timeout=setTimeout(e(this),this._keepAliveInterval))},this.cancel=function(){this._window.clearTimeout(this.timeout)}},p=function(a,b,c,d,e){this._window=b,c||(c=30),this.timeout=setTimeout(function(a,b,c){return function(){return a.apply(b,c)}}(d,a,e),1e3*c),this.cancel=function(){this._window.clearTimeout(this.timeout)}},q=function(b,c,d,e,f){if(!("WebSocket"in a&&null!==a.WebSocket))throw Error(k(i.UNSUPPORTED,["WebSocket"]));if(!("localStorage"in a&&null!==a.localStorage))throw Error(k(i.UNSUPPORTED,["localStorage"]));if(!("ArrayBuffer"in a&&null!==a.ArrayBuffer))throw Error(k(i.UNSUPPORTED,["ArrayBuffer"]));this._trace("Paho.MQTT.Client",b,c,d,e,f),this.host=c,this.port=d,this.path=e,this.uri=b,this.clientId=f,this._localKey=c+":"+d+("/mqtt"!=e?":"+e:"")+":"+f+":",this._msg_queue=[],this._sentMessages={},this._receivedMessages={},this._notify_msg_sent={},this._message_identifier=1,this._sequence=0;for(var g in localStorage)0!=g.indexOf("Sent:"+this._localKey)&&0!=g.indexOf("Received:"+this._localKey)||this.restore(g)};q.prototype.host,q.prototype.port,q.prototype.path,q.prototype.uri,q.prototype.clientId,q.prototype.socket,q.prototype.connected=!1,q.prototype.maxMessageIdentifier=65536,q.prototype.connectOptions,q.prototype.hostIndex,q.prototype.onConnectionLost,q.prototype.onMessageDelivered,
q.prototype.onMessageArrived,q.prototype.traceFunction,q.prototype._msg_queue=null,q.prototype._connectTimeout,q.prototype.sendPinger=null,q.prototype.receivePinger=null,q.prototype.receiveBuffer=null,q.prototype._traceBuffer=null,q.prototype._MAX_TRACE_ENTRIES=100,q.prototype.connect=function(a){var b=this._traceMask(a,"password");if(this._trace("Client.connect",b,this.socket,this.connected),this.connected)throw Error(k(i.INVALID_STATE,["already connected"]));if(this.socket)throw Error(k(i.INVALID_STATE,["already connected"]));this.connectOptions=a,a.uris?(this.hostIndex=0,this._doConnect(a.uris[0])):this._doConnect(this.uri)},q.prototype.subscribe=function(a,b){if(this._trace("Client.subscribe",a,b),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));var c=new n(8);c.topics=[a],c.requestedQos=void 0!=b.qos?[b.qos]:[0],b.onSuccess&&(c.onSuccess=function(a){b.onSuccess({invocationContext:b.invocationContext,grantedQos:a})}),b.onFailure&&(c.onFailure=function(a){b.onFailure({invocationContext:b.invocationContext,errorCode:a})}),b.timeout&&(c.timeOut=new p(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:i.SUBSCRIBE_TIMEOUT.code,errorMessage:k(i.SUBSCRIBE_TIMEOUT)}])),this._requires_ack(c),this._schedule_message(c)},q.prototype.unsubscribe=function(a,b){if(this._trace("Client.unsubscribe",a,b),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));var c=new n(10);c.topics=[a],b.onSuccess&&(c.callback=function(){b.onSuccess({invocationContext:b.invocationContext})}),b.timeout&&(c.timeOut=new p(this,window,b.timeout,b.onFailure,[{invocationContext:b.invocationContext,errorCode:i.UNSUBSCRIBE_TIMEOUT.code,errorMessage:k(i.UNSUBSCRIBE_TIMEOUT)}])),this._requires_ack(c),this._schedule_message(c)},q.prototype.send=function(a){if(this._trace("Client.send",a),!this.connected)throw Error(k(i.INVALID_STATE,["not connected"]));wireMessage=new n(3),wireMessage.payloadMessage=a,0<a.qos?this._requires_ack(wireMessage):this.onMessageDelivered&&(this._notify_msg_sent[wireMessage]=this.onMessageDelivered(wireMessage.payloadMessage)),this._schedule_message(wireMessage)},q.prototype.disconnect=function(){if(this._trace("Client.disconnect"),!this.socket)throw Error(k(i.INVALID_STATE,["not connecting or connected"]));wireMessage=new n(14),this._notify_msg_sent[wireMessage]=h(this._disconnected,this),this._schedule_message(wireMessage)},q.prototype.getTraceLog=function(){if(null!==this._traceBuffer){this._trace("Client.getTraceLog",new Date),this._trace("Client.getTraceLog in flight messages",this._sentMessages.length);for(var a in this._sentMessages)this._trace("_sentMessages ",a,this._sentMessages[a]);for(a in this._receivedMessages)this._trace("_receivedMessages ",a,this._receivedMessages[a]);return this._traceBuffer}},q.prototype.startTrace=function(){null===this._traceBuffer&&(this._traceBuffer=[]),this._trace("Client.startTrace",new Date,"1.0.2")},q.prototype.stopTrace=function(){delete this._traceBuffer},q.prototype._doConnect=function(a){this.connectOptions.useSSL&&(a=a.split(":"),a[0]="wss",a=a.join(":")),this.connected=!1,this.socket=4>this.connectOptions.mqttVersion?new WebSocket(a,["mqttv3.1"]):new WebSocket(a,["mqtt"]),this.socket.binaryType="arraybuffer",this.socket.onopen=h(this._on_socket_open,this),this.socket.onmessage=h(this._on_socket_message,this),this.socket.onerror=h(this._on_socket_error,this),this.socket.onclose=h(this._on_socket_close,this),this.sendPinger=new o(this,window,this.connectOptions.keepAliveInterval),this.receivePinger=new o(this,window,this.connectOptions.keepAliveInterval),this._connectTimeout=new p(this,window,this.connectOptions.timeout,this._disconnected,[i.CONNECT_TIMEOUT.code,k(i.CONNECT_TIMEOUT)])},q.prototype._schedule_message=function(a){this._msg_queue.push(a),this.connected&&this._process_queue()},q.prototype.store=function(a,b){var c={type:b.type,messageIdentifier:b.messageIdentifier,version:1};switch(b.type){case 3:b.pubRecReceived&&(c.pubRecReceived=!0),c.payloadMessage={};for(var d="",e=b.payloadMessage.payloadBytes,f=0;f<e.length;f++)d=15>=e[f]?d+"0"+e[f].toString(16):d+e[f].toString(16);c.payloadMessage.payloadHex=d,c.payloadMessage.qos=b.payloadMessage.qos,c.payloadMessage.destinationName=b.payloadMessage.destinationName,b.payloadMessage.duplicate&&(c.payloadMessage.duplicate=!0),b.payloadMessage.retained&&(c.payloadMessage.retained=!0),0==a.indexOf("Sent:")&&(void 0===b.sequence&&(b.sequence=++this._sequence),c.sequence=b.sequence);break;default:throw Error(k(i.INVALID_STORED_DATA,[key,c]))}localStorage.setItem(a+this._localKey+b.messageIdentifier,JSON.stringify(c))},q.prototype.restore=function(a){var b=localStorage.getItem(a),c=JSON.parse(b),d=new n(c.type,c);switch(c.type){case 3:for(var b=c.payloadMessage.payloadHex,e=new ArrayBuffer(b.length/2),e=new Uint8Array(e),f=0;2<=b.length;){var g=parseInt(b.substring(0,2),16),b=b.substring(2,b.length);e[f++]=g}b=new Paho.MQTT.Message(e),b.qos=c.payloadMessage.qos,b.destinationName=c.payloadMessage.destinationName,c.payloadMessage.duplicate&&(b.duplicate=!0),c.payloadMessage.retained&&(b.retained=!0),d.payloadMessage=b;break;default:throw Error(k(i.INVALID_STORED_DATA,[a,b]))}0==a.indexOf("Sent:"+this._localKey)?(d.payloadMessage.duplicate=!0,this._sentMessages[d.messageIdentifier]=d):0==a.indexOf("Received:"+this._localKey)&&(this._receivedMessages[d.messageIdentifier]=d)},q.prototype._process_queue=function(){for(var a=null,b=this._msg_queue.reverse();a=b.pop();)this._socket_send(a),this._notify_msg_sent[a]&&(this._notify_msg_sent[a](),delete this._notify_msg_sent[a])},q.prototype._requires_ack=function(a){var b=Object.keys(this._sentMessages).length;if(b>this.maxMessageIdentifier)throw Error("Too many messages:"+b);for(;void 0!==this._sentMessages[this._message_identifier];)this._message_identifier++;a.messageIdentifier=this._message_identifier,this._sentMessages[a.messageIdentifier]=a,3===a.type&&this.store("Sent:",a),this._message_identifier===this.maxMessageIdentifier&&(this._message_identifier=1)},q.prototype._on_socket_open=function(){var a=new n(1,this.connectOptions);a.clientId=this.clientId,this._socket_send(a)},q.prototype._on_socket_message=function(a){this._trace("Client._on_socket_message",a.data),a=this._deframeMessages(a.data);for(var b=0;b<a.length;b+=1)this._handleMessage(a[b])},q.prototype._deframeMessages=function(a){if(a=new Uint8Array(a),this.receiveBuffer){var b=new Uint8Array(this.receiveBuffer.length+a.length);b.set(this.receiveBuffer),b.set(a,this.receiveBuffer.length),a=b,delete this.receiveBuffer}try{for(var b=0,c=[];b<a.length;){var d;a:{var e=a,g=b,h=g,j=e[g],l=j>>4,m=15&j,g=g+1,o=void 0,p=0,q=1;do{if(g==e.length){d=[null,h];break a}o=e[g++],p+=(127&o)*q,q*=128}while(0!=(128&o));if(o=g+p,o>e.length)d=[null,h];else{var r=new n(l);switch(l){case 2:1&e[g++]&&(r.sessionPresent=!0),r.returnCode=e[g++];break;case 3:var h=m>>1&3,s=256*e[g]+e[g+1],g=g+2,t=f(e,g,s),g=g+s;h>0&&(r.messageIdentifier=256*e[g]+e[g+1],g+=2);var u=new Paho.MQTT.Message(e.subarray(g,o));1==(1&m)&&(u.retained=!0),8==(8&m)&&(u.duplicate=!0),u.qos=h,u.destinationName=t,r.payloadMessage=u;break;case 4:case 5:case 6:case 7:case 11:r.messageIdentifier=256*e[g]+e[g+1];break;case 9:r.messageIdentifier=256*e[g]+e[g+1],g+=2,r.returnCode=e.subarray(g,o)}d=[r,o]}}var v=d[0],b=d[1];if(null===v)break;c.push(v)}b<a.length&&(this.receiveBuffer=a.subarray(b))}catch(w){return void this._disconnected(i.INTERNAL_ERROR.code,k(i.INTERNAL_ERROR,[w.message,w.stack.toString()]))}return c},q.prototype._handleMessage=function(a){this._trace("Client._handleMessage",a);try{switch(a.type){case 2:if(this._connectTimeout.cancel(),this.connectOptions.cleanSession){for(var b in this._sentMessages){var c=this._sentMessages[b];localStorage.removeItem("Sent:"+this._localKey+c.messageIdentifier)}this._sentMessages={};for(b in this._receivedMessages){var d=this._receivedMessages[b];localStorage.removeItem("Received:"+this._localKey+d.messageIdentifier)}this._receivedMessages={}}if(0!==a.returnCode){this._disconnected(i.CONNACK_RETURNCODE.code,k(i.CONNACK_RETURNCODE,[a.returnCode,j[a.returnCode]]));break}this.connected=!0,this.connectOptions.uris&&(this.hostIndex=this.connectOptions.uris.length),a=[];for(var e in this._sentMessages)this._sentMessages.hasOwnProperty(e)&&a.push(this._sentMessages[e]);a=a.sort(function(a,b){return a.sequence-b.sequence}),e=0;for(var f=a.length;f>e;e++)if(c=a[e],3==c.type&&c.pubRecReceived){var g=new n(6,{messageIdentifier:c.messageIdentifier});this._schedule_message(g)}else this._schedule_message(c);this.connectOptions.onSuccess&&this.connectOptions.onSuccess({invocationContext:this.connectOptions.invocationContext}),this._process_queue();break;case 3:this._receivePublish(a);break;case 4:(c=this._sentMessages[a.messageIdentifier])&&(delete this._sentMessages[a.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage));break;case 5:(c=this._sentMessages[a.messageIdentifier])&&(c.pubRecReceived=!0,g=new n(6,{messageIdentifier:a.messageIdentifier}),this.store("Sent:",c),this._schedule_message(g));break;case 6:d=this._receivedMessages[a.messageIdentifier],localStorage.removeItem("Received:"+this._localKey+a.messageIdentifier),d&&(this._receiveMessage(d),delete this._receivedMessages[a.messageIdentifier]);var h=new n(7,{messageIdentifier:a.messageIdentifier});this._schedule_message(h);break;case 7:c=this._sentMessages[a.messageIdentifier],delete this._sentMessages[a.messageIdentifier],localStorage.removeItem("Sent:"+this._localKey+a.messageIdentifier),this.onMessageDelivered&&this.onMessageDelivered(c.payloadMessage);break;case 9:(c=this._sentMessages[a.messageIdentifier])&&(c.timeOut&&c.timeOut.cancel(),128===a.returnCode[0]?c.onFailure&&c.onFailure(a.returnCode):c.onSuccess&&c.onSuccess(a.returnCode),delete this._sentMessages[a.messageIdentifier]);break;case 11:(c=this._sentMessages[a.messageIdentifier])&&(c.timeOut&&c.timeOut.cancel(),c.callback&&c.callback(),delete this._sentMessages[a.messageIdentifier]);break;case 13:this.sendPinger.reset();break;case 14:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,k(i.INVALID_MQTT_MESSAGE_TYPE,[a.type]));break;default:this._disconnected(i.INVALID_MQTT_MESSAGE_TYPE.code,k(i.INVALID_MQTT_MESSAGE_TYPE,[a.type]))}}catch(l){this._disconnected(i.INTERNAL_ERROR.code,k(i.INTERNAL_ERROR,[l.message,l.stack.toString()]))}},q.prototype._on_socket_error=function(a){this._disconnected(i.SOCKET_ERROR.code,k(i.SOCKET_ERROR,[a.data]))},q.prototype._on_socket_close=function(){this._disconnected(i.SOCKET_CLOSE.code,k(i.SOCKET_CLOSE))},q.prototype._socket_send=function(a){if(1==a.type){var b=this._traceMask(a,"password");this._trace("Client._socket_send",b)}else this._trace("Client._socket_send",a);this.socket.send(a.encode()),this.sendPinger.reset()},q.prototype._receivePublish=function(a){switch(a.payloadMessage.qos){case"undefined":case 0:this._receiveMessage(a);break;case 1:var b=new n(4,{messageIdentifier:a.messageIdentifier});this._schedule_message(b),this._receiveMessage(a);break;case 2:this._receivedMessages[a.messageIdentifier]=a,this.store("Received:",a),a=new n(5,{messageIdentifier:a.messageIdentifier}),this._schedule_message(a);break;default:throw Error("Invaild qos="+wireMmessage.payloadMessage.qos)}},q.prototype._receiveMessage=function(a){this.onMessageArrived&&this.onMessageArrived(a.payloadMessage)},q.prototype._disconnected=function(a,b){this._trace("Client._disconnected",a,b),this.sendPinger.cancel(),this.receivePinger.cancel(),this._connectTimeout&&this._connectTimeout.cancel(),this._msg_queue=[],this._notify_msg_sent={},this.socket&&(this.socket.onopen=null,this.socket.onmessage=null,this.socket.onerror=null,this.socket.onclose=null,1===this.socket.readyState&&this.socket.close(),delete this.socket),this.connectOptions.uris&&this.hostIndex<this.connectOptions.uris.length-1?(this.hostIndex++,this._doConnect(this.connectOptions.uris[this.hostIndex])):(void 0===a&&(a=i.OK.code,b=k(i.OK)),this.connected?(this.connected=!1,this.onConnectionLost&&this.onConnectionLost({errorCode:a,errorMessage:b})):4===this.connectOptions.mqttVersion&&!1===this.connectOptions.mqttVersionExplicit?(this._trace("Failed to connect V4, dropping back to V3"),this.connectOptions.mqttVersion=3,this.connectOptions.uris?(this.hostIndex=0,this._doConnect(this.connectOptions.uris[0])):this._doConnect(this.uri)):this.connectOptions.onFailure&&this.connectOptions.onFailure({invocationContext:this.connectOptions.invocationContext,errorCode:a,errorMessage:b}))},q.prototype._trace=function(){if(this.traceFunction){for(var a in arguments)"undefined"!=typeof arguments[a]&&(arguments[a]=JSON.stringify(arguments[a]));a=Array.prototype.slice.call(arguments).join(""),this.traceFunction({severity:"Debug",message:a})}if(null!==this._traceBuffer){a=0;for(var b=arguments.length;b>a;a++)this._traceBuffer.length==this._MAX_TRACE_ENTRIES&&this._traceBuffer.shift(),0===a?this._traceBuffer.push(arguments[a]):"undefined"==typeof arguments[a]?this._traceBuffer.push(arguments[a]):this._traceBuffer.push("  "+JSON.stringify(arguments[a]))}},q.prototype._traceMask=function(a,b){var c,d={};for(c in a)a.hasOwnProperty(c)&&(d[c]=c==b?"******":a[c]);return d};var r=function(a,b,c,d){var e;if("string"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"host"]));if(2==arguments.length){d=b,e=a;var f=e.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(!f)throw Error(k(i.INVALID_ARGUMENT,[a,"host"]));a=f[4]||f[2],b=parseInt(f[7]),c=f[8]}else{if(3==arguments.length&&(d=c,c="/mqtt"),"number"!=typeof b||0>b)throw Error(k(i.INVALID_TYPE,[typeof b,"port"]));if("string"!=typeof c)throw Error(k(i.INVALID_TYPE,[typeof c,"path"]));e="ws://"+(-1!=a.indexOf(":")&&"["!=a.slice(0,1)&&"]"!=a.slice(-1)?"["+a+"]":a)+":"+b+c}for(var h=f=0;h<d.length;h++){var j=d.charCodeAt(h);j>=55296&&56319>=j&&h++,f++}if("string"!=typeof d||f>65535)throw Error(k(i.INVALID_ARGUMENT,[d,"clientId"]));var l=new q(e,a,b,c,d);this._getHost=function(){return a},this._setHost=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getPort=function(){return b},this._setPort=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getPath=function(){return c},this._setPath=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getURI=function(){return e},this._setURI=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getClientId=function(){return l.clientId},this._setClientId=function(){throw Error(k(i.UNSUPPORTED_OPERATION))},this._getOnConnectionLost=function(){return l.onConnectionLost},this._setOnConnectionLost=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onConnectionLost"]));l.onConnectionLost=a},this._getOnMessageDelivered=function(){return l.onMessageDelivered},this._setOnMessageDelivered=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onMessageDelivered"]));l.onMessageDelivered=a},this._getOnMessageArrived=function(){return l.onMessageArrived},this._setOnMessageArrived=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onMessageArrived"]));l.onMessageArrived=a},this._getTrace=function(){return l.traceFunction},this._setTrace=function(a){if("function"!=typeof a)throw Error(k(i.INVALID_TYPE,[typeof a,"onTrace"]));l.traceFunction=a},this.connect=function(a){if(a=a||{},g(a,{timeout:"number",userName:"string",password:"string",willMessage:"object",keepAliveInterval:"number",cleanSession:"boolean",useSSL:"boolean",invocationContext:"object",onSuccess:"function",onFailure:"function",hosts:"object",ports:"object",mqttVersion:"number",mqttVersionExplicit:"boolean",uris:"object"}),void 0===a.keepAliveInterval&&(a.keepAliveInterval=60),4<a.mqttVersion||3>a.mqttVersion)throw Error(k(i.INVALID_ARGUMENT,[a.mqttVersion,"connectOptions.mqttVersion"]));if(void 0===a.mqttVersion?(a.mqttVersionExplicit=!1,a.mqttVersion=4):a.mqttVersionExplicit=!0,void 0!==a.password&&void 0===a.userName)throw Error(k(i.INVALID_ARGUMENT,[a.password,"connectOptions.password"]));if(a.willMessage){if(!(a.willMessage instanceof s))throw Error(k(i.INVALID_TYPE,[a.willMessage,"connectOptions.willMessage"]));if(a.willMessage.stringPayload,"undefined"==typeof a.willMessage.destinationName)throw Error(k(i.INVALID_TYPE,[typeof a.willMessage.destinationName,"connectOptions.willMessage.destinationName"]))}if("undefined"==typeof a.cleanSession&&(a.cleanSession=!0),a.hosts){if(!(a.hosts instanceof Array))throw Error(k(i.INVALID_ARGUMENT,[a.hosts,"connectOptions.hosts"]));if(1>a.hosts.length)throw Error(k(i.INVALID_ARGUMENT,[a.hosts,"connectOptions.hosts"]));for(var b=!1,d=0;d<a.hosts.length;d++){if("string"!=typeof a.hosts[d])throw Error(k(i.INVALID_TYPE,[typeof a.hosts[d],"connectOptions.hosts["+d+"]"]));if(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/.test(a.hosts[d])){if(0==d)b=!0;else if(!b)throw Error(k(i.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]))}else if(b)throw Error(k(i.INVALID_ARGUMENT,[a.hosts[d],"connectOptions.hosts["+d+"]"]))}if(b)a.uris=a.hosts;else{if(!a.ports)throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));if(!(a.ports instanceof Array))throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));if(a.hosts.length!=a.ports.length)throw Error(k(i.INVALID_ARGUMENT,[a.ports,"connectOptions.ports"]));for(a.uris=[],d=0;d<a.hosts.length;d++){if("number"!=typeof a.ports[d]||0>a.ports[d])throw Error(k(i.INVALID_TYPE,[typeof a.ports[d],"connectOptions.ports["+d+"]"]));var b=a.hosts[d],f=a.ports[d];e="ws://"+(-1!=b.indexOf(":")?"["+b+"]":b)+":"+f+c,a.uris.push(e)}}}l.connect(a)},this.subscribe=function(a,b){if("string"!=typeof a)throw Error("Invalid argument:"+a);if(b=b||{},g(b,{qos:"number",invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),b.timeout&&!b.onFailure)throw Error("subscribeOptions.timeout specified with no onFailure callback.");if("undefined"!=typeof b.qos&&0!==b.qos&&1!==b.qos&&2!==b.qos)throw Error(k(i.INVALID_ARGUMENT,[b.qos,"subscribeOptions.qos"]));l.subscribe(a,b)},this.unsubscribe=function(a,b){if("string"!=typeof a)throw Error("Invalid argument:"+a);if(b=b||{},g(b,{invocationContext:"object",onSuccess:"function",onFailure:"function",timeout:"number"}),b.timeout&&!b.onFailure)throw Error("unsubscribeOptions.timeout specified with no onFailure callback.");l.unsubscribe(a,b)},this.send=function(a,b,c,d){var e;if(0==arguments.length)throw Error("Invalid argument.length");if(1==arguments.length){if(!(a instanceof s)&&"string"!=typeof a)throw Error("Invalid argument:"+typeof a);if(e=a,"undefined"==typeof e.destinationName)throw Error(k(i.INVALID_ARGUMENT,[e.destinationName,"Message.destinationName"]))}else e=new s(b),e.destinationName=a,3<=arguments.length&&(e.qos=c),4<=arguments.length&&(e.retained=d);l.send(e)},this.disconnect=function(){l.disconnect()},this.getTraceLog=function(){return l.getTraceLog()},this.startTrace=function(){l.startTrace()},this.stopTrace=function(){l.stopTrace()},this.isConnected=function(){return l.connected}};r.prototype={get host(){return this._getHost()},set host(a){this._setHost(a)},get port(){return this._getPort()},set port(a){this._setPort(a)},get path(){return this._getPath()},set path(a){this._setPath(a)},get clientId(){return this._getClientId()},set clientId(a){this._setClientId(a)},get onConnectionLost(){return this._getOnConnectionLost()},set onConnectionLost(a){this._setOnConnectionLost(a)},get onMessageDelivered(){return this._getOnMessageDelivered()},set onMessageDelivered(a){this._setOnMessageDelivered(a)},get onMessageArrived(){return this._getOnMessageArrived()},set onMessageArrived(a){this._setOnMessageArrived(a)},get trace(){return this._getTrace()},set trace(a){this._setTrace(a)}};var s=function(a){var b;if(!("string"==typeof a||a instanceof ArrayBuffer||a instanceof Int8Array||a instanceof Uint8Array||a instanceof Int16Array||a instanceof Uint16Array||a instanceof Int32Array||a instanceof Uint32Array||a instanceof Float32Array||a instanceof Float64Array))throw k(i.INVALID_ARGUMENT,[a,"newPayload"]);b=a,this._getPayloadString=function(){return"string"==typeof b?b:f(b,0,b.length)},this._getPayloadBytes=function(){if("string"==typeof b){var a=new ArrayBuffer(d(b)),a=new Uint8Array(a);return e(b,a,0),a}return b};var c=void 0;this._getDestinationName=function(){return c},this._setDestinationName=function(a){if("string"!=typeof a)throw Error(k(i.INVALID_ARGUMENT,[a,"newDestinationName"]));c=a};var g=0;this._getQos=function(){return g},this._setQos=function(a){if(0!==a&&1!==a&&2!==a)throw Error("Invalid argument:"+a);g=a};var h=!1;this._getRetained=function(){return h},this._setRetained=function(a){if("boolean"!=typeof a)throw Error(k(i.INVALID_ARGUMENT,[a,"newRetained"]));h=a};var j=!1;this._getDuplicate=function(){return j},this._setDuplicate=function(a){j=a}};return s.prototype={get payloadString(){return this._getPayloadString()},get payloadBytes(){return this._getPayloadBytes()},get destinationName(){return this._getDestinationName()},set destinationName(a){this._setDestinationName(a)},get qos(){return this._getQos()},set qos(a){this._setQos(a)},get retained(){return this._getRetained()},set retained(a){this._setRetained(a)},get duplicate(){return this._getDuplicate()},set duplicate(a){this._setDuplicate(a)}},{Client:r,Message:s}}(window)},{}],125:[function(a,b,c){(function(a){"use strict";function c(b){for(var c=new Array(arguments.length-1),d=0;d<c.length;)c[d++]=arguments[d];a.nextTick(function(){b.apply(null,c)})}b.exports=c}).call(this,a("_process"))},{_process:126}],126:[function(a,b,c){function d(){k=!1,h.length?j=h.concat(j):l=-1,j.length&&e()}function e(){if(!k){var a=setTimeout(d);k=!0;for(var b=j.length;b;){for(h=j,j=[];++l<b;)h&&h[l].run();l=-1,b=j.length}h=null,k=!1,clearTimeout(a)}}function f(a,b){this.fun=a,this.array=b}function g(){}var h,i=b.exports={},j=[],k=!1,l=-1;i.nextTick=function(a){var b=new Array(arguments.length-1);if(arguments.length>1)for(var c=1;c<arguments.length;c++)b[c-1]=arguments[c];j.push(new f(a,b)),1!==j.length||k||setTimeout(e,0)},f.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.binding=function(a){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(a){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},{}],127:[function(a,b,c){b.exports=a("./lib/_stream_duplex.js")},{"./lib/_stream_duplex.js":128}],128:[function(a,b,c){"use strict";function d(a){return this instanceof d?(j.call(this,a),k.call(this,a),a&&a.readable===!1&&(this.readable=!1),a&&a.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,a&&a.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",e)):new d(a)}function e(){this.allowHalfOpen||this._writableState.ended||h(f,this)}function f(a){a.end()}var g=Object.keys||function(a){var b=[];for(var c in a)b.push(c);return b};b.exports=d;var h=a("process-nextick-args"),i=a("core-util-is");i.inherits=a("inherits");var j=a("./_stream_readable"),k=a("./_stream_writable");i.inherits(d,j);for(var l=g(k.prototype),m=0;m<l.length;m++){var n=l[m];d.prototype[n]||(d.prototype[n]=k.prototype[n])}},{"./_stream_readable":130,"./_stream_writable":132,"core-util-is":5,inherits:8,"process-nextick-args":125}],129:[function(a,b,c){"use strict";function d(a){return this instanceof d?void e.call(this,a):new d(a)}b.exports=d;var e=a("./_stream_transform"),f=a("core-util-is");f.inherits=a("inherits"),f.inherits(d,e),d.prototype._transform=function(a,b,c){c(null,a)}},{"./_stream_transform":131,"core-util-is":5,inherits:8}],130:[function(a,b,c){(function(c){"use strict";function d(b,c){var d=a("./_stream_duplex");b=b||{},this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.readableObjectMode);var e=b.highWaterMark,f=this.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.defaultEncoding=b.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,b.encoding&&(G||(G=a("string_decoder/").StringDecoder),this.decoder=new G(b.encoding),this.encoding=b.encoding)}function e(b){a("./_stream_duplex");return this instanceof e?(this._readableState=new d(b,this),this.readable=!0,b&&"function"==typeof b.read&&(this._read=b.read),void D.call(this)):new e(b)}function f(a,b,c,d,e){var f=j(b,c);if(f)a.emit("error",f);else if(null===c)b.reading=!1,k(a,b);else if(b.objectMode||c&&c.length>0)if(b.ended&&!e){var h=new Error("stream.push() after EOF");a.emit("error",h)}else if(b.endEmitted&&e){var h=new Error("stream.unshift() after end event");a.emit("error",h)}else!b.decoder||e||d||(c=b.decoder.write(c)),e||(b.reading=!1),b.flowing&&0===b.length&&!b.sync?(a.emit("data",c),a.read(0)):(b.length+=b.objectMode?1:c.length,e?b.buffer.unshift(c):b.buffer.push(c),b.needReadable&&l(a)),n(a,b);else e||(b.reading=!1);return g(b)}function g(a){return!a.ended&&(a.needReadable||a.length<a.highWaterMark||0===a.length)}function h(a){if(a>=H)a=H;else{a--;for(var b=1;32>b;b<<=1)a|=a>>b;a++}return a}function i(a,b){return 0===b.length&&b.ended?0:b.objectMode?0===a?0:1:null===a||isNaN(a)?b.flowing&&b.buffer.length?b.buffer[0].length:b.length:0>=a?0:(a>b.highWaterMark&&(b.highWaterMark=h(a)),a>b.length?b.ended?b.length:(b.needReadable=!0,0):a)}function j(a,b){var c=null;return B.isBuffer(b)||"string"==typeof b||null===b||void 0===b||a.objectMode||(c=new TypeError("Invalid non-string/buffer chunk")),c}function k(a,b){if(!b.ended){if(b.decoder){var c=b.decoder.end();c&&c.length&&(b.buffer.push(c),b.length+=b.objectMode?1:c.length)}b.ended=!0,l(a)}}function l(a){var b=a._readableState;b.needReadable=!1,b.emittedReadable||(F("emitReadable",b.flowing),b.emittedReadable=!0,b.sync?z(m,a):m(a))}function m(a){F("emit readable"),a.emit("readable"),t(a)}function n(a,b){b.readingMore||(b.readingMore=!0,z(o,a,b))}function o(a,b){for(var c=b.length;!b.reading&&!b.flowing&&!b.ended&&b.length<b.highWaterMark&&(F("maybeReadMore read 0"),a.read(0),c!==b.length);)c=b.length;b.readingMore=!1}function p(a){return function(){var b=a._readableState;F("pipeOnDrain",b.awaitDrain),b.awaitDrain&&b.awaitDrain--,0===b.awaitDrain&&C.listenerCount(a,"data")&&(b.flowing=!0,t(a))}}function q(a){F("readable nexttick read 0"),a.read(0)}function r(a,b){b.resumeScheduled||(b.resumeScheduled=!0,z(s,a,b))}function s(a,b){b.reading||(F("resume read 0"),a.read(0)),b.resumeScheduled=!1,a.emit("resume"),t(a),b.flowing&&!b.reading&&a.read(0)}function t(a){var b=a._readableState;if(F("flow",b.flowing),b.flowing)do var c=a.read();while(null!==c&&b.flowing)}function u(a,b){var c,d=b.buffer,e=b.length,f=!!b.decoder,g=!!b.objectMode;if(0===d.length)return null;if(0===e)c=null;else if(g)c=d.shift();else if(!a||a>=e)c=f?d.join(""):B.concat(d,e),d.length=0;else if(a<d[0].length){var h=d[0];c=h.slice(0,a),d[0]=h.slice(a)}else if(a===d[0].length)c=d.shift();else{c=f?"":new B(a);for(var i=0,j=0,k=d.length;k>j&&a>i;j++){var h=d[0],l=Math.min(a-i,h.length);f?c+=h.slice(0,l):h.copy(c,i,0,l),l<h.length?d[0]=h.slice(l):d.shift(),i+=l}}return c}function v(a){var b=a._readableState;if(b.length>0)throw new Error("endReadable called on non-empty stream");b.endEmitted||(b.ended=!0,z(w,b,a))}function w(a,b){a.endEmitted||0!==a.length||(a.endEmitted=!0,b.readable=!1,b.emit("end"))}function x(a,b){for(var c=0,d=a.length;d>c;c++)b(a[c],c)}function y(a,b){for(var c=0,d=a.length;d>c;c++)if(a[c]===b)return c;return-1}b.exports=e;var z=a("process-nextick-args"),A=a("isarray"),B=a("buffer").Buffer;e.ReadableState=d;var C=a("events").EventEmitter;C.listenerCount||(C.listenerCount=function(a,b){return a.listeners(b).length});var D;!function(){try{D=a("stream")}catch(b){}finally{D||(D=a("events").EventEmitter)}}();var B=a("buffer").Buffer,E=a("core-util-is");E.inherits=a("inherits");var F=a("util");F=F&&F.debuglog?F.debuglog("stream"):function(){};var G;E.inherits(e,D),e.prototype.push=function(a,b){var c=this._readableState;return c.objectMode||"string"!=typeof a||(b=b||c.defaultEncoding,b!==c.encoding&&(a=new B(a,b),b="")),f(this,c,a,b,!1)},e.prototype.unshift=function(a){var b=this._readableState;return f(this,b,a,"",!0)},e.prototype.isPaused=function(){return this._readableState.flowing===!1},e.prototype.setEncoding=function(b){return G||(G=a("string_decoder/").StringDecoder),this._readableState.decoder=new G(b),this._readableState.encoding=b,this};var H=8388608;e.prototype.read=function(a){F("read",a);var b=this._readableState,c=a;if(("number"!=typeof a||a>0)&&(b.emittedReadable=!1),0===a&&b.needReadable&&(b.length>=b.highWaterMark||b.ended))return F("read: emitReadable",b.length,b.ended),0===b.length&&b.ended?v(this):l(this),null;if(a=i(a,b),0===a&&b.ended)return 0===b.length&&v(this),null;var d=b.needReadable;F("need readable",d),(0===b.length||b.length-a<b.highWaterMark)&&(d=!0,F("length less than watermark",d)),(b.ended||b.reading)&&(d=!1,F("reading or ended",d)),d&&(F("do read"),b.reading=!0,b.sync=!0,0===b.length&&(b.needReadable=!0),this._read(b.highWaterMark),b.sync=!1),d&&!b.reading&&(a=i(c,b));var e;return e=a>0?u(a,b):null,null===e&&(b.needReadable=!0,a=0),b.length-=a,0!==b.length||b.ended||(b.needReadable=!0),c!==a&&b.ended&&0===b.length&&v(this),null!==e&&this.emit("data",e),e},e.prototype._read=function(a){this.emit("error",new Error("not implemented"))},e.prototype.pipe=function(a,b){function d(a){F("onunpipe"),a===l&&f()}function e(){F("onend"),a.end()}function f(){F("cleanup"),a.removeListener("close",i),a.removeListener("finish",j),a.removeListener("drain",q),a.removeListener("error",h),a.removeListener("unpipe",d),l.removeListener("end",e),l.removeListener("end",f),l.removeListener("data",g),!m.awaitDrain||a._writableState&&!a._writableState.needDrain||q()}function g(b){F("ondata");var c=a.write(b);!1===c&&(F("false write response, pause",l._readableState.awaitDrain),l._readableState.awaitDrain++,l.pause())}function h(b){F("onerror",b),k(),a.removeListener("error",h),0===C.listenerCount(a,"error")&&a.emit("error",b)}function i(){a.removeListener("finish",j),k()}function j(){F("onfinish"),a.removeListener("close",i),k()}function k(){F("unpipe"),l.unpipe(a)}var l=this,m=this._readableState;switch(m.pipesCount){case 0:m.pipes=a;break;case 1:m.pipes=[m.pipes,a];break;default:m.pipes.push(a)}m.pipesCount+=1,F("pipe count=%d opts=%j",m.pipesCount,b);var n=(!b||b.end!==!1)&&a!==c.stdout&&a!==c.stderr,o=n?e:f;m.endEmitted?z(o):l.once("end",o),a.on("unpipe",d);var q=p(l);return a.on("drain",q),l.on("data",g),a._events&&a._events.error?A(a._events.error)?a._events.error.unshift(h):a._events.error=[h,a._events.error]:a.on("error",h),a.once("close",i),a.once("finish",j),a.emit("pipe",l),m.flowing||(F("pipe resume"),l.resume()),a},e.prototype.unpipe=function(a){var b=this._readableState;if(0===b.pipesCount)return this;if(1===b.pipesCount)return a&&a!==b.pipes?this:(a||(a=b.pipes),b.pipes=null,b.pipesCount=0,b.flowing=!1,a&&a.emit("unpipe",this),this);if(!a){var c=b.pipes,d=b.pipesCount;b.pipes=null,b.pipesCount=0,b.flowing=!1;for(var e=0;d>e;e++)c[e].emit("unpipe",this);return this}var e=y(b.pipes,a);return-1===e?this:(b.pipes.splice(e,1),b.pipesCount-=1,1===b.pipesCount&&(b.pipes=b.pipes[0]),a.emit("unpipe",this),this)},e.prototype.on=function(a,b){var c=D.prototype.on.call(this,a,b);if("data"===a&&!1!==this._readableState.flowing&&this.resume(),"readable"===a&&this.readable){var d=this._readableState;d.readableListening||(d.readableListening=!0,d.emittedReadable=!1,d.needReadable=!0,
d.reading?d.length&&l(this,d):z(q,this))}return c},e.prototype.addListener=e.prototype.on,e.prototype.resume=function(){var a=this._readableState;return a.flowing||(F("resume"),a.flowing=!0,r(this,a)),this},e.prototype.pause=function(){return F("call pause flowing=%j",this._readableState.flowing),!1!==this._readableState.flowing&&(F("pause"),this._readableState.flowing=!1,this.emit("pause")),this},e.prototype.wrap=function(a){var b=this._readableState,c=!1,d=this;a.on("end",function(){if(F("wrapped end"),b.decoder&&!b.ended){var a=b.decoder.end();a&&a.length&&d.push(a)}d.push(null)}),a.on("data",function(e){if(F("wrapped data"),b.decoder&&(e=b.decoder.write(e)),(!b.objectMode||null!==e&&void 0!==e)&&(b.objectMode||e&&e.length)){var f=d.push(e);f||(c=!0,a.pause())}});for(var e in a)void 0===this[e]&&"function"==typeof a[e]&&(this[e]=function(b){return function(){return a[b].apply(a,arguments)}}(e));var f=["error","close","destroy","pause","resume"];return x(f,function(b){a.on(b,d.emit.bind(d,b))}),d._read=function(b){F("wrapped _read",b),c&&(c=!1,a.resume())},d},e._fromList=u}).call(this,a("_process"))},{"./_stream_duplex":128,_process:126,buffer:4,"core-util-is":5,events:6,inherits:8,isarray:11,"process-nextick-args":125,"string_decoder/":139,util:3}],131:[function(a,b,c){"use strict";function d(a){this.afterTransform=function(b,c){return e(a,b,c)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function e(a,b,c){var d=a._transformState;d.transforming=!1;var e=d.writecb;if(!e)return a.emit("error",new Error("no writecb in Transform class"));d.writechunk=null,d.writecb=null,null!==c&&void 0!==c&&a.push(c),e&&e(b);var f=a._readableState;f.reading=!1,(f.needReadable||f.length<f.highWaterMark)&&a._read(f.highWaterMark)}function f(a){if(!(this instanceof f))return new f(a);h.call(this,a),this._transformState=new d(this);var b=this;this._readableState.needReadable=!0,this._readableState.sync=!1,a&&("function"==typeof a.transform&&(this._transform=a.transform),"function"==typeof a.flush&&(this._flush=a.flush)),this.once("prefinish",function(){"function"==typeof this._flush?this._flush(function(a){g(b,a)}):g(b)})}function g(a,b){if(b)return a.emit("error",b);var c=a._writableState,d=a._transformState;if(c.length)throw new Error("calling transform done when ws.length != 0");if(d.transforming)throw new Error("calling transform done when still transforming");return a.push(null)}b.exports=f;var h=a("./_stream_duplex"),i=a("core-util-is");i.inherits=a("inherits"),i.inherits(f,h),f.prototype.push=function(a,b){return this._transformState.needTransform=!1,h.prototype.push.call(this,a,b)},f.prototype._transform=function(a,b,c){throw new Error("not implemented")},f.prototype._write=function(a,b,c){var d=this._transformState;if(d.writecb=c,d.writechunk=a,d.writeencoding=b,!d.transforming){var e=this._readableState;(d.needTransform||e.needReadable||e.length<e.highWaterMark)&&this._read(e.highWaterMark)}},f.prototype._read=function(a){var b=this._transformState;null!==b.writechunk&&b.writecb&&!b.transforming?(b.transforming=!0,this._transform(b.writechunk,b.writeencoding,b.afterTransform)):b.needTransform=!0}},{"./_stream_duplex":128,"core-util-is":5,inherits:8}],132:[function(a,b,c){"use strict";function d(){}function e(a,b,c){this.chunk=a,this.encoding=b,this.callback=c,this.next=null}function f(b,c){var d=a("./_stream_duplex");b=b||{},this.objectMode=!!b.objectMode,c instanceof d&&(this.objectMode=this.objectMode||!!b.writableObjectMode);var e=b.highWaterMark,f=this.objectMode?16:16384;this.highWaterMark=e||0===e?e:f,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var g=b.decodeStrings===!1;this.decodeStrings=!g,this.defaultEncoding=b.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){o(c,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1}function g(b){var c=a("./_stream_duplex");return this instanceof g||this instanceof c?(this._writableState=new f(b,this),this.writable=!0,b&&("function"==typeof b.write&&(this._write=b.write),"function"==typeof b.writev&&(this._writev=b.writev)),void z.call(this)):new g(b)}function h(a,b){var c=new Error("write after end");a.emit("error",c),w(b,c)}function i(a,b,c,d){var e=!0;if(!x.isBuffer(c)&&"string"!=typeof c&&null!==c&&void 0!==c&&!b.objectMode){var f=new TypeError("Invalid non-string/buffer chunk");a.emit("error",f),w(d,f),e=!1}return e}function j(a,b,c){return a.objectMode||a.decodeStrings===!1||"string"!=typeof b||(b=new x(b,c)),b}function k(a,b,c,d,f){c=j(b,c,d),x.isBuffer(c)&&(d="buffer");var g=b.objectMode?1:c.length;b.length+=g;var h=b.length<b.highWaterMark;if(h||(b.needDrain=!0),b.writing||b.corked){var i=b.lastBufferedRequest;b.lastBufferedRequest=new e(c,d,f),i?i.next=b.lastBufferedRequest:b.bufferedRequest=b.lastBufferedRequest}else l(a,b,!1,g,c,d,f);return h}function l(a,b,c,d,e,f,g){b.writelen=d,b.writecb=g,b.writing=!0,b.sync=!0,c?a._writev(e,b.onwrite):a._write(e,f,b.onwrite),b.sync=!1}function m(a,b,c,d,e){--b.pendingcb,c?w(e,d):e(d),a._writableState.errorEmitted=!0,a.emit("error",d)}function n(a){a.writing=!1,a.writecb=null,a.length-=a.writelen,a.writelen=0}function o(a,b){var c=a._writableState,d=c.sync,e=c.writecb;if(n(c),b)m(a,c,d,b,e);else{var f=s(c);f||c.corked||c.bufferProcessing||!c.bufferedRequest||r(a,c),d?w(p,a,c,f,e):p(a,c,f,e)}}function p(a,b,c,d){c||q(a,b),b.pendingcb--,d(),u(a,b)}function q(a,b){0===b.length&&b.needDrain&&(b.needDrain=!1,a.emit("drain"))}function r(a,b){b.bufferProcessing=!0;var c=b.bufferedRequest;if(a._writev&&c&&c.next){for(var d=[],e=[];c;)e.push(c.callback),d.push(c),c=c.next;b.pendingcb++,b.lastBufferedRequest=null,l(a,b,!0,b.length,d,"",function(a){for(var c=0;c<e.length;c++)b.pendingcb--,e[c](a)})}else{for(;c;){var f=c.chunk,g=c.encoding,h=c.callback,i=b.objectMode?1:f.length;if(l(a,b,!1,i,f,g,h),c=c.next,b.writing)break}null===c&&(b.lastBufferedRequest=null)}b.bufferedRequest=c,b.bufferProcessing=!1}function s(a){return a.ending&&0===a.length&&null===a.bufferedRequest&&!a.finished&&!a.writing}function t(a,b){b.prefinished||(b.prefinished=!0,a.emit("prefinish"))}function u(a,b){var c=s(b);return c&&(0===b.pendingcb?(t(a,b),b.finished=!0,a.emit("finish")):t(a,b)),c}function v(a,b,c){b.ending=!0,u(a,b),c&&(b.finished?w(c):a.once("finish",c)),b.ended=!0}b.exports=g;var w=a("process-nextick-args"),x=a("buffer").Buffer;g.WritableState=f;var y=a("core-util-is");y.inherits=a("inherits");var z;!function(){try{z=a("stream")}catch(b){}finally{z||(z=a("events").EventEmitter)}}();var x=a("buffer").Buffer;y.inherits(g,z),f.prototype.getBuffer=function(){for(var a=this.bufferedRequest,b=[];a;)b.push(a),a=a.next;return b},function(){try{Object.defineProperty(f.prototype,"buffer",{get:a("util-deprecate")(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer() instead.")})}catch(b){}}(),g.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},g.prototype.write=function(a,b,c){var e=this._writableState,f=!1;return"function"==typeof b&&(c=b,b=null),x.isBuffer(a)?b="buffer":b||(b=e.defaultEncoding),"function"!=typeof c&&(c=d),e.ended?h(this,c):i(this,e,a,c)&&(e.pendingcb++,f=k(this,e,a,b,c)),f},g.prototype.cork=function(){var a=this._writableState;a.corked++},g.prototype.uncork=function(){var a=this._writableState;a.corked&&(a.corked--,a.writing||a.corked||a.finished||a.bufferProcessing||!a.bufferedRequest||r(this,a))},g.prototype.setDefaultEncoding=function(a){if("string"==typeof a&&(a=a.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((a+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+a);this._writableState.defaultEncoding=a},g.prototype._write=function(a,b,c){c(new Error("not implemented"))},g.prototype._writev=null,g.prototype.end=function(a,b,c){var d=this._writableState;"function"==typeof a?(c=a,a=null,b=null):"function"==typeof b&&(c=b,b=null),null!==a&&void 0!==a&&this.write(a,b),d.corked&&(d.corked=1,this.uncork()),d.ending||d.finished||v(this,d,c)}},{"./_stream_duplex":128,buffer:4,"core-util-is":5,events:6,inherits:8,"process-nextick-args":125,"util-deprecate":141}],133:[function(a,b,c){b.exports=a("./lib/_stream_passthrough.js")},{"./lib/_stream_passthrough.js":129}],134:[function(a,b,c){var d=function(){try{return a("stream")}catch(b){}}();c=b.exports=a("./lib/_stream_readable.js"),c.Stream=d||c,c.Readable=c,c.Writable=a("./lib/_stream_writable.js"),c.Duplex=a("./lib/_stream_duplex.js"),c.Transform=a("./lib/_stream_transform.js"),c.PassThrough=a("./lib/_stream_passthrough.js")},{"./lib/_stream_duplex.js":128,"./lib/_stream_passthrough.js":129,"./lib/_stream_readable.js":130,"./lib/_stream_transform.js":131,"./lib/_stream_writable.js":132}],135:[function(a,b,c){b.exports=a("./lib/_stream_transform.js")},{"./lib/_stream_transform.js":131}],136:[function(a,b,c){b.exports=a("./lib/_stream_writable.js")},{"./lib/_stream_writable.js":132}],137:[function(a,b,c){(function(b){!function(c){function d(a,b){if(!(this instanceof d))return new d(a,b);var e=this;f(e),e.q=e.c="",e.bufferCheckPosition=c.MAX_BUFFER_LENGTH,e.opt=b||{},e.opt.lowercase=e.opt.lowercase||e.opt.lowercasetags,e.looseCase=e.opt.lowercase?"toLowerCase":"toUpperCase",e.tags=[],e.closed=e.closedRoot=e.sawRoot=!1,e.tag=e.error=null,e.strict=!!a,e.noscript=!(!a&&!e.opt.noscript),e.state=V.BEGIN,e.strictEntities=e.opt.strictEntities,e.ENTITIES=e.strictEntities?Object.create(c.XML_ENTITIES):Object.create(c.ENTITIES),e.attribList=[],e.opt.xmlns&&(e.ns=Object.create(Q)),e.trackPosition=e.opt.position!==!1,e.trackPosition&&(e.position=e.line=e.column=0),n(e,"onready")}function e(a){for(var b=Math.max(c.MAX_BUFFER_LENGTH,10),d=0,e=0,f=D.length;f>e;e++){var g=a[D[e]].length;if(g>b)switch(D[e]){case"textNode":p(a);break;case"cdata":o(a,"oncdata",a.cdata),a.cdata="";break;case"script":o(a,"onscript",a.script),a.script="";break;default:r(a,"Max buffer length exceeded: "+D[e])}d=Math.max(d,g)}var h=c.MAX_BUFFER_LENGTH-d;a.bufferCheckPosition=h+a.position}function f(a){for(var b=0,c=D.length;c>b;b++)a[D[b]]=""}function g(a){p(a),""!==a.cdata&&(o(a,"oncdata",a.cdata),a.cdata=""),""!==a.script&&(o(a,"onscript",a.script),a.script="")}function h(a,b){return new i(a,b)}function i(a,b){if(!(this instanceof i))return new i(a,b);E.apply(this),this._parser=new d(a,b),this.writable=!0,this.readable=!0;var c=this;this._parser.onend=function(){c.emit("end")},this._parser.onerror=function(a){c.emit("error",a),c._parser.error=null},this._decoder=null,G.forEach(function(a){Object.defineProperty(c,"on"+a,{get:function(){return c._parser["on"+a]},set:function(b){return b?void c.on(a,b):(c.removeAllListeners(a),c._parser["on"+a]=b,b)},enumerable:!0,configurable:!1})})}function j(a){return a.split("").reduce(function(a,b){return a[b]=!0,a},{})}function k(a){return"[object RegExp]"===Object.prototype.toString.call(a)}function l(a,b){return k(a)?!!b.match(a):a[b]}function m(a,b){return!l(a,b)}function n(a,b,c){a[b]&&a[b](c)}function o(a,b,c){a.textNode&&p(a),n(a,b,c)}function p(a){a.textNode=q(a.opt,a.textNode),a.textNode&&n(a,"ontext",a.textNode),a.textNode=""}function q(a,b){return a.trim&&(b=b.trim()),a.normalize&&(b=b.replace(/\s+/g," ")),b}function r(a,b){return p(a),a.trackPosition&&(b+="\nLine: "+a.line+"\nColumn: "+a.column+"\nChar: "+a.c),b=new Error(b),a.error=b,n(a,"onerror",b),a}function s(a){return a.sawRoot&&!a.closedRoot&&t(a,"Unclosed root tag"),a.state!==V.BEGIN&&a.state!==V.BEGIN_WHITESPACE&&a.state!==V.TEXT&&r(a,"Unexpected end"),p(a),a.c="",a.closed=!0,n(a,"onend"),d.call(a,a.strict,a.opt),a}function t(a,b){if("object"!=typeof a||!(a instanceof d))throw new Error("bad call to strictFail");a.strict&&r(a,b)}function u(a){a.strict||(a.tagName=a.tagName[a.looseCase]());var b=a.tags[a.tags.length-1]||a,c=a.tag={name:a.tagName,attributes:{}};a.opt.xmlns&&(c.ns=b.ns),a.attribList.length=0,o(a,"onopentagstart",c)}function v(a,b){var c=a.indexOf(":"),d=0>c?["",a]:a.split(":"),e=d[0],f=d[1];return b&&"xmlns"===a&&(e="xmlns",f=""),{prefix:e,local:f}}function w(a){if(a.strict||(a.attribName=a.attribName[a.looseCase]()),-1!==a.attribList.indexOf(a.attribName)||a.tag.attributes.hasOwnProperty(a.attribName))return void(a.attribName=a.attribValue="");if(a.opt.xmlns){var b=v(a.attribName,!0),c=b.prefix,d=b.local;if("xmlns"===c)if("xml"===d&&a.attribValue!==O)t(a,"xml: prefix must be bound to "+O+"\nActual: "+a.attribValue);else if("xmlns"===d&&a.attribValue!==P)t(a,"xmlns: prefix must be bound to "+P+"\nActual: "+a.attribValue);else{var e=a.tag,f=a.tags[a.tags.length-1]||a;e.ns===f.ns&&(e.ns=Object.create(f.ns)),e.ns[d]=a.attribValue}a.attribList.push([a.attribName,a.attribValue])}else a.tag.attributes[a.attribName]=a.attribValue,o(a,"onattribute",{name:a.attribName,value:a.attribValue});a.attribName=a.attribValue=""}function x(a,b){if(a.opt.xmlns){var c=a.tag,d=v(a.tagName);c.prefix=d.prefix,c.local=d.local,c.uri=c.ns[d.prefix]||"",c.prefix&&!c.uri&&(t(a,"Unbound namespace prefix: "+JSON.stringify(a.tagName)),c.uri=d.prefix);var e=a.tags[a.tags.length-1]||a;c.ns&&e.ns!==c.ns&&Object.keys(c.ns).forEach(function(b){o(a,"onopennamespace",{prefix:b,uri:c.ns[b]})});for(var f=0,g=a.attribList.length;g>f;f++){var h=a.attribList[f],i=h[0],j=h[1],k=v(i,!0),l=k.prefix,m=k.local,n=""===l?"":c.ns[l]||"",p={name:i,value:j,prefix:l,local:m,uri:n};l&&"xmlns"!==l&&!n&&(t(a,"Unbound namespace prefix: "+JSON.stringify(l)),p.uri=l),a.tag.attributes[i]=p,o(a,"onattribute",p)}a.attribList.length=0}a.tag.isSelfClosing=!!b,a.sawRoot=!0,a.tags.push(a.tag),o(a,"onopentag",a.tag),b||(a.noscript||"script"!==a.tagName.toLowerCase()?a.state=V.TEXT:a.state=V.SCRIPT,a.tag=null,a.tagName=""),a.attribName=a.attribValue="",a.attribList.length=0}function y(a){if(!a.tagName)return t(a,"Weird empty close tag."),a.textNode+="</>",void(a.state=V.TEXT);if(a.script){if("script"!==a.tagName)return a.script+="</"+a.tagName+">",a.tagName="",void(a.state=V.SCRIPT);o(a,"onscript",a.script),a.script=""}var b=a.tags.length,c=a.tagName;a.strict||(c=c[a.looseCase]());for(var d=c;b--;){var e=a.tags[b];if(e.name===d)break;t(a,"Unexpected close tag")}if(0>b)return t(a,"Unmatched closing tag: "+a.tagName),a.textNode+="</"+a.tagName+">",void(a.state=V.TEXT);a.tagName=c;for(var f=a.tags.length;f-- >b;){var g=a.tag=a.tags.pop();a.tagName=a.tag.name,o(a,"onclosetag",a.tagName);var h={};for(var i in g.ns)h[i]=g.ns[i];var j=a.tags[a.tags.length-1]||a;a.opt.xmlns&&g.ns!==j.ns&&Object.keys(g.ns).forEach(function(b){var c=g.ns[b];o(a,"onclosenamespace",{prefix:b,uri:c})})}0===b&&(a.closedRoot=!0),a.tagName=a.attribValue=a.attribName="",a.attribList.length=0,a.state=V.TEXT}function z(a){var b,c=a.entity,d=c.toLowerCase(),e="";return a.ENTITIES[c]?a.ENTITIES[c]:a.ENTITIES[d]?a.ENTITIES[d]:(c=d,"#"===c.charAt(0)&&("x"===c.charAt(1)?(c=c.slice(2),b=parseInt(c,16),e=b.toString(16)):(c=c.slice(1),b=parseInt(c,10),e=b.toString(10))),c=c.replace(/^0+/,""),e.toLowerCase()!==c?(t(a,"Invalid character entity"),"&"+a.entity+";"):String.fromCodePoint(b))}function A(a,b){"<"===b?(a.state=V.OPEN_WAKA,a.startTagPosition=a.position):m(H,b)&&(t(a,"Non-whitespace before first tag."),a.textNode=b,a.state=V.TEXT)}function B(a,b){var c="";return b<a.length&&(c=a.charAt(b)),c}function C(a){var b=this;if(this.error)throw this.error;if(b.closed)return r(b,"Cannot write after close. Assign an onready handler.");if(null===a)return s(b);"object"==typeof a&&(a=a.toString());for(var c=0,d="";;){if(d=B(a,c++),b.c=d,!d)break;switch(b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++),b.state){case V.BEGIN:if(b.state=V.BEGIN_WHITESPACE,"\ufeff"===d)continue;A(b,d);continue;case V.BEGIN_WHITESPACE:A(b,d);continue;case V.TEXT:if(b.sawRoot&&!b.closedRoot){for(var f=c-1;d&&"<"!==d&&"&"!==d;)d=B(a,c++),d&&b.trackPosition&&(b.position++,"\n"===d?(b.line++,b.column=0):b.column++);b.textNode+=a.substring(f,c-1)}"<"!==d||b.sawRoot&&b.closedRoot&&!b.strict?(!m(H,d)||b.sawRoot&&!b.closedRoot||t(b,"Text data outside of root node."),"&"===d?b.state=V.TEXT_ENTITY:b.textNode+=d):(b.state=V.OPEN_WAKA,b.startTagPosition=b.position);continue;case V.SCRIPT:"<"===d?b.state=V.SCRIPT_ENDING:b.script+=d;continue;case V.SCRIPT_ENDING:"/"===d?b.state=V.CLOSE_TAG:(b.script+="<"+d,b.state=V.SCRIPT);continue;case V.OPEN_WAKA:if("!"===d)b.state=V.SGML_DECL,b.sgmlDecl="";else if(l(H,d));else if(l(R,d))b.state=V.OPEN_TAG,b.tagName=d;else if("/"===d)b.state=V.CLOSE_TAG,b.tagName="";else if("?"===d)b.state=V.PROC_INST,b.procInstName=b.procInstBody="";else{if(t(b,"Unencoded <"),b.startTagPosition+1<b.position){var g=b.position-b.startTagPosition;d=new Array(g).join(" ")+d}b.textNode+="<"+d,b.state=V.TEXT}continue;case V.SGML_DECL:(b.sgmlDecl+d).toUpperCase()===M?(o(b,"onopencdata"),b.state=V.CDATA,b.sgmlDecl="",b.cdata=""):b.sgmlDecl+d==="--"?(b.state=V.COMMENT,b.comment="",b.sgmlDecl=""):(b.sgmlDecl+d).toUpperCase()===N?(b.state=V.DOCTYPE,(b.doctype||b.sawRoot)&&t(b,"Inappropriately located doctype declaration"),b.doctype="",b.sgmlDecl=""):">"===d?(o(b,"onsgmldeclaration",b.sgmlDecl),b.sgmlDecl="",b.state=V.TEXT):l(K,d)?(b.state=V.SGML_DECL_QUOTED,b.sgmlDecl+=d):b.sgmlDecl+=d;continue;case V.SGML_DECL_QUOTED:d===b.q&&(b.state=V.SGML_DECL,b.q=""),b.sgmlDecl+=d;continue;case V.DOCTYPE:">"===d?(b.state=V.TEXT,o(b,"ondoctype",b.doctype),b.doctype=!0):(b.doctype+=d,"["===d?b.state=V.DOCTYPE_DTD:l(K,d)&&(b.state=V.DOCTYPE_QUOTED,b.q=d));continue;case V.DOCTYPE_QUOTED:b.doctype+=d,d===b.q&&(b.q="",b.state=V.DOCTYPE);continue;case V.DOCTYPE_DTD:b.doctype+=d,"]"===d?b.state=V.DOCTYPE:l(K,d)&&(b.state=V.DOCTYPE_DTD_QUOTED,b.q=d);continue;case V.DOCTYPE_DTD_QUOTED:b.doctype+=d,d===b.q&&(b.state=V.DOCTYPE_DTD,b.q="");continue;case V.COMMENT:"-"===d?b.state=V.COMMENT_ENDING:b.comment+=d;continue;case V.COMMENT_ENDING:"-"===d?(b.state=V.COMMENT_ENDED,b.comment=q(b.opt,b.comment),b.comment&&o(b,"oncomment",b.comment),b.comment=""):(b.comment+="-"+d,b.state=V.COMMENT);continue;case V.COMMENT_ENDED:">"!==d?(t(b,"Malformed comment"),b.comment+="--"+d,b.state=V.COMMENT):b.state=V.TEXT;continue;case V.CDATA:"]"===d?b.state=V.CDATA_ENDING:b.cdata+=d;continue;case V.CDATA_ENDING:"]"===d?b.state=V.CDATA_ENDING_2:(b.cdata+="]"+d,b.state=V.CDATA);continue;case V.CDATA_ENDING_2:">"===d?(b.cdata&&o(b,"oncdata",b.cdata),o(b,"onclosecdata"),b.cdata="",b.state=V.TEXT):"]"===d?b.cdata+="]":(b.cdata+="]]"+d,b.state=V.CDATA);continue;case V.PROC_INST:"?"===d?b.state=V.PROC_INST_ENDING:l(H,d)?b.state=V.PROC_INST_BODY:b.procInstName+=d;continue;case V.PROC_INST_BODY:if(!b.procInstBody&&l(H,d))continue;"?"===d?b.state=V.PROC_INST_ENDING:b.procInstBody+=d;continue;case V.PROC_INST_ENDING:">"===d?(o(b,"onprocessinginstruction",{name:b.procInstName,body:b.procInstBody}),b.procInstName=b.procInstBody="",b.state=V.TEXT):(b.procInstBody+="?"+d,b.state=V.PROC_INST_BODY);continue;case V.OPEN_TAG:l(S,d)?b.tagName+=d:(u(b),">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:(m(H,d)&&t(b,"Invalid character in tag name"),b.state=V.ATTRIB));continue;case V.OPEN_TAG_SLASH:">"===d?(x(b,!0),y(b)):(t(b,"Forward-slash in opening tag not followed by >"),b.state=V.ATTRIB);continue;case V.ATTRIB:if(l(H,d))continue;">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME:"="===d?b.state=V.ATTRIB_VALUE:">"===d?(t(b,"Attribute without value"),b.attribValue=b.attribName,w(b),x(b)):l(H,d)?b.state=V.ATTRIB_NAME_SAW_WHITE:l(S,d)?b.attribName+=d:t(b,"Invalid attribute name");continue;case V.ATTRIB_NAME_SAW_WHITE:if("="===d)b.state=V.ATTRIB_VALUE;else{if(l(H,d))continue;t(b,"Attribute without value"),b.tag.attributes[b.attribName]="",b.attribValue="",o(b,"onattribute",{name:b.attribName,value:""}),b.attribName="",">"===d?x(b):l(R,d)?(b.attribName=d,b.state=V.ATTRIB_NAME):(t(b,"Invalid attribute name"),b.state=V.ATTRIB)}continue;case V.ATTRIB_VALUE:if(l(H,d))continue;l(K,d)?(b.q=d,b.state=V.ATTRIB_VALUE_QUOTED):(t(b,"Unquoted attribute value"),b.state=V.ATTRIB_VALUE_UNQUOTED,b.attribValue=d);continue;case V.ATTRIB_VALUE_QUOTED:if(d!==b.q){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_Q:b.attribValue+=d;continue}w(b),b.q="",b.state=V.ATTRIB_VALUE_CLOSED;continue;case V.ATTRIB_VALUE_CLOSED:l(H,d)?b.state=V.ATTRIB:">"===d?x(b):"/"===d?b.state=V.OPEN_TAG_SLASH:l(R,d)?(t(b,"No whitespace between attributes"),b.attribName=d,b.attribValue="",b.state=V.ATTRIB_NAME):t(b,"Invalid attribute name");continue;case V.ATTRIB_VALUE_UNQUOTED:if(m(L,d)){"&"===d?b.state=V.ATTRIB_VALUE_ENTITY_U:b.attribValue+=d;continue}w(b),">"===d?x(b):b.state=V.ATTRIB;continue;case V.CLOSE_TAG:if(b.tagName)">"===d?y(b):l(S,d)?b.tagName+=d:b.script?(b.script+="</"+b.tagName,b.tagName="",b.state=V.SCRIPT):(m(H,d)&&t(b,"Invalid tagname in closing tag"),b.state=V.CLOSE_TAG_SAW_WHITE);else{if(l(H,d))continue;m(R,d)?b.script?(b.script+="</"+d,b.state=V.SCRIPT):t(b,"Invalid tagname in closing tag."):b.tagName=d}continue;case V.CLOSE_TAG_SAW_WHITE:if(l(H,d))continue;">"===d?y(b):t(b,"Invalid characters in closing tag");continue;case V.TEXT_ENTITY:case V.ATTRIB_VALUE_ENTITY_Q:case V.ATTRIB_VALUE_ENTITY_U:var h,i;switch(b.state){case V.TEXT_ENTITY:h=V.TEXT,i="textNode";break;case V.ATTRIB_VALUE_ENTITY_Q:h=V.ATTRIB_VALUE_QUOTED,i="attribValue";break;case V.ATTRIB_VALUE_ENTITY_U:h=V.ATTRIB_VALUE_UNQUOTED,i="attribValue"}";"===d?(b[i]+=z(b),b.entity="",b.state=h):l(b.entity.length?U:T,d)?b.entity+=d:(t(b,"Invalid character in entity name"),b[i]+="&"+b.entity+d,b.entity="",b.state=h);continue;default:throw new Error(b,"Unknown state: "+b.state)}}return b.position>=b.bufferCheckPosition&&e(b),b}c.parser=function(a,b){return new d(a,b)},c.SAXParser=d,c.SAXStream=i,c.createStream=h,c.MAX_BUFFER_LENGTH=65536;var D=["comment","sgmlDecl","textNode","tagName","doctype","procInstName","procInstBody","entity","attribName","attribValue","cdata","script"];c.EVENTS=["text","processinginstruction","sgmldeclaration","doctype","comment","opentagstart","attribute","opentag","closetag","opencdata","cdata","closecdata","error","end","ready","script","opennamespace","closenamespace"],Object.create||(Object.create=function(a){function b(){}b.prototype=a;var c=new b;return c}),Object.keys||(Object.keys=function(a){var b=[];for(var c in a)a.hasOwnProperty(c)&&b.push(c);return b}),d.prototype={end:function(){s(this)},write:C,resume:function(){return this.error=null,this},close:function(){return this.write(null)},flush:function(){g(this)}};var E;try{E=a("stream").Stream}catch(F){E=function(){}}var G=c.EVENTS.filter(function(a){return"error"!==a&&"end"!==a});i.prototype=Object.create(E.prototype,{constructor:{value:i}}),i.prototype.write=function(c){if("function"==typeof b&&"function"==typeof b.isBuffer&&b.isBuffer(c)){if(!this._decoder){var d=a("string_decoder").StringDecoder;this._decoder=new d("utf8")}c=this._decoder.write(c)}return this._parser.write(c.toString()),this.emit("data",c),!0},i.prototype.end=function(a){return a&&a.length&&this.write(a),this._parser.end(),!0},i.prototype.on=function(a,b){var c=this;return c._parser["on"+a]||-1===G.indexOf(a)||(c._parser["on"+a]=function(){var b=1===arguments.length?[arguments[0]]:Array.apply(null,arguments);b.splice(0,0,a),c.emit.apply(c,b)}),E.prototype.on.call(c,a,b)};var H="\r\n	 ",I="0124356789",J="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ",K="'\"",L=H+">",M="[CDATA[",N="DOCTYPE",O="http://www.w3.org/XML/1998/namespace",P="http://www.w3.org/2000/xmlns/",Q={xml:O,xmlns:P};H=j(H),I=j(I),J=j(J);var R=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,S=/[:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/,T=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD]/,U=/[#:_A-Za-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\u00B7\u0300-\u036F\u203F-\u2040\.\d-]/;K=j(K),L=j(L);var V=0;c.STATE={BEGIN:V++,BEGIN_WHITESPACE:V++,TEXT:V++,TEXT_ENTITY:V++,OPEN_WAKA:V++,SGML_DECL:V++,SGML_DECL_QUOTED:V++,DOCTYPE:V++,DOCTYPE_QUOTED:V++,DOCTYPE_DTD:V++,DOCTYPE_DTD_QUOTED:V++,COMMENT_STARTING:V++,COMMENT:V++,COMMENT_ENDING:V++,COMMENT_ENDED:V++,CDATA:V++,CDATA_ENDING:V++,CDATA_ENDING_2:V++,PROC_INST:V++,PROC_INST_BODY:V++,PROC_INST_ENDING:V++,OPEN_TAG:V++,OPEN_TAG_SLASH:V++,ATTRIB:V++,ATTRIB_NAME:V++,ATTRIB_NAME_SAW_WHITE:V++,ATTRIB_VALUE:V++,ATTRIB_VALUE_QUOTED:V++,ATTRIB_VALUE_CLOSED:V++,ATTRIB_VALUE_UNQUOTED:V++,ATTRIB_VALUE_ENTITY_Q:V++,ATTRIB_VALUE_ENTITY_U:V++,CLOSE_TAG:V++,CLOSE_TAG_SAW_WHITE:V++,SCRIPT:V++,SCRIPT_ENDING:V++},c.XML_ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'"},c.ENTITIES={amp:"&",gt:">",lt:"<",quot:'"',apos:"'",AElig:198,Aacute:193,Acirc:194,Agrave:192,Aring:197,Atilde:195,Auml:196,Ccedil:199,ETH:208,Eacute:201,Ecirc:202,Egrave:200,Euml:203,Iacute:205,Icirc:206,Igrave:204,Iuml:207,Ntilde:209,Oacute:211,Ocirc:212,Ograve:210,Oslash:216,Otilde:213,Ouml:214,THORN:222,Uacute:218,Ucirc:219,Ugrave:217,Uuml:220,Yacute:221,aacute:225,acirc:226,aelig:230,agrave:224,aring:229,atilde:227,auml:228,ccedil:231,eacute:233,ecirc:234,egrave:232,eth:240,euml:235,iacute:237,icirc:238,igrave:236,iuml:239,ntilde:241,oacute:243,ocirc:244,ograve:242,oslash:248,otilde:245,ouml:246,szlig:223,thorn:254,uacute:250,ucirc:251,ugrave:249,uuml:252,yacute:253,yuml:255,copy:169,reg:174,nbsp:160,iexcl:161,cent:162,pound:163,curren:164,yen:165,brvbar:166,sect:167,uml:168,ordf:170,laquo:171,not:172,shy:173,macr:175,deg:176,plusmn:177,sup1:185,sup2:178,sup3:179,acute:180,micro:181,para:182,middot:183,cedil:184,ordm:186,raquo:187,frac14:188,frac12:189,frac34:190,iquest:191,times:215,divide:247,OElig:338,oelig:339,Scaron:352,scaron:353,Yuml:376,fnof:402,circ:710,tilde:732,Alpha:913,Beta:914,Gamma:915,Delta:916,Epsilon:917,Zeta:918,Eta:919,Theta:920,Iota:921,Kappa:922,Lambda:923,Mu:924,Nu:925,Xi:926,Omicron:927,Pi:928,Rho:929,Sigma:931,Tau:932,Upsilon:933,Phi:934,Chi:935,Psi:936,Omega:937,alpha:945,beta:946,gamma:947,delta:948,epsilon:949,zeta:950,eta:951,theta:952,iota:953,kappa:954,lambda:955,mu:956,nu:957,xi:958,omicron:959,pi:960,rho:961,sigmaf:962,sigma:963,tau:964,upsilon:965,phi:966,chi:967,psi:968,omega:969,thetasym:977,upsih:978,piv:982,ensp:8194,emsp:8195,thinsp:8201,zwnj:8204,zwj:8205,lrm:8206,rlm:8207,ndash:8211,mdash:8212,lsquo:8216,rsquo:8217,sbquo:8218,ldquo:8220,rdquo:8221,bdquo:8222,dagger:8224,Dagger:8225,bull:8226,hellip:8230,permil:8240,prime:8242,Prime:8243,lsaquo:8249,rsaquo:8250,oline:8254,frasl:8260,euro:8364,image:8465,weierp:8472,real:8476,trade:8482,alefsym:8501,larr:8592,uarr:8593,rarr:8594,darr:8595,harr:8596,crarr:8629,lArr:8656,uArr:8657,rArr:8658,dArr:8659,hArr:8660,forall:8704,part:8706,exist:8707,empty:8709,nabla:8711,isin:8712,notin:8713,ni:8715,prod:8719,sum:8721,minus:8722,lowast:8727,radic:8730,prop:8733,infin:8734,ang:8736,and:8743,or:8744,cap:8745,cup:8746,"int":8747,there4:8756,sim:8764,cong:8773,asymp:8776,ne:8800,equiv:8801,le:8804,ge:8805,sub:8834,sup:8835,nsub:8836,sube:8838,supe:8839,oplus:8853,otimes:8855,perp:8869,sdot:8901,lceil:8968,rceil:8969,lfloor:8970,rfloor:8971,lang:9001,rang:9002,loz:9674,spades:9824,clubs:9827,hearts:9829,diams:9830},Object.keys(c.ENTITIES).forEach(function(a){var b=c.ENTITIES[a],d="number"==typeof b?String.fromCharCode(b):b;c.ENTITIES[a]=d});for(var W in c.STATE)c.STATE[c.STATE[W]]=W;V=c.STATE,String.fromCodePoint||!function(){var a=String.fromCharCode,b=Math.floor,c=function(){var c,d,e=16384,f=[],g=-1,h=arguments.length;if(!h)return"";for(var i="";++g<h;){var j=Number(arguments[g]);if(!isFinite(j)||0>j||j>1114111||b(j)!==j)throw RangeError("Invalid code point: "+j);65535>=j?f.push(j):(j-=65536,c=(j>>10)+55296,d=j%1024+56320,f.push(c,d)),(g+1===h||f.length>e)&&(i+=a.apply(null,f),f.length=0)}return i};Object.defineProperty?Object.defineProperty(String,"fromCodePoint",{value:c,configurable:!0,writable:!0}):String.fromCodePoint=c}()}("undefined"==typeof c?this.sax={}:c)}).call(this,a("buffer").Buffer)},{buffer:4,stream:138,string_decoder:139}],138:[function(a,b,c){function d(){e.call(this)}b.exports=d;var e=a("events").EventEmitter,f=a("inherits");f(d,e),d.Readable=a("readable-stream/readable.js"),d.Writable=a("readable-stream/writable.js"),d.Duplex=a("readable-stream/duplex.js"),d.Transform=a("readable-stream/transform.js"),d.PassThrough=a("readable-stream/passthrough.js"),d.Stream=d,d.prototype.pipe=function(a,b){function c(b){a.writable&&!1===a.write(b)&&j.pause&&j.pause()}function d(){j.readable&&j.resume&&j.resume()}function f(){k||(k=!0,a.end())}function g(){k||(k=!0,"function"==typeof a.destroy&&a.destroy())}function h(a){if(i(),0===e.listenerCount(this,"error"))throw a}function i(){j.removeListener("data",c),a.removeListener("drain",d),j.removeListener("end",f),j.removeListener("close",g),j.removeListener("error",h),a.removeListener("error",h),j.removeListener("end",i),j.removeListener("close",i),a.removeListener("close",i)}var j=this;j.on("data",c),a.on("drain",d),a._isStdio||b&&b.end===!1||(j.on("end",f),j.on("close",g));var k=!1;return j.on("error",h),a.on("error",h),j.on("end",i),j.on("close",i),a.on("close",i),a.emit("pipe",j),a}},{events:6,inherits:8,"readable-stream/duplex.js":127,"readable-stream/passthrough.js":133,"readable-stream/readable.js":134,"readable-stream/transform.js":135,"readable-stream/writable.js":136}],139:[function(a,b,c){function d(a){if(a&&!i(a))throw new Error("Unknown encoding: "+a)}function e(a){return a.toString(this.encoding)}function f(a){this.charReceived=a.length%2,this.charLength=this.charReceived?2:0}function g(a){this.charReceived=a.length%3,this.charLength=this.charReceived?3:0}var h=a("buffer").Buffer,i=h.isEncoding||function(a){switch(a&&a.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}},j=c.StringDecoder=function(a){switch(this.encoding=(a||"utf8").toLowerCase().replace(/[-_]/,""),d(a),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=f;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=g;break;default:return void(this.write=e)}this.charBuffer=new h(6),this.charReceived=0,this.charLength=0};j.prototype.write=function(a){for(var b="";this.charLength;){var c=a.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:a.length;if(a.copy(this.charBuffer,this.charReceived,0,c),this.charReceived+=c,this.charReceived<this.charLength)return"";a=a.slice(c,a.length),b=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var d=b.charCodeAt(b.length-1);if(!(d>=55296&&56319>=d)){if(this.charReceived=this.charLength=0,0===a.length)return b;break}this.charLength+=this.surrogateSize,b=""}this.detectIncompleteChar(a);var e=a.length;this.charLength&&(a.copy(this.charBuffer,0,a.length-this.charReceived,e),e-=this.charReceived),b+=a.toString(this.encoding,0,e);var e=b.length-1,d=b.charCodeAt(e);if(d>=55296&&56319>=d){var f=this.surrogateSize;return this.charLength+=f,this.charReceived+=f,this.charBuffer.copy(this.charBuffer,f,0,f),a.copy(this.charBuffer,0,0,f),b.substring(0,e)}return b},j.prototype.detectIncompleteChar=function(a){for(var b=a.length>=3?3:a.length;b>0;b--){var c=a[a.length-b];if(1==b&&c>>5==6){this.charLength=2;break}if(2>=b&&c>>4==14){this.charLength=3;break}if(3>=b&&c>>3==30){
this.charLength=4;break}}this.charReceived=b},j.prototype.end=function(a){var b="";if(a&&a.length&&(b=this.write(a)),this.charReceived){var c=this.charReceived,d=this.charBuffer,e=this.encoding;b+=d.slice(0,c).toString(e)}return b}},{buffer:4}],140:[function(a,b,c){function d(a,b){this._id=a,this._clearFn=b}var e=a("process/browser.js").nextTick,f=Function.prototype.apply,g=Array.prototype.slice,h={},i=0;c.setTimeout=function(){return new d(f.call(setTimeout,window,arguments),clearTimeout)},c.setInterval=function(){return new d(f.call(setInterval,window,arguments),clearInterval)},c.clearTimeout=c.clearInterval=function(a){a.close()},d.prototype.unref=d.prototype.ref=function(){},d.prototype.close=function(){this._clearFn.call(window,this._id)},c.enroll=function(a,b){clearTimeout(a._idleTimeoutId),a._idleTimeout=b},c.unenroll=function(a){clearTimeout(a._idleTimeoutId),a._idleTimeout=-1},c._unrefActive=c.active=function(a){clearTimeout(a._idleTimeoutId);var b=a._idleTimeout;b>=0&&(a._idleTimeoutId=setTimeout(function(){a._onTimeout&&a._onTimeout()},b))},c.setImmediate="function"==typeof setImmediate?setImmediate:function(a){var b=i++,d=arguments.length<2?!1:g.call(arguments,1);return h[b]=!0,e(function(){h[b]&&(d?a.apply(null,d):a.call(null),c.clearImmediate(b))}),b},c.clearImmediate="function"==typeof clearImmediate?clearImmediate:function(a){delete h[a]}},{"process/browser.js":126}],141:[function(a,b,c){(function(a){function c(a,b){function c(){if(!e){if(d("throwDeprecation"))throw new Error(b);d("traceDeprecation")?console.trace(b):console.warn(b),e=!0}return a.apply(this,arguments)}if(d("noDeprecation"))return a;var e=!1;return c}function d(b){if(!a.localStorage)return!1;var c=a.localStorage[b];return null==c?!1:"true"===String(c).toLowerCase()}b.exports=c}).call(this,"undefined"!=typeof global?global:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],142:[function(a,c,d){!function(){function a(a,b,c){return a.call.apply(a.bind,arguments)}function d(a,b,c){if(!a)throw Error();if(2<arguments.length){var d=Array.prototype.slice.call(arguments,2);return function(){var c=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(c,d),a.apply(b,c)}}return function(){return a.apply(b,arguments)}}function e(b,c,f){return e=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?a:d,e.apply(null,arguments)}function f(a,b){this.a=a,this.m=b||a,this.c=this.m.document}function g(a,b,c,d){if(b=a.c.createElement(b),c)for(var e in c)c.hasOwnProperty(e)&&("style"==e?b.style.cssText=c[e]:b.setAttribute(e,c[e]));return d&&b.appendChild(a.c.createTextNode(d)),b}function h(a,b,c){a=a.c.getElementsByTagName(b)[0],a||(a=document.documentElement),a.insertBefore(c,a.lastChild)}function i(a){a.parentNode&&a.parentNode.removeChild(a)}function j(a,b,c){b=b||[],c=c||[];for(var d=a.className.split(/\s+/),e=0;e<b.length;e+=1){for(var f=!1,g=0;g<d.length;g+=1)if(b[e]===d[g]){f=!0;break}f||d.push(b[e])}for(b=[],e=0;e<d.length;e+=1){for(f=!1,g=0;g<c.length;g+=1)if(d[e]===c[g]){f=!0;break}f||b.push(d[e])}a.className=b.join(" ").replace(/\s+/g," ").replace(/^\s+|\s+$/,"")}function k(a,b){for(var c=a.className.split(/\s+/),d=0,e=c.length;e>d;d++)if(c[d]==b)return!0;return!1}function l(a){if("string"==typeof a.f)return a.f;var b=a.m.location.protocol;return"about:"==b&&(b=a.a.location.protocol),"https:"==b?"https:":"http:"}function m(a){return a.m.location.hostname||a.a.location.hostname}function n(a,b,c){function d(){j&&e&&f&&(j(i),j=null)}b=g(a,"link",{rel:"stylesheet",href:b,media:"all"});var e=!1,f=!0,i=null,j=c||null;fa?(b.onload=function(){e=!0,d()},b.onerror=function(){e=!0,i=Error("Stylesheet failed to load"),d()}):setTimeout(function(){e=!0,d()},0),h(a,"head",b)}function o(a,b,c,d){var e=a.c.getElementsByTagName("head")[0];if(e){var f=g(a,"script",{src:b}),h=!1;return f.onload=f.onreadystatechange=function(){h||this.readyState&&"loaded"!=this.readyState&&"complete"!=this.readyState||(h=!0,c&&c(null),f.onload=f.onreadystatechange=null,"HEAD"==f.parentNode.tagName&&e.removeChild(f))},e.appendChild(f),setTimeout(function(){h||(h=!0,c&&c(Error("Script load timeout")))},d||5e3),f}return null}function p(){this.a=0,this.c=null}function q(a){return a.a++,function(){a.a--,s(a)}}function r(a,b){a.c=b,s(a)}function s(a){0==a.a&&a.c&&(a.c(),a.c=null)}function t(a){this.a=a||"-"}function u(a,b){this.c=a,this.f=4,this.a="n";var c=(b||"n4").match(/^([nio])([1-9])$/i);c&&(this.a=c[1],this.f=parseInt(c[2],10))}function v(a){return y(a)+" "+(a.f+"00")+" 300px "+w(a.c)}function w(a){var b=[];a=a.split(/,\s*/);for(var c=0;c<a.length;c++){var d=a[c].replace(/['"]/g,"");-1!=d.indexOf(" ")||/^\d/.test(d)?b.push("'"+d+"'"):b.push(d)}return b.join(",")}function x(a){return a.a+a.f}function y(a){var b="normal";return"o"===a.a?b="oblique":"i"===a.a&&(b="italic"),b}function z(a){var b=4,c="n",d=null;return a&&((d=a.match(/(normal|oblique|italic)/i))&&d[1]&&(c=d[1].substr(0,1).toLowerCase()),(d=a.match(/([1-9]00|normal|bold)/i))&&d[1]&&(/bold/i.test(d[1])?b=7:/[1-9]00/.test(d[1])&&(b=parseInt(d[1].substr(0,1),10)))),c+b}function A(a,b){this.c=a,this.f=a.m.document.documentElement,this.h=b,this.a=new t("-"),this.j=!1!==b.events,this.g=!1!==b.classes}function B(a){a.g&&j(a.f,[a.a.c("wf","loading")]),D(a,"loading")}function C(a){if(a.g){var b=k(a.f,a.a.c("wf","active")),c=[],d=[a.a.c("wf","loading")];b||c.push(a.a.c("wf","inactive")),j(a.f,c,d)}D(a,"inactive")}function D(a,b,c){a.j&&a.h[b]&&(c?a.h[b](c.c,x(c)):a.h[b]())}function E(){this.c={}}function F(a,b,c){var d,e=[];for(d in b)if(b.hasOwnProperty(d)){var f=a.c[d];f&&e.push(f(b[d],c))}return e}function G(a,b){this.c=a,this.f=b,this.a=g(this.c,"span",{"aria-hidden":"true"},this.f)}function H(a){h(a.c,"body",a.a)}function I(a){return"display:block;position:absolute;top:-9999px;left:-9999px;font-size:300px;width:auto;height:auto;line-height:normal;margin:0;padding:0;font-variant:normal;white-space:nowrap;font-family:"+w(a.c)+";"+("font-style:"+y(a)+";font-weight:"+(a.f+"00")+";")}function J(a,b,c,d,e,f){this.g=a,this.j=b,this.a=d,this.c=c,this.f=e||3e3,this.h=f||void 0}function K(a,b,c,d,e,f,g){this.v=a,this.B=b,this.c=c,this.a=d,this.s=g||"BESbswy",this.f={},this.w=e||3e3,this.u=f||null,this.o=this.j=this.h=this.g=null,this.g=new G(this.c,this.s),this.h=new G(this.c,this.s),this.j=new G(this.c,this.s),this.o=new G(this.c,this.s),a=new u(this.a.c+",serif",x(this.a)),a=I(a),this.g.a.style.cssText=a,a=new u(this.a.c+",sans-serif",x(this.a)),a=I(a),this.h.a.style.cssText=a,a=new u("serif",x(this.a)),a=I(a),this.j.a.style.cssText=a,a=new u("sans-serif",x(this.a)),a=I(a),this.o.a.style.cssText=a,H(this.g),H(this.h),H(this.j),H(this.o)}function L(){if(null===ha){var a=/AppleWebKit\/([0-9]+)(?:\.([0-9]+))/.exec(window.navigator.userAgent);ha=!!a&&(536>parseInt(a[1],10)||536===parseInt(a[1],10)&&11>=parseInt(a[2],10))}return ha}function M(a,b,c){for(var d in ga)if(ga.hasOwnProperty(d)&&b===a.f[ga[d]]&&c===a.f[ga[d]])return!0;return!1}function N(a){var b,c=a.g.a.offsetWidth,d=a.h.a.offsetWidth;(b=c===a.f.serif&&d===a.f["sans-serif"])||(b=L()&&M(a,c,d)),b?ea()-a.A>=a.w?L()&&M(a,c,d)&&(null===a.u||a.u.hasOwnProperty(a.a.c))?P(a,a.v):P(a,a.B):O(a):P(a,a.v)}function O(a){setTimeout(e(function(){N(this)},a),50)}function P(a,b){setTimeout(e(function(){i(this.g.a),i(this.h.a),i(this.j.a),i(this.o.a),b(this.a)},a),0)}function Q(a,b,c){this.c=a,this.a=b,this.f=0,this.o=this.j=!1,this.s=c}function R(a){0==--a.f&&a.j&&(a.o?(a=a.a,a.g&&j(a.f,[a.a.c("wf","active")],[a.a.c("wf","loading"),a.a.c("wf","inactive")]),D(a,"active")):C(a.a))}function S(a){this.j=a,this.a=new E,this.h=0,this.f=this.g=!0}function T(a,b,c,d,f){var g=0==--a.h;(a.f||a.g)&&setTimeout(function(){var a=f||null,h=d||null||{};if(0===c.length&&g)C(b.a);else{b.f+=c.length,g&&(b.j=g);var i,k=[];for(i=0;i<c.length;i++){var l=c[i],m=h[l.c],n=b.a,o=l;if(n.g&&j(n.f,[n.a.c("wf",o.c,x(o).toString(),"loading")]),D(n,"fontloading",o),n=null,null===ia)if(window.FontFace){var o=/Gecko.*Firefox\/(\d+)/.exec(window.navigator.userAgent),p=/OS X.*Version\/10\..*Safari/.exec(window.navigator.userAgent)&&/Apple/.exec(window.navigator.vendor);ia=o?42<parseInt(o[1],10):p?!1:!0}else ia=!1;n=ia?new J(e(b.g,b),e(b.h,b),b.c,l,b.s,m):new K(e(b.g,b),e(b.h,b),b.c,l,b.s,a,m),k.push(n)}for(i=0;i<k.length;i++)k[i].start()}},0)}function U(a,b,c){var d=[],e=c.timeout;B(b);var d=F(a.a,c,a.c),f=new Q(a.c,b,e);for(a.h=d.length,b=0,c=d.length;c>b;b++)d[b].load(function(b,c,d){T(a,f,b,c,d)})}function V(a,b){this.c=a,this.a=b}function W(a,b,c){var d=l(a.c);return a=(a.a.api||"fast.fonts.net/jsapi").replace(/^.*http(s?):(\/\/)?/,""),d+"//"+a+"/"+b+".js"+(c?"?v="+c:"")}function X(a,b){this.c=a,this.a=b}function Y(a,b,c){a?this.c=a:this.c=b+ja,this.a=[],this.f=[],this.g=c||""}function Z(a,b){for(var c=b.length,d=0;c>d;d++){var e=b[d].split(":");3==e.length&&a.f.push(e.pop());var f="";2==e.length&&""!=e[1]&&(f=":"),a.a.push(e.join(f))}}function $(a){if(0==a.a.length)throw Error("No fonts to load!");if(-1!=a.c.indexOf("kit="))return a.c;for(var b=a.a.length,c=[],d=0;b>d;d++)c.push(a.a[d].replace(/ /g,"+"));return b=a.c+"?family="+c.join("%7C"),0<a.f.length&&(b+="&subset="+a.f.join(",")),0<a.g.length&&(b+="&text="+encodeURIComponent(a.g)),b}function _(a){this.f=a,this.a=[],this.c={}}function aa(a){for(var b=a.f.length,c=0;b>c;c++){var d=a.f[c].split(":"),e=d[0].replace(/\+/g," "),f=["n4"];if(2<=d.length){var g,h=d[1];if(g=[],h)for(var h=h.split(","),i=h.length,j=0;i>j;j++){var k;if(k=h[j],k.match(/^[\w-]+$/)){var l=na.exec(k.toLowerCase());if(null==l)k="";else{if(k=l[2],k=null==k||""==k?"n":ma[k],l=l[1],null==l||""==l)l="4";else var m=la[l],l=m?m:isNaN(l)?"4":l.substr(0,1);k=[k,l].join("")}}else k="";k&&g.push(k)}0<g.length&&(f=g),3==d.length&&(d=d[2],g=[],d=d?d.split(","):g,0<d.length&&(d=ka[d[0]])&&(a.c[e]=d))}for(a.c[e]||(d=ka[e])&&(a.c[e]=d),d=0;d<f.length;d+=1)a.a.push(new u(e,f[d]))}}function ba(a,b){this.c=a,this.a=b}function ca(a,b){this.c=a,this.a=b}function da(a,b){this.c=a,this.f=b,this.a=[]}var ea=Date.now||function(){return+new Date},fa=!!window.FontFace;t.prototype.c=function(a){for(var b=[],c=0;c<arguments.length;c++)b.push(arguments[c].replace(/[\W_]+/g,"").toLowerCase());return b.join(this.a)},J.prototype.start=function(){var a=this.c.m.document,b=this,c=ea(),d=new Promise(function(d,e){function f(){ea()-c>=b.f?e():a.fonts.load(v(b.a),b.h).then(function(a){1<=a.length?d():setTimeout(f,25)},function(){e()})}f()}),e=new Promise(function(a,c){setTimeout(c,b.f)});Promise.race([e,d]).then(function(){b.g(b.a)},function(){b.j(b.a)})};var ga={D:"serif",C:"sans-serif"},ha=null;K.prototype.start=function(){this.f.serif=this.j.a.offsetWidth,this.f["sans-serif"]=this.o.a.offsetWidth,this.A=ea(),N(this)};var ia=null;Q.prototype.g=function(a){var b=this.a;b.g&&j(b.f,[b.a.c("wf",a.c,x(a).toString(),"active")],[b.a.c("wf",a.c,x(a).toString(),"loading"),b.a.c("wf",a.c,x(a).toString(),"inactive")]),D(b,"fontactive",a),this.o=!0,R(this)},Q.prototype.h=function(a){var b=this.a;if(b.g){var c=k(b.f,b.a.c("wf",a.c,x(a).toString(),"active")),d=[],e=[b.a.c("wf",a.c,x(a).toString(),"loading")];c||d.push(b.a.c("wf",a.c,x(a).toString(),"inactive")),j(b.f,d,e)}D(b,"fontinactive",a),R(this)},S.prototype.load=function(a){this.c=new f(this.j,a.context||this.j),this.g=!1!==a.events,this.f=!1!==a.classes,U(this,new A(this.c,a),a)},V.prototype.load=function(a){function b(){if(f["__mti_fntLst"+d]){var c,e=f["__mti_fntLst"+d](),g=[];if(e)for(var h=0;h<e.length;h++){var i=e[h].fontfamily;void 0!=e[h].fontStyle&&void 0!=e[h].fontWeight?(c=e[h].fontStyle+e[h].fontWeight,g.push(new u(i,c))):g.push(new u(i))}a(g)}else setTimeout(function(){b()},50)}var c=this,d=c.a.projectId,e=c.a.version;if(d){var f=c.c.m;o(this.c,W(c,d,e),function(e){e?a([]):(f["__MonotypeConfiguration__"+d]=function(){return c.a},b())}).id="__MonotypeAPIScript__"+d}else a([])},X.prototype.load=function(a){var b,c,d=this.a.urls||[],e=this.a.families||[],f=this.a.testStrings||{},g=new p;for(b=0,c=d.length;c>b;b++)n(this.c,d[b],q(g));var h=[];for(b=0,c=e.length;c>b;b++)if(d=e[b].split(":"),d[1])for(var i=d[1].split(","),j=0;j<i.length;j+=1)h.push(new u(d[0],i[j]));else h.push(new u(d[0]));r(g,function(){a(h,f)})};var ja="//fonts.googleapis.com/css",ka={latin:"BESbswy","latin-ext":"çöüğş",cyrillic:"йяЖ",greek:"αβΣ",khmer:"កខគ",Hanuman:"កខគ"},la={thin:"1",extralight:"2","extra-light":"2",ultralight:"2","ultra-light":"2",light:"3",regular:"4",book:"4",medium:"5","semi-bold":"6",semibold:"6","demi-bold":"6",demibold:"6",bold:"7","extra-bold":"8",extrabold:"8","ultra-bold":"8",ultrabold:"8",black:"9",heavy:"9",l:"3",r:"4",b:"7"},ma={i:"i",italic:"i",n:"n",normal:"n"},na=/^(thin|(?:(?:extra|ultra)-?)?light|regular|book|medium|(?:(?:semi|demi|extra|ultra)-?)?bold|black|heavy|l|r|b|[1-9]00)?(n|i|normal|italic)?$/,oa={Arimo:!0,Cousine:!0,Tinos:!0};ba.prototype.load=function(a){var b=new p,c=this.c,d=new Y(this.a.api,l(c),this.a.text),e=this.a.families;Z(d,e);var f=new _(e);aa(f),n(c,$(d),q(b)),r(b,function(){a(f.a,f.c,oa)})},ca.prototype.load=function(a){var b=this.a.id,c=this.c.m;b?o(this.c,(this.a.api||"https://use.typekit.net")+"/"+b+".js",function(b){if(b)a([]);else if(c.Typekit&&c.Typekit.config&&c.Typekit.config.fn){b=c.Typekit.config.fn;for(var d=[],e=0;e<b.length;e+=2)for(var f=b[e],g=b[e+1],h=0;h<g.length;h++)d.push(new u(f,g[h]));try{c.Typekit.load({events:!1,classes:!1,async:!0})}catch(i){}a(d)}},2e3):a([])},da.prototype.load=function(a){var b=this.f.id,c=this.c.m,d=this;b?(c.__webfontfontdeckmodule__||(c.__webfontfontdeckmodule__={}),c.__webfontfontdeckmodule__[b]=function(b,c){for(var e=0,f=c.fonts.length;f>e;++e){var g=c.fonts[e];d.a.push(new u(g.name,z("font-weight:"+g.weight+";font-style:"+g.style)))}a(d.a)},o(this.c,l(this.c)+(this.f.api||"//f.fontdeck.com/s/css/js/")+m(this.c)+"/"+b+".js",function(b){b&&a([])})):a([])};var pa=new S(window);pa.a.c.custom=function(a,b){return new X(b,a)},pa.a.c.fontdeck=function(a,b){return new da(b,a)},pa.a.c.monotype=function(a,b){return new V(b,a)},pa.a.c.typekit=function(a,b){return new ca(b,a)},pa.a.c.google=function(a,b){return new ba(b,a)};var qa={load:e(pa.load,pa)};"function"==typeof b&&b.amd?b(function(){return qa}):"undefined"!=typeof c&&c.exports?c.exports=qa:(window.WebFont=qa,window.WebFontConfig&&pa.load(window.WebFontConfig))}()},{}],143:[function(a,b,c){(function(){"use strict";var b;b=a("../lib/xml2js"),c.stripBOM=function(a){return"\ufeff"===a[0]?a.substring(1):a}}).call(this)},{"../lib/xml2js":145}],144:[function(a,b,c){(function(){"use strict";var a;a=new RegExp(/(?!xmlns)^.*:/),c.normalize=function(a){return a.toLowerCase()},c.firstCharLowerCase=function(a){return a.charAt(0).toLowerCase()+a.slice(1)},c.stripPrefix=function(b){return b.replace(a,"")},c.parseNumbers=function(a){return isNaN(a)||(a=a%1===0?parseInt(a,10):parseFloat(a)),a},c.parseBooleans=function(a){return/^(?:true|false)$/i.test(a)&&(a="true"===a.toLowerCase()),a}}).call(this)},{}],145:[function(a,b,c){(function(){"use strict";var b,d,e,f,g,h,i,j,k,l,m,n=function(a,b){function c(){this.constructor=a}for(var d in b)o.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},o={}.hasOwnProperty,p=function(a,b){return function(){return a.apply(b,arguments)}};k=a("sax"),f=a("events"),d=a("xmlbuilder"),b=a("./bom"),i=a("./processors"),l=a("timers").setImmediate,g=function(a){return"object"==typeof a&&null!=a&&0===Object.keys(a).length},h=function(a,b){var c,d,e;for(c=0,d=a.length;d>c;c++)e=a[c],b=e(b);return b},j=function(a){return a.indexOf("&")>=0||a.indexOf(">")>=0||a.indexOf("<")>=0},m=function(a){return"<![CDATA["+e(a)+"]]>"},e=function(a){return a.replace("]]>","]]]]><![CDATA[>")},c.processors=i,c.defaults={.1:{explicitCharkey:!1,trim:!0,normalize:!0,normalizeTags:!1,attrkey:"@",charkey:"#",explicitArray:!1,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!1,validator:null,xmlns:!1,explicitChildren:!1,childkey:"@@",charsAsChildren:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,emptyTag:""},.2:{explicitCharkey:!1,trim:!1,normalize:!1,normalizeTags:!1,attrkey:"$",charkey:"_",explicitArray:!0,ignoreAttrs:!1,mergeAttrs:!1,explicitRoot:!0,validator:null,xmlns:!1,explicitChildren:!1,preserveChildrenOrder:!1,childkey:"$$",charsAsChildren:!1,async:!1,strict:!0,attrNameProcessors:null,attrValueProcessors:null,tagNameProcessors:null,valueProcessors:null,rootName:"root",xmldec:{version:"1.0",encoding:"UTF-8",standalone:!0},doctype:null,renderOpts:{pretty:!0,indent:"  ",newline:"\n"},headless:!1,chunkSize:1e4,emptyTag:"",cdata:!1}},c.ValidationError=function(a){function b(a){this.message=a}return n(b,a),b}(Error),c.Builder=function(){function a(a){var b,d,e;this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e)}return a.prototype.buildObject=function(a){var b,e,f,g,h;return b=this.options.attrkey,e=this.options.charkey,1===Object.keys(a).length&&this.options.rootName===c.defaults[.2].rootName?(h=Object.keys(a)[0],a=a[h]):h=this.options.rootName,f=function(a){return function(c,d){var g,h,i,k,l,n;if("object"!=typeof d)a.options.cdata&&j(d)?c.raw(m(d)):c.txt(d);else for(l in d)if(o.call(d,l))if(h=d[l],l===b){if("object"==typeof h)for(g in h)n=h[g],c=c.att(g,n)}else if(l===e)c=a.options.cdata&&j(h)?c.raw(m(h)):c.txt(h);else if(Array.isArray(h))for(k in h)o.call(h,k)&&(i=h[k],c="string"==typeof i?a.options.cdata&&j(i)?c.ele(l).raw(m(i)).up():c.ele(l,i).up():f(c.ele(l),i).up());else"object"==typeof h?c=f(c.ele(l),h).up():"string"==typeof h&&a.options.cdata&&j(h)?c=c.ele(l).raw(m(h)).up():(null==h&&(h=""),c=c.ele(l,h.toString()).up());return c}}(this),g=d.create(h,this.options.xmldec,this.options.doctype,{headless:this.options.headless,allowSurrogateChars:this.options.allowSurrogateChars}),f(g,a).end(this.options.renderOpts)},a}(),c.Parser=function(a){function d(a){this.parseString=p(this.parseString,this),this.reset=p(this.reset,this),this.assignOrPush=p(this.assignOrPush,this),this.processAsync=p(this.processAsync,this);var b,d,e;if(!(this instanceof c.Parser))return new c.Parser(a);this.options={},d=c.defaults[.2];for(b in d)o.call(d,b)&&(e=d[b],this.options[b]=e);for(b in a)o.call(a,b)&&(e=a[b],this.options[b]=e);this.options.xmlns&&(this.options.xmlnskey=this.options.attrkey+"ns"),this.options.normalizeTags&&(this.options.tagNameProcessors||(this.options.tagNameProcessors=[]),this.options.tagNameProcessors.unshift(i.normalize)),this.reset()}return n(d,a),d.prototype.processAsync=function(){var a,b,c;try{return this.remaining.length<=this.options.chunkSize?(a=this.remaining,this.remaining="",this.saxParser=this.saxParser.write(a),this.saxParser.close()):(a=this.remaining.substr(0,this.options.chunkSize),this.remaining=this.remaining.substr(this.options.chunkSize,this.remaining.length),this.saxParser=this.saxParser.write(a),l(this.processAsync))}catch(c){if(b=c,!this.saxParser.errThrown)return this.saxParser.errThrown=!0,this.emit(b)}},d.prototype.assignOrPush=function(a,b,c){return b in a?(a[b]instanceof Array||(a[b]=[a[b]]),a[b].push(c)):this.options.explicitArray?a[b]=[c]:a[b]=c},d.prototype.reset=function(){var a,b,c,d;return this.removeAllListeners(),this.saxParser=k.parser(this.options.strict,{trim:!1,normalize:!1,xmlns:this.options.xmlns}),this.saxParser.errThrown=!1,this.saxParser.onerror=function(a){return function(b){return a.saxParser.resume(),a.saxParser.errThrown?void 0:(a.saxParser.errThrown=!0,a.emit("error",b))}}(this),this.saxParser.onend=function(a){return function(){return a.saxParser.ended?void 0:(a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),this.saxParser.ended=!1,this.EXPLICIT_CHARKEY=this.options.explicitCharkey,this.resultObject=null,d=[],a=this.options.attrkey,b=this.options.charkey,this.saxParser.onopentag=function(c){return function(e){var f,g,i,j,k;if(i={},i[b]="",!c.options.ignoreAttrs){k=e.attributes;for(f in k)o.call(k,f)&&(a in i||c.options.mergeAttrs||(i[a]={}),g=c.options.attrValueProcessors?h(c.options.attrValueProcessors,e.attributes[f]):e.attributes[f],j=c.options.attrNameProcessors?h(c.options.attrNameProcessors,f):f,c.options.mergeAttrs?c.assignOrPush(i,j,g):i[a][j]=g)}return i["#name"]=c.options.tagNameProcessors?h(c.options.tagNameProcessors,e.name):e.name,c.options.xmlns&&(i[c.options.xmlnskey]={uri:e.uri,local:e.local}),d.push(i)}}(this),this.saxParser.onclosetag=function(a){return function(){var c,e,f,i,j,k,l,m,n,p,q,r;if(m=d.pop(),l=m["#name"],a.options.explicitChildren&&a.options.preserveChildrenOrder||delete m["#name"],m.cdata===!0&&(c=m.cdata,delete m.cdata),q=d[d.length-1],m[b].match(/^\s*$/)&&!c?(e=m[b],delete m[b]):(a.options.trim&&(m[b]=m[b].trim()),a.options.normalize&&(m[b]=m[b].replace(/\s{2,}/g," ").trim()),m[b]=a.options.valueProcessors?h(a.options.valueProcessors,m[b]):m[b],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])),g(m)&&(m=""!==a.options.emptyTag?a.options.emptyTag:e),null!=a.options.validator){r="/"+function(){var a,b,c;for(c=[],a=0,b=d.length;b>a;a++)k=d[a],c.push(k["#name"]);return c}().concat(l).join("/");try{m=a.options.validator(r,q&&q[l],m)}catch(i){f=i,a.emit("error",f)}}if(a.options.explicitChildren&&!a.options.mergeAttrs&&"object"==typeof m)if(a.options.preserveChildrenOrder){if(q){q[a.options.childkey]=q[a.options.childkey]||[],n={};for(j in m)o.call(m,j)&&(n[j]=m[j]);q[a.options.childkey].push(n),delete m["#name"],1===Object.keys(m).length&&b in m&&!a.EXPLICIT_CHARKEY&&(m=m[b])}}else k={},a.options.attrkey in m&&(k[a.options.attrkey]=m[a.options.attrkey],delete m[a.options.attrkey]),!a.options.charsAsChildren&&a.options.charkey in m&&(k[a.options.charkey]=m[a.options.charkey],delete m[a.options.charkey]),Object.getOwnPropertyNames(m).length>0&&(k[a.options.childkey]=m),m=k;return d.length>0?a.assignOrPush(q,l,m):(a.options.explicitRoot&&(p=m,m={},m[l]=p),a.resultObject=m,a.saxParser.ended=!0,a.emit("end",a.resultObject))}}(this),c=function(a){return function(c){var e,f;return f=d[d.length-1],f?(f[b]+=c,a.options.explicitChildren&&a.options.preserveChildrenOrder&&a.options.charsAsChildren&&""!==c.replace(/\\n/g,"").trim()&&(f[a.options.childkey]=f[a.options.childkey]||[],e={"#name":"__text__"},e[b]=c,f[a.options.childkey].push(e)),f):void 0}}(this),this.saxParser.ontext=c,this.saxParser.oncdata=function(a){return function(a){var b;return b=c(a),b?b.cdata=!0:void 0}}(this)},d.prototype.parseString=function(a,c){var d,e;null!=c&&"function"==typeof c&&(this.on("end",function(a){return this.reset(),c(null,a)}),this.on("error",function(a){return this.reset(),c(a)}));try{return a=a.toString(),""===a.trim()?(this.emit("end",null),!0):(a=b.stripBOM(a),this.options.async?(this.remaining=a,l(this.processAsync),this.saxParser):this.saxParser.write(a).close())}catch(e){if(d=e,!this.saxParser.errThrown&&!this.saxParser.ended)return this.emit("error",d),this.saxParser.errThrown=!0;if(this.saxParser.ended)throw d}},d}(f.EventEmitter),c.parseString=function(a,b,d){var e,f,g;return null!=d?("function"==typeof d&&(e=d),"object"==typeof b&&(f=b)):("function"==typeof b&&(e=b),f={}),g=new c.Parser(f),g.parseString(a,e)}}).call(this)},{"./bom":143,"./processors":144,events:6,sax:137,timers:140,xmlbuilder:162}],146:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing attribute name of element "+a.name);if(null==c)throw new Error("Missing attribute value for attribute "+b+" of element "+a.name);this.name=this.stringify.attName(b),this.value=this.stringify.attValue(c)}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){return" "+this.name+'="'+this.value+'"'},a}()}).call(this)},{"lodash/create":96}],147:[function(a,b,c){(function(){var c,d,e,f,g;g=a("./XMLStringifier"),d=a("./XMLDeclaration"),e=a("./XMLDocType"),f=a("./XMLElement"),b.exports=c=function(){function a(a,b){var c,d;if(null==a)throw new Error("Root element needs a name");null==b&&(b={}),this.options=b,this.stringify=new g(b),d=new f(this,"doc"),c=d.element(a),c.isRoot=!0,c.documentObject=this,this.rootObject=c,b.headless||(c.declaration(b),(null!=b.pubID||null!=b.sysID)&&c.doctype(b))}return a.prototype.root=function(){return this.rootObject},a.prototype.end=function(a){return this.toString(a)},a.prototype.toString=function(a){var b,c,d,e,f,g,h,i;return e=(null!=a?a.pretty:void 0)||!1,b=null!=(g=null!=a?a.indent:void 0)?g:"  ",d=null!=(h=null!=a?a.offset:void 0)?h:0,c=null!=(i=null!=a?a.newline:void 0)?i:"\n",f="",null!=this.xmldec&&(f+=this.xmldec.toString(a)),null!=this.doctype&&(f+=this.doctype.toString(a)),f+=this.rootObject.toString(a),e&&f.slice(-c.length)===c&&(f=f.slice(0,-c.length)),f},a}()}).call(this)},{"./XMLDeclaration":154,"./XMLDocType":155,"./XMLElement":156,"./XMLStringifier":160}],148:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing CDATA text");this.text=this.stringify.cdata(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<![CDATA["+this.text+"]]>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":157,"lodash/create":96}],149:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing comment text");this.text=this.stringify.comment(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!-- "+this.text+" -->",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":157,"lodash/create":96}],150:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c,d,e,f){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");if(null==c)throw new Error("Missing DTD attribute name");if(!d)throw new Error("Missing DTD attribute type");if(!e)throw new Error("Missing DTD attribute default");if(0!==e.indexOf("#")&&(e="#"+e),!e.match(/^(#REQUIRED|#IMPLIED|#FIXED|#DEFAULT)$/))throw new Error("Invalid default value type; expected: #REQUIRED, #IMPLIED, #FIXED or #DEFAULT");if(f&&!e.match(/^(#FIXED|#DEFAULT)$/))throw new Error("Default value only applies to #FIXED or #DEFAULT");this.elementName=this.stringify.eleName(b),this.attributeName=this.stringify.attName(c),this.attributeType=this.stringify.dtdAttType(d),this.defaultValue=this.stringify.dtdAttDefault(f),this.defaultValueType=e}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ATTLIST "+this.elementName+" "+this.attributeName+" "+this.attributeType,"#DEFAULT"!==this.defaultValueType&&(g+=" "+this.defaultValueType),this.defaultValue&&(g+=' "'+this.defaultValue+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":96}],151:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing DTD element name");c||(c="(#PCDATA)"),Array.isArray(c)&&(c="("+c.join(",")+")"),this.name=this.stringify.eleName(b),this.value=this.stringify.dtdElementValue(c)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ELEMENT "+this.name+" "+this.value+">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":96}],152:[function(a,b,c){(function(){var c,d,e;d=a("lodash/create"),e=a("lodash/isObject"),b.exports=c=function(){function a(a,b,c,d){if(this.stringify=a.stringify,null==c)throw new Error("Missing entity name");if(null==d)throw new Error("Missing entity value");if(this.pe=!!b,this.name=this.stringify.eleName(c),e(d)){if(!d.pubID&&!d.sysID)throw new Error("Public and/or system identifiers are required for an external entity");if(d.pubID&&!d.sysID)throw new Error("System identifier is required for a public external entity");if(null!=d.pubID&&(this.pubID=this.stringify.dtdPubID(d.pubID)),null!=d.sysID&&(this.sysID=this.stringify.dtdSysID(d.sysID)),null!=d.nData&&(this.nData=this.stringify.dtdNData(d.nData)),this.pe&&this.nData)throw new Error("Notation declaration is not allowed in a parameter entity")}else this.value=this.stringify.dtdEntityValue(d)}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!ENTITY",this.pe&&(g+=" %"),g+=" "+this.name,this.value?g+=' "'+this.value+'"':(this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),this.nData&&(g+=" NDATA "+this.nData)),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":96,"lodash/isObject":110}],153:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing notation name");if(!c.pubID&&!c.sysID)throw new Error("Public or system identifiers are required for an external entity");this.name=this.stringify.eleName(b),null!=c.pubID&&(this.pubID=this.stringify.dtdPubID(c.pubID)),null!=c.sysID&&(this.sysID=this.stringify.dtdSysID(c.sysID))}return a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<!NOTATION "+this.name,this.pubID&&this.sysID?g+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.pubID?g+=' PUBLIC "'+this.pubID+'"':this.sysID&&(g+=' SYSTEM "'+this.sysID+'"'),g+=">",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":96}],154:[function(a,b,c){(function(){var c,d,e,f,g=function(a,b){function c(){this.constructor=a}for(var d in b)h.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},h={}.hasOwnProperty;e=a("lodash/create"),f=a("lodash/isObject"),d=a("./XMLNode"),b.exports=c=function(a){function b(a,c,d,e){var g;b.__super__.constructor.call(this,a),f(c)&&(g=c,c=g.version,d=g.encoding,e=g.standalone),c||(c="1.0"),this.version=this.stringify.xmlVersion(c),null!=d&&(this.encoding=this.stringify.xmlEncoding(d)),null!=e&&(this.standalone=this.stringify.xmlStandalone(e))}return g(b,a),b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,
d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?xml",g+=' version="'+this.version+'"',null!=this.encoding&&(g+=' encoding="'+this.encoding+'"'),null!=this.standalone&&(g+=' standalone="'+this.standalone+'"'),g+="?>",f&&(g+=d),g},b}(d)}).call(this)},{"./XMLNode":157,"lodash/create":96,"lodash/isObject":110}],155:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l;k=a("lodash/create"),l=a("lodash/isObject"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDTDAttList"),g=a("./XMLDTDEntity"),f=a("./XMLDTDElement"),h=a("./XMLDTDNotation"),j=a("./XMLProcessingInstruction"),b.exports=i=function(){function a(a,b,c){var d,e;this.documentObject=a,this.stringify=this.documentObject.stringify,this.children=[],l(b)&&(d=b,b=d.pubID,c=d.sysID),null==c&&(e=[b,c],c=e[0],b=e[1]),null!=b&&(this.pubID=this.stringify.dtdPubID(b)),null!=c&&(this.sysID=this.stringify.dtdSysID(c))}return a.prototype.element=function(a,b){var c;return c=new f(this,a,b),this.children.push(c),this},a.prototype.attList=function(a,b,c,d,f){var g;return g=new e(this,a,b,c,d,f),this.children.push(g),this},a.prototype.entity=function(a,b){var c;return c=new g(this,!1,a,b),this.children.push(c),this},a.prototype.pEntity=function(a,b){var c;return c=new g(this,!0,a,b),this.children.push(c),this},a.prototype.notation=function(a,b){var c;return c=new h(this,a,b),this.children.push(c),this},a.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},a.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},a.prototype.instruction=function(a,b){var c;return c=new j(this,a,b),this.children.push(c),this},a.prototype.root=function(){return this.documentObject.root()},a.prototype.document=function(){return this.documentObject},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k,l,m,n,o;if(i=(null!=a?a.pretty:void 0)||!1,e=null!=(k=null!=a?a.indent:void 0)?k:"  ",h=null!=(l=null!=a?a.offset:void 0)?l:0,g=null!=(m=null!=a?a.newline:void 0)?m:"\n",b||(b=0),o=new Array(b+h+1).join(e),j="",i&&(j+=o),j+="<!DOCTYPE "+this.root().name,this.pubID&&this.sysID?j+=' PUBLIC "'+this.pubID+'" "'+this.sysID+'"':this.sysID&&(j+=' SYSTEM "'+this.sysID+'"'),this.children.length>0){for(j+=" [",i&&(j+=g),n=this.children,d=0,f=n.length;f>d;d++)c=n[d],j+=c.toString(a,b+1);j+="]"}return j+=">",i&&(j+=g),j},a.prototype.ele=function(a,b){return this.element(a,b)},a.prototype.att=function(a,b,c,d,e){return this.attList(a,b,c,d,e)},a.prototype.ent=function(a,b){return this.entity(a,b)},a.prototype.pent=function(a,b){return this.pEntity(a,b)},a.prototype.not=function(a,b){return this.notation(a,b)},a.prototype.dat=function(a){return this.cdata(a)},a.prototype.com=function(a){return this.comment(a)},a.prototype.ins=function(a,b){return this.instruction(a,b)},a.prototype.up=function(){return this.root()},a.prototype.doc=function(){return this.document()},a}()}).call(this)},{"./XMLCData":148,"./XMLComment":149,"./XMLDTDAttList":150,"./XMLDTDElement":151,"./XMLDTDEntity":152,"./XMLDTDNotation":153,"./XMLProcessingInstruction":158,"lodash/create":96,"lodash/isObject":110}],156:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k=function(a,b){function c(){this.constructor=a}for(var d in b)l.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},l={}.hasOwnProperty;g=a("lodash/create"),j=a("lodash/isObject"),i=a("lodash/isFunction"),h=a("lodash/every"),e=a("./XMLNode"),c=a("./XMLAttribute"),f=a("./XMLProcessingInstruction"),b.exports=d=function(a){function b(a,c,d){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element name");this.name=this.stringify.eleName(c),this.children=[],this.instructions=[],this.attributes={},null!=d&&this.attribute(d)}return k(b,a),b.prototype.clone=function(){var a,c,d,e,f,h,i,j;d=g(b.prototype,this),d.isRoot&&(d.documentObject=null),d.attributes={},i=this.attributes;for(c in i)l.call(i,c)&&(a=i[c],d.attributes[c]=a.clone());for(d.instructions=[],j=this.instructions,e=0,f=j.length;f>e;e++)h=j[e],d.instructions.push(h.clone());return d.children=[],this.children.forEach(function(a){var b;return b=a.clone(),b.parent=d,d.children.push(b)}),d},b.prototype.attribute=function(a,b){var d,e;if(null!=a&&(a=a.valueOf()),j(a))for(d in a)l.call(a,d)&&(e=a[d],this.attribute(d,e));else i(b)&&(b=b.apply()),this.options.skipNullAttributes&&null==b||(this.attributes[a]=new c(this,a,b));return this},b.prototype.removeAttribute=function(a){var b,c,d;if(null==a)throw new Error("Missing attribute name");if(a=a.valueOf(),Array.isArray(a))for(c=0,d=a.length;d>c;c++)b=a[c],delete this.attributes[b];else delete this.attributes[a];return this},b.prototype.instruction=function(a,b){var c,d,e,g,h;if(null!=a&&(a=a.valueOf()),null!=b&&(b=b.valueOf()),Array.isArray(a))for(c=0,h=a.length;h>c;c++)d=a[c],this.instruction(d);else if(j(a))for(d in a)l.call(a,d)&&(e=a[d],this.instruction(d,e));else i(b)&&(b=b.apply()),g=new f(this,a,b),this.instructions.push(g);return this},b.prototype.toString=function(a,b){var c,d,e,f,g,i,j,k,m,n,o,p,q,r,s,t,u,v,w,x;for(p=(null!=a?a.pretty:void 0)||!1,f=null!=(r=null!=a?a.indent:void 0)?r:"  ",o=null!=(s=null!=a?a.offset:void 0)?s:0,n=null!=(t=null!=a?a.newline:void 0)?t:"\n",b||(b=0),x=new Array(b+o+1).join(f),q="",u=this.instructions,e=0,j=u.length;j>e;e++)g=u[e],q+=g.toString(a,b);p&&(q+=x),q+="<"+this.name,v=this.attributes;for(m in v)l.call(v,m)&&(c=v[m],q+=c.toString(a));if(0===this.children.length||h(this.children,function(a){return""===a.value}))q+="/>",p&&(q+=n);else if(p&&1===this.children.length&&null!=this.children[0].value)q+=">",q+=this.children[0].value,q+="</"+this.name+">",q+=n;else{for(q+=">",p&&(q+=n),w=this.children,i=0,k=w.length;k>i;i++)d=w[i],q+=d.toString(a,b+1);p&&(q+=x),q+="</"+this.name+">",p&&(q+=n)}return q},b.prototype.att=function(a,b){return this.attribute(a,b)},b.prototype.ins=function(a,b){return this.instruction(a,b)},b.prototype.a=function(a,b){return this.attribute(a,b)},b.prototype.i=function(a,b){return this.instruction(a,b)},b}(e)}).call(this)},{"./XMLAttribute":146,"./XMLNode":157,"./XMLProcessingInstruction":158,"lodash/create":96,"lodash/every":98,"lodash/isFunction":107,"lodash/isObject":110}],157:[function(a,b,c){(function(){var c,d,e,f,g,h,i,j,k,l,m,n={}.hasOwnProperty;m=a("lodash/isObject"),l=a("lodash/isFunction"),k=a("lodash/isEmpty"),g=null,c=null,d=null,e=null,f=null,i=null,j=null,b.exports=h=function(){function b(b){this.parent=b,this.options=this.parent.options,this.stringify=this.parent.stringify,null===g&&(g=a("./XMLElement"),c=a("./XMLCData"),d=a("./XMLComment"),e=a("./XMLDeclaration"),f=a("./XMLDocType"),i=a("./XMLRaw"),j=a("./XMLText"))}return b.prototype.element=function(a,b,c){var d,e,f,g,h,i,j,o,p,q;if(i=null,null==b&&(b={}),b=b.valueOf(),m(b)||(p=[b,c],c=p[0],b=p[1]),null!=a&&(a=a.valueOf()),Array.isArray(a))for(f=0,j=a.length;j>f;f++)e=a[f],i=this.element(e);else if(l(a))i=this.element(a.apply());else if(m(a)){for(h in a)if(n.call(a,h))if(q=a[h],l(q)&&(q=q.apply()),m(q)&&k(q)&&(q=null),!this.options.ignoreDecorators&&this.stringify.convertAttKey&&0===h.indexOf(this.stringify.convertAttKey))i=this.attribute(h.substr(this.stringify.convertAttKey.length),q);else if(!this.options.ignoreDecorators&&this.stringify.convertPIKey&&0===h.indexOf(this.stringify.convertPIKey))i=this.instruction(h.substr(this.stringify.convertPIKey.length),q);else if(!this.options.separateArrayItems&&Array.isArray(q))for(g=0,o=q.length;o>g;g++)e=q[g],d={},d[h]=e,i=this.element(d);else m(q)?(i=this.element(h),i.element(q)):i=this.element(h,q)}else i=!this.options.ignoreDecorators&&this.stringify.convertTextKey&&0===a.indexOf(this.stringify.convertTextKey)?this.text(c):!this.options.ignoreDecorators&&this.stringify.convertCDataKey&&0===a.indexOf(this.stringify.convertCDataKey)?this.cdata(c):!this.options.ignoreDecorators&&this.stringify.convertCommentKey&&0===a.indexOf(this.stringify.convertCommentKey)?this.comment(c):!this.options.ignoreDecorators&&this.stringify.convertRawKey&&0===a.indexOf(this.stringify.convertRawKey)?this.raw(c):this.node(a,b,c);if(null==i)throw new Error("Could not create any elements with: "+a);return i},b.prototype.insertBefore=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.insertAfter=function(a,b,c){var d,e,f;if(this.isRoot)throw new Error("Cannot insert elements at root level");return e=this.parent.children.indexOf(this),f=this.parent.children.splice(e+1),d=this.parent.element(a,b,c),Array.prototype.push.apply(this.parent.children,f),d},b.prototype.remove=function(){var a,b;if(this.isRoot)throw new Error("Cannot remove the root element");return a=this.parent.children.indexOf(this),[].splice.apply(this.parent.children,[a,a-a+1].concat(b=[])),b,this.parent},b.prototype.node=function(a,b,c){var d,e;return null!=a&&(a=a.valueOf()),null==b&&(b={}),b=b.valueOf(),m(b)||(e=[b,c],c=e[0],b=e[1]),d=new g(this,a,b),null!=c&&d.text(c),this.children.push(d),d},b.prototype.text=function(a){var b;return b=new j(this,a),this.children.push(b),this},b.prototype.cdata=function(a){var b;return b=new c(this,a),this.children.push(b),this},b.prototype.comment=function(a){var b;return b=new d(this,a),this.children.push(b),this},b.prototype.raw=function(a){var b;return b=new i(this,a),this.children.push(b),this},b.prototype.declaration=function(a,b,c){var d,f;return d=this.document(),f=new e(d,a,b,c),d.xmldec=f,d.root()},b.prototype.doctype=function(a,b){var c,d;return c=this.document(),d=new f(c,a,b),c.doctype=d,d},b.prototype.up=function(){if(this.isRoot)throw new Error("The root node has no parent. Use doc() if you need to get the document object.");return this.parent},b.prototype.root=function(){var a;if(this.isRoot)return this;for(a=this.parent;!a.isRoot;)a=a.parent;return a},b.prototype.document=function(){return this.root().documentObject},b.prototype.end=function(a){return this.document().toString(a)},b.prototype.prev=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),1>a)throw new Error("Already at the first node");return this.parent.children[a-1]},b.prototype.next=function(){var a;if(this.isRoot)throw new Error("Root node has no siblings");if(a=this.parent.children.indexOf(this),-1===a||a===this.parent.children.length-1)throw new Error("Already at the last node");return this.parent.children[a+1]},b.prototype.importXMLBuilder=function(a){var b;return b=a.root().clone(),b.parent=this,b.isRoot=!1,this.children.push(b),this},b.prototype.ele=function(a,b,c){return this.element(a,b,c)},b.prototype.nod=function(a,b,c){return this.node(a,b,c)},b.prototype.txt=function(a){return this.text(a)},b.prototype.dat=function(a){return this.cdata(a)},b.prototype.com=function(a){return this.comment(a)},b.prototype.doc=function(){return this.document()},b.prototype.dec=function(a,b,c){return this.declaration(a,b,c)},b.prototype.dtd=function(a,b){return this.doctype(a,b)},b.prototype.e=function(a,b,c){return this.element(a,b,c)},b.prototype.n=function(a,b,c){return this.node(a,b,c)},b.prototype.t=function(a){return this.text(a)},b.prototype.d=function(a){return this.cdata(a)},b.prototype.c=function(a){return this.comment(a)},b.prototype.r=function(a){return this.raw(a)},b.prototype.u=function(){return this.up()},b}()}).call(this)},{"./XMLCData":148,"./XMLComment":149,"./XMLDeclaration":154,"./XMLDocType":155,"./XMLElement":156,"./XMLRaw":159,"./XMLText":161,"lodash/isEmpty":106,"lodash/isFunction":107,"lodash/isObject":110}],158:[function(a,b,c){(function(){var c,d;d=a("lodash/create"),b.exports=c=function(){function a(a,b,c){if(this.stringify=a.stringify,null==b)throw new Error("Missing instruction target");this.target=this.stringify.insTarget(b),c&&(this.value=this.stringify.insValue(c))}return a.prototype.clone=function(){return d(a.prototype,this)},a.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+="<?",g+=this.target,this.value&&(g+=" "+this.value),g+="?>",f&&(g+=d),g},a}()}).call(this)},{"lodash/create":96}],159:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing raw text");this.value=this.stringify.raw(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":157,"lodash/create":96}],160:[function(a,b,c){(function(){var a,c=function(a,b){return function(){return a.apply(b,arguments)}},d={}.hasOwnProperty;b.exports=a=function(){function a(a){this.assertLegalChar=c(this.assertLegalChar,this);var b,e,f;this.allowSurrogateChars=null!=a?a.allowSurrogateChars:void 0,this.noDoubleEncoding=null!=a?a.noDoubleEncoding:void 0,e=(null!=a?a.stringify:void 0)||{};for(b in e)d.call(e,b)&&(f=e[b],this[b]=f)}return a.prototype.eleName=function(a){return a=""+a||"",this.assertLegalChar(a)},a.prototype.eleText=function(a){return a=""+a||"",this.assertLegalChar(this.elEscape(a))},a.prototype.cdata=function(a){if(a=""+a||"",a.match(/]]>/))throw new Error("Invalid CDATA text: "+a);return this.assertLegalChar(a)},a.prototype.comment=function(a){if(a=""+a||"",a.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+a);return this.assertLegalChar(a)},a.prototype.raw=function(a){return""+a||""},a.prototype.attName=function(a){return""+a||""},a.prototype.attValue=function(a){return a=""+a||"",this.attEscape(a)},a.prototype.insTarget=function(a){return""+a||""},a.prototype.insValue=function(a){if(a=""+a||"",a.match(/\?>/))throw new Error("Invalid processing instruction value: "+a);return a},a.prototype.xmlVersion=function(a){if(a=""+a||"",!a.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+a);return a},a.prototype.xmlEncoding=function(a){if(a=""+a||"",!a.match(/^[A-Za-z](?:[A-Za-z0-9._-]|-)*$/))throw new Error("Invalid encoding: "+a);return a},a.prototype.xmlStandalone=function(a){return a?"yes":"no"},a.prototype.dtdPubID=function(a){return""+a||""},a.prototype.dtdSysID=function(a){return""+a||""},a.prototype.dtdElementValue=function(a){return""+a||""},a.prototype.dtdAttType=function(a){return""+a||""},a.prototype.dtdAttDefault=function(a){return null!=a?""+a||"":a},a.prototype.dtdEntityValue=function(a){return""+a||""},a.prototype.dtdNData=function(a){return""+a||""},a.prototype.convertAttKey="@",a.prototype.convertPIKey="?",a.prototype.convertTextKey="#text",a.prototype.convertCDataKey="#cdata",a.prototype.convertCommentKey="#comment",a.prototype.convertRawKey="#raw",a.prototype.assertLegalChar=function(a){var b,c;if(b=this.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,c=a.match(b))throw new Error("Invalid character ("+c+") in string: "+a+" at index "+c.index);return a},a.prototype.elEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},a.prototype.attEscape=function(a){var b;return b=this.noDoubleEncoding?/(?!&\S+;)&/g:/&/g,a.replace(b,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;")},a}()}).call(this)},{}],161:[function(a,b,c){(function(){var c,d,e,f=function(a,b){function c(){this.constructor=a}for(var d in b)g.call(b,d)&&(a[d]=b[d]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},g={}.hasOwnProperty;e=a("lodash/create"),c=a("./XMLNode"),b.exports=d=function(a){function b(a,c){if(b.__super__.constructor.call(this,a),null==c)throw new Error("Missing element text");this.value=this.stringify.eleText(c)}return f(b,a),b.prototype.clone=function(){return e(b.prototype,this)},b.prototype.toString=function(a,b){var c,d,e,f,g,h,i,j,k;return f=(null!=a?a.pretty:void 0)||!1,c=null!=(h=null!=a?a.indent:void 0)?h:"  ",e=null!=(i=null!=a?a.offset:void 0)?i:0,d=null!=(j=null!=a?a.newline:void 0)?j:"\n",b||(b=0),k=new Array(b+e+1).join(c),g="",f&&(g+=k),g+=this.value,f&&(g+=d),g},b}(c)}).call(this)},{"./XMLNode":157,"lodash/create":96}],162:[function(a,b,c){(function(){var c,d;d=a("lodash/assign"),c=a("./XMLBuilder"),b.exports.create=function(a,b,e,f){return f=d({},b,e,f),new c(a,f).root()}}).call(this)},{"./XMLBuilder":147,"lodash/assign":95}],163:[function(a,b,c){"use strict";function d(b){[a("./nodes/visual/group"),a("./nodes/visual/image"),a("./nodes/visual/rectangle"),a("./nodes/visual/circle"),a("./nodes/visual/text"),a("./nodes/visual/stacklayout"),a("./nodes/visual/flowlayout"),a("./nodes/visual/scrollview"),a("./nodes/visual/htmlcontent"),a("./nodes/visual/cssdefinition"),a("./nodes/counter"),a("./nodes/expression"),a("./nodes/and"),a("./nodes/or"),a("./nodes/switch"),a("./nodes/numberblend"),a("./nodes/stringselector"),a("./nodes/stringmapper"),a("./nodes/drag"),a("./nodes/inverter"),a("./nodes/timer"),a("./nodes/velocity"),a("./nodes/variables/number"),a("./nodes/variables/string"),a("./nodes/variables/boolean"),a("./nodes/variables/color"),a("./nodes/touchposition"),a("./nodes/signaltoindex"),a("./nodes/substring"),a("./nodes/gyroscope"),a("./nodes/reload"),a("./nodes/colorblend"),a("./nodes/globals"),a("./nodes/eventsender"),a("./nodes/eventreceiver"),a("./nodes/screenresolution"),a("./nodes/javascript"),a("./nodes/javascript2"),a("./nodes/animation"),a("./nodes/transition"),a("./nodes/numberremapper"),a("./nodes/websocket"),a("./nodes/componentinputs"),a("./nodes/componentoutputs"),a("./nodes/valuechanged"),a("./nodes/visual/textinput"),a("./nodes/visual/page"),a("./nodes/visual/pages"),a("./nodes/pagenavigation"),a("./nodes/pagenavigationback"),a("./nodes/states"),a("./nodes/stringformat"),a("./nodes/data/foreach"),a("./nodes/data/foreachactions"),a("./nodes/data/modelnode"),a("./nodes/data/collectionnode"),a("./nodes/data/staticdata"),a("./nodes/data/restnode"),a("./nodes/shadernode"),a("./nodes/visual/video"),a("./nodes/sendmessage"),a("./nodes/receivemessage"),a("./nodes/scriptdownloader"),a("./nodes/uniqueid"),a("./nodes/visual/effect")].forEach(function(a){b.registerNode(a)})}function e(a){if(!a)return{};for(var b={},c=a.substr(1).split("&"),d=0;d<c.length;d++){var e=c[d].split("=");b[decodeURIComponent(e[0])]=decodeURIComponent(e[1]||"")}return b}function f(a){function b(a,b){if(c.rootComponent){var d=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);d.forEach(function(a){a.setHighlightEnabled&&a.setHighlightEnabled(b)})}}var c=this;if(a=a||{},f.instance=this,this.frameScheduled=!1,this.rootComponent=null,this._currentLoadedData=null,this.isWaitingForExport=!0,this.graphModel=new l,this.errorHandlers=[],this.runningInEditor=a.runStandalone?!1:!0,o.instance.setIsRunningInEditor(this.runningInEditor),this.editorConnection=new h,this.editorConnection.on("exportDataFull",function(a){c.patchExportData(a)===!1?(c.isWaitingForExport=!1,x.isEqual(c._currentLoadedData,a)===!1&&c.setData(a)):c.editorConnection.requestFullExport()}),this.editorConnection.on("hoverStart",function(a){b(a,!0)}),this.editorConnection.on("hoverEnd",function(a){b(a,!1)}),this.editorConnection.on("reload",this.reload.bind(this)),this.editorConnection.on("selectNodes",function(a){c.rootComponent&&(c.inspector.clearSelected(),a.forEach(function(a){var b=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);b.forEach(function(a){c.inspector.selectNode(a._internal.uiControl)})}))}),this.editorConnection.on("selectNode",function(a){if(c.rootComponent){var b=c.rootComponent.nodeScope.getNodesWithIdRecursive(a);c.inspector.multiSelection||c.inspector.clearSelected(),b.forEach(function(a){c.inspector.selectNode(a._internal.uiControl)})}}),this.editorConnection.on("editStart",this.enableInspector.bind(this)),this.editorConnection.on("editEnd",this.disableInspector.bind(this)),this.editorConnection.on("modelUpdate",this.onModelUpdateReceived.bind(this)),this.context=new g({uiEngineClass:t,runningInEditor:this.runningInEditor,editorConnection:this.editorConnection}),this.editorConnection.isRunningLocally()){this.context.setOutputCollectionEnabled(!0);var e=this;this.context.uiEngine.on("rightButtonClick",function(a){e.editorConnection.send({cmd:"showeditmenu",type:"viewer",content:JSON.stringify({insertX:a.x,insertY:a.y,x:a.domEvent.pageX,y:a.domEvent.pageY})})}),this.editorConnection.on("connected",function(){c.sendNodeLibrary()})}this.editorConnection.on("debuggingEnabledChanged",this.context.setOutputCollectionEnabled.bind(this.context)),this.editorConnection.on("captureScreenShot",function(a){c.context.uiEngine.captureScreenShot(a.width,a.height,function(b){a.callback(b)})}),this.context.eventEmitter.on("scheduleFrame",this.scheduleFrame.bind(this)),this.context.eventEmitter.on("reloadApplication",this.reload.bind(this)),this.registerGraphModelListeners(),this._resetData(),d(this);for(var i=0;i<__noodl_modules.length;i++){var j=__noodl_modules[i];if(j.nodes)for(var k=0;k<j.nodes.length;k++){var m=j.nodes[k];m.node||(m={node:m}),this.registerNode(m)}}this.inspector=new v,q.pubsub=new r,q.pubsub.setConnection(this.editorConnection)}var g=a("./nodecontext"),h=a("./editorconnection"),i=a("./nodelibraryexport"),j=a("./projectsettings"),k=a("./projectpatchers"),l=a("./models/graphmodel"),m=a("./nodedefinition"),n=a("./node"),o=a("./fontloader"),p=a("./editormodeleventshandler"),q=a("./services/services"),r=a("./services/pubsub"),s=a("./services/mqtt-connection"),t=a("./uiengine/uiengine"),u=a("./uiengine/renderer"),v=a("./inspector"),w=a("./useragent-utils"),x=(a("./guid"),a("lodash"));f.prototype.registerGraphModelListeners=function(){var a=this;this.graphModel.on("componentAdded",function(b){a.context.registerComponentModel(b)},this),this.graphModel.on("componentRemoved",function(b){a.context.deregisterComponentModel(b)},this),this.graphModel.on("settingsUpdated",function(){a.setViewportSettings(a.graphModel.getDeviceSettings(a.deviceName)),a.sendNodeLibrary()})},f.prototype.reload=function(){this._currentLoadedData&&this.setData(this._currentLoadedData)},f.prototype._resetData=function(){this.frameNumber=0,null!==this.rootComponent&&this.rootComponent.getVisualRoot()&&this.context.uiEngine.root.removeChild(this.rootComponent.getVisualRoot()._internal.uiControl),this.rootComponent=null,this._currentLoadedData=null,this.graphModel.reset(),this.context.reset()},f.prototype.registerNode=function(a){a.node?(this.context.nodeRegister.register(m.defineNode(a.node)),a.setup&&a.setup(this.context,this.graphModel)):this.context.nodeRegister.register(a)},f.prototype.patchExportData=function(a){var b=k.collectPatches(a),c=Object.keys(b),d=j.collectPatch(a.settings),e=this;return c.length>0||d?(this.editorConnection.isRunningLocally()&&(c.forEach(function(a){e.editorConnection.sendPatches(b[a])}),d&&e.editorConnection.sendPatches(d)),!0):!1},f.prototype.setRenderer=function(a,b){var c=this.context.uiEngine;c.removeAllRenderers();w.isMobile.any();b===!0&&document.styleSheets[0].cssRules[0].style.removeProperty("background-color"),"canvas2d"===a?(c.setRendererType(u.TypeCanvas,b),c.imageCache.setCrossOrigin(!1)):"webgl"===a?(c.setRendererType(u.TypeWebGL,b),c.imageCache.setCrossOrigin(!0)):c.setRendererType(u.TypeDOM,b)},f.prototype.setViewportSettings=function(a){this.currentRenderer!==a.renderer&&(this.setRenderer(a.renderer,a.transparent),this.currentRenderer=a.renderer),this.context.uiEngine.setFillMode(a.fillMode),"aspectFit"===a.fillMode&&this.context.uiEngine.setAspectFitViewport(a.canvasWidth,a.canvasHeight)},f.prototype.findMQTTBrokerWithType=function(a){for(var b=0;b<__noodl_modules.length;b++){var c=__noodl_modules[b].mqttBrokers;if(c)for(var d=0;d<c.length;d++){var e=c[d];if(e.id===a)return e}}},f.prototype.showDeviceMenu=function(a){var b=JSON.stringify({settings:{devices:"Default Device","Default.fillMode":"fill","Default.renderer":"canvas2d","Default.rootComponent":"/Main","Default Device.fillMode":"fill","Default Device.canvasWidth":1080,"Default Device.canvasHeight":1920,"Default Device.renderer":"canvas2d"},components:[{name:"/Main",nodes:[{id:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b",type:"Group",parameters:{fill:"parent"},ports:[],children:[{id:"fa90ea16-1232-0437-deea-5dd6263d8247",type:"Rectangle",parameters:{color:"#222222"},ports:[],children:[]},{id:"84ce46fb-1240-c8b1-6cf8-d49b466af961",type:"Scroll View",parameters:{sizeMode:"explicit",alignX:"left",alignY:"top",clip:!0,paddingTop:50,paddingBottom:50},ports:[],children:[{id:"919460fe-c10e-9656-1924-3b39afe0a908",type:"Text",version:2,parameters:{text:"DEVICE LIST",color:"#F7BC41",fontSize:26,x:30,fontFamily:"fonts/OpenSans-Regular.ttf"},ports:[],children:[]},{id:"01d3bb07-74e9-f7c5-442b-dda6601882b7",type:"Text",version:2,parameters:{text:"Choose a device from the list",color:"#7a7a7a",fontSize:16,x:30,fontFamily:"fonts/OpenSans-Light.ttf"},ports:[],children:[]},{id:"0a2e4207-be74-0e10-e3c7-c53c1f4cd287",type:"Group",version:2,parameters:{height:{value:15,unit:"px"}},ports:[],children:[]},{id:"88e5bc50-f85b-7cfc-61a9-8a8e947a91e0",type:"Stack Layout",parameters:{sizeMode:"childHeight",itemSpacing:5},ports:[],children:[{id:"6fff1cb1-b58c-aafd-8790-951dd51e2230",type:"For Each",parameters:{template:"/Device Item"},ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance",index:3}],children:[]}]}]}]},{id:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",type:"Collection",parameters:{collectionId:"Devices"},ports:[],children:[]},{id:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",type:"Static Data",parameters:{csv:"DeviceName\nDevice 1\nMy Other Device\nSome third device"},ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General",index:2}],children:[]}],connections:[{sourceId:"55b1046f-9c39-c183-7a7e-f7d0a0afd7a3",sourcePort:"items",targetId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",targetPort:"items"},{sourceId:"23a6c0c0-859b-cf8d-af06-95dba0c57d78",sourcePort:"items",targetId:"6fff1cb1-b58c-aafd-8790-951dd51e2230",targetPort:"items"}],ports:[],roots:["2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"]},{name:"/Device Item",nodes:[{id:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",type:"Group",version:2,parameters:{sizeMode:"explicit",height:{value:55,unit:"px"}},ports:[],children:[{id:"73bb365b-38c7-efde-1516-d06c61315551",type:"Rectangle",parameters:{color:"#363637"},ports:[],children:[]},{id:"0e012b10-9938-cedd-cb1d-8f643353367d",type:"Group",version:2,parameters:{sizeMode:"explicit",paddingLeft:30,paddingRight:30},ports:[],children:[{id:"84669e81-f629-9b95-e309-a409ef64ff2e",type:"Text",version:2,parameters:{color:"#f8f8f8",fontFamily:"fonts/OpenSans-Light.ttf",alignX:"left",alignY:"center",sizeMode:"childHeight",fontSize:20},ports:[],children:[]},{id:"7e35cfcb-81a5-14d4-6e30-cf04ff69ec6f",type:"Group",version:2,parameters:{alignY:"center",sizeMode:"childSize",alignX:"right"},ports:[],children:[{id:"7210c16d-d9cf-604f-cd4e-c3014d6487ee",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#f8f8f8",rotationZ:45,y:-3},ports:[],children:[]},{id:"5faf645f-3c87-219c-3371-3eeda03986bc",type:"Rectangle",parameters:{height:{value:2,unit:"px"},width:{value:10,unit:"px"},color:"#f8f8f8",rotationZ:-45,y:4},ports:[],children:[]}]}]}]},{id:"26f178df-a067-6a5f-1d93-d146462b9c0b",type:"Model",parameters:{idType:"instance",properties:"DeviceName"},ports:[{type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:"DeviceName",index:7}],children:[]},{id:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",type:"Event Sender",parameters:{channelName:"Device Chosen"},ports:[{name:"DeviceName",plug:"input",type:{name:"*",allowConnectionOnly:!0},index:1}],children:[]},{id:"7b90a527-a414-14b0-497f-ff4bc902f6df",type:"For Each Actions",parameters:{},ports:[],children:[]}],connections:[{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"84669e81-f629-9b95-e309-a409ef64ff2e",targetPort:"text"},{sourceId:"26f178df-a067-6a5f-1d93-d146462b9c0b",sourcePort:"DeviceName",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"DeviceName"},{sourceId:"ccd8d324-7db3-d669-1099-dd84a0da6cf1",sourcePort:"touch.tap",targetId:"28d2af23-0c6e-db12-ad4f-8b5e1099e083",targetPort:"sendEvent"},{sourceId:"7b90a527-a414-14b0-497f-ff4bc902f6df",sourcePort:"itemId",targetId:"26f178df-a067-6a5f-1d93-d146462b9c0b",targetPort:"modelId"}],ports:[],roots:["ccd8d324-7db3-d669-1099-dd84a0da6cf1"]}],rootComponent:"/Main",rootNode:"2d3ccd33-f1ef-2dc5-3e1a-ca9d61cd222b"});b=b.replace(/fonts\//g,"external/viewer/fonts/"),b=JSON.parse(b),this._currentLoadedData=b,this.graphModel.importEditorData(b),this.graphModel.getComponentWithName("/Main").removeNodeWithId(this.graphModel.getNodesWithType("Static Data")[0].id),this.deviceName="Default Device",this.context.eventSenderEmitter.once("Device Chosen",function(a){window.location=window.location.href+(window.location.search?"&":"?")+"device="+a.DeviceName}),this.editorConnection.close();var c=a.split(",").map(function(a){return{DeviceName:a}}),d=this;this.context.eventEmitter.once("frameStart",function(){d.rootComponent.nodeScope.noodlJavascriptAPI.Collection.get("Devices").set(c)})},f.prototype.setupMQTT=function(a,b){var c=("000000"+(Math.random()*Math.pow(36,6)<<0).toString(36)).slice(-6),d=c+"-"+(b||"Noodl Editor"),e=this;if((!this.mqttConnection||!this.mqttConnection.isConnected())&&(a.mqttUseExternalBroker||this.runningInEditor)){if(this.mqttConnection||(this.mqttConnection=new s),a.mqttUseExternalBroker){var f=a.mqttBrokerUrl;if(a.mqttBrokerType&&"default"!==a.mqttBrokerType){var g=this.findMQTTBrokerWithType(a.mqttBrokerType);f=function(){return g.url(e.graphModel.projectSettings)}}this.mqttConnection.connect({url:f,clientId:d})}else this.mqttConnection.connect({url:"mqtt://"+location.hostname+":1884",clientId:d});q.pubsub.setConnection(this.mqttConnection)}},f.prototype.setData=function(b){var c=this;this.graphModel.isEmpty()===!1&&this._resetData();var d=b.settings.devices&&b.settings.devices.split(",").length>1,f=e(window.location.search),g=this.editorConnection.isRunningLocally()===!1&&d>0&&!f.device;if(g)this.showDeviceMenu(b.settings.devices);else{this._currentLoadedData=b,this.graphModel.importEditorData(b);var h=this.graphModel.getSettings();this.runningInEditor===!1&&h.analyticsEnabled&&this.recordSession(this.graphModel.getSettings().analyticsServerUrl);var i=this.graphModel.getDeviceSettings(f.device);this.setupMQTT(h,i.name)}var j,k,i=this.graphModel.getDeviceSettings(f.device);this.deviceName=i.name,this.editorConnection.isRunningLocally()&&!f.device?(j=this.graphModel.rootComponent,k=this.graphModel.rootNode):(j=i.rootComponent||this.graphModel.rootComponent,k=i.rootId),k||(k=this.graphModel.getComponentWithName(j).getFirstRootId()),window.Noodl.PubSub=q.pubsub,window.Noodl.getProjectSettings=function(){return c.graphModel.projectSettings},window.Noodl.Collection=a("./nodes/data/collection"),window.Noodl.Model=a("./nodes/data/model");for(var l=0;l<__noodl_modules.length;l++)"function"==typeof __noodl_modules[l].setup&&__noodl_modules[l].setup();this.rootComponent=this.context.createComponentInstanceNode(j),
this.rootComponent.setRoot(k),this.context.setRootComponent(this.rootComponent),this.setViewportSettings(i),x.extend(window.Noodl,this.rootComponent.nodeScope.noodlJavascriptAPI),this.scheduleFrame()},f.prototype.scheduleFrame=function(){this.frameScheduled||(window.requestAnimationFrame(f.prototype._doFrame.bind(this)),this.frameScheduled=!0)},f.prototype._doFrame=function(){this.frameScheduled=!1,this.context.currentFrameTime=window.performance.now(),this.context.eventEmitter.emit("frameStart"),n.numberOfSignalsSentThisFrame=0,n.numberOfQueuedSignalsThisFrame=0,this.context.update(),this.context.layout(),this.context.update(),this.context.uiEngine.renderFrame(),this.context.eventEmitter.emit("frameEnd"),this.frameNumber++},f.prototype.getNodeLibrary=function(){var a=j.generateProjectSettings(this.graphModel.getRawProjectSettings()),b=i(this.context.nodeRegister);return b.projectsettings=a,JSON.stringify(b,null,3)},f.prototype.sendNodeLibrary=function(){var a=this.getNodeLibrary();this.lastSentNodeLibrary!==a&&(this.lastSentNodeLibrary=a,this.editorConnection.send({cmd:"nodelibrary",type:"viewer",content:this.getNodeLibrary()}))},f.prototype.enableInspector=function(){this.inspector.enable(this.context.uiEngine,this.editorConnection,this.rootComponent)},f.prototype.disableInspector=function(){this.inspector.disable()},f.prototype.connectToEditor=function(a){this.editorConnection.connect(a)},f.prototype.onModelUpdateReceived=function(a){this.isWaitingForExport||("projectInstanceChanged"===a.type?(this.context.uiEngine.clearImageCache(),this._resetData(),this.scheduleFrame(),this.isWaitingForExport=!0):p.handleEvent(this.context,this.graphModel,a))},f.prototype.addErrorHandler=function(a){this.errorHandlers.push(a)},f.prototype.reportError=function(a){this.errorHandlers.forEach(function(b){b(a)})},b.exports=f},{"./editorconnection":166,"./editormodeleventshandler":167,"./fontloader":169,"./guid":170,"./inspector":171,"./models/graphmodel":174,"./node":176,"./nodecontext":177,"./nodedefinition":178,"./nodelibraryexport":179,"./nodes/and":181,"./nodes/animation":182,"./nodes/colorblend":183,"./nodes/componentinputs":184,"./nodes/componentoutputs":186,"./nodes/counter":187,"./nodes/data/collection":188,"./nodes/data/collectionnode":189,"./nodes/data/foreach":190,"./nodes/data/foreachactions":191,"./nodes/data/model":192,"./nodes/data/modelnode":193,"./nodes/data/restnode":195,"./nodes/data/staticdata":196,"./nodes/drag":197,"./nodes/eventreceiver":198,"./nodes/eventsender":199,"./nodes/expression":200,"./nodes/globals":201,"./nodes/gyroscope":202,"./nodes/inverter":203,"./nodes/javascript":204,"./nodes/javascript2":205,"./nodes/numberblend":206,"./nodes/numberremapper":207,"./nodes/or":208,"./nodes/pagenavigation":209,"./nodes/pagenavigationback":210,"./nodes/receivemessage":211,"./nodes/reload":212,"./nodes/screenresolution":213,"./nodes/scriptdownloader":214,"./nodes/sendmessage":215,"./nodes/shadernode":216,"./nodes/signaltoindex":217,"./nodes/states":218,"./nodes/stringformat":219,"./nodes/stringmapper":220,"./nodes/stringselector":221,"./nodes/substring":222,"./nodes/switch":223,"./nodes/timer":224,"./nodes/touchposition":225,"./nodes/transition":226,"./nodes/uniqueid":227,"./nodes/valuechanged":228,"./nodes/variables/boolean":229,"./nodes/variables/color":230,"./nodes/variables/number":231,"./nodes/variables/string":232,"./nodes/velocity":234,"./nodes/visual/circle":235,"./nodes/visual/cssdefinition":236,"./nodes/visual/effect":237,"./nodes/visual/flowlayout":238,"./nodes/visual/group":239,"./nodes/visual/htmlcontent":240,"./nodes/visual/image":241,"./nodes/visual/page":243,"./nodes/visual/pages":244,"./nodes/visual/rectangle":245,"./nodes/visual/scrollview":247,"./nodes/visual/stacklayout":248,"./nodes/visual/text":249,"./nodes/visual/textinput":250,"./nodes/visual/video":252,"./nodes/websocket":254,"./projectpatchers":258,"./projectsettings":259,"./services/mqtt-connection":260,"./services/pubsub":261,"./services/services":262,"./uiengine/renderer":292,"./uiengine/uiengine":318,"./useragent-utils":319,lodash:117}],164:[function(a,b,c){"use strict";var d={easeOutQuartic:function(a,b,c){return c--,-(b-a)*(c*c*c*c-1)+a},easeInQuartic:function(a,b,c){return(b-a)*(c*c*c*c)+a},easeInOutQuartic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c*c*c+a:(c-=2,-(b-a)/2*(c*c*c*c-2)+a)},easeOutCubic:function(a,b,c){return c--,(b-a)*(c*c*c+1)+a},easeInCubic:function(a,b,c){return(b-a)*(c*c*c)+a},easeInOutCubic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c*c+a:(c-=2,(b-a)/2*(c*c*c+2)+a)},easeOutQuadratic:function(a,b,c){return-(b-a)*c*(c-2)+a},easeInQuadratic:function(a,b,c){return(b-a)*(c*c)+a},easeInOutQuadratic:function(a,b,c){return c*=2,1>c?(b-a)/2*c*c+a:(c-=1,-(b-a)/2*(c*(c-2)-1)+a)},linear:function(a,b,c){return a+(b-a)*c}};d.easeIn=d.easeInCubic,d.easeOut=d.easeOutCubic,d.easeInOut=d.easeInOutCubic,b.exports=d},{}],165:[function(a,b,c){"use strict";function d(a){var b=!1;return function(c){c=c?!0:!1,c&&b===!1&&a.valueChangedToTrue.call(this),b=c}}b.exports={createSetter:d}},{}],166:[function(a,b,c){"use strict";function d(a){var b=a||{};e.call(this),this.ws=a&&a.webSocketClass||WebSocket,this.reconnectOnClose=!0,this.forceDebugger=b.forceDebugger||"undefined"!=typeof document&&-1!==document.location.href.indexOf("forceDebugger=true")}var e=a("./eventsender"),f=a("./services/services"),g=a("./guid");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.isRunningLocally=function(){var a="undefined"!=typeof document&&("localhost"===document.location.hostname||"127.0.0.1"===document.location.hostname);return a},d.prototype.connect=function(a){this.socket=new this.ws(a);var b=this;this.socket.addEventListener("open",function(){b.clientId=g(),b.socket.send(JSON.stringify({cmd:"register",type:"viewer",clientId:b.clientId})),b.emit("connected")}),this.socket.addEventListener("close",function(){b.reconnectOnClose&&b.reconnect(a),b.emit("connectionClosed")}),this.socket.addEventListener("error",function(c){console.log("Editor connection error, trying to reconnect"),b.reconnect(a)}),this.socket.addEventListener("message",function(a){var c,d=JSON.parse(a.data);"registered"===d.cmd||("export"===d.cmd?(c=JSON.parse(d.content),"full"===d.type&&b.emit("exportDataFull",c)):"selectNode"===d.cmd?b.emit("selectNode",d.content.id):"selectNodes"===d.cmd?b.emit("selectNodes",d.content.ids):"hoverStart"===d.cmd?b.emit("hoverStart",d.content.id):"hoverEnd"===d.cmd?b.emit("hoverEnd",d.content.id):"requestAlign"===d.cmd?b.emit("requestAlign",d.content.mode):"refresh"===d.cmd?b.emit("reload"):"editStart"===d.cmd?b.emit("editStart"):"editEnd"===d.cmd?b.emit("editEnd"):"editMultipleSelectionStart"===d.cmd?b.emit("editMultipleSelectionStart"):"editMultipleSelectionEnd"===d.cmd?b.emit("editMultipleSelectionEnd"):"capture"===d.cmd?b.isRunningLocally()&&(c=JSON.parse(d.content),b.sendThumbnailCapture(c.width,c.height)):"connectionInspectors"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("connectionInspectorsUpdated",c.connectionsToInspect)):"debuggingEnabled"===d.cmd?(b.isRunningLocally()||b.forceDebugger)&&(c=JSON.parse(d.content),b.emit("debuggingEnabledChanged",c.enabled)):"modelUpdate"===d.cmd?b.emit("modelUpdate",d.content):"publish"===d.cmd?f.pubsub.routeMessage(d):console.log("Command not implemented",d))})},d.prototype.reconnect=function(a){var b=this;setTimeout(function(){b.connect(a)},2e3)},d.prototype.isConnected=function(){return void 0!==this.socket&&this.socket.readyState===this.ws.OPEN},d.prototype.send=function(a){this.isConnected()!==!1&&this.socket.send(JSON.stringify(a))},d.prototype.sendPulsingConnections=function(a){var b=[];Object.keys(a).forEach(function(c){var d=a[c];b=b.concat(d.connections)}),this.send({cmd:"connectiondebugpulse",type:"viewer",content:JSON.stringify({connectionsToPulse:b})})},d.prototype.sendConnectionValues=function(a){this.send({cmd:"connectionvalue",type:"viewer",content:JSON.stringify({connections:a})})},d.prototype.sendDynamicPorts=function(a,b){this.send({cmd:"instanceports",type:"viewer",content:JSON.stringify({nodeid:a,ports:b})})},d.prototype.sendThumbnailCapture=function(a,b){var c=this;this.emit("captureScreenShot",{width:a,height:b,callback:function(a){a&&c.send({cmd:"captured",type:"viewer",content:JSON.stringify({data:a})})}})},d.prototype.sendWarning=function(a,b,c,d){this.send({cmd:"showwarning",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b,key:c,warning:d})})},d.prototype.clearWarnings=function(a,b){this.send({cmd:"clearwarnings",type:"viewer",content:JSON.stringify({componentName:a,nodeId:b})})},d.prototype.sendPatches=function(a){this.send({cmd:"patchproject",type:"viewer",content:JSON.stringify(a)})},d.prototype.requestFullExport=function(){this.send({cmd:"register",type:"viewer"})};var h={};d.prototype.sendServiceRequest=function(a,b){a.token=g(),a.clientId=this.clientId,h[a.token]=b,this.send(a)},d.prototype.close=function(){this.reconnectOnClose=!1,this.isConnected()!==!1&&this.socket.close()},b.exports=d},{"./eventsender":168,"./guid":170,"./services/services":262}],167:[function(a,b,c){"use strict";function d(a,b,c){function d(b,c){var d={},f={};c.forEach(function(a){a&&"outputs"===a.plug&&(a.plug="output"),("input"===a.plug||"input/output"===a.plug)&&(d[a.name]=a),("output"===a.plug||"input/output"===a.plug)&&(f[a.name]=a)});var h=Object.keys(b.getInputPorts()),i=e.difference(h,Object.keys(d)),j=e.difference(Object.keys(d),h);i.forEach(b.removeInputPortWithName.bind(b)),j.forEach(function(c){b.addInputPort(d[c]),b.parameters&&b.parameters.hasOwnProperty(c)&&g(a.rootComponent.nodeScope,b,c,b.parameters[c])});var k=Object.keys(b.getOutputPorts()),l=e.difference(k,Object.keys(f)),m=e.difference(Object.keys(f),k);l.forEach(b.removeOutputPortWithName.bind(b)),m.forEach(function(a){b.addOutputPort(f[a])})}function f(a,b,c){if(a.hasNode(b)!==!1){var d=a.getNodeMetadata(b),e=d.inputs[c];if(e)return e.type.defaultUnit?{value:e["default"],unit:e.type.defaultUnit}:e["default"]}}function g(a,b,c,d){var e=a.getNodesWithIdRecursive(b.id);e.forEach(function(a){a.queueInput(c,d)})}var h;c.componentName&&(h=b.getComponentWithName(c.componentName)),c.port&&"outputs"===c.port.plug&&(c.port.plug="output");var i={nodeAdded:function(a){h.importEditorNodeData(a.model,a.parentId,a.childIndex)},nodeRemoved:function(a){h.removeNodeWithId(a.model.id)},connectionAdded:function(a){h.addConnection(a.model)},connectionRemoved:function(b){h.removeConnection(b.model);var c=h.getNodeWithId(b.model.targetId);if(0===h.getConnectionsToPort(c.id,b.model.targetId).length){var d=c.parameters[b.model.targetPort];void 0===d&&(d=f(a.nodeRegister,c.type,b.model.targetPort)),g(a.rootComponent.nodeScope,c,b.model.targetPort,d)}},multipleParametersChanged:function(b){var c=h.getNodeWithId(b.nodeId);return void 0===c?void console.log("parameterChanged: Unkown node id",b):void b.parameters.forEach(function(b){var d=b.value;void 0===d&&(d=f(a.nodeRegister,c.type,b.name)),c.setParameter(b.name,d)})},parameterChanged:function(b){var c=h.getNodeWithId(b.nodeId);if(void 0===c)return void console.log("parameterChanged: Unkown node id",b);var d=b.parameterValue;void 0===d&&(d=f(a.nodeRegister,c.type,b.parameterName)),c.setParameter(b.parameterName,d)},nodeAttached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),h.getNodeWithId(a.parentId),a.childIndex)},nodeDetached:function(a){h.setNodeParent(h.getNodeWithId(a.nodeId),null)},componentAdded:function(a){b.importComponentFromEditorData(a.model)},componentRemoved:function(a){b.removeComponentWithName(a.componentName)},rootAdded:function(a){h.addRootId(a.nodeId)},portAdded:function(b){var c=h.getNodeWithId(b.nodeId);("input"===b.port.plug||"input/output"===b.port.plug)&&(c.addInputPort(b.port),c.parameters.hasOwnProperty(b.port)&&g(a.rootComponent.nodeScope,c,b.port,c.parameters[b.port])),("output"===b.port.plug||"input/output"===b.port.plug)&&c.addOutputPort(b.port)},portRemoved:function(a){var b=h.getNodeWithId(a.nodeId);("input"===a.port.plug||"input/output"===a.port.plug)&&b.removeInputPortWithName(a.port.name),("output"===a.port.plug||"input/output"===a.port.plug)&&b.removeOutputPortWithName(a.port.name)},nodePortRenamed:function(a){("input"===a.port.plug||"input/output"===a.port.plug)&&h.renameInputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name),("output"===a.port.plug||"input/output"===a.port.plug)&&h.renameOutputPortOnNodeWithId(a.nodeId,a.oldName,a.port.name);var c=h.getNodeWithId(a.nodeId);"Component Inputs"===c.type?(h.addInputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameInputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeInputPortWithName(a.oldName)):"Component Outputs"===c.type&&(h.addOutputPort(a.port),b.getNodesWithType(h.name).forEach(function(b){b.component.renameOutputPortOnNodeWithId(b.id,a.oldName,a.port.name)}),h.removeOutputPortWithName(a.oldName))},componentPortsUpdated:function(a){d(h,a.ports)},instancePortsChanged:function(a){var b=h.getNodeWithId(a.nodeId);d(b,a.ports)},componentRenamed:function(a){b.renameComponent(a.oldName,a.newName)},settingsChanged:function(a){b.setSettings(a.settings)}};i.hasOwnProperty(c.type)?(i[c.type](c),a.scheduleFrame()):console.log("Unknown event",c)}var e=a("lodash");b.exports={handleEvent:d}},{lodash:117}],168:[function(a,b,c){"use strict";function d(){this.listeners={},this.numListeners={}}var e=a("lodash");d.prototype.on=function(a,b,c){this.listeners.hasOwnProperty(a)||(this.listeners[a]=[],this.numListeners[a]=0),this.listeners[a].push({callback:b,ref:c}),this.numListeners[a]++,this.numListeners[a]>1e3&&console.trace("too many events",a,this.numListeners[a])},d.prototype.removeListenersWithRef=function(a){var b=this.numListeners;e.forIn(this.listeners,function(c,d){var f=e.remove(c,function(b){return b.ref===a});b[d]-=f.length})},d.prototype.removeAllListeners=function(a){a?(delete this.listeners[a],delete this.numListeners[a]):(this.listeners={},this.numListeners={})},d.prototype.emit=function(a,b){var c=this.listeners[a];c&&c.forEach(function(a){a.callback.call(a.ref,b)})},b.exports=d},{lodash:117}],169:[function(a,b,c){"use strict";function d(){this.loadedFontFamilies={},this.fontCssFamiliesAdded={},this.fontCallbacks={};var a=this;["Arial","Arial Black","Courier New","Helvetica","Impact","Lucida Console","Tahoma","Times New Roman"].forEach(function(b){a.loadedFontFamilies[b]=!0})}function e(a){return a.replace(/\.[^\/.]+$/,"")}var f=a("webfontloader");d.prototype.setIsRunningInEditor=function(a){this.isRunningInEditor=a},d.prototype.loadFont=function(a){var b=e(a).split("/").pop();if(this.loadedFontFamilies[b])return void(this.fontCallbacks[b]&&this.fontCallbacks[b].forEach(function(a){a()}));if(!this.fontCssFamiliesAdded[b]){this.fontCssFamiliesAdded[b]=!0;var c=document.createElement("style");c.type="text/css",this.isRunningInEditor&&"/"!==a[0]&&(a="/"+a),c.appendChild(document.createTextNode("                    @font-face {                        font-family: '"+b+"';                        src: url('"+a+"');                    }                ")),document.head.appendChild(c);var d=this;f.load({timeout:6e5,custom:{families:[b]},fontactive:function(a){d.loadedFontFamilies[a]=!0,d.fontCallbacks[a]&&d.fontCallbacks[a].forEach(function(a){a()})}})}},d.prototype.callWhenFontIsActive=function(a,b){return this.loadedFontFamilies[a]?void b():(this.fontCallbacks[a]||(this.fontCallbacks[a]=[]),void this.fontCallbacks[a].push(b))},d.instance=new d,b.exports=d},{webfontloader:142}],170:[function(a,b,c){function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}b.exports=d},{}],171:[function(a,b,c){"use strict";function d(){this.mouseMoveListener=this._onMouseMove.bind(this),this.mouseDownListener=this._onMouseDown.bind(this),this.mouseUpListener=this._onMouseUp.bind(this),this.cycleIndex=0,this.multiHighlighted={},this.editorConnection=void 0,this.focusedSelectedControl=void 0,this.selectedControls=[],this.multiSelection=!1,this.resizeMode="none",this.isDragging=!1,this.dragDistance=0,this.highlightedControl=void 0}function e(a,b){return a-b}function f(a){if(a.parent&&a.parent.layoutRect&&a.layoutRect){var b=a.parent.layoutRect,c=a.layoutRect;return b.x>=c.x&&b.y>=c.y&&b.width<=c.width&&b.height<=c.height?0===a.parent.children.indexOf(a):!1}return!1}function g(a){var b=i.some(function(b){return a instanceof b});return b&&!f(a)}var h=a("./uiengine/math/aabb"),i=(a("./nodes/visual/group"),[a("./uiengine/controls/circlecontrol"),a("./uiengine/controls/imagecontrol"),a("./uiengine/controls/rectanglecontrol"),a("./uiengine/controls/textcontrol"),a("./uiengine/controls/textinputcontrol"),a("./uiengine/controls/htmlcontrol")]);d.prototype.getHitTestBox=function(a){var b=this.positionFromEvent(a),c=Math.min(b[0],this.multiDragStart[0]),d=Math.min(b[1],this.multiDragStart[1]),e=Math.max(b[0],this.multiDragStart[0]),f=Math.max(b[1],this.multiDragStart[1]);return h.createFrom(c,d,e,f)},d.prototype.selectFromMultiBox=function(a){var b=this.getHitTestBox(a),c=this.uiEngine.hitTestBox(b),d=Object.keys(c);d.sort(e);for(var f=!1,h=d.length-1;h>=0&&f===!1;h--)for(var i=c[d[h]],j=i.length-1;j>=0;j--)g(i[j])&&!this.nodeIsAmongSelected(i[j])&&(this.selectNode(i[j]),this.sendToEditor("select",{id:i[j].noodlNode.id,singleSelect:!1}))},d.prototype.highlightFromMultiBox=function(a){var b=this.getHitTestBox(a),c=this.uiEngine.hitTestBox(b),d=Object.keys(c);d.sort(e);for(var f=!1,h={},i=Object.keys(this.multiHighlighted),j=d.length-1;j>=0&&f===!1;j--)for(var k=c[d[j]],l=k.length-1;l>=0;l--)g(k[l])&&!this.nodeIsAmongSelected(k[l])&&(h[k[l].id]=k[l],this.multiHighlighted[k[l].id]=k[l],k[l].setHighlightEnabled(!0));for(var l=0;l<i.length;l++){var m=i[l];if(!h.hasOwnProperty(m)){var n=this.multiHighlighted[m];n.setHighlightEnabled(!1),delete this.multiHighlighted[m]}}},d.prototype.clearHighlightedBox=function(){for(var a=Object.keys(this.multiHighlighted),b=0;b<a.length;b++){var c=a[b],d=this.multiHighlighted[c];d!==this.highlightedControl&&d.setHighlightEnabled(!1)}this.multiHighlighted={}},d.prototype.setHighlightedControl=function(a){var b=this.positionFromEvent(a),c=null,d=null,f=this.cycleIndex;if(this.focusedSelectedControl){if(0==f&&h.isPointInside(this.focusedSelectedControl.extendedScreenAABB,b))return this.highlightedControl&&this.highlightedControl!==this.focusedSelectedControl&&this.highlightedControl.setHighlightEnabled(!1),void(this.highlightedControl=this.focusedSelectedControl);c=this.focusedSelectedControl.screenAABB,this.focusedSelectedControl.screenAABB=this.focusedSelectedControl.extendedScreenAABB,d=this.focusedSelectedControl.childAABB,this.focusedSelectedControl.childAABB&&(this.focusedSelectedControl.childAABB=this.focusedSelectedControl.extendedScreenAABB)}var i=this.uiEngine.hitTest(b[0],b[1]);this.focusedSelectedControl&&(this.focusedSelectedControl.screenAABB=c,this.focusedSelectedControl.childAABB=d),this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0);var j=Object.keys(i);j.sort(e);for(var k=!1,l=void 0,m=j.length-1;m>=0&&k===!1;m--)for(var n=i[j[m]],o=n.length-1;o>=0;o--)if(g(n[o])){if(l||(l=n[o]),f>0){f--;continue}this.highlightedControl=n[o],this.highlightedControl.setHighlightEnabled(!0),k=!0;break}!k&&l&&(this.cycleIndex=0,this.highlightedControl=l,this.highlightedControl.setHighlightEnabled(!0))},d.prototype.updateDragging=function(a,b){var c=this.positionFromEvent(a),d=c[0]-this.dragLastPos[0],e=c[1]-this.dragLastPos[1];this.dragDistance+=Math.abs(d)+Math.abs(e);for(var f={type:this.resizeMode,phase:b,nodes:[]},g=0;g<this.selectedControls.length;g++){var h=this.selectedControls[g],i=d,j=e;if(h&&"move"!==this.resizeMode&&h.parent){if("%"===h.widthUnit){var k=h.parent.layoutRect.width;i=d/k*100}if("%"===h.heightUnit){var l=h.parent.layoutRect.height;j=e/l*100}}f.nodes.push({id:h.noodlNode.id,delta:[d,e,i,j]})}this.sendToEditor("resizenodes",f),this.dragLastPos=c},d.prototype.sendToEditor=function(a,b){this.editorConnection&&this.editorConnection.send({cmd:a,type:"viewer",content:JSON.stringify(b)})},d.prototype.updateMultiDragControl=function(a){var b=this.positionFromEvent(a),c=Math.min(b[0],this.multiDragStart[0]),d=Math.min(b[1],this.multiDragStart[1]),e=Math.max(b[0],this.multiDragStart[0]),f=Math.max(b[1],this.multiDragStart[1]);this.multiDragControl.setPositionX(c),this.multiDragControl.setPositionY(d),this.multiDragControl.setWidth(e-c),this.multiDragControl.setHeight(f-d)},d.prototype._onMouseMove=function(a){var b=this.positionFromEvent(a);return this.lastMousePos=b,this.isMultiDragging&&(this.updateMultiDragControl(a),this.highlightFromMultiBox(a)),this.isDragging?void this.updateDragging(a,"move"):(this.selectedControls.length>0&&this.useForEditing&&this.updateCursorAndResizeArea(a),void this.setHighlightedControl(a))},d.prototype.positionFromEvent=function(a){return[this._getTouchX(a)*this.uiEngine.renderer.viewportWidth,this._getTouchY(a)*this.uiEngine.renderer.viewportHeight]},d.prototype.updateCursorAndResizeArea=function(a){if(0!==this.selectedControls.length){var b=this.positionFromEvent(a);this.focusedSelectedControl=void 0;for(var c=0;c<this.selectedControls.length;c++){var d=this.selectedControls[c],e=d.layoutRect,f=Math.min(40,Math.min(e.width,e.height)/4),g=h.create(),i=h.create(),j=h.create(),k=h.create();h.copy(g,d.screenAABB),h.copy(i,d.screenAABB),h.copy(j,d.screenAABB),h.copy(k,d.screenAABB);var l=h.create();h.copy(l,d.screenAABB),l.min[0]-=f/2,l.min[1]-=f/2,l.max[0]+=f/2,l.max[1]+=f/2,d.extendedScreenAABB=l,g.min[0]-=f/2,g.min[1]-=f/2,g.max[0]=g.min[0]+f,g.max[1]=g.min[1]+f,i.min[0]+=e.width-f/2,i.min[1]-=f/2,i.max[0]=i.min[0]+f,i.max[1]=i.min[1]+f,j.min[0]+=e.width-f/2,j.min[1]+=e.height-f/2,j.max[0]=j.min[0]+f,j.max[1]=j.min[1]+f,k.min[0]-=f/2,k.min[1]+=e.height-f/2,k.max[0]=k.min[0]+f,k.max[1]=k.min[1]+f;var m=h.createFrom(g.max[0],g.min[1],i.min[0],g.max[1]),n=h.createFrom(i.min[0],i.max[1],i.max[0],j.min[1]),o=h.createFrom(k.max[0],k.min[1],j.min[0],j.max[1]),p=h.createFrom(g.min[0],g.max[1],g.max[0],k.min[1]),q="auto";if(h.isPointInside(l,b)){var r=d.sizeMode||"explicit",s="explicit"===r||"childHeight"===r,t="explicit"===r||"childWidth"===r;h.isPointInside(g,b)&&s&&t?(q="nwse-resize",this.resizeMode="expandTopLeft"):h.isPointInside(i,b)&&s&&t?(q="nesw-resize",this.resizeMode="expandTopRight"):h.isPointInside(j,b)&&s&&t?(q="nwse-resize",this.resizeMode="expandBottomRight"):h.isPointInside(k,b)&&s&&t?(q="nesw-resize",this.resizeMode="expandBottomLeft"):h.isPointInside(m,b)&&t?(q="ns-resize",this.resizeMode="expandTop"):h.isPointInside(n,b)&&s?(q="ew-resize",this.resizeMode="expandRight"):h.isPointInside(o,b)&&t?(q="ns-resize",this.resizeMode="expandBottom"):h.isPointInside(p,b)&&s?(q="ew-resize",this.resizeMode="expandLeft"):(q="move",this.resizeMode="move"),this.focusedSelectedControl=d,document.body.style.cursor=q;break}document.body.style.cursor="auto",document.body.style.cursor=q}}},d.prototype.startDragging=function(a){this.isDragging=!0,this.dragLastPos=this.positionFromEvent(a),this.updateDragging(a,"enter")},d.prototype.sendRoundValues=function(){for(var a={type:"roundValues",phase:"exit",nodes:[]},b=0;b<this.selectedControls.length;b++){var c=this.selectedControls[b];a.nodes.push({type:"roundValues",phase:"exit",id:c.noodlNode.id,delta:[0,0]})}this.sendToEditor("resizenodes",a)},d.prototype.clearSelected=function(){for(var a=0;a<this.selectedControls.length;a++){var b=this.selectedControls[a];b.setSelectionEnabled(!1)}this.selectedControls=[]},d.prototype.selectNode=function(a){if(this.uiEngine){var b=this.rootComponent.nodeScope.getNodesWithIdRecursive(a.noodlNode.id),c=this;b.forEach(function(a){for(var b=a._internal.uiControl,d=0;d<c.selectedControls.length;d++)if(b===c.selectedControls[d])return;b.setSelectionEnabled(!0),c.selectedControls.push(b)})}},d.prototype.deselectNode=function(a){if(this.uiEngine){var b=this,c=this.rootComponent.nodeScope.getNodesWithIdRecursive(a.noodlNode.id);c.forEach(function(a){var c=a._internal.uiControl,d=b.selectedControls.indexOf(c);-1!==d&&b.selectedControls.splice(d,1),c.setSelectionEnabled(!1),b.sendToEditor("deselect",{id:c.noodlNode.id})})}},d.prototype.setMultipleSelectionEnabled=function(a){this.multiSelection=a},d.prototype.nodeIsAmongSelected=function(a){for(var b=0;b<this.selectedControls.length;b++){var c=this.selectedControls[b];if(c===a)return!0}return!1},d.prototype._onMouseUp=function(a){if(0===a.button&&this.nodeIsAmongSelected(this.highlightedControl)&&this.dragDistance<10){if(!this.multiSelection&&this.selectedControls.length>1)this.cycleIndex=0,this.clearSelected(),this.selectNode(this.highlightedControl),this.sendToEditor("select",{id:this.highlightedControl.noodlNode.id,singleSelect:!0});else if(this.multiSelection&&this.highlightedControl!==this.lastSelectedNode){var b=this.highlightedControl;this.deselectNode(this.highlightedControl),this.cycleIndex++,this.setHighlightedControl(a),this.highlightedControl!==b?(this.selectNode(this.highlightedControl),this.sendToEditor("select",{id:this.highlightedControl.noodlNode.id,singleSelect:!0})):this.cycleIndex=0}else this.cycleIndex=0;this.lastSelectedNode=null}else this.cycleIndex=0;if(this.isMultiDragging){var c=this.positionFromEvent(a),d=c[0]-this.multiDragStart[0],e=c[1]-this.multiDragStart[1],f=Math.sqrt(d*d+e*e);f>10&&this.selectFromMultiBox(a),this.clearHighlightedBox(),this.uiEngine.setOverlayNode(null),this.isMultiDragging=!1}this.isDragging=!1,this.dragDistance=null,this.sendRoundValues()},d.prototype._onMouseDown=function(a){var b=this.positionFromEvent(a);if(2===a.button){var c=null;this.highlightedControl&&(c=this.highlightedControl.noodlNode.id),this.sendToEditor("showeditmenu",{x:a.pageX,y:a.pageY,insertX:b[0],insertY:b[1],sourceNode:c})}else this.sendToEditor("hideeditmenu",{});if(0===a.button&&this.highlightedControl)this.nodeIsAmongSelected(this.highlightedControl)||(this.multiSelection||this.clearSelected(),this.selectNode(this.highlightedControl),this.sendToEditor("select",{id:this.highlightedControl.noodlNode.id,singleSelect:!1}),this.lastSelectedNode=this.highlightedControl),this.isDragging=!1,this.setHighlightedControl(a),this.updateCursorAndResizeArea(a),this.startDragging(a);else if(0===a.button){var d=this;this.selectedControls.forEach(function(a){a.setSelectionEnabled(!1),d.sendToEditor("deselect",{id:a.noodlNode.id})}),this.isDragging=!1,this.lastSelectedNode=null,this.selectedControls=[]}0===a.button&&this.multiSelection&&!this.isDragging&&(this.multiDragStart=this.positionFromEvent(a),this.isMultiDragging=!0,this.uiEngine.setOverlayNode(this.multiDragControl),this.updateMultiDragControl(a)),this.dragDistance=0},d.prototype.requestAlign=function(a){var b;if("left"===a||"centerHorizontal"===a||"right"===a){for(var c=0,d=Number.MAX_VALUE,e=Number.NEGATIVE_INFINITY,f=0;f<this.selectedControls.length;f++){var g=this.selectedControls[f];d=Math.min(d,g.layoutRect.x),c+=g.layoutRect.x+g.layoutRect.width/2,e=Math.max(e,g.layoutRect.x+g.layoutRect.width)}var h;h="left"===a?d:"right"===a?e:c/this.selectedControls.length,b=this.selectedControls.map(function(b){var c=b.layoutRect.x-h;return"right"===a?c+=b.layoutRect.width:"centerHorizontal"===a&&(c+=b.layoutRect.width/2),{id:b.noodlNode.id,x:Math.round(b.positionX-c),y:b.positionY}})}else{for(var i=0,j=Number.MAX_VALUE,k=Number.NEGATIVE_INFINITY,f=0;f<this.selectedControls.length;f++){var g=this.selectedControls[f];j=Math.min(j,g.layoutRect.y),i+=g.layoutRect.y+g.layoutRect.height/2,k=Math.max(k,g.layoutRect.y+g.layoutRect.height)}var l;l="top"===a?j:"bottom"===a?k:i/this.selectedControls.length,b=this.selectedControls.map(function(b){var c=b.layoutRect.y-l;return"bottom"===a?c+=b.layoutRect.height:"centerVertical"===a&&(c+=b.layoutRect.height/2),{id:b.noodlNode.id,x:b.positionX,y:Math.round(b.positionY-c)}})}this.sendToEditor("alignnodes",b)},d.prototype._getTouchX=function(a){return this.uiEngine?this.uiEngine.touchListener.getTouchX(a):0},d.prototype._getTouchY=function(a){return this.uiEngine?this.uiEngine.touchListener.getTouchY(a):0},d.prototype.enable=function(a,b,c){this.uiEngine=a,this.rootComponent=c,this.cycleIndex=0,this.multiDragControl||(this.multiDragControl=a.createRectangleControl(),this.multiDragControl.setColor("#33333"),this.multiDragControl.setSizeMode("explicit"),this.multiDragControl.setWidthUnit("px"),this.multiDragControl.setHeightUnit("px"),this.multiDragControl.setWidth(150),this.multiDragControl.setHeight(176),this.multiDragControl.setOpacity(.2),this.multiDragControl.setDepth(Number.MAX_VALUE)),this.uiEngine.touchListener.setTouchInterceptCallbacks(this.mouseMoveListener,this.mouseDownListener,this.mouseUpListener),this.editorConnection=b,this.useForEditing=!0,this.editorConnection.on("requestAlign",this.requestAlign.bind(this),this);var d=this;this.editorConnection.on("editMultipleSelectionStart",function(){d.setMultipleSelectionEnabled(!0)}),this,this.editorConnection.on("editMultipleSelectionEnd",function(){d.setMultipleSelectionEnabled(!1)},this),this.clearSelected(),void 0!==this.uiEngine.touchListener.lastMouseMove&&this._onMouseMove(this.uiEngine.touchListener.lastMouseMove)},d.prototype.disable=function(){this.editorConnection&&this.editorConnection.removeListenersWithRef(this),this.uiEngine&&(this.uiEngine.touchListener.setTouchInterceptCallbacks(void 0,void 0,void 0),this.editorConnection=void 0,this.lastSelectedNode=void 0,this.rootComponent=void 0,this.highlightedControl&&(this.highlightedControl.setHighlightEnabled(!1),this.highlightedControl=void 0),this.uiEngine.setOverlayNode(null),this.clearHighlightedBox(),this.isMultiDragging=!1,this.clearSelected(),this.focusedSelectedControl=void 0,document.body.style.cursor="auto",this.uiEngine=void 0)},b.exports=d},{"./nodes/visual/group":239,"./uiengine/controls/circlecontrol":265,"./uiengine/controls/htmlcontrol":269,"./uiengine/controls/imagecontrol":271,"./uiengine/controls/rectanglecontrol":274,"./uiengine/controls/textcontrol":279,"./uiengine/controls/textinputcontrol":280,"./uiengine/math/aabb":289}],172:[function(a,b,c){"use strict";function d(a,b){this.inputs={},this.outputs={},this.error=void 0;var c=e[a];if(!c)try{c=new Function("define","Noodl",a),e[a]=c}catch(d){this.error=d.message}if(c)try{c(this.define.bind(this),b)}catch(d){this.error=d.message}}var e={};d.prototype.define=function(a){this.inputs=a.inputs||{},this.outputs=a.outputs||{},this.setup=a.setup,this.run=a.run,this.destroy=a.destroy,this.definedObject=a},d.createFromCode=function(a,b){return new d(a,b)},d.createFromURL=function(a,b,c){var e=new window.XMLHttpRequest;e.open("GET",a,!0),e.onreadystatechange=function(){(4===this.readyState||this.readyState===XMLHttpRequest.DONE)&&c(new d(this.response,b))},e.onerror=function(){console.log("Failed to request",a)},e.send()},d.prototype.getPorts=function(){var a=[],b=this;return Object.keys(this.inputs).forEach(function(c){var d=b.inputs[c],e={name:c,plug:"input"};if("string"==typeof d)e.type={name:d},e.group="Inputs";else for(var f in d)e[f]=d[f];a.push(e)}),Object.keys(this.outputs).forEach(function(c){a.push({name:c,type:{name:b.outputs[c]},plug:"output",group:"Outputs"})}),a},b.exports=d},{}],173:[function(a,b,c){"use strict";function d(a){f.call(this),this.name=a,this.nodes={},this.connections=[],this.roots=[],this.inputPorts={},this.outputPorts={}}var e=a("./nodemodel"),f=a("./../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.addNode=function(a){a.component=this,this.nodes[a.id]=a,this.emit("nodeAdded",a)},d.prototype.getNodeWithId=function(a){return this.nodes[a]},d.prototype.getAllNodes=function(){return g.values(this.nodes)},d.prototype.getNodesWithType=function(a){var b=[],c=this;return Object.keys(this.nodes).forEach(function(d){var e=c.nodes[d];e.type===a&&b.push(e)}),b},d.prototype.addConnection=function(a){
this.connections.push(a),this.emit("connectionAdded",a)},d.prototype.removeConnection=function(a){var b=g.findIndex(this.connections,function(b){return g.isEqual(b,a)});this.connections.splice(b,1),this.emit("connectionRemoved",a)},d.prototype.getConnectionsFromPort=function(a,b){return this.connections.filter(function(c){return c.sourceId===a&&c.sourcePort===b})},d.prototype.getConnectionsToPort=function(a,b){return this.connections.filter(function(c){return c.targetId===a&&c.targetPort===b})},d.prototype.getConnectionsFrom=function(a){return this.connections.filter(function(b){return b.sourceId===a})},d.prototype.getConnectionsTo=function(a){return this.connections.filter(function(b){return b.targetId===a})},d.prototype.addRootId=function(a){-1===this.roots.indexOf(a)&&(this.roots.push(a),this.emit("rootAdded",a))},d.prototype.getFirstRootId=function(){return this.roots[0]},d.prototype.removeNodeWithId=function(a){var b=this.getNodeWithId(a);if(!b)return console.warn("ERROR: Attempted to remove non-existing node with ID:",a," - duplicate nodes in tree?"),!1;for(;b.children.length>0;){var c=b.children[0];this.removeNodeWithId(c.id)||b.children.shift()}for(var d=this.getConnectionsTo(a).concat(this.getConnectionsFrom(a)),e=0;e<d.length;e++)this.removeConnection(d[e]);this.setNodeParent(b,null);var f=this.roots.indexOf(b.id);return-1!==f&&(this.roots.splice(f,1),this.emit("rootRemoved",b.id)),this.emit("nodeRemoved",b),b.removeAllListeners(),delete this.nodes[a],!0},d.prototype.getAllConnections=function(){return this.connections},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.renameInputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsToPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getInputPort(b));f&&(e.removeInputPortWithName(b),f.name=c,e.addInputPort(f)),d.forEach(function(a){a.targetPort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.renameOutputPortOnNodeWithId=function(a,b,c){var d=this.getConnectionsFromPort(a,b);d.forEach(this.removeConnection.bind(this));var e=this.getNodeWithId(a),f=g.clone(e.getOutputPort(b));e.removeOutputPortWithName(b),f.name=c,e.addOutputPort(f),d.forEach(function(a){a.sourcePort=c}),d.forEach(this.addConnection.bind(this))},d.prototype.setNodeParent=function(a,b,c){a.parent&&(this.emit("nodeParentWillBeRemoved",a),a.parent.removeChild(a)),a.emit("parentUpdated",b),b&&(b.addChild(a,c),this.emit("nodeParentUpdated",a))},d.prototype.importEditorNodeData=function(a,b,c){var d=e.createFromExportData(a);this.addNode(d),b&&this.setNodeParent(d,this.getNodeWithId(b),c);var f=this;a.children&&a.children.forEach(function(a,b){f.importEditorNodeData(a,d.id,b)})},d.prototype.reset=function(){for(;this.roots.length;)this.removeNodeWithId(this.roots[0]);if(Object.keys(this.nodes).forEach(this.removeNodeWithId.bind(this)),this.nodes.length>0)throw new Error("Not all nodes were removed during a reset");if(this.connections.length>0)throw new Error("Not all connections were removed during a reset")},d.prototype.rename=function(a){var b=this.name;this.name=a,this.emit("renamed",{oldName:b,newName:a})},d.createFromExportData=function(a){var b=new d(a.name);return a.ports&&a.ports.forEach(function(a){("input"===a.plug||"input/output"===a.plug)&&b.addInputPort(a),("output"===a.plug||"input/output"===a.plug)&&b.addOutputPort(a)}),a.nodes&&a.nodes.forEach(b.importEditorNodeData.bind(b)),a.connections&&a.connections.forEach(b.addConnection.bind(b)),a.roots&&a.roots.forEach(b.addRootId.bind(b)),b},b.exports=d},{"./../eventsender":168,"./nodemodel":175,lodash:117}],174:[function(a,b,c){"use strict";function d(){f.call(this),this.components={},this.defaultDevice={canvasWidth:1080,canvasHeight:1920,fillMode:"aspectFit",renderer:"webgl",name:"Default Device"},this.settings=g.clone(h)}var e=a("./componentmodel"),f=a("./../eventsender"),g=a("lodash"),h={analyticsEnabled:!1,analyticsServerUrl:"http://localhost:8080"};d.prototype=Object.create(f.prototype),d.prototype.importComponentFromEditorData=function(a){var b=e.createFromExportData(a);this.addComponent(b)},d.prototype.importEditorData=function(a){a.settings&&this.setSettings(a.settings),a.components.forEach(this.importComponentFromEditorData.bind(this)),this.setRootComponentName(a.rootComponent),this.setRootNodeId(a.rootNode)},d.prototype.setRootComponentName=function(a){this.rootComponent=a,this.emit("rootComponentNameUpdated",a)},d.prototype.setRootNodeId=function(a){this.rootNode=a,this.emit("rootNodeIdChanged",a)},d.prototype.getNodesWithType=function(a){for(var b=[],c=Object.keys(this.components),d=0;d<c.length;d++){var e=this.components[c[d]];b=b.concat(e.getNodesWithType(a))}return b},d.prototype.getComponentWithName=function(a){return this.components[a]},d.prototype.getAllNodes=function(){for(var a=[],b=Object.keys(this.components),c=0;c<b.length;c++){var d=this.components[b[c]];a=a.concat(d.getAllNodes())}return a},d.prototype.addComponent=function(a){this.components[a.name]=a,this.getNodesWithType(a.name).forEach(this._addComponentPorts.bind(this)),a.getAllNodes().forEach(this._onNodeAdded.bind(this)),a.on("nodeAdded",this._onNodeAdded.bind(this),this),this.emit("componentAdded",a)},d.prototype.removeComponentWithName=function(a){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");var b=this.components[a];b.reset(),b.removeAllListeners(),delete this.components[b.name],this.emit("componentRemoved",b)},d.prototype.renameComponent=function(a,b){if(this.components.hasOwnProperty(a)===!1)return void console.error("GraphModel: Component with name "+componentNamee+" not in graph");this.getNodesWithType(a).forEach(function(a){a.type=b});var c=this.components[a];c.rename(b),delete this.components[a],this.components[b]=c},d.prototype._addComponentPorts=function(a){if(this.components.hasOwnProperty(a.type)){var b=this.components[a.type];g.forIn(b.getInputPorts(),a.addInputPort.bind(a)),g.forIn(b.getOutputPorts(),a.addOutputPort.bind(a))}},d.prototype._onNodeAdded=function(a){this._addComponentPorts(a),this.emit("nodeAdded",a),this.emit("nodeAdded."+a.type,a)},d.prototype.reset=function(){var a=this;Object.keys(this.components).forEach(function(b){a.removeComponentWithName(b)}),this.settings=g.clone(h),this.devices={}},d.prototype.isEmpty=function(){return 0===Object.keys(this.components).length},d.prototype.setSettings=function(a){if(a.hasOwnProperty("analyticsEnabed")&&(this.settings.analyticsEnabled=a.analyticsEnabled),a.hasOwnProperty("analyticsServerUrl")&&(this.settings.analyticsServerUrl=a.analyticsServerUrl),this.settings.mqttUseExternalBroker=a.mqttUseExternalBroker,this.settings.mqttBrokerUrl=a.mqttBrokerUrl,this.settings.mqttBrokerType=a.mqttBrokerType,a.devices){this.devices={};var b=this,c=a.devices.split(",");c.forEach(function(c){b.devices[c]={fillMode:a[c+".fillMode"]||b.defaultDevice.fillMode,canvasWidth:a[c+".canvasWidth"]||b.defaultDevice.canvasWidth,canvasHeight:a[c+".canvasHeight"]||b.defaultDevice.canvasHeight,renderer:a[c+".renderer"]||b.defaultDevice.renderer,transparent:a[c+".transparent"]||b.defaultDevice.transparent,rootComponent:a[c+".rootComponent"],name:c}}),this.defaultDeviceName=c[0]}this.projectSettings=a,this.emit("settingsUpdated")},d.prototype.getSettings=function(){return this.settings},d.prototype.getDeviceSettings=function(a){return a&&this.devices.hasOwnProperty(a)!==!1||(a=this.defaultDeviceName),a?this.devices[a]:this.defaultDevice},d.prototype.getRawProjectSettings=function(){return this.projectSettings||{}},b.exports=d},{"./../eventsender":168,"./componentmodel":173,lodash:117}],175:[function(a,b,c){"use strict";function d(a,b){e.call(this),this.id=a,this.type=b,this.inputs=[],this.outputs=[],this.children=[],this.parameters={},this.inputPorts={},this.outputPorts={}}var e=a("./../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setParameter=function(a,b){this.parameters[a]=b,this.emit("parameterUpdated",{name:a,value:b})},d.prototype.setParameters=function(a){var b=this;Object.keys(a).forEach(function(c){b.setParameter(c,a[c])})},d.prototype.addInputPort=function(a){this.inputPorts[a.name]=a,this.emit("inputPortAdded",a)},d.prototype.getInputPort=function(a){return this.inputPorts[a]},d.prototype.getInputPorts=function(){return this.inputPorts},d.prototype.removeInputPortWithName=function(a){if(this.inputPorts.hasOwnProperty(a)){var b=this.inputPorts[a];delete this.inputPorts[a],this.emit("inputPortRemoved",b)}},d.prototype.addOutputPort=function(a){this.outputPorts[a.name]=a,this.emit("outputPortAdded",a)},d.prototype.getOutputPort=function(a){return this.outputPorts[a]},d.prototype.getOutputPorts=function(){return this.outputPorts},d.prototype.removeOutputPortWithName=function(a){if(this.outputPorts.hasOwnProperty(a)){var b=this.outputPorts[a];delete this.outputPorts[a],this.emit("outputPortRemoved",b)}},d.prototype.addChild=function(a,b){a.parent=this,void 0===b?this.children.push(a):this.children.splice(b,0,a)},d.prototype.removeChild=function(a){a.parent=void 0;var b=this.children.indexOf(a);this.children.splice(b,1)},d.prototype.reset=function(){this.removeAllListeners()},d.createFromExportData=function(a){var b=new d(a.id,a.type);return a.parameters&&b.setParameters(a.parameters),a.ports&&a.ports.forEach(function(a){"outputs"===a.plug&&(a.plug="output"),("input"===a.plug||"input/output"===a.plug)&&b.addInputPort(a),("output"===a.plug||"input/output"===a.plug)&&b.addOutputPort(a)}),b},b.exports=d},{"./../eventsender":168}],176:[function(a,b,c){"use strict";function d(a){this.context=a,this._dirty=!1,this._cachedInputValues={},this._inputs={},this.numberedInputs={},this._outputs={},this._inputConnections={},this._outputList=[],this._isUpdating=!1,this._inputValuesQueue={},this._afterInputsHaveUpdatedCallbacks=[],this._internal={},this._signalsSentThisUpdate={}}function e(a){var b=a.split(" ");return b.splice(-1,1),b.join(" ")}var f=a("./outputproperty");d.numberOfQueuedSignalsThisFrame=0,d.numberOfSignalsSentThisFrame=0,Object.defineProperties(d.prototype,{registerInput:{value:function(a,b){if(this.hasInput(a))throw new Error("Input property "+a+" already registered");this._inputs[a]=b,b.hasOwnProperty("default")&&(this._cachedInputValues[a]=b["default"])}},deregisterInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Input property "+a+" doesn't exist");delete this._inputs[a],delete this._cachedInputValues[a]}},registerInputs:{value:function(a){for(var b in a)this.registerInput(b,a[b])}},_registerSelectors:{value:function(a){var b=this;Object.keys(a).forEach(function(c){var d=a[c],e={set:function(a){var c=a.split(" "),e=Number(c[c.length-1]);d.set.call(b,e)}};b.registerInput(c,e)})}},registerNumberedInput:{value:function(a,b){if(this.hasNumberedInput(a))throw new Error("Numbered input property "+a+" already registered");this.numberedInputs[a]=b,b.selectors&&this._registerSelectors(b.selectors)}},getInput:{value:function(a){if(this.hasInput(a)===!1)throw new Error("Node "+this.name+": Invalid input property "+a);return this._inputs[a]}},hasInput:{value:function(a){return a in this._inputs}},hasNumberedInput:{value:function(a){return this.numberedInputs.hasOwnProperty(a)}},registerInputIfNeeded:{value:function(a){this.hasInput(a)===!1&&this._isUnregisteredNumberedInput(a)&&this._registerNumberedInputInstance(a)}},_isUnregisteredNumberedInput:{value:function(a){var b=e(a);return this.numberedInputs.hasOwnProperty(b)}},_registerNumberedInputInstance:{value:function(a){var b=a.split(" "),c=b[b.length-1];if(isNaN(c))throw new Error("Numbered input with name "+a+" doesn't end with a number");c=Number(c);var d=this.numberedInputs[e(a)],f={name:d.name,set:d.createSetter.call(this,c)};this.registerInput(a,f)}},setInputValue:{value:function(a,b,c){this._cachedInputValues[a]=b;var d=this.getInput(a);c?d.set.call(this,b,c):d.set.call(this,b)}},hasOutput:{value:function(a){return a in this._outputs}},registerOutput:{value:function(a,b){if(this.hasOutput(a))throw new Error("Output property "+a+" already registered");var c=new f({owner:this,getter:b.getter,name:a});this._outputs[a]=c,this._outputList.push(c)}},deregisterOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Output property "+a+" isn't registered");var b=this._outputs[a];if(b.hasConnections())throw new Error("Output property "+a+" has connections and can't be removed");delete this._outputs[a];var c=this._outputList.indexOf(b);this._outputList.splice(c,1)}},registerOutputs:{value:function(a){for(var b in a)this.registerOutput(b,a[b])}},registerOutputIfNeeded:{value:function(){}},getOutput:{value:function(a){if(this.hasOutput(a)===!1)throw new Error("Node "+this.name+" doesn't have a port named "+a);return this._outputs[a]}},connectInput:{value:function(a,b,c){if(this.hasInput(a)===!1)throw new Error("Invalid connection, input doesn't exist. Trying to connect from "+b.name+" output "+c+" to "+this.name+" input "+a);var d=b.getOutput(c);if(d.registerConnection(this,a),this._inputConnections[a]||(this._inputConnections[a]=[],this._inputValuesQueue[a]=[]),this._inputConnections[a].push(d),b._signalsSentThisUpdate[c])this.queueInput(a,!0),this.queueInput(a,!1);else{var e=d.value;void 0!==e&&this.queueInput(a,e)}this.flagDirty()}},removeInputConnection:{value:function(a,b,c){if(!this._inputConnections[a])throw new Error("Node removeInputConnection: Input doesn't exist");for(var d=this._inputConnections[a],e=0;e<d.length;e++){var f=d[e];if(f.owner.id===b&&f.name===c){d.splice(e,1);var g=f.owner.getOutput(c);g.deregisterConnection(this,a);break}}}},isInputConnected:{value:function(a){return this._inputConnections.hasOwnProperty(a)}},update:{value:function(){if(!this._isUpdating&&this._dirty!==!1){this._isUpdating=!0;var a,b=0;try{for(;this._dirty&&100>b;){this._updateDependencies(),this._dirty=!1;for(var c=!0,d=Object.keys(this._inputValuesQueue);c;){for(c=!1,a=0;a<d.length;a++){var e=d[a],f=this._inputValuesQueue[e];if(f.length>0){var g=f.shift();null!==g&&"object"==typeof g&&g.hasOwnProperty("value")&&g.hasOwnProperty("unit")?this.setInputValue(e,g.value,g.unit):this.setInputValue(e,g),f.length>0&&(c=!0)}}var h=this._afterInputsHaveUpdatedCallbacks;for(this._afterInputsHaveUpdatedCallbacks=[],a=0;a<h.length;a++)h[a].call(this)}b++}}catch(i){throw this._isUpdating=!1,i}this._isUpdating=!1}}},_updateDependencies:{value:function(){for(var a in this._inputConnections)for(var b=this._inputConnections[a],c=0;c<b.length;++c)"reference"!==b[c].type&&b[c].owner.update()}},flagDirty:{value:function(){if(!this._dirty){this._dirty=!0,this.context&&this.context.nodeIsDirty(this);for(var a=0;a<this._outputList.length;++a)this._outputList[a].flagDependeesDirty()}}},sendValue:{value:function(a,b){if(this.hasOutput(a)===!1)return void console.log("Error: Node",this.name,"doesn't have a output named",a);var c=this.getOutput(a);c.hasConnections()!==!1&&void 0!==b&&(d.numberOfSignalsSentThisFrame++,c.sendValue(b),this.context&&this.context.connectionSentValue(c,b))}},flagOutputDirty:{value:function(a){var b=this.getOutput(a);b.hasConnections()!==!1&&this.sendValue(a,b.value)}},flagAllOutputsDirty:{value:function(a){for(var b=0;b<this._outputList.length;++b){var c=this._outputList[b];this.sendValue(c.name,c.value)}}},sendSignalOnOutput:{value:function(a){this.sendValue(a,!0),this.sendValue(a,!1),this._signalsSentThisUpdate[a]=!0,this.scheduleAfterInputsHaveUpdated(function(){this._signalsSentThisUpdate[a]=!1})}},queueInput:{value:function(a,b,c){d.numberOfQueuedSignalsThisFrame++,this._inputValuesQueue[a]||(this._inputValuesQueue[a]=[]),c?this._inputValuesQueue[a].push({value:b,unit:c}):this._inputValuesQueue[a].push(b),this.flagDirty()}},scheduleAfterInputsHaveUpdated:{value:function(a){d.numberOfQueuedSignalsThisFrame++,this._afterInputsHaveUpdatedCallbacks.push(a),this.flagDirty()}},setNodeModel:{value:function(a){this.model=a,a.on("parameterUpdated",this._onNodeModelParameterUpdated,this);var b=this;a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){b.hasOutput(a.name)&&b.deregisterOutput(a.name)},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0)}},_onNodeModelParameterUpdated:{value:function(a){this.registerInputIfNeeded(a.name),"object"==typeof a.value&&a.value.hasOwnProperty("unit")?this.queueInput(a.name,a.value.value,a.value.unit):this.queueInput(a.name,a.value)}}}),b.exports=d},{"./outputproperty":257}],177:[function(a,b,c){"use strict";function d(a){if(a=a||{},a.runningInEditor=a.hasOwnProperty("runningInEditor")?a.runningInEditor:!1,this._dirtyNodes=[],this.callbacksAfterUpdate=[],this.eventEmitter=new e,this.eventEmitter.setMaxListeners(1e3),this.eventSenderEmitter=new e,this.eventSenderEmitter.setMaxListeners(1e4),this.globalValues={},this.globalsEventEmitter=new e,this.globalsEventEmitter.setMaxListeners(1e3),this.runningInEditor=a.runningInEditor,this.currentFrameTime=0,this.nodeRegister=new f(this),this.timerScheduler=new g(this.scheduleFrame.bind(this)),this.componentModels={},this.outputCollectionEnabled=!1,this.connectionsToPulse={},this.connectionsToPulseChanged=!1,this.connectionsToInspect={},this.inspectedConnectionValuesToSendQueue=[],this.connectionPulsingCallbackScheduled=!1,this.editorConnection=a.editorConnection,this.rootComponent=void 0,this.editorConnection&&this.editorConnection.on("connectionInspectorsUpdated",this.onConnectionInspectorsUpdated.bind(this)),a.uiEngineClass){var b=a.uiEngineClass;this.uiEngine=new b(this.timerScheduler,document.body),this.uiEngine.eventSender.on("requestFrame",this.scheduleFrame.bind(this))}}var e=a("events").EventEmitter,f=a("./noderegister"),g=a("./timerscheduler");d.prototype.setRootComponent=function(a){this.rootComponent=a,a.getVisualRoot()&&this.uiEngine.root.addChild(a.getVisualRoot()._internal.uiControl)},d.prototype.onConnectionInspectorsUpdated=function(a){var b={};a.forEach(function(a){var c=a.fromId+a.fromProperty;b[c]=a}),this.connectionsToInspect=b,this.sendConnectionsToInspectValues()},d.prototype.layout=function(){this.uiEngine&&this.uiEngine.layout()},d.prototype.update=function(){for(var a,b,c=!0,d=0;c&&10>d;){this.layout();var e=this._dirtyNodes;for(this._dirtyNodes=[],a=0,b=e.length;b>a;++a)e[a].update();var f=this.callbacksAfterUpdate;for(this.callbacksAfterUpdate=[],a=0,b=f.length;b>a;a++)f[a]();this.layout(),c=this.callbacksAfterUpdate.length>0||this._dirtyNodes.length>0,d++}this.timerScheduler.hasPendingTimers()&&(this.scheduleFrame(),this.timerScheduler.runTimers(this.currentFrameTime)),this.flushConnectionsToInspect()},d.prototype.flushConnectionsToInspect=function(){this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),this.inspectedConnectionValuesToSendQueue.length>0&&(this.editorConnection.sendConnectionValues(this.inspectedConnectionValuesToSendQueue),this.inspectedConnectionValuesToSendQueue=[])},d.prototype.reset=function(){this.eventEmitter.emit("applicationDataReloaded");var a=this.eventEmitter;["frameStart","frameEnd"].forEach(function(b){a.removeAllListeners(b)}),this.globalValues={},this._dirtyNodes.length=0,this.callbacksAfterUpdate.length=0,this.timerScheduler.runningTimers=[],this.timerScheduler.newTimers=[],this.rootComponent=void 0,this.clearAllConnectionInspections()},d.prototype.nodeIsDirty=function(a){this._dirtyNodes.push(a),this.scheduleFrame()},d.prototype.scheduleFrame=function(){this.eventEmitter.emit("scheduleFrame")},d.prototype.scheduleAfterUpdate=function(a){this.callbacksAfterUpdate.push(a),this.scheduleFrame()},d.prototype.scheduleNextFrame=function(a){this.eventEmitter.once("frameStart",a),this.scheduleFrame()},d.prototype.setGlobalValue=function(a,b){this.globalValues[a]=b,this.globalsEventEmitter.emit(a)},d.prototype.getGlobalValue=function(a){return this.globalValues[a]},d.prototype.reloadApplication=function(){this.eventEmitter.emit("reloadApplication")},d.prototype.registerComponentModel=function(a){if(this.componentModels.hasOwnProperty(a.name))throw new Error("Duplicate component name "+a.name);this.componentModels[a.name]=a;var b=this;a.on("renamed",function(c){delete b.componentModels[c.oldName],b.componentModels[c.newName]=a},this)},d.prototype.deregisterComponentModel=function(a){this.componentModels.hasOwnProperty(a.name)&&(this.componentModels[a.name].removeListenersWithRef(this),delete this.componentModels[a.name])},d.prototype.getComponentModel=function(a){if(!a)throw new Error("Component instance must have a name");if(this.componentModels.hasOwnProperty(a)===!1)throw new Error("Unknown component "+a);return this.componentModels[a]},d.prototype.hasComponentModelWithName=function(a){return this.componentModels.hasOwnProperty(a)},d.prototype.createComponentInstanceNode=function(b){var c=this.getComponentModel(b),d=a("./nodes/componentinstance"),e=new d(this);return e.name=b,e.setComponentModel(c),e},d.prototype._sendConnectionValue=function(a,b){if(this.connectionsToInspect.hasOwnProperty(a.id)&&this.inspectedConnectionValuesToSendQueue.push({id:a.id,value:b}),this.connectionsToPulse.hasOwnProperty(a.id))return void(this.connectionsToPulse[a.id].timestamp="undefined"!=typeof window?window.performance.now():+new Date);var c=[];a.connections.forEach(function(b){c.push(a.owner.id+a.name+b.node.id+b.inputPortName)}),this.connectionsToPulse[a.id]={timestamp:"undefined"!=typeof window?window.performance.now():+new Date,connections:c},this.connectionsToPulseChanged=!0,this.connectionPulsingCallbackScheduled===!1&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.connectionSentValue=function(a,b){this.editorConnection&&this.editorConnection.isConnected()&&this.outputCollectionEnabled&&this._sendConnectionValue(a,b)},d.prototype.clearAllConnectionInspections=function(){this.connectionsToInspect={},this.connectionsToPulse={},this.editorConnection.sendPulsingConnections(this.connectionsToPulse)},d.prototype.clearOldConnectionPulsing=function(){this.connectionPulsingCallbackScheduled=!1;var a="undefined"!=typeof window?window.performance.now():+new Date,b=this,c=Object.keys(this.connectionsToPulse);c.forEach(function(c){var d=b.connectionsToPulse[c];a-d.timestamp>100&&(b.connectionsToPulseChanged=!0,delete b.connectionsToPulse[c])}),this.connectionsToPulseChanged&&(this.connectionsToPulseChanged=!1,this.editorConnection.sendPulsingConnections(this.connectionsToPulse)),Object.keys(this.connectionsToPulse).length>0&&(this.connectionPulsingCallbackScheduled=!0,setTimeout(this.clearOldConnectionPulsing.bind(this),100))},d.prototype.sendConnectionsToInspectValues=function(){var a=this,b=[];Object.keys(this.connectionsToInspect).forEach(function(c){var d=a.connectionsToInspect[c],e=a.rootComponent.nodeScope.getNodesWithIdRecursive(d.toId);if(e.length>0){var f=e[e.length-1],g=f._cachedInputValues[d.toProperty];"object"==typeof g&&"Node"===g.constructor.name&&(g="<Node> "+g.name),b.push({id:c,value:g})}}),b.length>0&&this.editorConnection.sendConnectionValues(b)},d.prototype.setOutputCollectionEnabled=function(a){this.outputCollectionEnabled=a,a&&this.sendConnectionsToInspectValues()},d.prototype.sendGlobalEventFromEventSender=function(a,b){this.eventSenderEmitter.emit(a,b),this.sessionRecorder&&this.sessionRecorder.appendEvent(a)},d.prototype.setSessionRecorder=function(a){this.sessionRecorder=a},b.exports=d},{"./noderegister":180,"./nodes/componentinstance":185,"./timerscheduler":264,events:6}],178:[function(a,b,c){"use strict";function d(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");d.set&&(a[c]={set:d.set}),d.setUnitType&&(a[c].setUnitType=d.setUnitType),b.inputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,"default":d["default"],index:d.index,exportToEditor:d.hasOwnProperty("exportToEditor")?d.exportToEditor:!0,inputPriority:d.inputPriority||0},d.valueChangedToTrue&&(b.inputs[c].type={name:"boolean",allowConnectionsOnly:!0})}function e(a,b,c,d){if(a.hasOwnProperty(c))throw new Error("Input property "+c+" already registered");a[c]={createSetter:d.createSetter},b.numberedInputs[c]={displayPrefix:d.displayPrefix,group:d.group,name:d.name},d.selectors&&(b.numberedInputs[c].selectors={},a[c].selectors={},Object.keys(d.selectors).forEach(function(e){var f=d.selectors[e];b.numberedInputs[c].selectors[e]={displayName:f.displayName,editorName:f.editorName,group:f.group},a[c].selectors[e]={set:f.set}}))}function f(a,b,c){Object.keys(c).forEach(function(e){d(a,b,e,c[e])})}function g(a,b){Object.keys(b).forEach(function(c){var d=b[c];a.outputs[c]={displayName:d.displayName,editorName:d.editorName,group:d.group,type:d.type,index:d.index,exportToEditor:d.hasOwnProperty("exportToEditor")?d.exportToEditor:!0}})}function h(a,b){Object.keys(b).forEach(function(c){a[c]=b[c]["default"]})}function i(a){function b(a){k.call(this,a)}if(!a.category)throw new Error("Node must have a category");if(!a.name)throw new Error("Node must have a name");var c={inputs:{},outputs:{},numberedInputs:{},category:a.category,dynamicports:a.dynamicports,allowChildren:a.allowChildren,allowChildrenWithCategory:a.allowChildrenWithCategory,allowAsChild:a.allowAsChild,panels:a.panels,color:a.color,usePortAsLabel:a.usePortAsLabel,portLabelTruncationMode:a.portLabelTruncationMode,name:a.name,displayNodeName:a.displayNodeName,deprecated:a.deprecated,haveComponentPorts:a.haveComponentPorts,version:a.version};a._internal=a._internal||{},a.prototypeExtensions=a.prototypeExtensions||{},a.inputs=a.inputs||{},a.outputs=a.outputs||{},a.numberedInputs=a.numberedInputs||{},a.initialize=a.initialize||function(){};var d={},i={};f(d,c,a.inputs),g(c,a.outputs),Object.keys(a.numberedInputs).forEach(function(b){e(i,c,b,a.numberedInputs[b])}),Object.keys(a.prototypeExtensions).forEach(function(b){a.prototypeExtensions[b].value||(a.prototypeExtensions[b]={value:a.prototypeExtensions[b]})}),b.prototype=Object.create(k.prototype,a.prototypeExtensions),Object.defineProperty(b.prototype,"name",{value:a.name});var j=function(e){var f=new b(e);return f._inputs=Object.create(d),Object.keys(a.inputs).forEach(function(b){var c=a.inputs[b];c.valueChangedToTrue&&(f._inputs[b]={set:l.createSetter({valueChangedToTrue:c.valueChangedToTrue})})}),Object.keys(a.outputs).forEach(function(b){var c=a.outputs[b];"signal"===c.type?f.registerOutput(b,{getter:function(){return!1}}):f.registerOutput(b,c)}),Object.keys(i).forEach(function(a){f.registerNumberedInput(a,i[a])}),h(f._cachedInputValues,c.inputs),a.initialize.call(f),f};return j.metadata=c,j}function j(a,b){for(var c in b)if("initialize"===c&&a.initialize){var d=a.initialize;a.initialize=function(){d.call(this),b.initialize.call(this)}}else b[c]&&b[c].constructor===Object?a[c]=j(a[c]||{},b[c]):b[c]&&b[c].constructor===Array&&a[c]&&a[c].constructor==Array?a[c]=a[c].concat(b[c]):a[c]=b[c];return a}var k=a("./node"),l=a("./edgetriggeredinput");b.exports={defineNode:i,extend:j}},{"./edgetriggeredinput":165,"./node":176}],179:[function(a,b,c){"use strict";function d(a){var b={typecasts:[{from:"boolean",to:["number","string","signal"]},{from:"number",to:["boolean","string"]},{from:"string",to:["number","boolean","image","color"]},{from:"signal",to:["boolean","number"]},{from:"image",to:[]},{from:"color",to:[]},{from:"enum",to:[]},{from:"object",to:[]},{from:"domelement",to:[]},{from:"reference",to:[]},{from:"font",to:[]}],dynamicports:[{type:"conditionalports",name:"basic"},{type:"expand",name:"basic"},{type:"portchannel",name:"event-sender-channel",channelPortname:"channelName",typename:"Event Sender",ignorePorts:["channelName","sendEvent","propagation"]},{type:"numbered",name:"simple-number",port:{type:"number"}},{type:"numbered",name:"simple-boolean",port:{type:"boolean"}},{type:"numbered",name:"simple-string",port:{type:"string"}},{type:"numbered",name:"simple-color",port:{type:"color"}}],colors:{nodes:{component:{base:"#6e3599",baseHighlighted:"#8440b8",header:"#6e3599",headerHighlighted:"#8440b8",outline:"#6e3599",outlineHighlighted:"#b58900",text:"#ffffff"},visual:{base:"#2a4e6e",baseHighlighted:"#376690",header:"#2a4e6e",headerHighlighted:"#376690",outline:"#2a4e6e",outlineHighlighted:"#b58900",text:"#ffffff"},data:{base:"#6d8241",baseHighlighted:"#2f8d22",header:"#6d8241",headerHighlighted:"#2f8d22",outline:"#6d8241",outlineHighlighted:"#b58900",text:"#ffffff"},javascript:{base:"#a24176",baseHighlighted:"#ab5484",header:"#a24176",headerHighlighted:"#ab5484",outline:"#ab5484",outlineHighlighted:"#d57bab",text:"#ffffff"},"default":{base:"#3e434e",baseHighlighted:"#505768",header:"#3e434e",headerHighlighted:"#505768",outline:"#3e434e",outlineHighlighted:"#b58900",text:"#ffffff"}},connections:{signal:{normal:"#468c8c",highlighted:"#73babb",pulsing:"#92d9d8"},"default":{normal:"#916311",highlighted:"#ffa300",pulsing:"#ffe85d"}}},nodetypes:[{name:"Component Children",color:"component",panels:"none",allowAsChild:!0,category:"Visual",haveComponentChildren:["Visual"]}]},c=Object.keys(a._constructors);return c.forEach(function(c){function d(a,b){var c={name:a,type:b.type,plug:"output"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),b.editorName&&(c.editorName=b.editorName),f.ports.push(c)}var e=a._constructors[c].metadata,f={name:c};b.nodetypes.push(f),e.version&&(f.version=e.version),e.displayNodeName&&(f.displayNodeName=e.displayNodeName),e.deprecated&&(f.deprecated=!0),e.haveComponentPorts&&(f.haveComponentPorts=!0),"Visual"===e.category&&(f.allowAsChild=!0,f.allowAsExportRoot=!0,f.color="visual"),e.allowChildren&&(f.allowChildrenWithCategory=["Visual"],f.color="visual"),e.allowChildrenWithCategory&&(f.allowChildrenWithCategory=e.allowChildrenWithCategory),e.allowAsChild&&(f.allowAsChild=!0),f.category=e.category,e.panels&&(f.panels=e.panels),e.usePortAsLabel&&(f.usePortAsLabel=e.usePortAsLabel,f.portLabelTruncationMode=e.portLabelTruncationMode),e.color&&(f.color=e.color),e.dynamicports&&(f.dynamicports=e.dynamicports.slice()),f.ports=[];var g=f.dynamicports||[],h={},i={};e.dynamicports&&(e.dynamicports.filter(function(a){return"conditionalports/basic"===a.name}).forEach(function(a){a.ports.forEach(function(a){i[a.plug+"/"+a.name]=!0})}),e.dynamicports.filter(function(a){return void 0!==a.channelPort}).forEach(function(a){i[a.channelPort.plug+"/"+a.channelPort.name]=!0})),e.numberedInputs&&Object.keys(e.numberedInputs).forEach(function(a){var b=e.numberedInputs[a],c={name:b.name,prefix:a};b.displayPrefix&&(c.displayPrefix=b.displayPrefix);var d={plug:"input"};if(b.group&&(d.group=b.group),c.port=d,b.selectors){var f=[];Object.keys(b.selectors).forEach(function(a){var c=b.selectors[a];h[a]=!0;var d={name:a,plug:"input"};c.displayName&&(d.displayName=c.displayName),c.description&&(d.description=c.description),c.editorName&&(d.editorName=c.editorName),c.group&&(d.group=c.group),d.allowEditOnly=!0,f.push(d)}),c.selectors=f}g.push(c)}),g.length&&(f.dynamicports=g),Object.keys(e.inputs).forEach(function(a){if(!h.hasOwnProperty("input/"+a)&&!i.hasOwnProperty("input/"+a)){var b=e.inputs[a];if(b.exportToEditor!==!1){var c={name:a,type:b.type,plug:"input"};b.group&&(c.group=b.group),b.displayName&&(c.displayName=b.displayName),
b.description&&(c.description=b.description),b.editorName&&(c.editorName=b.editorName),void 0!==b["default"]&&(c["default"]=b["default"]),b.hasOwnProperty("index")&&(c.index=b.index),f.ports.push(c)}}}),Object.keys(e.outputs).forEach(function(a){if(!h.hasOwnProperty("output/"+a)&&!i.hasOwnProperty("output/"+a)){var b=e.outputs[a];d(a,b)}})}),b}b.exports=d},{}],180:[function(a,b,c){"use strict";function d(a){this._constructors={},this.context=a}d.prototype.register=function(a){var b=a.metadata.name;this._constructors[b]=a},d.prototype.createNode=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a](this.context)},d.prototype.getNodeMetadata=function(a){if(this._constructors.hasOwnProperty(a)===!1)throw new Error("Unknown node type with name "+a);return this._constructors[a].metadata},d.prototype.hasNode=function(a){return this._constructors.hasOwnProperty(a)},b.exports=d},{}],181:[function(a,b,c){"use strict";function d(a){return!a}var e=a("../nodedefinition");b.exports=e.defineNode({name:"And",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return this._internal.inputs[a]=!1,function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){var a=this._internal.inputs;return a.length>0&&a.some(d)===!1}}}})},{"../nodedefinition":178}],182:[function(a,b,c){"use strict";function d(a){this.name=a.name,this.startValue=0,this.endValue=0,this.currentValue=void 0,this.startMode="implicit",this.ease=a.ease,this.node=a.node,this.hasSampledStartValue=!1;var b=this;this.animation=a.node.context.timerScheduler.createTimer({startValue:0,endValue:0,onRunning:function(a){var c=b.ease(this.startValue,this.endValue,a);b.setCurrentValue(c)}}),this.animation.startValue=0,this.animation.endValue=0}var e=(a("../node"),a("../nodedefinition")),f=a("../easecurves"),g=a("bezier-easing");Object.defineProperties(d.prototype,{setCurrentValue:{value:function(a){this.currentValue=a,this.node.flagOutputDirty(this.name)}},play:{value:function(a,b){if(void 0===a&&(console.log("Animation warning, start value is undefined"),a=0),void 0===b)return void console.error("Animation error, start:",a,"end:",b);var c=this.animation;c.startValue=a,this.setCurrentValue(a),c.endValue=b,c.duration=this.node._internal.duration,c.start()}},playToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.endValue))}},playToStart:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.getTargetsCurrentValue(),this.startValue))}},replayToEnd:{value:function(){this.hasConnections()!==!1&&(this.updateStartValue(),this.play(this.startValue,this.endValue))}},replayToStart:{value:function(){this.hasConnections()!==!1&&this.play(this.endValue,this.startValue)}},hasConnections:{value:function(){return this.node.getOutput(this.name).hasConnections()}},getTargetsCurrentValue:{value:function(){var a=this.node.getOutput(this.name).connections;return a[0].node._cachedInputValues[a[0].inputPortName]}},updateStartValue:{value:function(){"implicit"!==this.startMode||this.hasSampledStartValue||(this.hasSampledStartValue=!0,this.startValue=this.getTargetsCurrentValue())}},stop:{value:function(){this.animation.stop(),this.setCurrentValue(void 0)}},jumpToStart:{value:function(){this.animation.stop(),this.setCurrentValue(this.startValue)}},jumpToEnd:{value:function(){this.animation.stop(),this.setCurrentValue(this.endValue)}}});var h=[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}],i=300,j={name:"Animation",category:"Animation",initialize:function(){var a=this._internal;a.duration=i,a.ease=f.easeOut,a._isPlayingToEnd=!1,a.animations=[],a.cubicBezierPoints=[0,0,0,0],a.cubicBezierFunction=void 0;var b=this;a.animation=this.context.timerScheduler.createTimer({onFinish:function(){a._isPlayingToEnd===!1?b.sendSignalOnOutput("hasReachedStart"):b.sendSignalOnOutput("hasReachedEnd")}})},inputs:{duration:{index:0,type:"number",displayName:"Duration (ms)",group:"Animation Properties","default":i,set:function(a){this._internal.duration=a}},easingCurve:{index:10,type:{name:"enum",enums:h},group:"Animation Properties",displayName:"Easing Curve","default":"easeOut",set:function(a){var b;"cubicBezier"===a?(this.updateCubicBezierFunction(),b=this._internal.cubicBezierFunction):b=f[a],this._internal.ease=b}},playToEnd:{index:20,group:"Play",displayName:"To End",editorName:"Play To End",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!0;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToEnd()})}},playToStart:{index:21,group:"Play",displayName:"To Start",editorName:"Play To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].playToStart()})}},replayToEnd:{index:22,group:"Play",displayName:"From Start To End",editorName:"Play From Start To End",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations,c=this;this._internal._isPlayingToEnd=!0,this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToEnd()})}},replayToStart:{index:23,group:"Play",displayName:"From End To Start",editorName:"Play From End To Start",valueChangedToTrue:function(){this._internal._isPlayingToEnd=!1;var a=this._internal.animation,b=this._internal.animations,c=this;this.scheduleAfterInputsHaveUpdated(function(){a.duration=c._internal.duration,a.start();for(var d=0;d<b.length;d++)b[d].ease=c._internal.ease,b[d].replayToStart()})}},stop:{index:60,group:"Instant Actions",displayName:"Stop",valueChangedToTrue:function(){var a=this._internal.animation,b=this._internal.animations;a.stop();for(var c=0;c<b.length;c++)b[c].stop()}},jumpToStart:{index:61,group:"Instant Actions",displayName:"Jump To Start",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToStart();this.sendSignalOnOutput("hasReachedStart")}},jumpToEnd:{index:62,group:"Instant Actions",displayName:"Jump To End",valueChangedToTrue:function(){for(var a=this._internal.animations,b=0;b<a.length;b++)a[b].jumpToEnd();this.sendSignalOnOutput("hasReachedEnd")}},cubicBezierP1X:{set:function(a){this._internal.cubicBezierPoints[0]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP1Y:{set:function(a){this._internal.cubicBezierPoints[1]=a,this.updateCubicBezierFunction()}},cubicBezierP2X:{set:function(a){this._internal.cubicBezierPoints[2]=Math.min(1,Math.max(0,a)),this.updateCubicBezierFunction()}},cubicBezierP2Y:{set:function(a){this._internal.cubicBezierPoints[3]=a,this.updateCubicBezierFunction()}}},outputs:{hasReachedStart:{type:"signal",group:"Signals",displayName:"Has Reached Start"},hasReachedEnd:{type:"signal",group:"Signals",displayName:"Has Reached End"}},dynamicports:[{name:"conditionalports/basic",condition:"easingCurve = cubicBezier",ports:[{name:"cubicBezierP1X",displayName:"P1 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:11},{name:"cubicBezierP1Y",displayName:"P1 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:12},{name:"cubicBezierP2X",displayName:"P2 X",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:13},{name:"cubicBezierP2Y",displayName:"P2 Y",group:"Cubic Bezier",plug:"input",type:{name:"number"},index:14}]},{name:"expand/basic",indexStep:100,template:[{name:"{{portname}}.startMode",type:{name:"enum",enums:[{value:"explicit",label:"Explicit"},{value:"implicit",label:"Implicit"}],allowEditOnly:!0},plug:"input",group:"{{portname}} Animation",displayName:"Start Mode","default":"implicit",index:1e3},{name:"{{portname}}.endValue",type:"number",plug:"input",group:"{{portname}} Animation",displayName:"End Value",editorName:"End Value | {{portname}} ","default":0,index:1002}]},{name:"expand/basic",condition:"'{{portname}}.startMode' = explicit",indexStep:100,template:[{name:"{{portname}}.startValue",plug:"input",type:"number",displayName:"Start Value",editorName:"Start Value | {{portname}}",group:"{{portname}} Animation","default":0,index:1001}]}],panels:[{name:"PortEditor",title:"Animations",plug:"output",type:{name:"number"},group:"Animation Values"}],prototypeExtensions:{updateCubicBezierFunction:{value:function(){var a=this._internal.cubicBezierPoints,b=g(a);this._internal.cubicBezierFunction=function(a,c,d){return f.linear(a,c,b.get(d))},this._internal.ease=this._internal.cubicBezierFunction}},_registerAnimationGroup:{value:function(a){var b=new d({node:this,ease:this._internal.ease,name:a});this._internal.animations.push(b);var c={};c[a+".startMode"]={set:function(a){b.startMode=a}},c[a+".startValue"]={"default":0,set:function(a){b.startValue=a}},c[a+".endValue"]={"default":0,set:function(a){b.endValue=a}},this.registerInputs(c),this.registerOutput(a,{getter:function(){return b.currentValue}})}},registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=a.indexOf("."),c=a.substr(0,b);this.hasOutput(c)||this._registerAnimationGroup(c)}}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this._registerAnimationGroup(a)}}}};b.exports=e.defineNode(j)},{"../easecurves":164,"../node":176,"../nodedefinition":178,"bezier-easing":2}],183:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a){var b=a.toString(16);return 1==b.length?"0"+b:b}function g(a){return"#"+f(a[0])+f(a[1])+f(a[2])}var h=a("../easecurves"),i=[0,0,0],j=[0,0,0],k=[0,0,0],l={name:"Color Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.resultColor="#000000",a.blendValue=0,a.colors=[]},numberedInputs:{color:{name:"numbered/simple-color",displayPrefix:"Color",createSetter:function(a){return function(b){this._internal.colors[a]=b,this.updateColor()}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value","default":0,set:function(a){this._internal.blendValue=a,this.updateColor()}}},outputs:{result:{type:"color",displayName:"Result",getter:function(){return this._internal.resultColor}}},prototypeExtensions:{updateColor:function(){function a(a){return b[a]?b[a]:"#000000"}var b=this._internal.colors;if(0!==b.length){var c=d(0,b.length-1,this._internal.blendValue),f=Math.floor(c),l=c-f;0===l?this._internal.resultColor=a(f):(e(i,a(f)),e(j,a(f+1)),k[0]=Math.floor(h.linear(i[0],j[0],l)),k[1]=Math.floor(h.linear(i[1],j[1],l)),k[2]=Math.floor(h.linear(i[2],j[2],l)),this._internal.resultColor=g(k)),this.flagOutputDirty("result")}}}};b.exports={node:l}},{"../easecurves":164}],184:[function(a,b,c){"use strict";b.exports={node:{name:"Component Inputs",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"output",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,category:"Component Utilities",initialize:function(){this._internal.outputs={}},prototypeExtensions:{registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:function(){return this.nodeScope.componentOwner._internal.inputValues[a]}})}}}}},{}],185:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.nodeScope=new f(a,this),this._internal.childRoot=null,this._internal.componentOutputValues={},this._internal.componentOutputs=[],this._internal.componentInputs=[],this._internal.inputValues={}}var e=a("../node"),f=a("../nodescope"),g=a("lodash");d.prototype=Object.create(e.prototype,{setComponentModel:{value:function(a){this.model=a;var b=this;this.nodeScope.setComponentModel(a),this._internal.componentInputs=this.nodeScope.getNodesWithType("Component Inputs"),this._internal.componentOutputs=this.nodeScope.getNodesWithType("Component Outputs"),g.values(a.getInputPorts()).forEach(this.registerComponentInputPort.bind(this)),g.values(a.getOutputPorts()).forEach(this.registerComponentOutputPort.bind(this)),a.roots&&a.roots.length>0&&this.setRoot(a.roots[0]),a.on("rootAdded",function(a){b._internal.root||b.setRoot(a)},this),a.on("rootRemoved",function(c){if(b._internal.root&&b._internal.root.id===c){var d=b._internal.visualParent;b.resetRoot();var e=a.getFirstRootId();e&&this.nodeScope.hasNodeWithId(e)&&(b.setRoot(a.getFirstRootId()),d&&d.addChild(b))}},this),a.on("inputPortAdded",this.registerComponentInputPort.bind(this),this),a.on("outputPortAdded",this.registerComponentOutputPort.bind(this),this),a.on("inputPortRemoved",function(a){b.hasInput(a.name)&&b.deregisterInput(a.name)},this),a.on("outputPortRemoved",function(a){this.hasOutput(a.name)&&b.deregisterOutput(a.name)},this),a.on("nodeAdded",function(a){"Component Inputs"===a.type?b._internal.componentInputs.push(b.nodeScope.getNodeWithId(a.id)):"Component Outputs"===a.type&&b._internal.componentOutputs.push(b.nodeScope.getNodeWithId(a.id))},this),a.on("nodeRemoved",function(a){"Component Inputs"===a.type?g.remove(b._internal.componentInputs,{id:a.id}):"Component Outputs"===a.type&&g.remove(b._internal.componentOutputs,{id:a.id})},this),a.on("renamed",function(a){b.name=a.newName},this)}},_onNodeDeleted:{value:function(){this.model&&(this.model.removeListenersWithRef(this),this.model=void 0),this.nodeScope.reset()}},registerComponentInputPort:{value:function(a){this.registerInput(a.name,{set:function(b,c){c?this._internal.inputValues[a.name]={value:b,unit:c}:this._internal.inputValues[a.name]=b,this._internal.componentInputs.forEach(function(b){b.registerOutputIfNeeded(a.name),b.flagOutputDirty(a.name)})}})}},registerComponentOutputPort:{value:function(a){this.registerOutput(a.name,{getter:function(){return this._internal.componentOutputValues[a.name]}})}},setOutputFromComponentOutput:{value:function(a,b){this.hasOutput(a)!==!1&&(this._internal.componentOutputValues[a]=b,this.flagOutputDirty(a))}},setRoot:{value:function(a){if(!a)throw Error("id must be set");var b=this.nodeScope.getNodeWithId(a);if(b.getVisualRoot){this._internal.root&&this.resetRoot(),this._internal.root=b;var c=b.getVisualRoot();c&&(c._internal.visualParent&&c._internal.visualParent.removeChild(this._internal.root),void 0===c.componentIds&&(c.componentIds=[]),-1===c.componentIds.indexOf(this.id)&&c.componentIds.push(this.id))}}},resetRoot:{value:function(){this._internal.visualParent&&this._internal.visualParent.removeChild(this);var a=this._internal.root.getVisualRoot();if(this._internal.root=void 0,a&&a.componentIds){var b=a.componentIds.indexOf(this.id);-1!==b&&a.componentIds.splice(b,1)}}},setChildRoot:{value:function(a){var b=this._internal.childRoot,c=a;if(this._internal.childRoot=c,this.model.children){var d=this.parentNodeScope,e=this.model.children.map(function(a){return d.getNodeWithId(a.id)});if(b)for(var f=0;f<e.length;f++)b.isChild(e[f])&&b.removeChild(e[f]);if(c)for(var f=0;f<e.length;f++){var g=e[f],h=g.model.parent.children.indexOf(g.model);this.addChild(g,h)}}}},getChildRootIndex:{value:function(){if(!this._internal.childRoot||!this._internal.childRoot.model||!this._internal.childRoot.model.children)return 0;for(var a=this._internal.childRoot.model.children,b=0;b<a.length;b++)if("Component Children"===a[b].type)return b;return 0}},getChildRoot:{value:function(){return this._internal.childRoot?this._internal.childRoot:this._internal.root.getChildRoot()}},getVisualRoot:{value:function(){return this._internal.root?this._internal.root.getVisualRoot():void 0}},addChild:{value:function(a,b){this.getChildRoot().addChild(a,b+this.getChildRootIndex())}},flagDirty:{value:function(){if(!this._dirty){e.prototype.flagDirty.call(this);for(var a=this._internal.componentInputs,b=0,c=a.length;c>b;b++)a[b].flagDirty();this._internal.componentOutputs.forEach(function(a){a.flagDirty()})}}},setHighlightEnabled:{value:function(a){var b=this.getVisualRoot();b&&b.setHighlightEnabled&&b.setHighlightEnabled(a)}},update:{value:function(){e.prototype.update.call(this),this._internal.componentOutputs.forEach(function(a){a.update()})}}}),d.prototype.constructor=d,b.exports=d},{"../node":176,"../nodescope":255,lodash:117}],186:[function(a,b,c){"use strict";b.exports={node:{category:"Component Utilities",name:"Component Outputs",panels:[{name:"PortEditor",context:["select","connectTo"],title:"Outputs",plug:"input",type:{name:"*"},canArrangeInGroups:!0},{name:"PropertyEditor",hidden:!0}],color:"component",haveComponentPorts:!0,prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.nodeScope.componentOwner.setOutputFromComponentOutput(a,b)}})}}}}},{}],187:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Counter",category:"Math",initialize:function(){this._internal.currentValue=0,this._internal.startValue=0,this._internal.startValueSet=!1,this._internal.limitsEnabled=!1,this._internal.limitsMin=0,this._internal.limitsMax=0},inputs:{increase:{displayName:"Increase Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue>=this._internal.limitsMax||(this._internal.currentValue++,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},decrease:{displayName:"Decrease Count",valueChangedToTrue:function(){this._internal.limitsEnabled&&this._internal.currentValue<=this._internal.limitsMin||(this._internal.currentValue--,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},reset:{displayName:"Reset To Start",valueChangedToTrue:function(){0!==this.currentValue&&(this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},startValue:{type:"number",displayName:"Start Value","default":0,set:function(a){this._internal.startValue=Number(a),this._internal.startValueSet===!1&&(this._internal.startValueSet=!0,this._internal.currentValue=this._internal.startValue,this.flagOutputDirty("currentCount"),this.sendSignalOnOutput("countChanged"))}},limitsMin:{type:{name:"number"},displayName:"Min Value",group:"Limits","default":0,set:function(a){this._internal.limitsMin=Number(a)}},limitsMax:{type:{name:"number"},displayName:"Max Value",group:"Limits","default":0,set:function(a){this._internal.limitsMax=Number(a)}},limitsEnabled:{type:{name:"boolean"},displayName:"Limits Enabled",group:"Limits","default":!1,set:function(a){this._internal.limitsEnabled=a?!0:!1}}},outputs:{currentCount:{displayName:"Current Count",type:"number",getter:function(){return this._internal.currentValue}},countChanged:{displayName:"Count Changed",type:"signal"}}})},{"../nodedefinition":178}],188:[function(a,b,c){"use strict";function d(){this.items=[]}var e=a("./model"),f=a("lodash"),g={};d.get=function(a){return void 0===a&&(a=e.guid()),g[a]||(g[a]=new d),g[a]},d.exists=function(a){return void 0!==g[a]},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);-1!==c&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=f.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.set=function(a){function b(a){for(var b={},c=a.length,d=0;c>d;d++){var e=a[d];b[e.getId()]=e}return b}var c,f;if(a!==this){var a=a instanceof d?a.items:a,g=[];for(c=a.length,f=0;c>f;f++){var h=a[f];h instanceof e?g.push(h):g.push(e.create(h))}var i=this.items,j=b(i),k=b(g);for(c=i.length,f=0;c>f;f++)k.hasOwnProperty(i[f].getId())||(this.removeAtIndex(f),f--,c--);for(f=0;f<Math.min(i.length,g.length);f++)i[f]!==g[f]&&(j.hasOwnProperty(g[f].getId())&&this.remove(g[f]),this.addAtIndex(g[f],f));for(f=i.length;f<g.length;f++)this.add(g[f])}},d.prototype.contains=function(a){return-1!==this.items.indexOf(a)},d.prototype.add=function(a){this.contains(a)||(this.items.push(a),this.notify("add",{item:a}),this.notify("change"),a.notify("add",{collection:this}))},d.prototype.addAtIndex=function(a,b){this.contains(a)||(this.items.splice(b,0,a),this.notify("add",{item:a,index:b}),this.notify("change"),a.notify("add",{collection:this,index:b}))},d.prototype.removeAtIndex=function(a){var b=this.items[a];this.items.splice(a,1),this.notify("remove",{item:b,index:a}),this.notify("change"),b.notify("remove",{collection:this})},d.prototype.remove=function(a){var b=this.items.indexOf(a);-1!==b&&this.removeAtIndex(b)},d.prototype.size=function(){return this.items.length},d.prototype.get=function(a){return this.items[a]},d.prototype.each=function(a){for(var b=0;b<this.items.length;b++)a(this.items[b],b)},b.exports=d},{"./model":192,lodash:117}],189:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("./model"),g=a("./collection"),h=a("./persisthelper"),i=a("lodash");h.setDeltaHandlerForType("collection",function(a,b){for(var c=g.get(a),d=0,e=b.removed.length;e>d;d++){var h=b.removed[d];c.remove(f.get(h))}for(var d=0,e=b.added.length;e>d;d++){var i,j=b.added[d];i=f.exists(j.id)?f.get(j.id):f.create(j),c.add(i)}}),h.setInitialFetchHandlerForType("collection",function(a,b){var c=g.get(a);if(c){for(var d=[],e=0,h=b.length;h>e;e++){var i,j=b[e];i=f.exists(j.id)?f.get(j.id):f.create(j),d.push(i)}c.set(d)}});var j={name:"Collection",category:"Data",usePortAsLabel:"collectionId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"persistType = local OR persistType = global",ports:[{name:"persist",plug:"input",type:"signal",displayName:"Persist",group:"Persistence"},{name:"fetch",plug:"input",type:"signal",displayName:"Fetch",group:"Persistence"},{name:"persistWorking",plug:"output",type:"boolean",displayName:"In Progress",group:"Persistence"},{name:"persistSuccess",plug:"output",type:"signal",displayName:"Persist Success",group:"Persistence"},{name:"persistFailure",plug:"output",type:"signal",displayName:"Persist Failure",group:"Persistence"},{name:"fetchSuccess",plug:"output",type:"signal",displayName:"Fetch Success",group:"Persistence"},{name:"fetchFailure",plug:"output",type:"signal",displayName:"Fetch Failure",group:"Persistence"}]}],initialize:function(){var a=this,b=!1;this._internal.collectionChangedCallback=function(){b||(b=!0,a.scheduleAfterInputsHaveUpdated(function(){a.sendSignalOnOutput("modified"),a.flagOutputDirty("count"),b=!1}))},this._internal.copySourceItemsCallback=function(){a.copySourceItems()},this._internal.persistHelper=new h({scheduleFunction:this.scheduleAfterInputsHaveUpdated.bind(this),onPersistDataNeeded:function(){var b=a._internal.collection;if(b){var c=[];return b.each(function(a){c.push(a.getId())}),c}},onPersistSuccess:function(){a.sendSignalOnOutput("persistSuccess")},onPersistFailure:function(){a.sendSignalOnOutput("persistFailure")},onFetchSuccess:function(b){var c=a._internal.collection;if(c){for(var d=[],e=0,g=b.length;g>e;e++){var h,i=b[e];h=f.exists(i.id)?f.get(i.id):f.create(i),d.push(h)}c.set(d)}a.sendSignalOnOutput("fetchSuccess")},onFetchFailure:function(){a.sendSignalOnOutput("fetchFailure")},onWorkingChanged:function(){a.flagOutputDirty("persistWorking")}})},inputs:{collectionId:{type:"string",displayName:"Id",group:"General",set:function(a){this.setCollectionID(a)}},items:{type:"collection",group:"Modify",displayName:"Items",set:function(a){if(a&&a!==this._internal.sourceItems)if(a instanceof g)this.bindSourceCollection(a),this.scheduleCopySourceItems();else if(i.isArray(a)){var b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){b.collection&&b.collection.set(a)})}}},modifyId:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Item Id",group:"Modify",set:function(a){this._internal.modifyId=a}},add:{displayName:"Add",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(b.modifyId){var c=f.get(b.modifyId);b.collection.add(c),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()}})}},remove:{displayName:"Remove",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(b.modifyId){var c=f.get(b.modifyId);b.collection.remove(c),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()}})}},clear:{displayName:"Clear",group:"Modify",valueChangedToTrue:function(){var a=this,b=this._internal;this.scheduleAfterInputsHaveUpdated(function(){b.collection.set([]),a.sendSignalOnOutput("modified"),"sync"===a._internal.persistHelper.persistType&&a._internal.persistHelper.schedulePersist()})}},persistType:{displayName:"Type",group:"Persistence",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"local",label:"Local"},{value:"global",label:"Global"},{value:"sync",label:"Sync"}]},"default":"none",set:function(a){this._internal.persistHelper.setPersistType(a)}},persist:{displayName:"Persist",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.schedulePersist()}},fetch:{displayName:"Fetch",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.scheduleFetch()}}},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.name}},items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}},count:{type:"number",displayName:"Count",group:"General",getter:function(){return this._internal.collection?this._internal.collection.size():0}},modified:{group:"Events",type:"signal",displayName:"Modified"},persistWorking:{displayName:"In Progress",group:"Persistence",type:"boolean",getter:function(){return this._internal.persistHelper.isWorking()}},persistSuccess:{displayName:"Persist Success",group:"Persistence",type:"signal"},persistFailure:{displayName:"Persist Failure",group:"Persistence",type:"signal"},fetchSuccess:{displayName:"Fetch Success",group:"Persistence",type:"signal"},fetchFailure:{displayName:"Fetch Failure",group:"Persistence",type:"signal"}},prototypeExtensions:{setCollectionID:function(a){this._internal.name=a,this.setCollection(g.get(a)),this.flagOutputDirty("id"),this._internal.persistHelper.setId("collection/"+a)},setCollection:function(a){this.bindCollection(a),this.flagOutputDirty("items"),this.flagOutputDirty("count")},unbindSourceCollection:function(){var a=this._internal;a.sourceItems&&a.sourceItems instanceof g&&(a.sourceItems.off("change",this._internal.copySourceItemsCallback),a.sourceItems=void 0)},bindSourceCollection:function(a){var b=this._internal;this.unbindSourceCollection(),b.sourceItems=a,a instanceof g&&a.on("change",this._internal.copySourceItemsCallback)},unbindCurrentCollection:function(){var a=this._internal.collection;a&&(a.off("change",this._internal.collectionChangedCallback),this._internal.collection=void 0)},bindCollection:function(a){this.unbindCurrentCollection(),this._internal.collection=a,a.on("change",this._internal.collectionChangedCallback)},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()},scheduleCopySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems||(a.hasScheduledCopySourceItems=!0,this.scheduleAfterInputsHaveUpdated(this.copySourceItems.bind(this)))},copySourceItems:function(){var a=this._internal;a.hasScheduledCopySourceItems=!1,(a.collection||void 0!==a.idType&&"explicit"!==a.idType)&&(a.collection||"unique"!==a.idType||this.newCollectionID(),a.collection.set(a.sourceItems))}}},k=d.defineNode(j);b.exports=k},{"../../node":176,"../../nodedefinition":178,"./collection":188,"./model":192,"./persisthelper":194,lodash:117}],190:[function(a,b,c){"use strict";var d=a("../../nodedefinition"),e=a("../../node"),f=a("../../guid"),g="// model item is available in item variable\n// set the component variable to the name of the desired component for this\n// item. Component name must start with a '/'.\ncomponent = '/MyComponent';",h={name:"For Each",color:"data",category:"Visual",dynamicports:[{name:"conditionalports/basic",condition:"templateType = explicit OR templateType NOT SET",ports:[{name:"template",plug:"input",type:"component",displayName:"Component",group:"Appearance"}]},{name:"conditionalports/basic",condition:"templateType = dynamic",ports:[{name:"templateScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script","default":g,group:"Appearance"}]}],initialize:function(){this._internal.itemNodes=[];var a=this;this._internal.onAddItem=function(b){a.addItem(b.item,b.index)},this._internal.onRemoveItem=function(b){a.removeItem(b.item)}},inputs:{items:{group:"Data",displayName:"Items",type:{name:"collection",allowConnectionsOnly:!0},set:function(a){a&&a!==this._internal.items&&(this.bindCollection(a),this.scheduleRefresh())}},templateType:{group:"Appearance",displayName:"Template Type",type:{name:"enum",enums:[{label:"Explicit",value:"explicit"},{label:"Dynamic",value:"dynamic"}]},"default":"explicit",set:function(a){this._internal.templateType=a,this.scheduleRefresh()}},template:{set:function(a){this._internal.template=a,this.scheduleRefresh()}},templateScript:{set:function(a){try{this._internal.templateFunction=new Function("item","var component;"+a+";return component;")}catch(b){console.log(b),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-syntax-warning",{message:"<strong>Syntax</strong>: "+b.message})}this.scheduleRefresh()}},refresh:{group:"Appearance",displayName:"Refresh",type:"signal",valueChangedToTrue:function(){this.scheduleRefresh()}}},prototypeExtensions:{updateTarget:function(a){this._internal.target=a?this.nodeScope.getNodeWithId(a):void 0,this.scheduleRefresh()},setNodeModel:function(a){e.prototype.setNodeModel.call(this,a),a.parent&&this.updateTarget(a.parent.id);var b=this;a.on("parentUpdated",function(a){b.updateTarget(a?a.id:void 0)},this)},scheduleRefresh:function(){var a=this,b=this._internal;b.hasScheduledRefresh||(b.hasScheduledRefresh=!0,this.scheduleAfterInputsHaveUpdated(function(){a.refresh()}))},unbindCurrentCollection:function(){var a=this._internal.items;a&&(a.off("add",this._internal.onAddItem),a.off("remove",this._internal.onRemoveItem),this._internal.collection=void 0)},bindCollection:function(a){var b=this._internal;this.unbindCurrentCollection(),a.on("add",this._internal.onAddItem),a.on("remove",this._internal.onRemoveItem),b.items=a},getTemplateForModel:function(a){var b=this._internal;if(void 0===b.templateType||"explicit"===b.templateType)return b.template;if(b.templateFunction){try{var c=b.templateFunction(a)}catch(d){console.log(d),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"foreach-dynamic-warning",{message:"<strong>Dynamic template</strong>: "+d.message})}return c}},addItem:function(a,b){var c=this._internal,d=this.getTemplateForModel(a);if(d){var e=this.nodeScope.createNode(d,f());e._forEachModel=a;var g=e.nodeScope.getNodesWithType("For Each Actions");if(g&&g.length>0)for(var h=0;h<g.length;h++)g[h].setItemId(a.getId()),g[h].signalAdded();c.itemNodes.push(e),c.target.addChild(e,b)}},removeItem:function(a){function b(){var b=c.target._internal.children;for(var d in b){var e=b[d];
if(e._forEachModel===a&&!e._forEachRemoveInProgress)return e}}var c=this._internal,d=b();if(d){var e=d.nodeScope.getNodesWithType("For Each Actions");e&&e.length>0?(d._forEachRemoveInProgress=!0,e[0].tryRemove(function(){c.target.removeChild(d),c.target.nodeScope.deleteNode(d)})):(c.target.removeChild(d),c.target.nodeScope.deleteNode(d));var f=c.itemNodes.indexOf(d);-1!==f&&c.itemNodes.splice(f,1)}},refresh:function(){var a=this._internal;if(a.hasScheduledRefresh=!1,(a.template||a.templateFunction)&&a.items&&a.target){for(var b=0;b<a.itemNodes.length;b++)a.target.removeChild(a.itemNodes[b]);a.itemNodes=[];for(var b=0;b<a.items.size();b++){var c=a.items.get(b);this.addItem(c)}}},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.unbindCurrentCollection()}}};b.exports=d.defineNode(h)},{"../../guid":170,"../../node":176,"../../nodedefinition":178}],191:[function(a,b,c){"use strict";var d={name:"For Each Actions",displayNodeName:"For Each Item",category:"Data",color:"data",inputs:{removeCompleted:{type:{name:"boolean",allowConnectionsOnly:!0},displayName:"Remove Completed",group:"Events",valueChangedToTrue:function(){this._internal.removeCompletedCallback&&this._internal.removeCompletedCallback()}}},outputs:{added:{type:"signal",displayName:"Added",group:"Events"},tryRemove:{type:"signal",displayName:"Try Remove",group:"Events"},itemId:{type:"string",displayName:"Item Id",group:"General",getter:function(){return this._internal.itemId}}},prototypeExtensions:{setItemId:function(a){this._internal.itemId=a,this.flagOutputDirty("itemId")},signalAdded:function(){this.sendSignalOnOutput("added")},tryRemove:function(a){this.getOutput("tryRemove").hasConnections()?(this._internal.removeCompletedCallback=a,this.sendSignalOnOutput("tryRemove")):this.scheduleAfterInputsHaveUpdated(function(){a()})}}};b.exports={node:d}},{}],192:[function(a,b,c){function d(a,b){this.id=a,this.data=b}var e=a("lodash"),f={};d.get=function(a){return void 0===a&&(a=d.guid()),f[a]||(f[a]=new d(a,{})),f[a]},d.create=function(a){var b=a?a:{},c=d.get(b.id);for(var e in b)"id"!==e&&c.set(e,b[e]);return c},d.exists=function(a){return void 0!==f[a]},d.guid=function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()},d.prototype.on=function(a,b){this.listeners||(this.listeners={}),this.listeners[a]||(this.listeners[a]=[]),this.listeners[a].push(b)},d.prototype.off=function(a,b){if(this.listeners&&this.listeners[a]){var c=this.listeners[a].indexOf(b);-1!==c&&this.listeners[a].splice(c,1)}},d.prototype.notify=function(a,b){if(this.listeners&&this.listeners[a])for(var c=e.clone(this.listeners[a]),d=0;d<c.length;d++)c[d](b)},d.prototype.setAll=function(a){for(var b in a)if("id"!==b&&this.data[b]!==a[b]){var c=this.data[b];this.data[b]=a[b],this.notify("change",{name:b,value:a[b],old:c})}},d.prototype.set=function(a,b,c){if(c&&c.resolve&&-1!==a.indexOf(".")){for(var e=a.split("."),f=this,g=0;g<e.length-1;g++){var h=f.get(e[g]);if(!(h instanceof d))return;f=h}return void f.set(e[e.length-1],b)}var i=this.data[a];this.data[a]=b,i!==b&&(!c||!c.silent)&&this.notify("change",{name:a,value:b,old:i})},d.prototype.getId=function(){return this.id},d.prototype.get=function(a,b){if(b&&b.resolve&&-1!==a.indexOf(".")){for(var c=a.split("."),e=this,f=0;f<c.length-1;f++){var g=e.get(c[f]);if(!(g instanceof d))return;e=g}return e.get(c[c.length-1])}return this.data[a]},b.exports=d},{lodash:117}],193:[function(a,b,c){"use strict";function d(a){return this._internal.model?this._internal.model.get(a,{resolve:!0}):void 0}function e(a,b){this._internal.inputValues[a]=b}function f(a,b,c){var d=[];b=b?b.split(","):void 0;for(var e in b){var f=b[e];d.push({type:{name:"*",allowConnectionsOnly:!0},plug:"input/output",group:"Properties",name:f})}var g=JSON.stringify(d);j[a]!==g&&(j[a]=g,c.sendDynamicPorts(a,d))}var g=a("./model"),h=(a("../../edgetriggeredinput"),a("../../node")),i=a("./persisthelper"),j={};i.setDeltaHandlerForType("model",function(a,b){var c=g.get(a);for(var d in b)c.set(d,b[d])}),i.setInitialFetchHandlerForType("model",function(a,b){var c=g.get(a);c&&c.setAll(b)});var k={name:"Model",category:"Data",usePortAsLabel:"modelId",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"persistType = local OR persistType = global",ports:[{name:"persist",plug:"input",type:"signal",displayName:"Persist",group:"Persistence"},{name:"fetch",plug:"input",type:"signal",displayName:"Fetch",group:"Persistence"},{name:"persistWorking",plug:"output",type:"boolean",displayName:"In Progress",group:"Persistence"},{name:"persistSuccess",plug:"output",type:"signal",displayName:"Persist Success",group:"Persistence"},{name:"persistFailure",plug:"output",type:"signal",displayName:"Persist Failure",group:"Persistence"},{name:"fetchSuccess",plug:"output",type:"signal",displayName:"Fetch Success",group:"Persistence"},{name:"fetchFailure",plug:"output",type:"signal",displayName:"Fetch Failure",group:"Persistence"}]}],initialize:function(){var a=this._internal;a.inputValues={};var b=this;this._internal.onModelChangedCallback=function(a){b.hasOutput(a.name)&&b.flagOutputDirty(a.name)},this._internal.persistHelper=new i({scheduleFunction:this.scheduleAfterInputsHaveUpdated.bind(this),onPersistDataNeeded:function(){for(var c in a.inputValues)a.model.set(c,a.inputValues[c],{resolve:!0});return b.sendSignalOnOutput("stored"),a.model.data},onPersistSuccess:function(){b.sendSignalOnOutput("persistSuccess")},onPersistFailure:function(){b.sendSignalOnOutput("persistFailure")},onFetchSuccess:function(c){a.model.setAll(c),b.sendSignalOnOutput("fetchSuccess")},onFetchFailure:function(){b.sendSignalOnOutput("fetchFailure")},onWorkingChanged:function(){b.flagOutputDirty("persistWorking")}})},outputs:{id:{type:"string",displayName:"Id",group:"General",getter:function(){return this._internal.model?this._internal.model.getId():void 0}},stored:{type:"signal",displayName:"Stored",group:"Events"},persistWorking:{displayName:"In Progress",group:"Persistence",type:"boolean",getter:function(){return this._internal.persistHelper.isWorking()}},persistSuccess:{displayName:"Persist Success",group:"Persistence",type:"signal"},persistFailure:{displayName:"Persist Failure",group:"Persistence",type:"signal"},fetchSuccess:{displayName:"Fetch Success",group:"Persistence",type:"signal"},fetchFailure:{displayName:"Fetch Failure",group:"Persistence",type:"signal"}},inputs:{modelId:{type:"string",displayName:"Id",group:"General",set:function(a){this.setModelID(a)}},properties:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Properties",group:"Properties",set:function(a){}},store:{displayName:"Store",group:"Actions",valueChangedToTrue:function(){this.scheduleStore()}},clear:{displayName:"Clear",group:"Actions",valueChangedToTrue:function(){var a=this._internal;if(a.model)for(var b in a.inputValues)a.model.set(b,void 0,{resolve:!0})}},persistType:{displayName:"Type",group:"Persistence",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"local",label:"Local"},{value:"global",label:"Global"},{value:"sync",label:"Sync"}]},"default":"none",set:function(a){this._internal.persistHelper.setPersistType(a)}},persist:{displayName:"Persist",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.schedulePersist()}},fetch:{displayName:"Fetch",group:"Persistence",valueChangedToTrue:function(){this._internal.persistHelper.scheduleFetch()}}},prototypeExtensions:{scheduleStore:function(){if(!this.hasScheduledStore){this.hasScheduledStore=!0;var a=this._internal;this.scheduleAfterInputsHaveUpdated(function(){if(this.hasScheduledStore=!1,a.model){for(var b in a.inputValues)a.model.set(b,a.inputValues[b],{resolve:!0});this.sendSignalOnOutput("stored"),"sync"===this._internal.persistHelper.persistType&&this._internal.persistHelper.schedulePersist()}})}},setModelID:function(a){var b=g.get(a);this.setModel(b),this._internal.persistHelper.setId("model/"+a)},setModel:function(a){this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.model=a,this.flagOutputDirty("id"),a.on("change",this._internal.onModelChangedCallback);for(var b in a.data)this.hasOutput(b)&&this.flagOutputDirty(b)},_onNodeDeleted:function(){h.prototype._onNodeDeleted.call(this),this._internal.model&&this._internal.model.off("change",this._internal.onModelChangedCallback),this._internal.persistHelper.unsubscribe()},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Model",function(b){b.parameters.properties&&f(b.id,b.parameters.properties,a.editorConnection),b.on("parameterUpdated",function(c){"properties"===c.name&&f(b.id,b.parameters.properties,a.editorConnection)})})}}},{"../../edgetriggeredinput":165,"../../node":176,"./model":192,"./persisthelper":194}],194:[function(a,b,c){"use strict";function d(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}function e(a){var b=a.topic.substring("ndl/persist/getaccepted/".length);if(m[b]===a.payload.clientToken){var c=b.split("/")[0],d=b.substring(c.length+1);n[c](d,a.payload.data)}}function f(a){m[a]||(k.pubsub.subscribe("ndl/persist/getaccepted/"+a,e),m[a]=d(),k.pubsub.publish("ndl/persist/get/"+a,{clientToken:m[a]}))}function g(){o||(o=!0,k.pubsub.on("connected",function(){for(var a in m)k.pubsub.publish("ndl/persist/get/"+a,{clientToken:m[a]})}))}function h(a){var b=a.topic.substring("ndl/persist/delta/".length);if(p[b]){var c=b.split("/")[0],d=b.substring(c.length+1);q[c](d,a.payload.delta)}}function i(a){p[a]?p[a].cnt++:(p[a]={cnt:1},k.pubsub.subscribe("ndl/persist/delta/"+a,h))}function j(a){p[a]&&(p[a].cnt--,0===p[a].cnt&&(k.pubsub.unsubscribe("ndl/persist/delta/"+a,h),delete p[a],delete m[a]))}var k=a("../../services/services"),l=function(a){for(var b in a)this[b]=a[b];this.hasScheduled={},g()},m={},n={};l.setInitialFetchHandlerForType=function(a,b){n[a]=b};var o=!1,p={},q={};l.setDeltaHandlerForType=function(a,b){q[a]=b},l.prototype.setId=function(a){this.id=a;var b=this;this.schedule("subscribeToPersistService",function(){b.subscribeToPersistService()})},l.prototype.isWorking=function(){return!!this.persistWorking},l.prototype.setPersistType=function(a){this.persistType=a;var b=this;this.schedule("subscribeToPersistService",function(){b.subscribeToPersistService()})},l.prototype.schedule=function(a,b){var c=this;this.hasScheduled[a]||(this.hasScheduled[a]=!0,this.scheduleFunction(function(){b(),c.hasScheduled[a]=!1}))},l.prototype.unsubscribe=function(){this.lastSubscribedId&&(k.pubsub.unsubscribe("ndl/persist/updateaccepted/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/updaterejected/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/getaccepted/"+this.lastSubscribedId,this.messageHandler),k.pubsub.unsubscribe("ndl/persist/getrejected/"+this.lastSubscribedId,this.messageHandler),j(this.lastSubscribedId))},l.prototype.handleMessage=function(a){0===a.topic.indexOf("ndl/persist/updateaccepted/")?a.payload.clientToken===this.persistUpdateClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onPersistSuccess()):0===a.topic.indexOf("ndl/persist/updaterejected/")?a.payload.clientToken===this.persistUpdateClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onPersistFailure()):0===a.topic.indexOf("ndl/persist/getaccepted/")?a.payload.clientToken===this.persistGetClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onFetchSuccess(a.payload.data)):0===a.topic.indexOf("ndl/persist/getrejected/")&&a.payload.clientToken===this.persistGetClientToken&&(this.persistWorking=!1,this.onWorkingChanged(this.persistWorking),this.onFetchFailure())},l.prototype.subscribeToPersistService=function(){var a=""!==this.id?this.id:void 0;("global"===this.persistType||"sync"===this.persistType)&&this.lastSubscribedId!==a&&(this.unsubscribe(),this.lastSubscribedId=a,void 0!==a&&("global"===this.persistType||"sync"===this.persistType)&&(this.messageHandler=this.handleMessage.bind(this),k.pubsub.subscribe("ndl/persist/updateaccepted/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/updaterejected/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/getaccepted/"+a,this.messageHandler),k.pubsub.subscribe("ndl/persist/getrejected/"+a,this.messageHandler),"sync"===this.persistType&&(i(a),f(a))))},l.prototype.schedulePersist=function(){var a=this;this.schedule("schedulePersist",function(){a.persistData(a.onPersistDataNeeded())})},l.prototype.persistData=function(a){if(a){var b=this.persistType,c=this.id;if("local"===b)try{localStorage["noodl-persist-"+c]=JSON.stringify(a),this.onPersistSuccess()}catch(e){this.onPersistFailure()}else("global"===b||"sync"===b)&&(this.persistUpdateClientToken=d(),k.pubsub.publish("ndl/persist/update/"+c,{data:a,clientToken:this.persistUpdateClientToken}),this.persistWorking=!0,this.onWorkingChanged(this.persistWorking))}},l.prototype.scheduleFetch=function(){var a=this;this.schedule("scheduleFetch",function(){a.fetchData()})},l.prototype.fetchData=function(){var a=this.persistType,b=this.id;if("local"===a)try{var c=localStorage["noodl-persist-"+b],e=JSON.parse(c?c:"{}");if(0===b.indexOf("collection/")){for(var f=[],g=0;g<e.length;g++){var h=localStorage["noodl-persist-model/"+e[g]],i=JSON.parse(h?h:"{}");i.id=e[g],f.push(i)}this.onFetchSuccess(f)}else this.onFetchSuccess(e)}catch(j){this.onFetchFailure()}else("global"===a||"sync"===a)&&(this.persistGetClientToken=d(),k.pubsub.publish("ndl/persist/get/"+b,{clientToken:this.persistGetClientToken}),this.persistWorking=!0,this.onWorkingChanged(this.persistWorking))},b.exports=l},{"../../services/services":262}],195:[function(a,b,c){"use strict";function d(a){return this._internal.responseOutputs[a]}function e(a,b){this._internal.requestInputs[a]=b}function f(a,b){function c(a){for(var b=0;b<d.length;b++)if(d[b].name===a)return!0;return!1}if(a.parameters){var d=[];if(a.parameters.resource){var e=a.parameters.resource.match(/\{[A-Za-z0-9_]*\}/g);for(var f in e){var h=e[f],i=h.replace("{","").replace("}","");d.push({name:i,type:"string",plug:"input",group:"Inputs"})}}if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var j=a.parameters.externalFile,k=void 0!==b;k&&"/"!==j[0]&&(j="/"+j),g.createFromURL(j,null,function(e){e.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)})}else if(a.parameters.code){var l=g.createFromCode(a.parameters.code,null);l.getPorts().forEach(function(a){c(a.name)||d.push(a)}),b.sendDynamicPorts(a.id,d)}}}var g=(a("../../nodedefinition"),a("../../node"),a("../../guid"),a("../../javascriptnodeparser")),h=a("xml2js"),i="define({\n	// The input ports of the REST node, name of input and type\n	inputs:{\n	    //ExampleInput:'number',\n	},\n	\n	// The output ports of the REST node, name of output and type\n	outputs:{\n	    //ExampleOutput:'string',\n	},\n	\n	//Add custom code to setup the request object before the request\n	//is made.\n	//\n	//*request.resource     contains the resource path of the request.\n	//*request.method       contains the method, GET, POST, PUT or DELETE.\n	//*request.headers      is a map where you can add additional headers.\n	//*request.parameters   is a map the parameters that will be appended\n	//                      to the url.\n	//*request.content      contains the content of the request as a javascript\n	//                      object.\n	//\n	// The inputs and outputs maps can also be accessed via *this.inputs and\n	// *this.outputs.\n	request:function(inputs,request) {\n	},\n	\n	// Add custom code to convert the response content to outputs\n	//\n	//*response.status    The status code of the response\n	//*response.content   The content of the response as a javascript\n	//                    object.\n	//*response.request   The request object that resulted in the response.\n	//\n	// The inputs and outputs maps can also be accessed via *this.inputs and\n	// *this.outputs.\n	response:function(outputs,response) {\n	}\n})\n",j="//Add prototype backend code to response to the request\n//\n//*context.request                      contains the request object as passed from the\n//                                      request script.\n//*context.sendResponse(status,content) should be called to send a response back\n//                                      to the request script with status code\n//                                      and a javascript object with the content\n//                                      of the response.\ncontext.sendResponse(200,{result:'success'});\n",k={name:"REST",category:"Data",color:"data",initialize:function(){this._internal.requestInputs={},this._internal.responseOutputs={},this._internal.backendProperties={},this._internal.hasPendingFetch=!1,this._internal.useExternalFile=!1},dynamicports:[{name:"conditionalports/basic",condition:"backendType = external OR backendType NOT SET",ports:[{name:"backendEndpoint",plug:"input",type:{name:"string"},displayName:"Endpoint",group:"Backend"}]},{name:"conditionalports/basic",condition:"backendType = prototype",ports:[{name:"backendScript",plug:"input",type:{name:"string",codeeditor:"javascript",allowEditOnly:!0},displayName:"Script","default":j,group:"Backend"}]},{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Script",group:"Request",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},"default":i}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Request",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{resource:{type:"string",displayName:"Resource",group:"Request","default":"/",set:function(a){this._internal.resource=a}},method:{type:{name:"enum",enums:[{label:"GET",value:"GET"},{label:"POST",value:"POST"},{label:"DELETE",value:"DELETE"},{label:"PUT",value:"PUT"}]},displayName:"Method",group:"Request","default":"GET",set:function(a){this._internal.method=a}},useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},"default":"no",displayName:"Use External File",group:"Request",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){a&&this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){var b=g.createFromCode(a,this.nodeScope.noodlJavascriptAPI);this._onCodeParsed(b)}})}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;g.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a),b._internal.hasPendingFetch===!0&&(b._internal.hasPendingFetch=!1,b.doFetch())})}}},fetch:{type:"signal",displayName:"Fetch",group:"Actions",valueChangedToTrue:function(){this.scheduleFetch()}},cancel:{type:"signal",displayName:"Cancel",group:"Actions",valueChangedToTrue:function(){this.cancelFetch()}},backendType:{type:{name:"enum",enums:[{label:"External",value:"external"},{label:"Prototype",value:"prototype"}],allowEditOnly:!0},displayName:"Backend type",group:"Backend","default":"external",set:function(a){this._internal.backendType=a}}},outputs:{fetching:{type:"boolean",displayName:"Fetching",group:"Status",getter:function(){return!!this._internal.fetching}},started:{type:"signal",displayName:"Started",group:"Signals"},completed:{type:"signal",displayName:"Completed",group:"Signals"},statusOK:{type:"signal",displayName:"Status OK",group:"Signals"},statusFail:{type:"signal",displayName:"Status Fail",group:"Signals"}},prototypeExtensions:{_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error})),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.requestFunction=a.definedObject.request,this._internal.responseFunction=a.definedObject.response}},registerOutputIfNeeded:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:d.bind(this,a)})},registerInputIfNeeded:function(a){var b=this;this.hasInput(a)||(0===a.indexOf("backend")?this.registerInput(a,{set:function(c){b._internal.backendProperties[a]=c}}):this.registerInput(a,{set:e.bind(this,a)}))},scheduleFetch:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doFetch.bind(this)))},doResponse:function(a,b,c){if(this._internal.responseFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.responseFunction.apply(d,[this._internal.responseOutputs,{status:a,content:b,request:c}])}for(var e in this._internal.responseOutputs)this.hasOutput(e)&&this.flagOutputDirty(e);200===a?this.sendSignalOnOutput("statusOK"):this.sendSignalOnOutput("statusFail"),this._internal.fetching=!1,this.flagOutputDirty("fetching"),this.sendSignalOnOutput("completed")},doExternalFetch:function(a){var b=this,c=new window.XMLHttpRequest,d=this._internal.backendProperties.backendEndpoint+a.resource;if(Object.keys(a.parameters).length>0){d+="?";for(var e in a.parameters)d+=e+"="+a.parameters[e]+"&"}c.open(a.method,window.encodeURI(d),!0);for(var f in a.headers)c.setRequestHeader(f,a.headers[f]);c.onreadystatechange=function(){var c=(this.response,!1);if(4===this.readyState||this.readyState===XMLHttpRequest.DONE){var d=this.status,e=this.getResponseHeader("content-type"),f=this.response;e&&(e=e.toLowerCase(),-1!==e.indexOf("/json")?(b.doResponse(d,JSON.parse(f),a),c=!0):-1!==e.indexOf("/xml")&&(h.parseString(f,function(c,e){b.doResponse(d,c?f:e,a)}),c=!0)),c===!1&&b.doResponse(d,f,a)}},c.onerror=function(){console.log("REST: Failed to request",d)},a.content?(c.setRequestHeader("Content-Type","application/json"),c.send(JSON.stringify(a.content))):c.send()},doPrototypeFetch:function(a){var b=this,c=this._internal.backendProperties.backendScript,d=new Function("context",c),e={request:a,sendResponse:function(c,d){b.doResponse(c,d,a)}};d(e)},doFetch:function(){if(this._internal.hasScheduledFetch=!1,this._internal.useExternalFile===!0&&this._internal.isWaitingForExternalFileToLoad===!0)return void(this._internal.hasPendingFetch=!0);this.sendSignalOnOutput("started"),this._internal.fetching=!0,this.flagOutputDirty("fetching");var a=this._internal.resource;for(var b in this._internal.requestInputs)a=a.replace("{"+b+"}",this._internal.requestInputs[b]);var c={resource:a,headers:{},method:void 0!==this._internal.method?this._internal.method:"GET",parameters:{}};if(this._internal.requestFunction){var d={inputs:this._internal.requestInputs,outputs:this._internal.responseOutputs};this._internal.requestFunction.apply(d,[this._internal.requestInputs,c])}void 0===this._internal.backendType||"external"===this._internal.backendType?this.doExternalFetch(c):this.doPrototypeFetch(c)}}};b.exports={node:k,setup:function(a,b){a.editorConnection&&b.on("nodeAdded.REST",function(b){f(b,a.editorConnection),b.on("parameterUpdated",function(c){f(b,a.editorConnection)})})}}},{"../../guid":170,"../../javascriptnodeparser":172,"../../node":176,"../../nodedefinition":178,xml2js:145}],196:[function(a,b,c){"use strict";function d(a,b){b=b||",";for(var c,d=new RegExp("(\\"+b+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+b+"\\r\\n]*))","gi"),e=[[]],f=null;(f=d.exec(a))&&c!==d.lastIndex;){c=d.lastIndex;var g=f[1];g.length&&g!==b&&e.push([]);var h;h=f[2]?f[2].replace(new RegExp('""',"g"),'"'):f[3],e[e.length-1].push(h)}return e}var e=a("../../nodedefinition"),f=a("./collection"),g={name:"Static Data",category:"Data",color:"data",dynamicports:[{name:"conditionalports/basic",condition:"type = csv OR type NOT SET",ports:[{name:"csv",plug:"input",type:{name:"string",codeeditor:"text"},displayName:"CSV",group:"General"}]},{name:"conditionalports/basic",condition:"type = json",ports:[{name:"json",plug:"input",type:{name:"string",codeeditor:"json"},displayName:"JSON",group:"General"}]}],inputs:{type:{type:{name:"enum",enums:[{label:"CSV",value:"csv"},{label:"JSON",value:"json"}]},displayName:"Type",group:"General","default":"csv",set:function(a){this._internal.type=a}},csv:{set:function(a){this._internal.csv=a,this.scheduleParseData()}},json:{set:function(a){this._internal.json=a,this.scheduleParseData()}}},outputs:{items:{type:"collection",displayName:"Items",group:"General",getter:function(){return this._internal.collection}}},prototypeExtensions:{scheduleParseData:function(){var a=this._internal;a.hasScheduledParseData||(a.hasScheduledParseData=!0,this.scheduleAfterInputsHaveUpdated(this.parseData.bind(this)))},parseData:function(){var a=this._internal;if(a.hasScheduledParseData=!1,a.collection||(a.collection=f.get()),void 0===a.type||"csv"===a.type){for(var b=d(a.csv),c=[],e=b[0],g=1;g<b.length;g++){for(var h=b[g],i={},j=0;j<e.length;j++)i[e[j]]=h[j];c.push(i)}a.collection.set(c),this.flagOutputDirty("items")}else if("json"===a.type){var c=JSON.parse(a.json);a.collection.set(c),this.flagOutputDirty("items")}}}};b.exports=e.defineNode(g)},{"../../nodedefinition":178,"./collection":188}],197:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this._internal.snapPositions.length-1;return this._internal.snapPositions.some(function(c,d){return c>a?(b=d-1,!0):!1}),b}function f(a){this._internal.currentSnappedIndex!==a&&(this._internal.currentSnappedIndex=a,this.flagOutputDirty("currentIndex"))}function g(a,b,c){var e=b+(c>0?1:-1);return e=d(0,a.length-1,e)}function h(a,b,c,e){var f=.5,g=.02,h=50,i=a.length-1,j=Math.abs(c-a[b]),k=Math.abs(e);if(h>j&&f>k)return b;for(var l=0;l<a.length;++l){if(j=Math.abs(c-a[l]),h>j&&g>k){i=l,e>0&&i--;break}if(a[l]>c){i=l-1;break}}return e>0&&i++,d(0,a.length-1,i)}function i(a,b,c){var d;if("none"!==this._internal.snapBehavior){d="everyPosition"===this._internal.snapBehavior?g(this._internal.snapPositions,a,c):h(this._internal.snapPositions,this._internal.currentSnappedIndex,b,c);var e=this._internal.snapAnimation;e.startPosition=b,e.endPosition=this._internal.snapPositions[d],e.start(),f.call(this,d)}}function j(a){var b=a;this._internal.clampEnabled===!0&&(b=d(this._internal.clampMin,this._internal.clampMax,a)),0===this._internal.dragGestureRecognizer.axis?this._internal.target.setPositionX(b):this._internal.target.setPositionY(b)}function k(){var a=this._internal.target._internal.uiControl;return 0===this._internal.dragGestureRecognizer.axis?a.positionX:a.positionY}function l(a,b){if(a._internal.dragEnabled!==!1){var c=a._internal.dragGestureRecognizer.onTouch(b);return a._internal.track?c:void 0}}var m=(a("../node"),a("../nodedefinition")),n=a("../easecurves"),o={name:"Drag",category:"Interaction",initialize:function(){var a=this,b=this._internal;b.snapPositions=[0],b.target=void 0,b.track=!0,b.startSnapIndex=0,b.currentSnappedIndex=0,b.snapBehavior="none",b.dragEnabled=!0,b.dragRatio=1,b.snapDuration=300,b.clampMin=0,b.clampMax=0,b.clampEnabled=!1,b.snapAnimation=this.context.timerScheduler.createTimer({duration:b.snapDuration,ease:n.easeOut,startPosition:0,endPosition:0,onRunning:function(b){j.call(a,this.ease(this.startPosition,this.endPosition,b))}}),b.controlStart=0,b.indexOnDragStart=0,b.snapIndex=0,b.dragGestureRecognizer={},b.dragGestureRecognizer=this.context.uiEngine.createDragGestureRecognizer({axis:0,threshold:5,onDragStart:function(){b.snapAnimation.stop(),a.sendSignalOnOutput("dragStart"),b.controlStart=k.call(a),b.indexOnDragStart=e.call(a,b.controlStart)},onDrag:function(){var c=b.controlStart+this.dragDistance*b.dragRatio;if("none"!==b.snapBehavior){var e=b.snapPositions[0],f=b.snapPositions[b.snapPositions.length-1];c=d(e,f,c)}j.call(a,c)},onDragEnd:function(){a.sendSignalOnOutput("dragEnd"),i.call(a,b.indexOnDragStart,k.call(a),this.velocity)}})},inputs:{target:{type:"reference",displayName:"Target",group:"Target Node",set:function(a){if(this._internal.target&&(this._internal.target.removeTouchHandlersWithId(this),this._internal.target=void 0),a){var b=a.getVisualRoot();if(!b._internal.uiControl)throw new Error("target must be a visual node, not a "+b.name);this._internal.target=b,this._internal.target.addTouchHandler(l.bind(null,this),this);var c=this;this.context.scheduleAfterUpdate(function(){"none"!==c._internal.snapBehavior&&j.call(c,c._internal.snapPositions[c._internal.startSnapIndex])})}}},axis:{type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},"default":"0",displayName:"Drag Direction",group:"Drag Behavior",set:function(a){this._internal.dragGestureRecognizer.axis=Number(a)}},snapBehavior:{type:{name:"enum",enums:[{value:"none",label:"None"},{value:"everyPosition",label:"Every Position"},{value:"closestPosition",label:"Closest Position"}]},"default":"none",group:"Drag Behavior",displayName:"Snap Behavior",set:function(a){this._internal.snapBehavior=a}},track:{type:"boolean",displayName:"Track Touch",group:"Drag Behavior","default":!0,set:function(a){this._internal.track=a}},dragThreshold:{type:{name:"number",allowEditOnly:!0},displayName:"Drag Threshold",group:"Drag Behavior","default":5,set:function(a){this._internal.dragGestureRecognizer.threshold=a}},dragEnabled:{type:{name:"boolean"},displayName:"Drag Enabled",group:"Drag Behavior","default":!0,set:function(a){this._internal.dragEnabled=a?!0:!1}},dragRatio:{type:"number",displayName:"Drag Ratio","default":1,group:"Drag Behavior",set:function(a){this._internal.dragRatio=Number(a)}},"snapToIndex.index":{type:"number",displayName:"Index",group:"Snap To Index","default":0,set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.snapIndex=Math.floor(a)}},"snapToIndex.duration":{type:"number",displayName:"Duration",editorName:"Duration|Snap To Index",group:"Snap To Index","default":300,set:function(a){this._internal.snapDuration=a}},"snapToIndex.do":{group:"Snap To Index",displayName:"Do",editorName:"Do|Snap To Index",valueChangedToTrue:function(){var a=this._internal.snapAnimation,b=this;this.scheduleAfterInputsHaveUpdated(function(){a.startPosition=k.call(b),a.endPosition=b._internal.snapPositions[b._internal.snapIndex],a.duration=b._internal.snapDuration,a.start(),f.call(b,b._internal.snapIndex)})}},"clampDragPosition.min":{type:{name:"number"},displayName:"Start",group:"Constrain","default":0,set:function(a){this._internal.clampMin=a}},"clampDragPosition.max":{type:{name:"number"},displayName:"End",group:"Constrain","default":0,set:function(a){this._internal.clampMax=a}},"clampDragPosition.enabled":{type:{name:"boolean"},displayName:"Constrain",group:"Constrain","default":!1,set:function(a){this._internal.clampEnabled=a}}},numberedInputs:{position:{name:"numbered/simple-number",displayPrefix:"Position",group:"Snap Positions",createSetter:function(a){return function(b){this._internal.snapPositions[a]=b}},selectors:{startAt:{displayName:"Start At",group:"Snap Positions",set:function(a){var b=this._internal;b.startSnapIndex=a,f.call(this,a),b.target&&a<b.snapPositions.length&&j.call(this,b.snapPositions[b.startSnapIndex])}}}}},outputs:{dragStart:{group:"Signals",type:"signal",displayName:"Drag Started"},dragEnd:{group:"Signals",type:"signal",displayName:"Drag Ended"},currentIndex:{group:"Current State",type:"number",displayName:"Current Index",getter:function(){return this._internal.currentSnappedIndex;
}}}};b.exports=m.defineNode(o)},{"../easecurves":164,"../node":176,"../nodedefinition":178}],198:[function(a,b,c){"use strict";var d={name:"Event Receiver",category:"Events",usePortAsLabel:"channelName",color:"component",initialize:function(){var a=this._internal;a.outputValues={},a.outputNames=[],a.eventReceived=!1,a._isEnabled=!0,a.channelName=""},dynamicports:[{name:"portchannel/event-sender-channel",channelPort:{name:"channelName",displayName:"Channel",plug:"input"},port:{type:"*",plug:"output",allowConnectionOnly:!0}}],inputs:{enabled:{displayName:"Enabled",type:"boolean","default":!0,set:function(a){this._internal._isEnabled=a?!0:!1}},channelName:{set:function(a){this._internal.onEventReceivedCallback&&(this.context.eventSenderEmitter.removeListener(this._internal.channelName,this._internal.onEventReceivedCallback),this._internal.onEventReceivedCallback=null),this._internal.channelName=a,this.registerListenersForChannel(a)}}},outputs:{eventReceived:{displayName:"Event Received",type:"signal"}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;this._internal.outputNames.push(a),this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},handleEvent:function(a){if(this._internal._isEnabled!==!1){this.sendSignalOnOutput("eventReceived");for(var b in a)this.hasOutput(b)&&(this._internal.outputValues[b]=a[b],this.flagOutputDirty(b))}},onEventReceived:function(a){this.handleEvent(a)},registerListenersForChannel:function(a){var b=this.context.eventSenderEmitter;this._internal.onEventReceivedCallback=this.onEventReceived.bind(this),b.on(a,this._internal.onEventReceivedCallback);var c=this;this.context.eventEmitter.once("applicationDataReloaded",function(){c._internal.onEventReceivedCallback&&b.removeListener(a,c._internal.onEventReceivedCallback)})},getChannelName:function(){return this._internal.channelName}}};b.exports={node:d}},{}],199:[function(a,b,c){"use strict";var d={name:"Event Sender",category:"Events",usePortAsLabel:"channelName",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Inputs",plug:"input",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.inputValues={},this._internal.channelName="",this._internal.propagation="global"},inputs:{sendEvent:{displayName:"Send Event",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){"global"===a._internal.propagation?a.context.sendGlobalEventFromEventSender(a._internal.channelName,a._internal.inputValues):a.nodeScope.sendEventFromThisScope(a._internal.channelName,a._internal.inputValues,a._internal.propagation)})}},channelName:{type:{name:"string",allowEditOnly:!0},"default":"",group:"Settings",displayName:"Channel Name",set:function(a){this._internal.channelName=a,this._internal.inputValues._channelName=a}},propagation:{type:{name:"enum",enums:[{value:"global",label:"Global"},{value:"parent",label:"Parent"},{value:"children",label:"Children"}]},"default":"global",group:"Settings",displayName:"Propagation",set:function(a){this._internal.propagation=a}}},prototypeExtensions:{registerInputIfNeeded:{value:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}}}}};b.exports={node:d}},{}],200:[function(a,b,c){"use strict";function d(a,b){function c(){return a.apply(this,b)}return c.prototype=a.prototype,new c}function e(a){function b(a){-1===l.indexOf(a)&&(d.some(function(b){return b===a})||d.push(a))}function c(a){"Identifier"!==a.type||a.raw?"ConditionalExpression"===a.type?(c(a.test),c(a.consequent),c(a.alternate)):"MemberExpression"===a.type?c(a.object):"CallExpression"===a.type?(c(a.callee),a.arguments.forEach(c)):"UnaryExpression"===a.type?c(a.argument):("BinaryExpression"===a.type||"LogicalExpression"===a.type)&&(c(a.left),c(a.right)):b(a.name)}var d=[];try{var e=h(a);c(e)}catch(f){d=[]}return d}function f(a,b,c){var d=e(b),f=d.map(function(a){return{name:a,type:"number",plug:"input"}});c.sendDynamicPorts(a,f)}var g=(a("../node"),a("lodash")),h=a("jsep"),i={name:"Expression",category:"Math",usePortAsLabel:"expression",initialize:function(){var a=this._internal;a.scope={},a.hasScheduledEvaluation=!1,a.code=void 0,a.cachedValue=0,a.currentExpression="",a.compiledFunction=void 0,a.inputNames=[],a.inputValues=[]},inputs:{expression:{inputPriority:1,type:{name:"string",allowEditOnly:!0},displayName:"Expression",set:function(a){var b=this._internal;b.currentExpression=j+"return ("+a+");",b.compiledFunction=void 0;var c=e(a),d=g.difference(c,b.inputNames),f=g.difference(b.inputNames,c),h=this;f.forEach(function(a){h.deregisterInput(a),delete b.scope[a]}),d.forEach(function(a){h.registerInput(a,{set:function(c){b.scope[a]=c,this._scheduleEvaluateExpression()}}),b.scope[a]=0,h._cachedInputValues[a]=0}),b.inputNames=Object.keys(b.scope),this._scheduleEvaluateExpression()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.currentExpression?this._internal.cachedValue:0}}},prototypeExtensions:{_scheduleEvaluateExpression:{value:function(){var a=this._internal;a.hasScheduledEvaluation===!1&&(a.hasScheduledEvaluation=!0,this.flagDirty(),this.scheduleAfterInputsHaveUpdated(function(){var b=a.cachedValue;a.cachedValue=this._calculateExpression(),b!==a.cachedValue&&this.flagOutputDirty("result"),a.hasScheduledEvaluation=!1}))}},_calculateExpression:{value:function(){var a=this._internal;a.compiledFunction||(a.compiledFunction=this._compileFunction());for(var b=0;b<a.inputNames.length;++b){var c=a.scope[a.inputNames[b]];a.inputValues[b]=c}try{return a.compiledFunction.apply(null,a.inputValues)}catch(d){console.error("Error in expression:",d.message)}return 0}},_compileFunction:{value:function(){var a=this._internal.currentExpression,b=Object.keys(this._internal.scope),c=a+b.join(" ");if(k.hasOwnProperty(c)===!1){b.push(a);try{k[c]=d(Function,b)}catch(e){console.error("Failed to compile JS function",e.message)}}return k[c]}}}},j=["var min = Math.min,    max = Math.max,    cos = Math.cos,    sin = Math.sin,    tan = Math.tan,    sqrt = Math.sqrt,    pi = Math.PI,    round = Math.round,    floor = Math.floor,    ceil = Math.ceil,    abs = Math.abs,    random = Math.random;"].join(""),k={},l=["min","max","cos","sin","tan","sqrt","pi","round","floor","ceil","abs","random","Math","window","document"];b.exports={node:i,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Expression",function(b){b.parameters.expression&&f(b.id,b.parameters.expression,a.editorConnection),b.on("parameterUpdated",function(c){"expression"===c.name&&f(b.id,b.parameters.expression,a.editorConnection)})})}}},{"../node":176,jsep:12,lodash:117}],201:[function(a,b,c){"use strict";var d=a("../node"),e={name:"Globals",category:"Utilities",color:"component",initialize:function(){this._internal.listeners=[]},panels:[{name:"PortEditor",context:["select","connectTo","connectFrom"],title:"Globals",plug:"input/output",type:{name:"*"}}],prototypeExtensions:{_onNodeDeleted:function(){d.prototype._onNodeDeleted.call(this);for(var a=this.context.globalsEventEmitter,b=0;b<this._internal.listeners.length;b++){var c=this._internal.listeners[b];a.removeListener(c.name,c.listener)}this._internal.listeners=[]},_newOutputValueReceived:{value:function(a){this._cachedInputValues[a]=this.context.globalValues[a],this.flagOutputDirty(a)}},registerInputIfNeeded:{value:function(a){var b=this;this.hasInput(a)||this.registerInput(a,{set:b.context.setGlobalValue.bind(b.context,a)})}},registerOutputIfNeeded:{value:function(a){if(!this.hasOutput(a)){var b=this._newOutputValueReceived.bind(this,a),c=this.context.globalsEventEmitter;this._internal.listeners.push({name:a,listener:b}),c.on(a,b),this.registerOutput(a,{getter:function(){return this.context.globalValues[a]}})}}}}};b.exports={node:e}},{"../node":176}],202:[function(a,b,c){"use strict";function d(a){a.alpha!==this._internal.alpha&&(this._internal.alpha=a.alpha,this.flagOutputDirty("rotationZ")),a.beta!==this._internal.beta&&(this._internal.beta=a.beta,this.flagOutputDirty("rotationX")),a.gamma!==this._internal.gamma&&(this._internal.gamma=a.gamma,this.flagOutputDirty("rotationY"))}var e=a("../nodedefinition"),f={name:"Gyroscope",displayNodeName:"Device Orientation",category:"Sensors",initialize:function(){this._internal.alpha=0,this._internal.beta=0,this._internal.gamma=0;var a=d.bind(this);window.addEventListener("deviceorientation",a),this.context.eventEmitter.once("applicationDataReloaded",function(){window.removeEventListener("deviceorientation",a)})},outputs:{rotationX:{type:"number",displayName:"Rotation X",getter:function(){return-this._internal.beta}},rotationY:{type:"number",displayName:"Rotation Y",getter:function(){return this._internal.gamma}},rotationZ:{type:"number",displayName:"Rotation Z",getter:function(){return-this._internal.alpha}}}};b.exports=e.defineNode(f)},{"../nodedefinition":178}],203:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e={name:"Inverter",category:"Math",initialize:function(){this._internal.currentValue=!1},inputs:{value:{type:{name:"boolean"},displayName:"Value",set:function(a){this._internal.currentValue=a,this.flagOutputDirty("result")}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return!this._internal.currentValue}}}};b.exports=d.defineNode(e)},{"../nodedefinition":178}],204:[function(a,b,c){"use strict";function d(){return this._internal.isFirstFrame?void(this._internal.isFirstFrame=!1):(this._evaluateFunction(),this.context.nodeIsDirty(this),void this.flagDirty())}function e(a,b){this._internal.needsToEval=!0,this._internal.inputValues[a]=b,this.flagDirty()}function f(a){return this._internal.needsToEval&&this._evaluateFunction(),this._internal.outputValues[a]}var g=a("../nodedefinition"),h=a("../node"),i={};b.exports=g.defineNode({name:"Javascript",category:"Javascript",displayNodeName:"Javascript (Deprecated)",deprecated:!0,panels:[{name:"PortEditor",context:["select"],title:"Inputs",plug:"input",type:{name:"*"}},{name:"PortEditor",context:["select"],title:"Outputs",plug:"output",type:{name:"*"}}],initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.needsToEval=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(a){if(!a)throw new Error("Output port name must be specified");b.flagOutputDirty(a)}},a.isFirstFrame=!0,a.onFrameStart=d.bind(this)},inputs:{code:{type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},displayName:"code",group:"Code",set:function(a){i[a]||(i[a]=new Function("inputs","outputs",a)),this._internal.userFunction=i[a],this._internal.needsToEval=!0}},runEveryFrame:{type:"boolean",displayName:"Run Every Frame",group:"Settings",set:function(a){a=a?!0:!1;var b=this.context.eventEmitter;a===!0?b.on("frameStart",this._internal.onFrameStart):b.removeListener("frameStart",this._internal.onFrameStart)}}},prototypeExtensions:{update:{value:function(){this._dirty===!1||this._isUpdating||(h.prototype.update.call(this),this._internal.needsToEval&&(this._evaluateFunction(),this.flagDirty()))}},registerInputIfNeeded:{value:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})}},registerOutputIfNeeded:{value:function(a){this.hasOutput(a)||this.registerOutput(a,{getter:f.bind(this,a)})}},_evaluateFunction:{value:function(){var a=this._internal;a.userFunction.call(a.userFunctionScope,a.inputValues,a.outputValues),a.needsToEval=!1}},flagDirty:{value:function(){for(var a in this._internal.outputValues)this.flagOutputDirty(a);h.prototype.flagDirty.call(this)}}}})},{"../node":176,"../nodedefinition":178}],205:[function(a,b,c){"use strict";function d(){for(var a in this._internal.dirtyOutputs)this.flagOutputDirty(a);this._internal.dirtyOutputs={}}function e(){this._internal.setupScheduled||(this._internal.setupScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.killed||(this._callSetupFunction(),this._internal.setupScheduled=!1,d.call(this))}))}function f(){this._internal.runScheduled||this._internal.killed||(this._internal.runScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.killed||(this._callRunFunction(),this._internal.changedInputs={},this._internal.runScheduled=!1,d.call(this))}))}function g(){this._internal.runNextFrame=!1,f.call(this)}function h(a,b){this._internal.inputValues[a]=b,this._internal.hasParsedCode===!0&&(this._internal.changedInputs[a]=!0,f.call(this))}function i(a){return this._internal.outputValues[a]}function j(a,b){function c(b){b.error?d.sendWarning(a.component.name,a.id,"js-parse-waring",{message:b.error}):d.sendDynamicPorts(a.id,b.getPorts())}var d=b.editorConnection;if(a.parameters)if(a.parameters.externalFile&&"yes"===a.parameters.useExternalFile){var e=a.parameters.externalFile;b.runningInEditor&&"/"!==e[0]&&(e="/"+e),l.createFromURL(e,null,c)}else if(a.parameters.code){var f=l.createFromCode(a.parameters.code,null);c(f)}}var k=a("../node"),l=a("../javascriptnodeparser"),m=["define({","    inputs: {",'        inputValue: "number"',"    },","    outputs: {",'        outputValue: "number"',"    },","    destroy: function(inputs, outputs) {","","    },","    setup: function(inputs, outputs) {","","    },","    run: function(inputs, outputs, changedInputs) {","","    }","});"].join("\n"),n={name:"Javascript2",displayNodeName:"Javascript",category:"Javascript",color:"javascript",initialize:function(){var a=this._internal;a.inputValues={},a.outputValues={},a.outputProperties={},a.dirtyOutputs={},a.runScheduled=!1,a.setupScheduled=!1,a.runNextFrameScheduled=!1,a.isWaitingForExternalFileToLoad=!1,a.useExternalFile=!1,a.runFunction=void 0,a.destroyFunction=void 0,a.setupFunction=void 0,a.hasParsedCode=!1,a.changedInputs={},a.killed=!1;var b=this;a.userFunctionScope={flagOutputDirty:function(c){if(!c)throw new Error("Output port name must be specified");b.flagOutputDirty(c),a.dirtyOutputs.hasOwnProperty(c)&&delete a.dirtyOutputs[c]},runNextFrame:function(){a.runNextFrameScheduled||(a.runNextFrameScheduled=!0,b.context.scheduleNextFrame(function(){a.runNextFrameScheduled=!1,a.killed||f.call(b)}))},sendSignalOnOutput:function(c){a.outputValues[c]=!0,b.flagOutputDirty(c),a.outputValues[c]=!1,b.flagOutputDirty(c)}},a.onFrameStart=g.bind(this)},dynamicports:[{name:"conditionalports/basic",condition:"useExternalFile = no OR useExternalFile NOT SET",ports:[{name:"code",displayName:"Code",group:"Code",plug:"input",type:{name:"string",allowEditOnly:!0,codeeditor:"javascript"},"default":m}]},{name:"conditionalports/basic",condition:"useExternalFile = yes",ports:[{name:"externalFile",displayName:"File Path",group:"Code",plug:"input",type:{name:"source",allowEditOnly:!0}}]}],inputs:{useExternalFile:{type:{name:"enum",enums:[{value:"yes",label:"Yes"},{value:"no",label:"No"}],allowEditOnly:!0},"default":"no",displayName:"Use External File",group:"Code",set:function(a){this._internal.isWaitingForExternalFileToLoad="yes"===a,this._internal.useExternalFile="yes"===a}},code:{set:function(a){if(a){var b=this;this.scheduleAfterInputsHaveUpdated(function(){if(this._internal.useExternalFile===!1){this._callDestroyFunction();var c=l.createFromCode(a,b.nodeScope.noodlJavascriptAPI);b._onCodeParsed(c)}})}}},externalFile:{set:function(a){if(this._internal.useExternalFile!==!1){this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a);var b=this;l.createFromURL(a,this.nodeScope.noodlJavascriptAPI,function(a){b._internal.isWaitingForExternalFileToLoad=!1,b._onCodeParsed(a)})}}}},prototypeExtensions:{_onNodeDeleted:function(){k.prototype._onNodeDeleted.call(this),this._internal.killed=!0,this._callDestroyFunction()},update:function(){this._internal.isWaitingForExternalFileToLoad===!0?this._dirty=!1:k.prototype.update.call(this)},_onCodeParsed:function(a){if(this.context.editorConnection&&(this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),a.error?this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-parse-waring",{message:a.error}):this.context.editorConnection.sendDynamicPorts(this.id,a.getPorts())),!a.error){var b=this;Object.keys(a.outputs).forEach(function(a){b.registerOutputIfNeeded(a)}),this._internal.setupFunction=a.setup,this._internal.runFunction=a.run,this._internal.destroyFunction=a.destroy,this._internal.setupFunction&&e.call(this),this._internal.runFunction&&f.call(this),this._internal.hasParsedCode=!0}},registerInputIfNeeded:function(a){this.hasInput(a)||(this._internal.inputValues[a]=void 0,this.registerInput(a,{set:h.bind(this,a)}))},registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){var b=this;Object.defineProperty(this._internal.outputProperties,a,{set:function(c){b._internal.outputValues[a]=c,b._internal.dirtyOutputs[a]=!0,b.context.scheduleFrame()},get:function(){return b._internal.outputValues[a]}}),this.registerOutput(a,{getter:i.bind(this,a)})}},_callRunFunction:function(){var a=this._internal;if(a.runFunction&&!a.killed)try{a.runFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties,a.changedInputs)}catch(b){console.log("Error in JS node run code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-run-waring",{message:"<strong>run</strong>: "+b.message})}},_callDestroyFunction:function(){var a=this._internal;if(a.destroyFunction)try{a.destroyFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node destroy code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-destroy-waring",{message:"<strong>setup</strong>: "+b.message})}},_callSetupFunction:function(){var a=this._internal;if(a.setupFunction&&!a.killed)try{a.setupFunction.call(a.userFunctionScope,a.inputValues,a.outputProperties)}catch(b){console.log("Error in JS node setup code.",Object.getPrototypeOf(b).constructor.name+": "+b.message),this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"js-setup-waring",{message:"<strong>setup</strong>: "+b.message})}}}};b.exports={node:n,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Javascript2",function(b){j(b,a),b.on("parameterUpdated",function(c){j(b,a)})})}}},{"../javascriptnodeparser":172,"../node":176}],206:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../easecurves");b.exports=d.defineNode({name:"Number Blend",category:"Interpolation",initialize:function(){var a=this._internal;a.inputs=[],a.blendValue=0,a.result=0,a.clamp=!1},prototypeExtensions:{updateResult:function(){var a=this._internal.inputs;if(0===a.length)return 0;var b=Math.floor(this._internal.blendValue),c=this._internal.blendValue-b;b>=a.length-1?this._internal.clamp?(b=a.length-1,c=0):(c+=b-(a.length-1),b=a.length-1):0>=b&&(this._internal.clamp?(b=0,c=0):(c+=b,b=0)),0===c||1===a.length?this._internal.result=a[b]:b===a.length-1&&c>0?this._internal.result=e.linear(a[b-1],a[b],c+1):this._internal.result=e.linear(a[b],a[b+1],c),this.flagOutputDirty("result")}},numberedInputs:{input:{name:"numbered/simple-number",displayPrefix:"Number",createSetter:function(a){var b=this._internal.inputs;return b[a]=0,function(c){b[a]!==c&&(b[a]=c,this.updateResult())}}}},inputs:{blendValue:{type:"number",displayName:"Blend Value","default":0,set:function(a){this._internal.blendValue=a,this.updateResult()}},clamp:{type:"boolean",displayName:"Clamp","default":!1,set:function(a){this._internal.clamp=a?!0:!1,this.updateResult()}}},outputs:{result:{type:"number",displayName:"Result",getter:function(){return this._internal.result}}}})},{"../easecurves":164,"../nodedefinition":178}],207:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Number Remapper",category:"Math",initialize:function(){var a=this._internal;a._currentInputValue=0,a._remappedValue=0,a._minInputValue=0,a._maxInputValue=0,a._minOutputValue=0,a._maxOutputValue=1,a._clampOutput=!0},inputs:{inputValue:{group:"Value to Remap",type:{name:"number",allowConnectionOnly:!0},"default":0,displayName:"Input Value",set:function(a){this._internal._currentInputValue=a,this._calculateNewOutputValue()}},minInputValue:{group:"Input Parameters",type:{name:"number"},"default":0,displayName:"Input Minimum",set:function(a){this._internal._minInputValue=a,this._calculateNewOutputValue()}},maxInputValue:{group:"Input Parameters",type:{name:"number"},"default":0,displayName:"Input Maximum",set:function(a){this._internal._maxInputValue=a,this._calculateNewOutputValue()}},minOutputValue:{group:"Output Parameters",type:{name:"number"},"default":0,displayName:"Output Minimum",set:function(a){this._internal._minOutputValue=a,this._calculateNewOutputValue()}},maxOutputValue:{group:"Output Parameters",type:{name:"number"},"default":1,displayName:"Output Maximum",set:function(a){this._internal._maxOutputValue=a,this._calculateNewOutputValue()}},clamp:{group:"Output Parameters",type:{name:"boolean",allowEditOnly:!0},"default":!0,displayName:"Clamp Output",set:function(a){this._internal._clampOutput=a?!0:!1,this._calculateNewOutputValue()}}},outputs:{remappedValue:{type:"number",displayName:"Remapped Value",group:"Outputs",getter:function(){return this._internal._remappedValue}}},prototypeExtensions:{_calculateNewOutputValue:{value:function(){var a,b=this._internal;a=b._maxInputValue===b._minInputValue?0:(b._currentInputValue-b._minInputValue)/(b._maxInputValue-b._minInputValue),b._clampOutput&&(a=Math.max(0,Math.min(1,a))),b._remappedValue=b._minOutputValue+a*(b._maxOutputValue-b._minOutputValue),this.flagOutputDirty("remappedValue")}}}})},{"../nodedefinition":178}],208:[function(a,b,c){"use strict";function d(a){return a?!0:!1}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Or",category:"Logic",initialize:function(){this._internal.inputs=[]},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Input",createSetter:function(a){return function(b){this._internal.inputs[a]!==b&&(this._internal.inputs[a]=b,this.flagOutputDirty("result"))}}}},outputs:{result:{type:"boolean",displayName:"Result",getter:function(){return this._internal.inputs.some(d)}}}})},{"../nodedefinition":178}],209:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithTypeRecursive("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithTypeRecursive("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition"),f=a("lodash"),g=a("../node");b.exports=e.defineNode({name:"Page Navigation",category:"Navigation",initialize:function(){this._internal.inputValues={},this._internal.portUpdateScheduled=!1,this._internal.targetPagesNode=null,this._internal.resetPageStack=!1},inputs:{navigate:{displayName:"Navigate To Page",group:"Navigation",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(this._doNavigation.bind(this))}},destination:{displayName:"Destination",group:"Navigation",type:"component",set:function(a){var b=this._internal;if(b.destinationComponentModel&&(b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentModel=void 0),this.context.hasComponentModelWithName(a)!==!1){b.destinationComponentModel&&b.destinationComponentModel.removeListenersWithRef(this),b.destinationComponentName=a;var c=this.context.getComponentModel(a);b.destinationComponentModel=c,this.updateDestinationPagePorts(c),c.on("inputPortAdded",this.scheduleUpdateDestinationPagePorts.bind(this,c),this),c.on("inputPortRemoved",this.scheduleUpdateDestinationPagePorts.bind(this,c),this)}}},targetPages:{displayName:"Pages Target",group:"Navigation",type:"reference",set:function(a){this._internal.targetPagesNode=a}},resetPageStack:{displayName:"Reset history",group:"Navigation","default":!1,type:"boolean",set:function(a){this._internal.resetPageStack=a?!0:!1}}},prototypeExtensions:{_doNavigation:function(){var a=this._internal;if(a.destinationComponentName){var b=a.destinationComponentModel.getInputPorts();for(var c in a.inputValues)b.hasOwnProperty(c)===!1&&delete a.inputValues[c];var e=this._internal.targetPagesNode,f=e?e:d(this.nodeScope);this._internal.resetPageStack?f.resetTo(a.destinationComponentName,a.inputValues):f.navigateTo(a.destinationComponentName,a.inputValues)}},_onNodeDeleted:function(){g.prototype._onNodeDeleted.call(this);var a=this._internal;a.destinationComponentModel&&a.destinationComponentModel.removeListenersWithRef(this)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this._internal.inputValues[a]=b}})},scheduleUpdateDestinationPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateDestinationPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateDestinationPagePorts:function(a){var b=f.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Destination Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}})},{"../node":176,"../nodedefinition":178,lodash:117}],210:[function(a,b,c){"use strict";function d(a){for(var b=a.getNodesWithTypeRecursive("Page");0===b.length&&a.componentOwner;)a=a.componentOwner.parentNodeScope,b=a.getNodesWithTypeRecursive("Page");var c=b[0];return c._internal.pagesNode}var e=a("../nodedefinition");b.exports=e.defineNode({name:"Page Navigation Back",category:"Navigation",inputs:{back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){var a=d(this.nodeScope);a.back()}}}})},{"../nodedefinition":178}],211:[function(a,b,c){"use strict";function d(a,b,c){for(var e in a){var f=c+e;"object"!=typeof a[e]||null===a[e]||Array.isArray(a[e])?b.push({key:f,value:a[e]}):d(a[e],b,f+".")}}function e(a,b){this._internal.topicComponents[a]=b,this.scheduleSubscribe()}function f(a){return this._internal.outputValues[a]}function g(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});var g=b.match(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g);for(var f in g)e.push({name:g[f].replace(/\+/g,""),group:"Topic components",plug:"output",type:"*"});c.sendDynamicPorts(a,e)}var h=a("../services/services"),i=a("../node"),j={name:"Receive Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"outputs",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){var a=this._internal;a.payload={},a.messageReceived=!1,a.isEnabled=!0,a.topic="",a.topicComponents={},a.outputValues={},a.outputList=[]},inputs:{enabled:{displayName:"Enabled",type:"boolean","default":!0,set:function(a){this._internal.isEnabled=a?!0:!1}},topic:{displayName:"Topic",type:"string","default":"",set:function(a){this._internal.topic=a,this.scheduleSubscribe()}}},outputs:{messageReceived:{displayName:"Received",type:"signal"}},prototypeExtensions:{_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this.subscription&&(h.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:e.bind(this,a)})},registerOutputIfNeeded:function(a){this.hasOutput(a)||(this._internal.outputList.push(a),this.registerOutput(a,{getter:f.bind(this,a)}))},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponents;for(var c in b)a=a.replace("{"+c+"}",b[c]);return a.replace(/\+([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\+/g,"+")},handleMessage:function(a){if(this._internal.isEnabled!==!1){for(var b=this._internal.topic.split("/"),c=a.topic.split("/"),e=0;e<c.length;e++){var f=b[e];if("+"===f[0]&&"+"===f[f.length-1]){var g=f.substring(1,f.length-1);this._internal.outputValues[g]=c[e],this.flagOutputDirty(g)}}var h=[],i=a.payload;if("object"==typeof i)d(i,h,"");else{var j=this.model.outputPorts,k=Object.keys(j).sort(function(a,b){return j[a].index-j[b].index});i.split(",").forEach(function(a,b){h.push({key:k[b],value:a})})}for(var e=0;e<h.length;e++){var l=h[e];this._internal.outputValues[l.key]=l.value,this.hasOutput(l.key)&&this.flagOutputDirty(l.key)}this.sendSignalOnOutput("messageReceived"),this.context.scheduleFrame()}},onMessageReceived:function(a){this.handleMessage(a)},scheduleSubscribe:function(){var a=this;this._internal.subscribeScheduled||(this._internal.subscribeScheduled=!0,this.scheduleAfterInputsHaveUpdated(function(){a._internal.subscribeScheduled=!1,a.subscribe()}))},subscribe:function(){this.subscription&&(h.pubsub.unsubscribe(this.subscription.topic,this.subscription.subscriber),this.subscription=void 0);var a=this.computeTopic();if(a){var b=this.onMessageReceived.bind(this);this.subscription={topic:a,subscriber:b},h.pubsub.subscribe(a,b),this.context.eventEmitter.once("applicationDataReloaded",function(){h.pubsub.unsubscribe(a,b)})}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Receive Message",function(b){b.parameters.topic&&g(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&g(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../node":176,"../services/services":262}],212:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Reload",category:"Utilities",inputs:{reload:{displayName:"Reload",valueChangedToTrue:function(){this.context.reloadApplication()}}}})},{"../nodedefinition":178}],213:[function(a,b,c){"use strict";var d={name:"Screen Resolution",category:"Utilities",initialize:function(){var a=this;this.context.uiEngine.on("viewportSizeChanged",this._viewportSizeChanged.bind(this),this),this.context.eventEmitter.once("applicationDataReloaded",function(){a.context.uiEngine.removeListenersWithRef(a)}),this._viewportSizeChanged(this.context.uiEngine.getViewportSize())},outputs:{width:{type:"number",displayName:"Width",getter:function(){return this._internal.width}},height:{type:"number",displayName:"Height",getter:function(){return this._internal.height}},aspectRatio:{type:"number",displayName:"Aspect Ratio",getter:function(){return this._internal.width/this._internal.height}}},prototypeExtensions:{_viewportSizeChanged:function(a){this._internal.width=a.width,this._internal.height=a.height,this.flagAllOutputsDirty()}}};b.exports={node:d}},{}],214:[function(a,b,c){"use strict";var d=(a("../node"),{name:"Script Downloader",category:"HTML",initialize:function(){var a=this._internal;a.loaded=!1,a.scripts=[],a.loadedScripts={},a.startLoad=!0,a.loadStarted=!1},inputs:{startLoad:{type:"boolean","default":!0,set:function(a){this._internal.startLoad!==a&&(this._internal.startLoad=a,a&&this.updateScripts())}}},outputs:{loaded:{type:"boolean",displayName:"Loaded",getter:function(){this._internal;return this._internal.loaded}}},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Script",group:"External scripts",index:3008,createSetter:function(a){var b=this;return function(c){c=c.toString(),b._internal.scripts[a]=c,b._internal.loadStarted||(b._internal.loadStarted=!0,this.scheduleAfterInputsHaveUpdated(function(){b.updateScripts()}))}}}},prototypeExtensions:{removeLoadTerminator:function(){var a="sentinel_"+this.id,b=document.getElementById(a);b&&b.parentNode&&b.parentNode.removeChild(b)},updateScripts:function(){if(this._internal.startLoad){this._internal.loadStarted=!1;var a="sentinel_"+this.id;this.removeLoadTerminator();var b=this._internal.scripts;b=b.filter(function(a){return""!==a});for(var c=document.head.getElementsByTagName("script"),d={},e=0;e<c.length;e++){
var f=c[e];void 0!==f.src&&""!==f.src&&(d[f.src]=f)}for(var e=0;e<b.length;e++){var f=b[e].trim();if(!this._internal.loadedScripts.hasOwnProperty(f)){if(d.hasOwnProperty(f))continue;var g=document.createElement("script");g.src=f,g.async=!1,document.head.appendChild(g)}}var h=this,i=document.createElement("script");i.onload=i.onreadystatechange=function(a){this.readyState&&"loaded"!==this.readyState&&"complete"!==this.readyState||(h._internal.loaded=!0,h.flagOutputDirty("loaded"),h.removeLoadTerminator())},i.id=a,i.src="load_terminator.js",i.async=!1,document.head.appendChild(i)}}}});b.exports={node:d,setup:function(a,b){!a.editorConnection||!a.editorConnection.isRunningLocally()}}},{"../node":176}],215:[function(a,b,c){"use strict";function d(){return"undefined"!=typeof window?window.performance.now():+new Date}function e(a,b,c){return a.length>0&&(a+=","),a+=c}function f(a,b,c){for(var d=b.split("."),e=0;e<d.length-1;e++)a[d[e]]||(a[d[e]]={}),a=a[d[e]];return a[d[d.length-1]]=c,a}function g(a,b){this._internal.inputValues[a]=b,this._internal.publishOnInputsChanged&&this.schedulePublish()}function h(a,b,c){var d=b.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g),e=[];for(var f in d)e.push({name:d[f].replace(/(\{|\})/g,""),group:"Topic components",plug:"input",type:"*"});c.sendDynamicPorts(a,e)}var i=a("../services/services"),j={name:"Send Message",category:"Messages",usePortAsLabel:"topic",color:"component",panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Payload",plug:"input",group:"Payload",type:{name:"*",allowConnectionOnly:!0}}],initialize:function(){this._internal.payload={},this._internal.topic="",this._internal.inputValues={},this._internal.topicComponentsMap={},this._internal.hasScheduledPublish=!1,this._internal.publishOnInputsChanged=!1,this._internal.rateLimitEnabled=!1,this._internal.maxMessagesPerSecond=10,this._internal.lastPublishTime=0,this._internal.format="json"},dynamicports:[{name:"conditionalports/basic",condition:"rateLimit = true",ports:[{name:"maxMessagesPerSecond",type:"number","default":10,displayName:"Messages / Sec",group:"Rate Limit",plug:"input"}]}],inputs:{send:{displayName:"Send",valueChangedToTrue:function(){this.schedulePublish()}},topic:{type:{name:"string"},"default":"",displayName:"Topic",group:"General",set:function(a){this._internal.topic=a;var b=a.match(/\{([a-z]|[A-Z])([a-z]|[A-Z]|[0-9])*\}/g);for(var c in b)this._internal.topicComponentsMap[b[c].replace(/(\{|\})/g,"")]=!0}},format:{type:{name:"enum",enums:[{value:"json",label:"JSON"},{value:"csv",label:"CSV"}]},displayName:"Format",group:"General","default":"json",set:function(a){this._internal.format=a}},publishOnInputsChanged:{type:"boolean","default":!1,displayName:"Send On Change",group:"General",set:function(a){this._internal.publishOnInputsChanged=a?!0:!1}},rateLimit:{type:"boolean","default":!1,displayName:"Rate Limit",group:"Rate Limit",set:function(a){this._internal.rateLimitEnabled=a?!0:!1}},maxMessagesPerSecond:{set:function(a){this._internal.maxMessagesPerSecond=Number(a)}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:g.bind(this,a)})},computeTopic:function(){var a=this._internal.topic,b=this._internal.topicComponentsMap,c=this._internal.inputValues;for(var d in b)a=a.replace("{"+d+"}",c[d]);return a},schedulePublish:function(){if(!this._internal.hasScheduledPublish){if(this._internal.rateLimitEnabled){clearTimeout(this._internal.rateLimitTimeoutId);var a=d(),b=1e3/this._internal.maxMessagesPerSecond,c=a-this._internal.lastPublishTime;if(b>c)return void(this._internal.rateLimitTimeoutId=setTimeout(this.schedulePublish.bind(this),b-c))}this._internal.hasScheduledPublish=!0,this.scheduleAfterInputsHaveUpdated(function(){this._internal.hasScheduledPublish=!1;var a,b,c=this.computeTopic(),g=this._internal.inputValues,h=this._internal.topicComponentsMap;"csv"===this._internal.format?(b=e,a=""):(b=f,a={});for(var j in g)h[j]||(a=b(a,j,g[j]));i.pubsub.publish(c,a),this._internal.lastPublishTime=d()})}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.Send Message",function(b){b.parameters.topic&&h(b.id,b.parameters.topic,a.editorConnection),b.on("parameterUpdated",function(c){"topic"===c.name&&h(b.id,b.parameters.topic,a.editorConnection)})})}}},{"../services/services":262}],216:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../shaderparser"),f=a("../node"),g=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),h=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),i=d.defineNode({name:"Shader",category:"Graphics",initialize:function(){var a=this._internal;a.inputValues={},a.vertexShaderSource=g,a.fragmentShaderSource=h,this.context.uiEngine.on("shaderError",this.onShaderError.bind(this),this)},inputs:{vertexShader:{displayName:"Vertex shader",type:{name:"string",allowEditOnly:!0,codeeditor:"glsl"},"default":g,set:function(a){this._internal.vertexShaderSource=a,this.context.editorConnection&&this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),this.flagOutputDirty("shader")}},fragmentShader:{displayName:"Fragment shader",type:{name:"string",allowEditOnly:!0,codeeditor:"glsl"},"default":h,set:function(a){this._internal.fragmentShaderSource=a,this.context.editorConnection&&this.context.editorConnection.clearWarnings(this.nodeScope.componentOwner.name,this.id),this.flagOutputDirty("shader")}}},outputs:{shader:{displayName:"Shader",type:"object",getter:function(){var a=this._internal,b=e.extractUniforms(a.vertexShaderSource,a.fragmentShaderSource),c=[];return b.forEach(function(a){e.StandardUniformNames[a.name]||c.push(a)}),{vertexShaderSource:a.vertexShaderSource,fragmentShaderSource:a.fragmentShaderSource,id:this.id,uniforms:c}}}},prototypeExtensions:{_onNodeDeleted:function(){f.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this)},onShaderError:function(a){a.id===this.id&&this.context.editorConnection&&this.context.editorConnection.sendWarning(this.nodeScope.componentOwner.name,this.id,"glsl-syntax-error",{message:a.error,property:a.type})}}});b.exports=i},{"../node":176,"../nodedefinition":178,"../shaderparser":263}],217:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=a("../edgetriggeredinput");b.exports=d.defineNode({name:"Signal To Index",category:"Logic",initialize:function(){this._internal.currentIndex=0},numberedInputs:{input:{name:"numbered/simple-boolean",displayPrefix:"Signal",createSetter:function(a){return e.createSetter({valueChangedToTrue:this.onValueChangedToTrue.bind(this,a)})},selectors:{startIndex:{displayName:"Start Index",set:function(a){this._internal.currentIndex=a,this.flagOutputDirty("index")}}}}},outputs:{index:{displayName:"Index",type:"number",getter:function(){return this._internal.currentIndex}},signalTriggered:{displayName:"Signal Triggered",type:"signal"}},prototypeExtensions:{onValueChangedToTrue:function(a){this.sendSignalOnOutput("signalTriggered"),this._internal.currentIndex!==a&&(this._internal.currentIndex=a,this.flagOutputDirty("index"))}}})},{"../edgetriggeredinput":165,"../nodedefinition":178}],218:[function(a,b,c){"use strict";function d(a,b,c){var d=b.states,e=b.values,f=[];e=e?e.split(","):void 0;for(var g in e){var j=e[g];f.push({type:{name:"number",allowConnectionsOnly:!0},plug:"output",group:"Values",name:j})}d=d?d.split(","):void 0,d&&d.forEach(function(a){e&&e.forEach(function(b){f.push({plug:"input",type:"number",group:a+" Values",name:"value-"+a+"-"+b,displayName:b,editorName:a+"|"+b})}),f.push({plug:"input",type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"},{value:"cubicBezier",label:"Cubic Bezier"}]},"default":"easeOut",displayName:"Easing Curve",group:a+" Transition",name:"transition-"+a}),"cubicBezier"===b["transition-"+a]&&(f=f.concat([{name:"cubicBezierP1X-"+a,editorName:a+"|P1 X",displayName:"P1 X",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP1Y-"+a,editorName:a+"|P1 Y",displayName:"P1 Y",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP2X-"+a,editorName:a+"|P2 X",displayName:"P2 X",group:a+" Transition",plug:"input",type:"number","default":0},{name:"cubicBezierP2Y-"+a,editorName:a+"|P2 Y",displayName:"P2 Y",group:a+" Transition",plug:"input",type:"number","default":0}])),f.push({plug:"input",type:"number","default":h,displayName:"Duration",group:a+" Transition",name:"duration-"+a}),f.push({plug:"input",type:{name:"boolean",allowConnectionsOnly:!0},displayName:"To "+a,name:"to-"+a,group:"Go to state"}),f.push({plug:"output",type:"boolean",displayName:"At "+a,name:"at-"+a,group:"Current state"}),f.push({plug:"output",type:"signal",displayName:"Has Reached "+a,name:"reached-"+a,group:"Current state"})}),d&&f.push({plug:"input",type:{name:"enum",enums:d},group:"States",displayName:"Start at",name:"startState","default":d[0]});var k=JSON.stringify(f);i[a]!==k&&(i[a]=k,c.sendDynamicPorts(a,f))}var e=a("../edgetriggeredinput"),f=a("../easecurves"),g=a("bezier-easing"),h=300,i={},j={name:"States",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentValues={},b.stateParameters={},b.startValues={},b.bezierEaseCurves={},b.valuesAreInitialised=!1,b.animation=this.context.timerScheduler.createTimer({duration:h,ease:f.easeOut,onStart:function(){},onRunning:function(c){var d=this.ease(0,1,c),e=b.values,f=b.currentValues,g=b.stateParameters,h="value-"+b.state+"-",i=b.startValues;for(var j in e){var k=e[j];f[k]=i[k]*(1-d)+(g[h+k]||0)*d,a.flagOutputDirty(k)}},onFinish:function(){var c="reached-"+b.state;a.hasOutput(c)&&a.sendSignalOnOutput(c)}})},inputs:{states:{type:{name:"stringlist",allowEditOnly:!0},displayName:"States",group:"States",set:function(a){if(this._internal.states=a?a.split(","):[],this._internal.states.length>0){var b=this;this.scheduleAfterInputsHaveUpdated(function(){b._internal.state||b.goToState(b._internal.states[0])})}}},values:{type:{name:"stringlist",allowEditOnly:!0},displayName:"Values",group:"Values",set:function(a){var b=this._internal;b.values=a.split(",");for(var c in b.values)this.registerOutputIfNeeded(b.values[c])}},toggle:{group:"Go to state",displayName:"Toggle",valueChangedToTrue:function(){var a=this._internal,b=this;if(a.states){var c=a.states.indexOf(a.state),d=(c+1)%a.states.length;this._internal.scheduledToGoToState=a.states[d],this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a.states[d])})}}},currentState:{type:{name:"string",allowConnectionsOnly:!0},displayName:"Current State",group:"Go to state",set:function(a){var b=this,c=this._internal;c.states&&-1!==c.states.indexOf(a)&&(c.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)}))}}},outputs:{currentState:{type:"string",displayName:"Current State",group:"Current State",getter:function(){return this._internal.state}},stateChanged:{type:"signal",displayName:"State Changed",group:"Current State"}},prototypeExtensions:{registerOutputIfNeeded:function(a){var b=this._internal;this.hasOutput(a)||this.registerOutput(a,{getter:function(){return b.currentValues[a]}})},registerInputIfNeeded:function(a){var b=this,c=this._internal;if(!this.hasInput(a))if(0===a.indexOf("to-")){var d=a.substring(3);this.registerInput(a,{set:e.createSetter({valueChangedToTrue:function(){this._internal.scheduledToGoToState=d,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(d)})}})})}else if("startState"===a)this.registerInput(a,{set:function(a){this._internal.scheduledToGoToState=a,this.scheduleAfterInputsHaveUpdated(function(){b.goToState(a)})}});else if(0===a.indexOf("value-")){var f=a.split("-"),d=f[1],g=f[2];this.registerInput(a,{set:function(e){c.stateParameters[a]=e,c.state===d&&(c.currentValues[g]=e,b.flagOutputDirty(g))}})}else if(0===a.search(/duration-/g))this.registerInput(a,{set:function(b){c.stateParameters[a]=b}});else if(0===a.search(/transition-/g)){var d=a.substring(11);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,"cubicBezier"===b&&this.updateCubicBezierFunction(d)}})}else if(0===a.search(/cubicBezierP[1-2][X-Y]-/g)){var d=a.substring(15);this.registerInput(a,{set:function(b){c.stateParameters[a]=b,this.updateCubicBezierFunction(d)}})}},updateCubicBezierFunction:function(a){var b=[],c=this._internal;["1X","1Y","2X","2Y"].forEach(function(d,e){var f=c.stateParameters["cubicBezierP"+d+"-"+a]||0;e%2===0&&(f=Math.min(1,Math.max(0,f))),b.push(f)});var d=g(b);c.bezierEaseCurves[a]=function(a,b,c){return f.linear(a,b,d.get(c))}},jumpToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a)){b.animation.stop();var c="value-"+a+"-";for(var d in b.values){var e=b.values[d];b.currentValues[e]=b.stateParameters[c+e]||0,this.flagOutputDirty(e)}b.valuesAreInitialised=!0,b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}},goToState:function(a){var b=this._internal;if(b.states&&(a||(a=b.states[0]),b.state!==a))if(this._internal.scheduledToGoToState=void 0,b.valuesAreInitialised){for(var c in b.values){var d=b.values[c];b.startValues[d]=b.currentValues[d]}var e=b.stateParameters["transition-"+a]||"easeOut";b.animation.ease="cubicBezier"===e?b.bezierEaseCurves[a]:f[e];var g="duration-"+a;b.animation.duration=b.stateParameters.hasOwnProperty(g)?b.stateParameters[g]:h,b.animation.start(),b.state=a,this.sendSignalOnOutput("stateChanged"),this.updateAtStatePorts(),this.flagOutputDirty("currentState")}else this.jumpToState(a)},updateAtStatePorts:function(){var a=this._internal,b=a.states;for(var c in b){var d=b[c],e="at-"+d;a.currentValues[e]=a.state===d,this.hasOutput(e)&&this.flagOutputDirty(e)}}}};b.exports={node:j,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.States",function(b){b.parameters.states&&d(b.id,b.parameters,a.editorConnection),b.on("parameterUpdated",function(c){("states"===c.name||"values"===c.name||"transition-"===c.name.substring(0,11))&&d(b.id,b.parameters,a.editorConnection)})})}}},{"../easecurves":164,"../edgetriggeredinput":165,"bezier-easing":2}],219:[function(a,b,c){"use strict";function d(a,b){this._internal.inputValues[a]=b,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}function e(a,b,c){var d=b.match(/\{[A-Za-z0-9_]*\}/g),e=[];for(var f in d){var g=d[f],h=g.replace("{","").replace("}","");e.push({name:h,type:"*",plug:"input"})}c.sendDynamicPorts(a,e)}var f={name:"String Format",category:"String Manipulation",initialize:function(){var a=this._internal;a.format="",a.cachedResult="",a.resultDirty=!1,a.inputValues={}},inputs:{format:{type:{name:"string",multiline:!0},displayName:"Format",set:function(a){this._internal.format=a,this._internal.resultDirty=!0,this.flagOutputDirty("formatted")}}},outputs:{formatted:{type:"string",displayName:"Formatted",getter:function(){var a=this._internal;if(a.resultDirty){var b=a.format,c=a.format.match(/\{[A-Za-z0-9_]*\}/g),d=[];c&&(d=c.map(function(a){return a.replace("{","").replace("}","")})),d.forEach(function(c){var d=a.inputValues[c];b=b.replace("{"+c+"}",void 0!==d?d:"")}),a.cachedResult=b,a.resultDirty=!1}return a.cachedResult}}},prototypeExtensions:{registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:d.bind(this,a)})}}};b.exports={node:f,setup:function(a,b){a.editorConnection&&a.editorConnection.isRunningLocally()&&b.on("nodeAdded.String Format",function(b){b.parameters.format&&e(b.id,b.parameters.format,a.editorConnection),b.on("parameterUpdated",function(c){"format"===c.name&&e(b.id,b.parameters.format,a.editorConnection)})})}}},{}],220:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Mapper",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.mappings=[]},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",index:11,createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this.scheduleMapping()}}},output:{name:"numbered/simple-string",displayPrefix:"Mapping",index:12,group:"Mappings",createSetter:function(a){return function(b){b=b.toString(),this._internal.mappings[a]=b,this.scheduleMapping()}}}},inputs:{inputString:{type:{name:"string"},index:1,displayName:"Input String",set:function(a){this._internal.currentInputString=a,this.scheduleMapping()}},defaultMapping:{type:"string",displayName:"Default",index:10,group:"Mappings",set:function(a){this._internal.defaultMapping=a,this.scheduleMapping()}}},outputs:{mappedString:{type:"string",displayName:"Mapped String",group:"Value",getter:function(){return this._internal.mappedString}}},prototypeExtensions:{doMapping:function(){this._internal.hasScheduledFetch=!1;var a=this._internal.inputs.indexOf(this._internal.currentInputString);-1!==a?this._internal.mappedString=this._internal.mappings[a]:this._internal.mappedString=this._internal.defaultMapping,this.flagOutputDirty("mappedString")},scheduleMapping:function(){var a=this._internal;a.hasScheduledFetch||(a.hasScheduledFetch=!0,this.scheduleAfterInputsHaveUpdated(this.doMapping.bind(this)))}}})},{"../nodedefinition":178}],221:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"String Selector",category:"Utilities",initialize:function(){this._internal.inputs=[],this._internal.currentSelectedIndex=0,this._internal.indexChanged=!1},numberedInputs:{input:{name:"numbered/simple-string",displayPrefix:"Input",group:"Inputs",createSetter:function(a){return function(b){b=b.toString(),this._internal.inputs[a]=b,this._internal.currentSelectedIndex===a&&this.flagOutputDirty("currentValue")}}}},inputs:{index:{type:{name:"number"},displayName:"Index","default":0,set:function(a){a=0|a,this._internal.currentSelectedIndex=a,this.flagOutputDirty("currentValue"),this.sendSignalOnOutput("indexChanged")}}},outputs:{currentValue:{type:"string",displayName:"Current Value",group:"Value",getter:function(){return this._internal.inputs[this._internal.currentSelectedIndex]}},indexChanged:{type:"signal",displayName:"Index Changed",group:"Signals"}}})},{"../nodedefinition":178}],222:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Substring",category:"String Manipulation",initialize:function(){var a=this._internal;a.startIndex=0,a.endIndex=-1,a.cachedResult="",a.inputString="",a.resultDirty=!1},inputs:{start:{type:"number",displayName:"Start","default":0,set:function(a){this._internal.startIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},end:{type:"number",displayName:"End","default":0,set:function(a){this._internal.endIndex=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}},string:{type:{name:"string"},displayName:"String","default":"",set:function(a){a=a.toString(),this._internal.inputString=a,this._internal.resultDirty=!0,this.flagOutputDirty("result")}}},outputs:{result:{type:"string",displayName:"Result",getter:function(){var a=this._internal;return a.resultDirty&&(-1===a.endIndex?a.cachedResult=a.inputString.substr(a.startIndex):a.cachedResult=a.inputString.substr(a.startIndex,a.endIndex-a.startIndex),a.resultDirty=!1),a.cachedResult}}}})},{"../nodedefinition":178}],223:[function(a,b,c){"use strict";var d={name:"Switch",category:"Logic",initialize:function(){this._internal.state=!1,this._internal.initialized=!1},inputs:{on:{displayName:"On",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!0&&(this._internal.state=!0,this.flagOutputDirty("state"),this.emitSignals())}},off:{displayName:"Off",group:"Change State",valueChangedToTrue:function(){this._internal.state!==!1&&(this._internal.state=!1,this.flagOutputDirty("state"),this.emitSignals())}},flip:{displayName:"Flip",group:"Change State",valueChangedToTrue:function(){this._internal.state=!this._internal.state,this.flagOutputDirty("state"),this.emitSignals()}},onFromStart:{type:"boolean",displayName:"Start State",group:"Start State","default":!1,set:function(a){a&&!this._internal.initialized&&(this._internal.state=!0,this.flagOutputDirty("state"),this._internal.initialized=!0,this.emitSignals())}}},outputs:{state:{type:"boolean",displayName:"Current State",getter:function(){return this._internal.state}},switchedToOn:{displayName:"Switched To On",type:"signal",group:"Signals"},switchedToOff:{displayName:"Switched To Off",type:"signal",group:"Signals"}},prototypeExtensions:{emitSignals:function(){this._internal.state===!0?this.sendSignalOnOutput("switchedToOn"):this.sendSignalOnOutput("switchedToOff")}}};b.exports={node:d}},{}],224:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Timer",category:"Utilities",initialize:function(){var a=this;this._internal._animation=this.context.timerScheduler.createTimer({duration:0,onStart:function(){a.sendSignalOnOutput("timerStarted")},onFinish:function(){a.sendSignalOnOutput("timerFinished")}})},inputs:{start:{displayName:"Start",valueChangedToTrue:function(){this._internal._animation._isRunning===!1&&this._internal._animation.start()}},restart:{displayName:"Restart",valueChangedToTrue:function(){this._internal._animation.start()}},duration:{type:"number",displayName:"Duration","default":0,set:function(a){this._internal._animation.duration=a}},startDelay:{type:"number",displayName:"Start Delay","default":0,set:function(a){this._internal._animation.delay=a}},stop:{displayName:"Stop",valueChangedToTrue:function(){this._internal._animation.stop()}}},outputs:{timerStarted:{type:"signal",displayName:"Started"},timerFinished:{type:"signal",displayName:"Finished"}}})},{"../nodedefinition":178}],225:[function(a,b,c){"use strict";var d=a("../node"),e={name:"Touch Position",category:"Interaction",initialize:function(){this._internal.x=0,this._internal.y=0,this.context.uiEngine.on("touchEvent",this.onTouchEvent.bind(this),this)},outputs:{x:{type:"number",displayName:"Position X",getter:function(){return this._internal.x}},y:{type:"number",displayName:"Position Y",getter:function(){return this._internal.y}}},prototypeExtensions:{_onNodeDeleted:function(){d.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this)},onTouchEvent:function(a){this._internal.x!==a.x&&(this._internal.x=a.x,this.flagOutputDirty("x")),this._internal.y!==a.y&&(this._internal.y=a.y,this.flagOutputDirty("y"))}}};b.exports={node:e}},{"../node":176}],226:[function(a,b,c){"use strict";function d(a){var b=this._internal._animation;b.stop(),b.startValue=a,this.scheduleAfterInputsHaveUpdated(function(){b.endValue!==a&&b.start()}),this._internal.currentNumber=a,this.flagOutputDirty("currentValue")}var e=a("../nodedefinition"),f=a("../easecurves"),g=300,h={name:"Transition",category:"Animation",initialize:function(){var a=this,b=this._internal;b.currentNumber=0,b.numberInitialized=!1,b.animationStarted=!1,b.setCurrentNumberEnabled=!1,b.overrideValue=0,b._animation=this.context.timerScheduler.createTimer({duration:g,startValue:0,endValue:0,ease:f.easeOut,onStart:function(){b.animationStarted=!0},onRunning:function(c){b.currentNumber=this.ease(this.startValue,this.endValue,c),a.flagOutputDirty("currentValue")},onFinish:function(){a.sendSignalOnOutput("atTargetValue")}})},inputs:{targetValue:{type:{name:"number"},displayName:"Value",group:"Target Value","default":void 0,set:function(a){if(a===!0?a=1:a===!1&&(a=0),a=Number(a),!isNaN(a)){var b=this._internal;return b.numberInitialized===!1?(b.currentNumber=a,b.numberInitialized=!0,b._animation.endValue=a,void this.flagOutputDirty("currentValue")):void(a!==b._animation.endValue&&(b._animation.startValue=b.currentNumber,b._animation.endValue=a,b._animation.start()))}}},"overrideCurrentValue.value":{type:{name:"number"},group:"Override Value",displayName:"Value",editorName:"Value|Override Value",set:function(a){this._internal.overrideValue=a}},"overrideCurrentValue.do":{group:"Override Value",displayName:"Do",editorName:"Do|Override Value",valueChangedToTrue:function(){d.call(this,this._internal.overrideValue)}},duration:{type:"number",group:"Parameters",displayName:"Duration","default":g,set:function(a){this._internal._animation.duration=a}},delay:{type:"number",group:"Parameters",displayName:"Delay","default":0,set:function(a){this._internal._animation.delay=a}},easingCurve:{type:{name:"enum",enums:[{value:"easeOut",label:"Ease Out"},{value:"easeIn",label:"Ease In"},{value:"linear",label:"Linear"},{value:"easeInOut",label:"Ease In Out"}]},"default":"easeOut",displayName:"Easing Curve",group:"Parameters",set:function(a){this._internal._animation.ease=f[a]}}},outputs:{currentValue:{type:"number",displayName:"Current Value",group:"Current State",getter:function(){return this._internal.currentNumber}},atTargetValue:{type:"signal",displayName:"At Target Value",group:"Signals"}}};b.exports=e.defineNode(h)},{"../easecurves":164,"../nodedefinition":178}],227:[function(a,b,c){"use strict";var d=a("../nodedefinition"),e=d.defineNode({name:"Unique Id",category:"String Manipulation",initialize:function(){var a=this._internal;a.guid=this.guid()},inputs:{"new":{displayName:"New",valueChangedToTrue:function(){var a=this._internal;a.guid=this.guid(),this.flagOutputDirty("guid")}}},outputs:{guid:{type:"string",displayName:"Id",getter:function(){var a=this._internal;return a.guid}}},prototypeExtensions:{guid:function(){function a(){return Math.floor(65536*(1+Math.random())).toString(16).substring(1)}return a()+a()+"-"+a()+"-"+a()+"-"+a()+"-"+a()+a()+a()}}});b.exports=e},{"../nodedefinition":178}],228:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Value Changed",category:"Logic",initialize:function(){this._internal.lastValue=void 0},inputs:{value:{type:"*",displayName:"Input",set:function(a){this._internal.lastValue!==a&&(this.sendSignalOnOutput("valueChanged"),this._internal.lastValue=a)}}},outputs:{valueChanged:{type:"signal",displayName:"Value Changed"}}})},{"../nodedefinition":178}],229:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Boolean",startValue:!1,type:{name:"boolean"},cast:function(a){return Boolean(a)}});b.exports={node:e}},{"./variablebase":233}],230:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition");b.exports=e.defineNode(d.createDefinition({name:"Color",startValue:"#f1f2f4",type:{name:"color"},cast:function(a){return a}}))},{"../../nodedefinition":178,"./variablebase":233}],231:[function(a,b,c){"use strict";var d=a("./variablebase"),e=d.createDefinition({name:"Number",startValue:0,type:{name:"number"},cast:function(a){return Number(a)}});b.exports={node:e}},{"./variablebase":233}],232:[function(a,b,c){"use strict";var d=a("./variablebase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"String",startValue:"",type:{name:"string"},cast:function(a){return a.toString()}});e.extend(f,{outputs:{length:{type:"number",displayName:"Length",getter:function(){return this._internal.currentValue.length}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":178,"./variablebase":233}],233:[function(a,b,c){"use strict";function d(a){return{name:a.name,category:"Variables",initialize:function(){this._internal.currentValue=a.startValue,this._internal.latestValue=0},inputs:{value:{type:a.type,displayName:"Value","default":a.startValue,set:function(a){this.isInputConnected("saveValue")===!1?this.setValueTo(a):this._internal.latestValue=a}},saveValue:{displayName:"Save Value",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){this.setValueTo(this._internal.latestValue)})}}},outputs:{savedValue:{type:a.type.name,displayName:"Saved Value",getter:function(){return this._internal.currentValue}}},prototypeExtensions:{setValueTo:function(b){b=a.cast(b),this._internal.currentValue=b,this.flagAllOutputsDirty()}}}}b.exports={createDefinition:d}},{}],234:[function(a,b,c){"use strict";var d=a("../nodedefinition");b.exports=d.defineNode({name:"Velocity",category:"Math",initialize:function(){var a=this._internal;a.oldValue=0,a.sampledAtTime=0,a.velocity=0},inputs:{value:{type:"number",displayName:"Value",set:function(a){var b=this._internal;if(0===b.sampledAtTime)return b.oldValue=a,void(b.sampledAtTime=this.context.currentFrameTime);if(this.context.currentFrameTime!==b.sampledAtTime){var c=this.context.currentFrameTime-b.sampledAtTime;b.velocity=(a-b.oldValue)/c,b.sampledAtTime=this.context.currentFrameTime,b.oldValue=a,this.flagOutputDirty("velocity")}}}},outputs:{velocity:{type:"number",displayName:"Velocity",getter:function(){return this._internal.velocity}}}})},{"../nodedefinition":178}],235:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f0f0f0",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"px",defaultWidth:200,defaultHeight:200,defaultColor:f,createControl:function(a){var b=a.createCircleControl();return b.setWidth(200),b.setColor(f),b}});delete g.inputs.height,g.inputs.width.displayName="Size",g.inputs.width.type.units=["px"],e.extend(g,{name:"Circle",inputs:{solid:{index:3004,type:"boolean",displayName:"Solid",group:"Appearance","default":!0,set:function(a){this._internal.uiControl.setSolid(a?!0:!1)}},lineWidth:{index:3005,type:"number",displayName:"Line Width",group:"Appearance","default":1,set:function(a){this._internal.uiControl.setLineWidth(a)}},blur:{index:3006,displayName:"Blur Length",group:"Appearance",type:"number","default":0,set:function(a){this._internal.uiControl.setBlur(a)}},arcAngle:{index:3007,displayName:"Arc Angle",group:"Appearance",type:"number","default":360,set:function(a){this._internal.uiControl.setArcAngle(a*Math.PI/180)}},image:{index:3500,displayName:"Image Path",group:"Image Properties",type:{name:"image"},set:function(a){"string"==typeof a&&this.context.runningInEditor&&"/"!==a[0]&&(a="/"+a),this._internal.uiControl.setImagePath(a)}}}}),b.exports={node:g}},{"../../nodedefinition":178,"./renderable":246}],236:[function(a,b,c){"use strict";function d(a,b){var c,d=/\s+([0-9]+)\s*vw/g,e=a+"";do c=d.exec(a),c&&(e=e.replace(c[0]," "+Math.round(parseInt(c[1])*b)+"px"));while(c);return e}var e=a("../../node"),f={name:"CSS Definition",category:"HTML",initialize:function(){var a=this._internal;a.style="",this.context.uiEngine.on("viewportSizeChanged",this.viewPortSizeChanged.bind(this),this)},inputs:{style:{index:4005,type:{name:"string",allowEditOnly:!0,codeeditor:"css"},displayName:"Style",group:"Content","default":"",set:function(a){var b=this.context.uiEngine.getUIScale();this.updateStyle(a,b)}}},outputs:{},prototypeExtensions:{getStyleRefId:function(){return"style_"+this.id},viewPortSizeChanged:function(a){var b=this.context.uiEngine.getUIScale();this.updateStyle(this._internal.style,b)},removeStyleDeclaration:function(){var a=this.getStyleRefId(),b=(this._internal,document.getElementById(a));null!==b&&b.parentNode.removeChild(b)},_onNodeDeleted:function(){e.prototype._onNodeDeleted.call(this),this.context.uiEngine.removeListenersWithRef(this),this.removeStyleDeclaration()},updateStyle:function(a,b){var c=this._internal,e=this.getStyleRefId();if(c.style=a,a=d(a,b),null!==a){var f=document.getElementById(e);null===f&&(f=document.createElement("style"),f.id=e,f.type="text/css",document.head.appendChild(f)),f.innerHTML="\n"+a+"\n"}else this.removeStyleDeclaration()}}};b.exports={node:f,setup:function(a,b){!a.editorConnection||!a.editorConnection.isRunningLocally();
}}},{"../../node":176}],237:[function(a,b,c){"use strict";var d=a("./util/shadersupport"),e=a("./layoutbase"),f=a("../../node"),g=a("../../nodedefinition"),h=a("../../uiengine/controls/effectcontrol"),i=e.createDefinition({name:"Effect group",createControl:function(a){return a.createEffectControl()}}),j=[{name:"gaussianBlur.radius",plug:"input",type:"number","default":h.StandardGaussianBlurRadius,displayName:"Blur Radius",group:"Effects",index:2002}],k=[{name:"standardEffect.amount",plug:"input",type:"number","default":h.StandardEffectAmount,displayName:"Effect Amount",group:"Effects",index:2001}];g.extend(i,{initialize:function(){var a=this._internal;a.standardEffect="none",a.shaderSupport=new d(a.uiControl,!1),a.secondaryShaderSupport=new d(a.uiControl,!0);var b=this;a.uiControl.on("layoutWidthChanged",function(){b.flagOutputDirty("outputImage")}),a.uiControl.on("layoutHeightChanged",function(){b.flagOutputDirty("outputImage")})},dynamicports:[{name:"conditionalports/basic",condition:"standardEffect = gaussianBlur",ports:j},{name:"conditionalports/basic",condition:"standardEffect != none",ports:k}],inputs:{"gaussianBlur.radius":{set:function(a){this._internal.uiControl.setGaussianBlurRadius(a)}},"standardEffect.amount":{set:function(a){this._internal.uiControl.setEffectAmount(a)}},standardEffect:{type:{name:"enum",enums:[{value:"none",label:"None"},{value:"gaussianBlur",label:"Gaussian Blur"},{value:"desaturate",label:"Desaturate"}]},group:"Effects",displayName:"Standard Effect","default":"none",index:2e3,set:function(a){this._internal.standardEffect=a,this._internal.uiControl.setStandardEffect(a),this.scheduleAfterInputsHaveUpdated(function(){this.updatePorts()})}},vertices:{type:"object",displayName:"Vertices",group:"Effects",set:function(a){this._internal.uiControl.setVertices(a)}},renderScale:{group:"Effects",index:2003,type:{name:"number",units:["%"],defaultUnit:"%"},"default":100,displayName:"Render Scale",set:function(a){var b=Math.max(.01,Math.min(4,a/100));this._internal.uiControl.setRenderScale(b)}},maskImage:{index:2004,type:{name:"image"},displayName:"Mask Image Path",group:"Effects",set:function(a){this.scheduleAfterInputsHaveUpdated(function(){this._internal.uiControl.setMaskImagePath(a)})}},drawToScreen:{index:2005,type:"boolean",group:"Effects",displayName:"Draw To Screen","default":!0,set:function(a){this._internal.uiControl.setDrawToScreen(a)}},shader:{type:"object",displayName:"Shader",group:"Shader properties",set:function(a){var b=this._internal;b.uiControl.setShader(a),b.shaderSupport.setShader(a,this.id),this.scheduleAfterInputsHaveUpdated(function(){this.updatePorts()})}},secondPassShader:{type:"object",displayName:"Second Pass Shader",group:"Shader properties",set:function(a){var b=this._internal;b.uiControl.setSecondaryShader(a),b.secondaryShaderSupport.setShader(a),this.scheduleAfterInputsHaveUpdated(function(){this.updatePorts()})}},cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance","default":0,set:function(a){this._internal.uiControl.setCornerRadius(a)}}},outputs:{outputImage:{type:"string",displayName:"Output Image",group:"Effects",getter:function(){return this._internal.uiControl.getOutputImageId()}}},prototypeExtensions:{_onNodeDeleted:function(){f.prototype._onNodeDeleted.call(this),this._internal.shaderSupport.control=null},registerOutputIfNeeded:function(a){f.prototype.registerOutputIfNeeded.call(this),"outputImage"===a&&(this._internal.uiControl.setFrameBufferIsExclusive(!0),this._internal.uiControl.setRenderEffectsToTexture(!0))},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:this.uniformSetter.bind(this,a)})},updatePorts:function(){if(this.context.editorConnection&&this.context.editorConnection.isRunningLocally()){var a=this._internal.shaderSupport.ports;a=a.concat(this._internal.secondaryShaderSupport.ports),this.context.editorConnection.sendDynamicPorts(this.id,a)}},uniformSetter:function(a,b){var c=this._internal;this.scheduleAfterInputsHaveUpdated(function(){-1!==a.indexOf(c.secondaryShaderSupport.uniformPrefix)?c.secondaryShaderSupport.setUniform(a,b):c.shaderSupport.setUniform(a,b)})}},version:1}),b.exports={node:i}},{"../../node":176,"../../nodedefinition":178,"../../uiengine/controls/effectcontrol":267,"./layoutbase":242,"./util/shadersupport":251}],238:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Flow Layout",hasOrientation:!0,createControl:function(a){return a.createFlowLayoutControl()}});e.extend(f,{inputs:{verticalItemSpacing:{index:2501,group:"Layout",displayName:"V. Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setVerticalItemSpacing(Number(a))}},horizontalItemSpacing:{index:2502,group:"Layout",displayName:"H. Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setHorizontalItemSpacing(Number(a))}},contentAlignX:{index:2503,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Layout",displayName:"Content Align X","default":"left",set:function(a){this._internal.uiControl.setContentAlignX(a)}},contentAlignY:{index:2504,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Layout",displayName:"Content Align Y","default":"top",set:function(a){this._internal.uiControl.setContentAlignY(a)}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":178,"./layoutbase":242}],239:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=d.createDefinition({name:"Group",createControl:function(a){return a.createDockLayoutControl()},version:2});b.exports={node:e}},{"./layoutbase":242}],240:[function(a,b,c){"use strict";function d(){return/{{[{]?(.*?)[}]?}}/g}function e(a,b){this._internal.inputValues[a]=b,this.shouldUpdateHTML()&&f.call(this)}function f(){var a,b=this._internal.content,c=b+"",e=d(),f=this._internal.inputValues;do if(a=e.exec(b)){var g="";a[1]in f&&f[a[1]]&&(g=f[a[1]]),c=c.replace(a[0],g)}while(a);return this._internal.uiControl.setContent(c)}function g(a){var b,c=d(),e=[];do b=c.exec(a),b&&e.push({group:"Inputs",plug:"input",name:b[1],type:"string"});while(b);this.context.editorConnection&&this.context.editorConnection.isRunningLocally()&&this.context.editorConnection.sendDynamicPorts(this.id,e)}var h=a("../../nodedefinition"),i=a("../../node"),j=a("./visualbase"),k=j.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,createControl:function(a){return a.createHtmlControl()}}),l={name:"html",plug:"input",index:3004,type:{name:"string",allowEditOnly:!0,codeeditor:"html"},"default":"<!DOCTYPE html>",displayName:"HTML",group:"Content"},m={name:"HTML Content",initialize:function(){var a=this._internal;a.content="",a.addedToDOM=!1,a.inputValues={},a.usesDynamicContent=!1,a.elementType="div"},dynamicports:[{name:"conditionalports/basic",condition:"elementType = div AND usesDynamicContent = false OR usesDynamicContent NOT SET",ports:[l]},{name:"conditionalports/basic",condition:"elementType NOT SET AND usesDynamicContent = false OR usesDynamicContent NOT SET",ports:[l]},{name:"conditionalports/basic",condition:"elementType = div OR elementType NOT SET",ports:[{index:3003,type:{name:"boolean"},displayName:"Dynamic Content",group:"Content",name:"usesDynamicContent",plug:"input"}]}],inputs:{elementType:{index:3002,group:"Content",displayName:"Element type",type:{name:"enum",enums:[{value:"div",label:"div"},{value:"canvas",label:"canvas"}]},"default":"div",set:function(a){var b=this._internal,c=b.uiControl;(null===c.domNode||c.domNode.element.tagName.toLowerCase().valueOf()!==a.valueOf())&&(c.domNode&&(c.domNode.removeListenersWithRef(this),c.domNode.dispose()),this._internal.addedToDOM=!1,this.hasOutput("isAddedToDOM")&&this.flagOutputDirty("isAddedToDOM"),this._internal.elementType=a,this.createDOMNodeWithElementType(a),this.hasOutput("domElement")&&this.flagOutputDirty("domElement"))}},usesDynamicContent:{"default":!1,set:function(a){if(this._internal.uiControl.isAttached()&&"div"===this.internal.elementType)if(a&&!this._internal.usesDynamicContent){var b=this._internal.content;this._internal.content="",g.call(this,this._internal.content),f.call(this),this._internal.content=b}else!a&&this._internal.usesDynamicContent&&(g.call(this,this._internal.content),f.call(this));this._internal.usesDynamicContent=a}},html:{"default":"",set:function(a){this._internal.content!==a&&(this._internal.content=a,this.shouldUpdateHTML()&&f.call(this),g.call(this,a))}},className:{index:3008,type:{name:"string"},displayName:"CSS Classes",group:"Content","default":"",set:function(a){this._internal.className!==a&&(this._internal.className=a,this._internal.uiControl.setClassName(a))}}},outputs:{isAddedToDOM:{type:"boolean",displayName:"Added to DOM",group:"General",getter:function(){return this._internal.addedToDOM}},domElement:{type:"domelement",displayName:"DOM Element",group:"General",getter:function(){return this._internal.uiControl.domNode.element}}},prototypeExtensions:{createDOMNodeWithElementType:function(a){var b=this._internal,c=b.uiControl,d=this.context.uiEngine.createDOMElement("html",a,c.id,!0);c.setDomNode(d);var e=this;d.on("addedToParent",function(a){b.addedToDOM||(e._internal.addedToParentCallback&&e._internal.addedToParentCallback(a),e.shouldUpdateHTML()&&(g.call(e,e._internal.content),f.call(e)),b.addedToDOM=!0,e.hasOutput("isAddedToDOM")&&e.flagOutputDirty("isAddedToDOM"),b.initialHTMLSetCallback&&b.initialHTMLSetCallback())},this),d.on("removedFromParent",function(a){b.addedToDOM=!1,e.hasOutput("isAddedToDOM")&&e.flagOutputDirty("isAddedToDOM")},this)},setNodeModel:function(a){var b=this._internal,c=a.parameters.elementType||"div";"canvas"!==c.valueOf()&&"div"!==c.valueOf()&&(c="div"),b.elementType=c,this.createDOMNodeWithElementType(c),i.prototype.setNodeModel.call(this,a)},shouldUpdateHTML:function(){return this._internal.uiControl.isAttached()&&!this._internal.usesDynamicContent&&"div"===this._internal.elementType},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this);var a=this._internal;a.addedToParentCallback&&delete a.addedToParentCallback,a.initialHTMLSetCallback&&delete a.initialHTMLSetCallback;var b=a.uiControl;null!==b.domNode&&b.domNode.removeListenersWithRef(this),b.dispose()},registerInputIfNeeded:function(a){this.hasInput(a)||(this._internal.inputValues[a]=void 0,this.registerInput(a,{set:e.bind(this,a)}))}}},n=h.extend(k,m);b.exports={definition:m,node:n,setup:function(a,b){!a.editorConnection||!a.editorConnection.isRunningLocally()}}},{"../../node":176,"../../nodedefinition":178,"./visualbase":253}],241:[function(a,b,c){"use strict";var d=a("./util/shadersupport"),e=a("./renderable"),f=a("../../nodedefinition"),g=a("../../node"),h=(a("../../uiengine/controls/effectcontrol"),e.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultColor:"#ffffff",createControl:function(a){return a.createImageControl()}}));f.extend(h,{name:"Image",version:2,usePortAsLabel:"image",portLabelTruncationMode:"filename",initialize:function(){var a=this._internal;a.shaderSupport=new d(a.uiControl)},inputs:{image:{index:2500,type:{name:"image"},displayName:"Image Path",group:"Image Properties",set:function(a){this._internal.uiControl.setImagePath(a?a:null)}},cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance","default":0,set:function(a){this._internal.uiControl.innerControl.setCornerRadius(a)}},fillMode:{index:2501,type:{name:"enum",enums:[{value:"original",label:"Original"},{value:"aspectFill",label:"Aspect Fill"},{value:"aspectFit",label:"Aspect Fit"},{value:"fill",label:"Fill"}],allowEditOnly:!0},displayName:"Fill Mode",group:"Image Properties","default":"original",set:function(a){this._internal.uiControl.setFillMode(a)}},clipImage:{index:2502,type:"boolean",displayName:"Clip Image","default":!0,group:"Image Properties",set:function(a){this._internal.uiControl.setClip(a?!0:!1)}},vertices:{type:"object",displayName:"Vertices",group:"Image properties",set:function(a){this._internal.uiControl.setVertices(a)}},shader:{type:"object",displayName:"Shader",group:"Image Properties",set:function(a){var b=this._internal;b.shader=a,b.uiControl.setShader(a),b.shaderSupport.setShader(a,this.id),this.updatePorts()}}},prototypeExtensions:{_onNodeDeleted:function(){g.prototype._onNodeDeleted.call(this),this._internal.shaderSupport.control=null},updatePorts:function(){this.context.editorConnection&&this.context.editorConnection.isRunningLocally()&&this.context.editorConnection.sendDynamicPorts(this.id,this._internal.shaderSupport.ports)},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:this.uniformSetter.bind(this,a)})},uniformSetter:function(a,b){var c=this._internal;this.scheduleAfterInputsHaveUpdated(function(){c.shaderSupport.setUniform(a,b)})}}});var i=[{inputName:"cropStartX",index:0,"default":0,displayName:"Crop Start X"},{inputName:"cropEndX",index:2,"default":1,displayName:"Crop End X"},{inputName:"cropStartY",index:1,"default":0,displayName:"Crop Start Y"},{inputName:"cropEndY",index:3,"default":1,displayName:"Crop End Y"}],j={};i.forEach(function(a){var b=a.index;j[a.inputName]={index:2503+b,type:"number",group:"Image Properties","default":a["default"],displayName:a.displayName,set:function(a){this._internal.innerControl._srcRect[b]=a,this._internal.innerControl.contentDirty=!0}}}),f.extend(h,j),b.exports=f.defineNode(h)},{"../../node":176,"../../nodedefinition":178,"../../uiengine/controls/effectcontrol":267,"./renderable":246,"./util/shadersupport":251}],242:[function(a,b,c){"use strict";function d(a){var b=e.createDefinition({createControl:a.createControl,sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});return f.extend(b,{name:a.name,version:a.version,initialize:function(){var a=this._internal;a.children=[],a.padding=0},allowChildren:!0,inputs:{clip:{group:"Appearance",displayName:"Clip",type:"boolean",index:3100,"default":!1,set:function(a){this._internal.uiControl.setClip(a)}},padding:{group:"Padding",displayName:"Padding",type:"number",index:2800,"default":0,set:function(a){var b=this._internal.uiControl;this._internal.padding=a,b.setPaddingTop(a),b.setPaddingLeft(a),b.setPaddingBottom(a),b.setPaddingRight(a)}},paddingLeft:{group:"Padding",displayName:"Pad Left",type:"number",index:2801,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingLeft(a)}},paddingRight:{group:"Padding",displayName:"Pad Right",type:"number",index:2802,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingRight(a)}},paddingTop:{group:"Padding",displayName:"Pad Top",type:"number",index:2803,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingTop(a)}},paddingBottom:{group:"Padding",displayName:"Pad Bottom",type:"number",index:2804,set:function(a){a=void 0!==a?a:this._internal.padding,this._internal.uiControl.setPaddingBottom(a)}}},outputs:{childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}},prototypeExtensions:{addChild:{value:function(a,b){if(!a.getVisualRoot)throw new Error("child must have a visual root");var c=this._internal.uiControl,d=this._internal.children;void 0===b&&(b=d.length),b=Math.max(0,b),c.addChild(a.getVisualRoot()._internal.uiControl,b),b===d.length?d.push(a):d.splice(b,0,a),this.flagOutputDirty("childCount");for(var e=b;e<d.length;e++)d[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=this,a.getVisualRoot()._internal.visualParent=this}},getChildren:{value:function(){return g.clone(this._internal.children)}},removeChild:{value:function(a){if(!a.getVisualRoot)throw new Error("child must be a visual node");var b=this._internal.children,c=b.indexOf(a);if(-1===c)throw new Error("child is not a child of this node");if(a.getVisualRoot()){var d=a.getVisualRoot()._internal.uiControl;d.parent&&d.parent.removeChild(d)}b.splice(c,1),this.flagOutputDirty("childCount");for(var e=c;e<b.length;e++)b[e].getVisualRoot().flagOutputDirty("childIndex");a._internal.visualParent=void 0,a.getVisualRoot()&&(a.getVisualRoot()._internal.visualParent=void 0)}},isChild:{value:function(a){return-1!==this._internal.children.indexOf(a)}},getChildRoot:{value:function(){return this}}}}),a.hasOrientation&&f.extend(b,{initialize:function(){this._internal.uiControl.setOrientation("vertical")},inputs:{orientation:{index:2500,group:"Layout",displayName:"Orientation",type:{name:"enum",enums:[{value:"horizontal",label:"Horizontal"},{value:"vertical",label:"Vertical"}]},"default":"vertical",set:function(a){this._internal.uiControl.setOrientation(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition"),g=a("lodash");b.exports={createDefinition:d}},{"../../nodedefinition":178,"./visualbase":253,lodash:117}],243:[function(a,b,c){"use strict";function d(a,b){var c=a.getLayoutRect().width;void 0===c&&(c=0);var d=.3*-c;0>=b?a.setPositionX(g.easeInOut(d,0,1+b)):a.setPositionX(g.easeInOut(0,c,b))}var e=a("./layoutbase"),f=a("../../nodedefinition"),g=a("../../easecurves"),h=e.createDefinition({name:"Page",createControl:function(a){return a.createDockLayoutControl()}});f.extend(h,{initialize:function(){this._internal.title="",this._internal.transition="default",this._internal.transitionPosition=0,this._internal.transitionDuration=350,this._internal.customTransitionDuration=350},dynamicports:[{name:"conditionalports/basic",condition:"transition = custom",ports:[{name:"customTransitionDuration",plug:"input",type:"number",displayName:"Transition Duration",group:"Page","default":350}]}],inputs:{title:{type:"string",displayName:"Title",group:"Page",set:function(a){this._internal.title=a,this._internal.pagesNode&&this._internal.pagesNode.flagOutputDirty("currentPageTitle")}},transition:{displayName:"Transition",group:"Page","default":"default",type:{name:"enum",enums:[{value:"none",label:"None"},{value:"default",label:"Default"},{value:"custom",label:"Custom"}]},set:function(a){var b=this._internal;b.transition=a}},customTransitionDuration:{set:function(a){this._internal.customTransitionDuration=a}}},outputs:{transitionPosition:{index:0,type:"number",displayName:"Transition Position",group:"Page",getter:function(){return this._internal.transitionPosition}},pageShowing:{type:"signal",displayName:"Page Showing",group:"Page Signals"},pageHiding:{type:"signal",displayName:"Page Hiding",group:"Page Signals"},pageShown:{type:"signal",displayName:"Page Shown",group:"Page Signals"},pageHidden:{type:"signal",displayName:"Page Hidden",group:"Page Signals"}},prototypeExtensions:{setPagesNode:function(a){this._internal.pagesNode=a},setTransitionPosition:function(a){var b=this._internal;"default"===b.transition&&d(this,a),b.transitionPosition=a,this.flagOutputDirty("transitionPosition")},getAnimationDuration:function(){switch(this._internal.transition){case"none":return 0;case"default":case"ios":return 350;case"custom":return this._internal.customTransitionDuration}return 0},getAnimationPosition:function(){return this._internal.transitionPosition},sendPageShowingSignal:function(){this.sendSignalOnOutput("pageShowing")},sendPageHidingSignal:function(){this.sendSignalOnOutput("pageHiding")},sendPageShownSignal:function(){this.sendSignalOnOutput("pageShown")},sendPageHiddenSignal:function(){this.sendSignalOnOutput("pageHidden")},getTitle:function(){return this._internal.title}}}),b.exports=f.defineNode(h)},{"../../easecurves":164,"../../nodedefinition":178,"./layoutbase":242}],244:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=a("../../guid"),g=a("../../easecurves"),h=a("lodash"),i=a("../../node"),j=d.createDefinition({name:"Pages",createControl:function(a){return a.createDockLayoutControl()}});e.extend(j,{initialize:function(){this._internal.pageStack=[],this._internal.isNavigating=!1,this._internal.portUpdateScheduled=!1},inputs:{startPage:{type:"component",displayName:"Start Page",group:"Navigation",set:function(a){if(this._cleanup(),a){var b=this._createPage(a);this.startPageComponent=b;var c=this._internal,d=this.context.getComponentModel(a);c.startPageComponentModel=d,this.updateStartPagePorts(d),d.on("inputPortAdded",this.scheduleUpdateStartPagePorts.bind(this,d),this),d.on("inputPortRemoved",this.scheduleUpdateStartPagePorts.bind(this,d),this),c.pageStack.push(b),this.addPageAtIndex(b,0),b.getVisualRoot().sendPageShowingSignal()}}},back:{displayName:"Back",group:"Navigation",valueChangedToTrue:function(){this.back()}}},outputs:{currentPageTitle:{type:"string",displayName:"Current Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return 0===a.length?"":a[a.length-1].getVisualRoot().getTitle()}},prevPageTitle:{type:"string",displayName:"Previous Page Title",group:"Pages",getter:function(){var a=this._internal.pageStack;return a.length<2?"":a[a.length-2].getVisualRoot().getTitle()}},hasPreviousPage:{type:"boolean",displayName:"Has Previous Page",group:"Pages",getter:function(){return this._internal.pageStack.length>1}},navigatedForward:{type:"signal",displayName:"Navigated Forward",group:"Pages Signals"},navigatedBack:{type:"signal",displayName:"Navigated Back",group:"Pages Signals"}},prototypeExtensions:{_cleanup:function(){var a=this._internal;a.startPageComponentModel&&(a.startPageComponentModel.removeListenersWithRef(this),a.startPageComponentModel=void 0);var b=this;this.getChildren().forEach(function(a){b.removeChild(a),b.nodeScope.deleteNode(a)}),a.pageStack.forEach(function(a){a._onNodeDeleted()}),this.startPageComponent=void 0,a.pageStack=[]},_onNodeDeleted:function(){i.prototype._onNodeDeleted.call(this),this._cleanup()},addPageAtIndex:function(a,b){this.addChild(a,b),this.flagOutputDirty("currentPageTitle"),this.flagOutputDirty("prevPageTitle")},waitUntilNewPageLoaded:function(a,b){var c=this;this.context.uiEngine.renderer.setClipToViewport(!1);this._internal;this.context.uiEngine.setTouchEnabled(!1),this.context.scheduleNextFrame(function(){0===i.numberOfSignalsSentThisFrame&&0===i.numberOfQueuedSignalsThisFrame||a>=4?c.context.scheduleNextFrame(function(){c.context.uiEngine.setTouchEnabled(!0),b()}):c.waitUntilNewPageLoaded(a+1,b)})},navigateTo:function(a,b){if(!this._internal.isNavigating){var c=this._internal,d=c.pageStack,e=d[d.length-1],f=this._createPage(a,b),g=f.getVisualRoot();d.push(f),this.addPageAtIndex(f),this.context.layout(),g.setTransitionPosition(1),f.update();var h=this;this.waitUntilNewPageLoaded(0,function(){h._animationPageAnimationPositionTo(f,0),h._animationPageAnimationPositionTo(e,-1)}),d.length>1&&this.flagOutputDirty("hasPreviousPage"),this.sendSignalOnOutput("navigatedForward")}},resetTo:function(a,b){var c=this._internal,d=c.pageStack,e=this._createPage(a,b),f=e.getVisualRoot(),g=this;d.forEach(function(a){g.isChild(a)&&g.removeChild(a),g.nodeScope.deleteNode(a)}),d.length=0,d.push(e),this.addPageAtIndex(e),this.context.layout(),f.setTransitionPosition(0),e.update(),f.sendPageShownSignal(),this.flagOutputDirty("hasPreviousPage")},back:function(){var a=this._internal.pageStack;if(1!==a.length&&!this._internal.isNavigating){var b=a.pop();1===a.length&&this.flagOutputDirty("hasPreviousPage");var c=a[a.length-1];c.getVisualRoot()._internal.visualParent||this.addPageAtIndex(c,this._internal.children.indexOf(b)-1),this._animationPageAnimationPositionTo(c,0),this._animationPageAnimationPositionTo(b,1),this.sendSignalOnOutput("navigatedBack")}},_animationPageAnimationPositionTo:function(a,b){var c=a.getVisualRoot(),d=c.getAnimationPosition();if(d!==b){0===b?c.sendPageShowingSignal():c.sendPageHidingSignal(),this._internal.isNavigating=!0;var e=this,f=this.context.timerScheduler.createTimer({duration:c.getAnimationDuration(),onRunning:function(a){c.setTransitionPosition(g.linear(d,b,a))},onFinish:function(){e.context.uiEngine.renderer.setClipToViewport(!0),-1===b||1===b?(c.sendPageHiddenSignal(),e.isChild(a)&&e.removeChild(a),1===b&&e.context.scheduleNextFrame(function(){e.nodeScope.deleteNode(a)})):0===b&&c.sendPageShownSignal(),e._internal.isNavigating=!1}});f.start()}},_createPage:function(a,b){var c=this.nodeScope.createNode(a,f());c.getVisualRoot().setPagesNode(this);for(var d in b)c.queueInput(d,b[d]);return c},registerInputIfNeeded:function(a){this.hasInput(a)||this.registerInput(a,{set:function(b){this.startPageComponent?this.startPageComponent.setInputValue(a,b):this.scheduleAfterInputsHaveUpdated(function(){this.startPageComponent.hasInput(a)&&this.startPageComponent.setInputValue(a,b)})}})},scheduleUpdateStartPagePorts:function(a){if(!this._internal.portUpdateScheduled){this._internal.portUpdateScheduled=!0;var b=this;this.context.scheduleAfterUpdate(function(){b.updateStartPagePorts(a),b._internal.portUpdateScheduled=!1})}},updateStartPagePorts:function(a){var b=h.values(a.getInputPorts()).map(function(a){return{name:a.name,plug:"input",type:a.type,group:"Start Page Inputs"}});this.context.editorConnection.sendDynamicPorts(this.id,b)}}}),b.exports=e.defineNode(j)},{"../../easecurves":164,"../../guid":170,"../../node":176,"../../nodedefinition":178,"./layoutbase":242,lodash:117}],245:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f="#f1f2f4",g=d.createDefinition({defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,defaultColor:f,createControl:function(a){var b=a.createRectangleControl();return b.setColor(f),b}});e.extend(g,{name:"Rectangle",inputs:{cornerRadius:{index:3004,type:"number",displayName:"Corner Radius",group:"Appearance","default":0,set:function(a){this._internal.uiControl.setCornerRadius(a)}},blur:{index:3005,type:"number",displayName:"Blur Length",group:"Appearance","default":0,set:function(a){this._internal.uiControl.setBlur(a)}}}}),b.exports=e.defineNode(g)},{"../../nodedefinition":178,"./renderable":246}],246:[function(a,b,c){"use strict";function d(a){if(!a.defaultColor)throw new Error("No default color specified");var b=e.createDefinition(a),c=[{value:"alpha",label:"Alpha"},{value:"solid",label:"Solid"},{value:"additive",label:"Additive"},{value:"multiply",label:"Multiply"}];return f.extend(b,{inputs:{blendMode:{index:3003,type:{name:"enum",enums:c},"default":"alpha",displayName:"Blend Mode",group:"Appearance",set:function(a){this._internal.uiControl.setBlendMode(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance","default":a.defaultColor,set:function(a){this._internal.uiControl.setColor(a)}}}}),b}var e=a("./visualbase"),f=a("../../nodedefinition");b.exports={createDefinition:d}},{"../../nodedefinition":178,"./visualbase":253}],247:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a){var b=this.noodlNode,c=b._internal;if(c.scrollEnabled===!1||c.uiControl.touchPropagation===!1)return c.isTracking&&(c.isTracking=!1,b.sendSignalOnOutput("dragEnded")),void(c.hasReceivedEnter=!1);var d,e=c.uiControl.scroller,f=c.uiControl.scrollOffset;if(a.isEnter&&(c.hasReceivedEnter=!0),a.isExit)c.isTracking===!0?(b.sendSignalOnOutput("dragEnded"),c.isTracking=!1,b.context.scheduleAfterUpdate(function(){e.onTouch(f,a)})):e.onTouch(f,a),c.hasReceivedEnter=!1;else{if(c.hasReceivedEnter===!1){c.hasReceivedEnter=!0;var g={};for(var h in a)g[h]=a[h];g.type="isEnter",g.isEnter=!0,g.isDown=g.isUp=g.isMove=!1,c.uiControl.onTouch(g)}d=e.onTouch(f,a),"StartTracking"===d&&c.isTracking===!1&&(c.isTracking=!0,b.sendSignalOnOutput("dragStarted"))}return d}function f(a){var b=this._internal.children;if(b.length<=1)return 0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=0,e=this._internal.uiControl.getItemSpacing(),f=0,g=b.length;g>f;++f){var h=b[f].getVisualRoot().getLayoutRect(),i=h[c];if(Math.floor(d+i)>a)return f;d+=i+e}return console.error("Invalid position",a),b.length-1}function g(a){var b=this._internal.children;if(0>a||a>=b.length)return console.error("ScrollView: Invalid item index",index),0;for(var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.uiControl.getItemSpacing(),e=0,f=0;a>f;f++)e+=b[f].getVisualRoot().getLayoutRect()[c]+d;return e}function h(a){return a=d(0,this._internal.children.length-1,a),g.call(this,a)}function i(a){var b=this._internal;a!==b.currentIndex&&(b.currentIndex=a,this.flagOutputDirty("index"),this.sendSignalOnOutput("indexChanged"))}function j(a,b){var c=this,d=Math.max(0,Math.min(a,this._internal.uiControl.getScrollObjectSize()-this._internal.uiControl.getScrollViewSize()));this.context.timerScheduler.createTimer({duration:b,startPosition:l.call(this),endPosition:-d,onRunning:function(a){c._internal.uiControl.setScrollOffset(q.easeOut(this.startPosition,this.endPosition,a))}}).start()}function k(a,b){return b}function l(){return this._internal.uiControl.scrollOffset}function m(a,b){var c=f.call(this,-l.call(this)),e=0;return e=0>a?c+1:c,e=d(0,this._internal.children.length-1,e),-h.call(this,e)}function n(a,b){var c="horizontal"===this._internal.uiControl.orientation?"width":"height",d=this._internal.children,e=this._internal.uiControl.getItemSpacing();if(1===d.length)return 0>a?-d[0].getVisualRoot().getLayoutRect()[c]:0;for(var f=0,g=0,h=Number.MAX_VALUE,i=0,j=0;j<d.length-1;++j){var k=d[j].getVisualRoot().getLayoutRect()[c],m=f+k+e,n=Math.abs(f+b),o=Math.abs(m+b);if(h>n&&(h=n,i=f),h>o&&(h=o,i=m),o>n){var p=l.call(this);return 0>a&&-f>p?-m:a>0&&p>-f?-g:-f}g=f,f+=k+e}return-f}var o=a("./layoutbase"),p=a("../../nodedefinition"),q=a("../../easecurves"),r=500,s=o.createDefinition({name:"Scroll View",createControl:function(a){return a.createScrollViewControl()},hasItemSpacing:!0});p.extend(s,{initialize:function(){var a=this._internal;a.scrollEnabled=!0,a.isTracking=!1,a.currentIndex=0,a.hasReceivedEnter=!1,a.scrollToPositionValue=0,a.scrollDuration=r,a.scrollToPositionDuration=r,a.scrollToIndexDuration=r,a.scrollToIndexValue=0,a.uiControl.scrollEndedPositionCallback=function(a,b){return b};var b=this;this._internal.uiControl.on("scrollOffsetChanged",function(a){b.flagOutputDirty("scrollPosition");var c=f.call(b,-a);if(c<b._internal.children.length){var d=b._internal.children[c].getVisualRoot().getLayoutRect(),e="horizontal"===b._internal.uiControl.orientation?"width":"height",g=-a+.5*d[e];i.call(b,f.call(b,g))}}),this.addTouchHandler(e,b)},inputs:{itemSpacing:{index:2400,group:"Layout",displayName:"Item Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}},clip:{index:3100,type:"boolean",group:"Appearance",displayName:"Clip","default":!1,set:function(a){this._internal.uiControl.setClip(a?!0:!1)}},scrollDuration:{index:2500,type:"number",displayName:"Scroll Duration",group:"Scroll Behavior","default":r,set:function(a){this._internal.uiControl.setScrollDuration(Number(a))}},snap:{index:2501,type:{name:"enum",enums:[{value:"disabled",label:"Disabled"},{value:"item",label:"Item"},{value:"everyItem",label:"Every Item"}]},displayName:"Snap",group:"Scroll Behavior","default":"disabled",set:function(a){"disabled"===a?this._internal.uiControl.scrollEndedPositionCallback=k.bind(this):"everyItem"===a?this._internal.uiControl.scrollEndedPositionCallback=m.bind(this):"item"===a?this._internal.uiControl.scrollEndedPositionCallback=n.bind(this):console.error("Unknown snap value: "+a);
}},scrollAxis:{index:2502,type:{name:"enum",enums:[{value:"0",label:"Horizontal"},{value:"1",label:"Vertical"}]},displayName:"Scroll Direction",group:"Scroll Behavior","default":"1",set:function(a){this._internal.uiControl.setOrientation(Number(a)?"vertical":"horizontal")}},scrollStartPosition:{index:2503,type:"number",displayName:"Start Position",group:"Scroll Behavior","default":0,set:function(a){this._internal.uiControl.setScrollOffset(Number(a))}},scrollEnabled:{index:2504,type:"boolean",displayName:"Scroll Enabled",group:"Scroll Behavior","default":!0,set:function(a){this._internal.scrollEnabled=a?!0:!1}},overscrollEnabled:{index:2505,type:"boolean",displayName:"Overscroll Enabled",group:"Scroll Behavior","default":!0,set:function(a){var b=a?!0:!1;this._internal.uiControl.setOverscrollEnabled(b)}},scrollThreshold:{index:2506,type:"number",displayName:"Scroll Threshold",group:"Scroll Behavior","default":50,set:function(a){this._internal.uiControl.setScrollThreshold(0|a)}},"scrollToPosition.value":{index:6e3,type:"number",displayName:"Position",editorName:"Position|Scroll To Position",group:"Scroll To Position","default":0,set:function(a){this._internal.scrollToPositionValue=a}},"scrollToPosition.do":{index:6001,group:"Scroll To Position",editorName:"Do|Scroll To Position",displayName:"Do",valueChangedToTrue:function(){this.scheduleAfterInputsHaveUpdated(function(){j.call(this,this._internal.scrollToPositionValue,this._internal.scrollToPositionDuration)})}},"scrollToPosition.duration":{index:6002,group:"Scroll To Position",displayName:"Duration",editorName:"Duration|Scroll To Position",type:"number","default":r,set:function(a){this._internal.scrollToPositionDuration=a}},"scrollToIndex.value":{index:6003,group:"Scroll To Index",editorName:"Index|Scroll To Index",displayName:"Index",type:"number","default":0,set:function(a){this._internal.scrollToIndexValue=Math.floor(a)}},"scrollToIndex.do":{index:6004,group:"Scroll To Index",editorName:"Do|Scroll To Index",displayName:"Do",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){if(a._internal.children.length>0){var b=h.call(this,this._internal.scrollToIndexValue);j.call(this,b,this._internal.scrollToIndexDuration)}})}},"scrollToIndex.duration":{index:6005,type:"number",group:"Scroll To Index",displayName:"Duration",editorName:"Duration|Scroll To Index","default":r,set:function(a){this._internal.scrollToIndexDuration=a}}},outputs:{dragStarted:{type:"signal",displayName:"Drag Started",group:"Signals"},dragEnded:{type:"signal",displayName:"Drag Ended",group:"Signals"},indexChanged:{displayName:"Index Changed",group:"Signals",type:"signal"},scrollPosition:{displayName:"Scroll Position",type:"number",getter:function(){return this._internal.uiControl.scrollOffset}},index:{displayName:"Scroll Index",type:"number",getter:function(){return this._internal.currentIndex}},childCount:{displayName:"Child Count",type:"number",getter:function(){return this._internal.children.length}}}}),b.exports=p.defineNode(s)},{"../../easecurves":164,"../../nodedefinition":178,"./layoutbase":242}],248:[function(a,b,c){"use strict";var d=a("./layoutbase"),e=a("../../nodedefinition"),f=d.createDefinition({name:"Stack Layout",hasOrientation:!0,hasItemSpacing:!0,createControl:function(a){return a.createStackLayoutControl()}});e.extend(f,{inputs:{itemSpacing:{index:2501,group:"Layout",displayName:"Item Spacing",type:"number","default":0,set:function(a){this._internal.uiControl.setItemSpacing(Number(a))}}}}),b.exports=e.defineNode(f)},{"../../nodedefinition":178,"./layoutbase":242}],249:[function(a,b,c){"use strict";var d=a("./renderable"),e=a("../../nodedefinition"),f=a("../../fontloader"),g="Text",h=d.createDefinition({createControl:function(a){var b=a.createTextControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(g),b},defaultColor:"#ffffff",sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"childSize",widthCondition:"sizeMode = explicit OR sizeMode = childHeight",heightCondition:"sizeMode = explicit OR sizeMode = childWidth",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});e.extend(h,{name:"Text",version:2,usePortAsLabel:"text",inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},"default":g,set:function(a){this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family","default":"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;f.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size","default":40,set:function(a){this._internal.uiControl.setFontSize(a)}},lineHeight:{index:2503,type:"number",displayName:"Line Height",group:"Text","default":0,set:function(a){this._internal.uiControl.setLineHeight(a)}},alignment:{index:2504,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}],allowEditOnly:!0},displayName:"Horizontal",group:"Text Alignment","default":"left",set:function(a){this._internal.uiControl.setHorizontalAlignment(a)}},verticalAlignment:{index:2505,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}],allowEditOnly:!0},displayName:"Vertical",group:"Text Alignment","default":"top",set:function(a){this._internal.uiControl.setVerticalAlignment(a)}},clipText:{index:2999,type:"boolean",displayName:"Clip Text","default":!0,group:"Appearance",set:function(a){this._internal.uiControl.setClip(a?!0:!1)}}}}),b.exports={node:h,setup:function(a,b){b.on("nodeAdded.Text",function(a){a.parameters.fontFamily&&f.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a){"fontFamily"===a.name&&f.instance.loadFont(a.value)})})}}},{"../../fontloader":169,"../../nodedefinition":178,"./renderable":246}],250:[function(a,b,c){"use strict";function d(a){var b=this.noodlNode;return a.isUp?(b._internal.uiControl.focus(),"StopPropagation"):void 0}var e=a("./renderable"),f=a("../../nodedefinition"),g=a("../../fontloader"),h="Text",i=e.createDefinition({controlAttribute:"innerTextControl",createControl:function(a){var b=a.createTextInputControl();return b.setColor("#ffffff"),b.setFontFamily("Helvetica"),b.setFontSize(40),b.setText(h),b},defaultColor:"#ffffff",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100});f.extend(i,{name:"Text Input",initialize:function(){this.addTouchHandler(d),this._internal.confirmBlurs=!1;var a=this;this._internal.uiControl.on("confirmed",function(){a.sendSignalOnOutput("confirmed"),a._internal.confirmBlurs&&a._internal.uiControl.blur()}),this._internal.uiControl.on("textChanged",function(){a.flagOutputDirty("text")},this),this._internal.uiControl.on("focused",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this),this._internal.uiControl.on("blurred",function(){a.flagOutputDirty("focused"),a.flagOutputDirty("blurred")},this)},inputs:{text:{index:2500,group:"Text",displayName:"Text",type:{name:"string",multiline:!0},"default":h,set:function(a){this._internal.uiControl.getText()!==a&&this._internal.uiControl.setText(a)}},fontFamily:{index:2501,type:"font",group:"Text",displayName:"Font Family","default":"Helvetica",set:function(a){var b=a.replace(/\.[^\/.]+$/,"");b=b.split("/").pop();var c=this._internal;g.instance.callWhenFontIsActive(b,function(){c.uiControl.setFontFamily(b)})}},fontSize:{index:2502,type:"number",group:"Text",displayName:"Font Size","default":40,set:function(a){this._internal.uiControl.setFontSize(a)}},clear:{index:2600,group:"Actions",displayName:"Clear",valueChangedToTrue:function(){this._internal.uiControl.setText("")}},focus:{index:2601,group:"Actions",displayName:"Focus",valueChangedToTrue:function(){this._internal.uiControl.focus()}},blur:{index:2602,group:"Actions",displayName:"Blur",valueChangedToTrue:function(){this._internal.uiControl.blur()}},confirmBlurs:{index:2603,type:"boolean",displayName:"Blur On Confirm","default":!1,group:"Actions",set:function(a){this._internal.confirmBlurs=a}},type:{index:3001,group:"Appearance",displayName:"Type","default":"text",type:{name:"enum",enums:[{value:"text",label:"Text"},{value:"textarea",label:"Text Area"},{value:"password",label:"Password"},{value:"email",label:"Email"},{value:"tel",label:"Tel"},{value:"number",label:"Number"}]},set:function(a){this._internal.uiControl.setInputType(a)}},color:{index:3002,type:"color",displayName:"Color",group:"Appearance","default":"#ffffff",set:function(a){this._internal.uiControl.setColor(a)}}},outputs:{text:{index:2500,group:"Text",displayName:"Text",type:"string",getter:function(){return this._internal.uiControl.getText()}},focused:{index:2501,group:"State",displayName:"Focused",type:"boolean",getter:function(){return this._internal.uiControl.isFocused()}},blurred:{index:2502,group:"State",displayName:"Blurred",type:"boolean",getter:function(){return!this._internal.uiControl.isFocused()}},confirmed:{index:2503,group:"State",displayName:"Confirmed",type:"signal"}},prototypeExtensions:{setText:function(a){this._internal.uiControl.setText(a)}}}),b.exports={node:i,setup:function(a,b){b.on("nodeAdded.Text Input",function(a){a.parameters.fontFamily&&g.instance.loadFont(a.parameters.fontFamily),a.on("parameterUpdated",function(a,b){"fontFamily"===a&&g.instance.loadFont(b)})})}}},{"../../fontloader":169,"../../nodedefinition":178,"./renderable":246}],251:[function(a,b,c){function d(a,b){this.control=a,this.uniformValues={},this.uniformTypes={},this.ports=[],this.numPasses=1,this.isSecondaryPass=b,this.uniformPrefix=b?d.SecondPassUniformPrefix:d.UniformPrefix}d.UniformPrefix="shader-",d.SecondPassUniformPrefix="second-pass-shader-",d.prototype.isVectorType=function(a){return"vec4"===a||"vec3"===a||"vec2"===a},d.prototype.createValueOfType=function(a){return"float"===a?0:"vec2"===a?[0,0]:"vec3"===a?[0,0,0]:"vec4"===a?[0,0,0,0]:"sampler2D"===a?{image:null,imagePath:null}:null},d.prototype.setShader=function(a,b){this.controlId=b;var c=[],d={},e=this,f="Shader Variables",g=this.uniformPrefix;this.isSecondaryPass&&(f="Second Pass "+f);var h=a?a.uniforms:[];h.forEach(function(a){if(!(a.name in e.uniformValues)){var b=e.createValueOfType(a.type);e.uniformValues[a.name]=b,e.control.setUniform(a.name,b,a.type,this.isSecondaryPass)}"float"===a.type?(d[a.name]=a.type,c.push({group:f,plug:"input",displayName:a.name,name:g+a.name,type:"number","default":0})):"sampler2D"===a.type?(d[a.name]=a.type,c.push({group:f,plug:"input",displayName:a.name,name:g+a.name,type:"image"})):("vec2"===a.type||"vec3"===a.type||"vec4"===a.type)&&(d[a.name]=a.type,c.push({group:f,plug:"input",displayName:a.name+"X",name:g+a.name+"X",type:"number","default":0}),c.push({group:f,plug:"input",displayName:a.name+"Y",name:g+a.name+"Y",type:"number","default":0}),("vec3"===a.type||"vec4"===a.type)&&c.push({group:f,plug:"input",displayName:a.name+"Z",name:g+a.name+"Z",type:"number","default":0}),"vec4"===a.type&&c.push({group:f,plug:"input",displayName:a.name+"W",name:g+a.name+"W",type:"number","default":0}))}),this.uniformTypes=d,this.ports=c,this.shader=a},d.prototype.setUniform=function(a,b){a=a.replace(this.uniformPrefix,"");var c=a.substring(0,a.length-1);if(this.isVectorType(this.uniformTypes[c])){c in this.uniformValues||(this.uniformValues[c]=this.createValueOfType(this.uniformTypes[c]));var d=this.uniformValues[c],e=a[a.length-1];"X"===e?d[0]=b||0:"Y"===e?d[1]=b||0:"Z"===e?d[2]=b||0:"W"===e&&(d[3]=b||0),this.uniformValues[c]=d,this.control.setUniform(c,d,this.uniformTypes[a],this.isSecondaryPass)}else if("sampler2D"===this.uniformTypes[a]){a in this.uniformValues||(this.uniformValues[a]={image:null,imagePath:null});var f=this.uniformValues[a];if(f.imagePath===b)return;f.imagePath=b,f.image=null;var g=this.control,h=this;this.control.imageCache.getImage(b,function(b){b._path===f.imagePath&&(f.image=b,g.setUniform(a,f,h.isSecondaryPass))})}else this.control.setUniform(a,b||0,this.uniformTypes[a],this.isSecondaryPass);return!1},b.exports=d},{}],252:[function(a,b,c){"use strict";var d=(a("./renderable"),a("../../nodedefinition")),e=a("./visualbase"),f=a("../../nodes/visual/htmlcontent"),g=(a("events").EventEmitter,e.createDefinition({sizeEnums:[{value:"explicit",label:"Explicit"},{value:"childWidth",label:"Content Width"},{value:"childHeight",label:"Content Height"},{value:"childSize",label:"Content Size"}],defaultSizeEnum:"explicit",defaultSizeUnit:"%",defaultWidth:100,defaultHeight:100,createControl:function(a){return a.createHtmlControl()}})),h=Object.assign({},f.definition);delete h.dynamicports;var g=d.extend(g,h);d.extend(g,{name:"Video",category:"Visual",initialize:function(){var a=this;f.node.initialize.bind(this)();var b=this._internal;b.videoPath="",b.paused=!1,b.autoplay=!1,b.loop=!1,b.poster=void 0,b.seekTime=0,b.fillMode="contain",b.preload=!1,b.hasSignaledLoaded=!1;this.context;this._internal.addedToParentCallback=function(c){b.uiControl.domNode.element.style.overflow="hidden";var d="width: 100%; height: 100%; object-fit: "+b.fillMode+";",e='<video style="'+d+'" playsinline';b.autoplay&&(e+=" autoplay"),e+=b.preload?' preload="auto"':' preload="metadata"',b.loop&&(e+=" loop"),b.poster&&(e+=' poster="'+b.poster+'"'),b.muted&&(e+=" muted"),""!==b.videoPath&&(e+=' src="'+b.videoPath+'"'),e+="></video>",b.content=e,a.restartPlayback()};var c=this;b.onMetadataLoaded=function(){var a=b.uiControl.domNode;if(a&&a.element){var d=a.element.firstChild;c._internal.uiControl.setMediaSize(d.videoWidth,d.videoHeight)}},b.onTimeUpdate=function(){c.flagOutputDirty("currentTime")},b.onDurationChange=function(){c.flagOutputDirty("duration")},b.onCanPlayThrough=function(){b.hasSignaledLoaded||(c.sendSignalOnOutput("gotLoaded"),b.hasSignaledLoaded=!0)},b.onPlay=function(){c.sendSignalOnOutput("startedPlaying")},b.onPause=function(){c.restartPlayback()},b.onCanPlay=function(){c.restartPlayback()},this._internal.initialHTMLSetCallback=function(){var a=c.getVideoNode();a.removeEventListener("timeupdate",b.onTimeUpdate),a.removeEventListener("durationchange",b.onDurationChange),a.removeEventListener("loadedmetadata",b.onMetadataLoaded),a.removeEventListener("canplaythrough",b.onCanPlayThrough),a.removeEventListener("play",b.onPlay),a.removeEventListener("canplay",b.onCanPlay),a.removeEventListener("pause",b.onPause),a.addEventListener("timeupdate",b.onTimeUpdate),a.addEventListener("durationchange",b.onDurationChange),a.addEventListener("loadedmetadata",b.onMetadataLoaded),a.addEventListener("canplaythrough",b.onCanPlayThrough),a.addEventListener("play",b.onPlay),a.addEventListener("pause",b.onPause),a.addEventListener("canplay",b.onCanPlay)}},inputs:{videoPath:{type:{name:"string"},displayName:"Video Path",group:"Video Properties",set:function(a){if(this._internal.addedToDOM){var b=this.getVideoNode();b.src=a}this._internal.hasSignaledLoaded=!1,this._internal.videoPath=a}},posterPath:{type:{name:"string"},displayName:"Poster path",group:"Video Properties",set:function(a){if(this._internal.addedToDOM){var b=this.getVideoNode();b.poster=a}this._internal.poster=a}},fillMode:{type:{name:"enum",enums:[{value:"cover",label:"Aspect Fill"},{value:"contain",label:"Aspect Fit"},{value:"fill",label:"Fill"}],allowEditOnly:!0},displayName:"Fill Mode",group:"Video Properties","default":"contain",set:function(a){var b=this.getVideoNode();b&&(b.style.objectFit=a),this._internal.fillMode=a}},preload:{type:{name:"boolean"},displayName:"Preload",group:"Video Properties",set:function(a){var b=this.getVideoNode();b&&(b.preload=a?"auto":"metadata"),this._internal.preload=a}},loop:{type:{name:"boolean"},displayName:"Loop",group:"Video Properties",set:function(a){var b=this.getVideoNode();b&&(b.loop=a),this._internal.loop=a}},muted:{type:{name:"boolean"},displayName:"Muted",group:"Video Properties",set:function(a){var b=this.getVideoNode();b&&(b.muted=a),this._internal.muted=a}},autoplay:{type:{name:"boolean"},displayName:"Autoplay",group:"Video Properties",description:"On iOS the video needs to be muted for autoplay to work.",set:function(a){var b=this.getVideoNode();b&&(b.autoplay=a,a&&b.play()["catch"](function(a){})),this._internal.autoplay=a}},"seekToTime.time":{type:{name:"number"},displayName:"Seek Time",group:"Seek to time",set:function(a){this._internal.seekTime=a}},"seekToTime.do":{type:{name:"signal"},displayName:"Do",editorName:"Do | Seek to time",group:"Seek to time",valueChangedToTrue:function(){var a=this.getVideoNode();a&&(a.currentTime=this._internal.seekTime)}},pause:{displayName:"Pause",group:"Actions",valueChangedToTrue:function(){var a=this.getVideoNode();a&&a.pause(),this._internal.paused=!0,this._internal.startPlaying=!1}},play:{displayName:"Play",group:"Actions",valueChangedToTrue:function(){var a=this.getVideoNode();this._internal.paused=!1,a?a.play()["catch"](function(a){}):this._internal.startPlaying=!0}}},outputs:{duration:{type:{name:"number"},displayName:"Duration",group:"Video Properties",getter:function(){var a=this.getVideoNode();return a?isNaN(a.duration)?void 0:a.duration:void 0}},currentTime:{type:{name:"number"},displayName:"Current Time",group:"Video Properties",getter:function(){var a=this.getVideoNode();return a?a.currentTime:0}},paused:{type:{name:"boolean"},displayName:"Paused",group:"Video Properties",getter:function(){var a=this.getVideoNode();return a?a.paused():!0}},startedPlaying:{type:"signal",displayName:"Started playing",group:"Video Properties"},gotLoaded:{type:"signal",displayName:"Got loaded",group:"Video Properties"}},prototypeExtensions:{restartPlayback:function(){var a=this._internal,b=this;a.autoplay&&!a.paused&&this.context.scheduleNextFrame(function(){var a=b.getVideoNode();a&&a.play()["catch"](function(a){})})},_onNodeDeleted:function(){f.definition.prototypeExtensions._onNodeDeleted.call(this);var a=this.getVideoNode();a&&(a.removeEventListener("canplaythrough",this._internal.onCanPlayThrough),a.removeEventListener("timeupdate",this._internal.onTimeUpdate),a.removeEventListener("durationchange",this._internal.onDurationChange),a.removeEventListener("loadedmetadata",this._internal.onMetadataLoaded),a.removeEventListener("play",this._internal.onPlay),a.removeEventListener("oncanplay",this._internal.onCanPlay),a.removeEventListener("pause",this._internal.onPause))},initFillMode:function(){},shouldUpdateHTML:function(){return this._internal.uiControl.isAttached()&&!this._internal.addedToDOM},getVideoNode:function(){return this._internal.addedToDOM?this._internal.uiControl.domNode.element.firstChild:null}}}),delete g.inputs.html,delete g.inputs.elementType,delete g.inputs.usesDynamicContent,delete g.outputs.isAddedToDOM,delete g.outputs.domElement,b.exports=d.defineNode(g)},{"../../nodedefinition":178,"../../nodes/visual/htmlcontent":240,"./renderable":246,"./visualbase":253,events:6}],253:[function(a,b,c){"use strict";function d(a){if(a=a||{},!a.createControl)throw new Error("createControl can't be undefined");a.sizeEnums=a.sizeEnums||[],a.defaultSizeEnum=a.defaultSizeEnum||"",a.defaultSizeUnit=a.defaultSizeUnit||"px",a.defaultPivotUnit=a.defaultPivotUnit||"%",a.defaultWidth=a.hasOwnProperty("defaultWidth")?a.defaultWidth:0,a.defaultHeight=a.hasOwnProperty("defaultHeight")?a.defaultHeight:0,a.widthCondition=a.widthCondition||"sizeMode = explicit OR sizeMode = childHeight OR sizeMode NOT SET",a.heightCondition=a.heightCondition||"sizeMode = explicit OR sizeMode = childWidth OR sizeMode NOT SET";var b={category:"Visual",initialize:function(){var b=this._internal,c=a.createControl.call(this,this.context.uiEngine);c.onTouch=g,c.onHover=h,c.noodlNode=this,b.uiControl=c,b.touchHandlers=[],b.hoverHandlers=[],b.visualParent=void 0,c.setSizeMode(a.defaultSizeEnum),c.setWidth(a.defaultWidth),c.setHeight(a.defaultHeight),c.setWidthUnit(a.defaultSizeUnit),c.setHeightUnit(a.defaultSizeUnit),c.setPivotXUnit(a.defaultPivotUnit),c.setPivotYUnit(a.defaultPivotUnit),this._internal.tapHandler=this.context.uiEngine.createTapHandler(e),this.addTouchHandler(j,this),this.addHoverHandler(k,this);var d=this;c.on("screenXChanged",function(){d.flagOutputDirty("screenX")}),c.on("screenYChanged",function(){d.flagOutputDirty("screenY")}),c.on("layoutWidthChanged",function(){d.flagOutputDirty("width")}),c.on("layoutHeightChanged",function(){d.flagOutputDirty("height")})},inputs:{x:{type:{name:"number"},group:"Placement",index:2002,displayName:"Position X","default":0,set:function(a){this.setPositionX(Number(a))}},y:{type:{name:"number"},index:2003,group:"Placement",displayName:"Position Y","default":0,set:function(a){this.setPositionY(Number(a))}},z:{type:{name:"number"},index:2004,group:"Placement",displayName:"Position Z","default":0,set:function(a){this._internal.uiControl.setPositionZ(Number(a))}},alignX:{index:2e3,type:{name:"enum",enums:[{value:"left",label:"Left"},{value:"center",label:"Center"},{value:"right",label:"Right"}]},group:"Placement",displayName:"Align X","default":"left",set:function(a){this._internal.uiControl.setAlignX(a)}},alignY:{index:2001,type:{name:"enum",enums:[{value:"top",label:"Top"},{value:"center",label:"Center"},{value:"bottom",label:"Bottom"}]},group:"Placement",displayName:"Align Y","default":"top",set:function(a){this._internal.uiControl.setAlignY(a)}},width:{index:1001,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Width",group:"Dimensions","default":a.defaultWidth,set:function(a,b){void 0!==a&&this._internal.uiControl.setWidth(Number(a)),b&&this._internal.uiControl.setWidthUnit(b)}},height:{index:1002,type:{name:"number",units:["%","px"],defaultUnit:a.defaultSizeUnit},displayName:"Height",group:"Dimensions","default":a.defaultHeight,set:function(a,b){void 0!==a&&this._internal.uiControl.setHeight(Number(a)),b&&this._internal.uiControl.setHeightUnit(b)}},opacity:{index:3e3,group:"Appearance",displayName:"Opacity",type:"number","default":1,set:function(a){this._internal.uiControl.setOpacity(Number(a))}},visible:{type:{name:"boolean"},index:3001,displayName:"Visible",group:"Appearance","default":!0,set:function(a){this._internal.uiControl.setVisible(a?!0:!1)}},scaleX:{index:5e3,type:"number",group:"Transform",displayName:"Scale X","default":1,set:function(a){this._internal.uiControl.setScaleX(Number(a))}},scaleY:{index:5001,type:"number",group:"Transform",displayName:"Scale Y","default":1,set:function(a){this._internal.uiControl.setScaleY(Number(a))}},rotationX:{index:5002,type:"number",group:"Transform",displayName:"Rotation X","default":0,set:function(a){this._internal.uiControl.setRotationX(Math.PI/180*Number(a))}},rotationY:{index:5003,type:"number",group:"Transform",displayName:"Rotation Y","default":0,set:function(a){this._internal.uiControl.setRotationY(Math.PI/180*Number(a))}},rotationZ:{index:5004,type:"number",group:"Transform",displayName:"Rotation Z","default":0,set:function(a){this._internal.uiControl.setRotationZ(Math.PI/180*Number(a))}},pivotX:{index:5005,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},"default":50,group:"Transform",displayName:"Pivot X",set:function(a,b){b&&this._internal.uiControl.setPivotXUnit(b),this._internal.uiControl.setPivotX(Number(a))}},pivotY:{index:5006,type:{name:"number",units:["%","px"],defaultUnit:a.defaultPivotUnit},"default":50,group:"Transform",displayName:"Pivot Y",set:function(a,b){b&&this._internal.uiControl.setPivotYUnit(b),this._internal.uiControl.setPivotY(Number(a))}},pivotZ:{index:5007,type:"number",group:"Transform",displayName:"Pivot Z","default":0,set:function(a){this._internal.uiControl.setPivotZ(Number(a))}},touchPropagation:{index:4e3,type:{name:"boolean"},displayName:"Ignore Touch","default":!1,set:function(a){this._internal.uiControl.setTouchPropagation(a?!1:!0)}},blockTouch:{index:4001,type:{name:"boolean"},displayName:"Block Touch","default":!1,set:function(a){this._internal.uiControl.setBlockTouch(a?!0:!1)}},depth:{index:4002,type:{name:"number"},displayName:"Depth",set:function(a){a===!0?a=1:a===!1&&(a=0),this._internal.uiControl.setDepth(Number(a))}}},outputs:{"this":{type:"reference",displayName:"This",getter:function(){return this}},childIndex:{type:"number",displayName:"Child Index",getter:function(){var a=this._internal.uiControl.parent;return a?a.children.indexOf(this._internal.uiControl):-1}},width:{displayName:"Width",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.width}},height:{displayName:"Height",group:"Dimensions",type:"number",getter:function(){return this._internal.uiControl.layoutRect.height}},x:{displayName:"Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionX}},y:{displayName:"Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.positionY}},screenX:{displayName:"Screen Position X",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenX()}},screenY:{displayName:"Screen Position Y",group:"Placement",type:"number",getter:function(){return this._internal.uiControl.getScreenY()}}},prototypeExtensions:{addTouchHandler:function(a,b){this._internal.touchHandlers.push({callback:a,id:b})},removeTouchHandlersWithId:function(a){n.remove(this._internal.touchHandlers,function(b){return b.id===a})},addHoverHandler:function(a,b){this._internal.hoverHandlers.push({callback:a,id:b})},removeHoverHandler:function(a){n.remove(this._internal.hoverHandlers,function(b){return b.id===a})},getVisualRoot:function(){return this},_onNodeDeleted:function(){m.prototype._onNodeDeleted.call(this),this._internal.uiControl.removeListenersWithRef(this),this._internal.uiControl.dispose()},setPositionX:function(a){this._internal.uiControl.setPositionX(a),this.flagOutputDirty("x")},setPositionY:function(a){this._internal.uiControl.setPositionY(a),this.flagOutputDirty("y")},getLayoutRect:function(){return this._internal.uiControl.layoutRect},setHighlightEnabled:function(a){this._internal.uiControl.setHighlightEnabled(a)}}};return a.sizeEnums.length>0&&f(b,a),i(b),b}function e(a){var b=a.noodlNode;b.sendSignalOnOutput("touch.tap")}function f(a,b){var c={index:1001,name:"width",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Width",group:"Dimensions","default":b.defaultWidth},d={index:1002,name:"height",plug:"input",type:{name:"number",units:["%","px"],defaultUnit:b.defaultSizeUnit},displayName:"Height",group:"Dimensions","default":b.defaultHeight},e={name:"conditionalports/basic",condition:b.widthCondition,ports:[c]},f={name:"conditionalports/basic",condition:b.heightCondition,ports:[d]},g=[e,f];l(a,{dynamicports:g,inputs:{sizeMode:{index:1e3,type:{name:"enum",enums:b.sizeEnums,allowEditOnly:!0},group:"Dimensions",displayName:"Size Mode","default":b.defaultSizeEnum,set:function(a){this._internal.uiControl.setSizeMode(a)}}}})}function g(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.touchHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&("StartTracking"===e?b=e:"StopPropagation"===e&&"StartTracking"!==b&&(b=e))}),c.context.scheduleFrame(),b}function h(a){var b=void 0,c=this.noodlNode,d=this;return c._internal.hoverHandlers.forEach(function(c){var e=c.callback.call(d,a);void 0!==e&&"StopPropagation"===e&&(b=e)}),c.context.scheduleFrame(),b}function i(a){l(a,{initialize:function(){this._internal.hasSignaledMove=!1,this.context.nodeIsDirty(this)},outputs:{"touch.tap":{group:"Touch",displayName:"Tap",type:"signal"},"touch.press":{type:"signal",group:"Touch",displayName:"Press"},"touch.release":{type:"signal",group:"Touch",displayName:"Release"},"touch.enter":{type:"signal",group:"Touch",displayName:"Enter"},"touch.exit":{type:"signal",group:"Touch",displayName:"Exit"},"touch.move":{type:"signal",group:"Touch",displayName:"Move"},"hover.enter":{type:"signal",group:"Hover",displayName:"Hover Enter"},"hover.move":{type:"signal",group:"Hover",displayName:"Hover Move"},"hover.exit":{type:"signal",group:"Hover",displayName:"Hover Exit"}}})}function j(a){var b=this.noodlNode;return a.isDown&&(b.sendSignalOnOutput("touch.press"),b._internal.hasSignaledMove=!1),a.isMove?b._internal.hasSignaledMove===!1&&(b._internal.hasSignaledMove=!0,b.sendSignalOnOutput("touch.move")):a.isUp?b.sendSignalOnOutput("touch.release"):a.isEnter?b.sendSignalOnOutput("touch.enter"):a.isExit&&b.sendSignalOnOutput("touch.exit"),b.getOutput("touch.tap").hasConnections()?b._internal.tapHandler.onTouch(this,a):void 0}function k(a){var b=this.noodlNode;a.isHoverEnter&&b.sendSignalOnOutput("hover.enter"),a.isHoverMove?b.sendSignalOnOutput("hover.move"):a.isHoverExit&&b.sendSignalOnOutput("hover.exit")}var l=a("../../nodedefinition").extend,m=a("../../node"),n=a("lodash");b.exports={createDefinition:d}},{"../../node":176,"../../nodedefinition":178,lodash:117}],254:[function(a,b,c){"use strict";function d(a){function b(){j[a]&&(console.log("websocket disconnected",a),delete j[a])}if(!j[a]){var c=new WebSocket(a);c.addEventListener("close",b),c.addEventListener("error",b),j[a]=c}return j[a]}function e(a){function b(){e.reconnectTimer||(e.reconnectTimer=window.setTimeout(e.connect.bind(e,e.uri),1e3))}function c(){console.log("websocket connected",e.socket.url),e.eventEmitter.emit("connected"),e.context.eventEmitter.once("applicationDataReloaded",function(){e._close(),e.eventEmitter.removeAllListeners()}),e.socket.addEventListener("message",e._onMessage)}function d(a){var b=JSON.parse(a.data);e.eventEmitter.emit("jsonMessage",b)}this.eventEmitter=new h,this.eventEmitter.setMaxListeners(1e3),this.context=a;var e=this;this._reconnect=b,this._onConnectionOpen=c,this._onMessage=d}function f(a,b){if(a){var c={};for(var d in b)isNaN(Number(b[d]))?c[d]=b[d]:c[d]=Number(b[d]);a.send(JSON.stringify(c))}}var g=a("../nodedefinition"),h=a("events").EventEmitter,i=a("lodash"),j={};e.prototype._close=function(){this.socket&&(clearTimeout(this.reconnectTimer),this.reconnectTimer=void 0,this.eventEmitter.emit("disconnected"),this.socket.removeEventListener("close",this._reconnect),this.socket.removeEventListener("error",this._reconnect),this.socket.removeEventListener("open",this._onConnectionOpen),this.socket.removeEventListener("message",this._onMessage),this.socket=void 0)},e.prototype.connect=function(a){this._close(),this.uri=a,this.socket=d(a),this.socket.addEventListener("close",this._reconnect),this.socket.addEventListener("error",this._reconnect),this.socket.readyState===WebSocket.OPEN?this._onConnectionOpen():this.socket.addEventListener("open",this._onConnectionOpen)},e.prototype.addEventListener=function(a,b){this.eventEmitter.on(a,b)},e.prototype.send=function(a){this.socket&&this.socket.readyState===WebSocket.OPEN&&this.socket.send(a)},b.exports=g.defineNode({name:"Websocket",category:"Communication",initialize:function(){var a=this._internal;a.socket=new e(this.context),a.socket.addEventListener("connected",this.onConnected.bind(this)),a.socket.addEventListener("disconnected",this.onDisconnected.bind(this)),a.socket.addEventListener("jsonMessage",this.onMessageReceived.bind(this)),a.connected=!1,a.inputValues={},a.outputValues={},a.outputNames=[]},panels:[{name:"PortEditor",context:["select","connectFrom"],title:"Outputs",plug:"output",type:{name:"*",group:"Output data"}},{name:"PortEditor",context:["select","connectTo"],title:"Data To Send",plug:"input",group:"Data To Send",type:{name:"string"}}],inputs:{address:{group:"Settings",displayName:"Ip Address:Port",type:{name:"string"},set:function(a){if(!(void 0===a||a.length<=0)){var b=a;i.startsWith(b,"ws://")||i.startsWith(b,"wss://")||(b="ws://"+b),b[b.length]-1!=="/"&&(b+="/"),this._internal.socket.connect(b)}}},sendData:{group:"Send Data",displayName:"Send Data",valueChangedToTrue:function(){var a=this;this.scheduleAfterInputsHaveUpdated(function(){
a._internal.inputValues._nodeId=a.id,f(a._internal.socket,a._internal.inputValues)})}}},outputs:{newDataReceived:{displayName:"New Data Received",type:"signal"},connected:{displayName:"Connected",type:"boolean",getter:function(){return this._internal.connected}}},prototypeExtensions:{registerOutputIfNeeded:function(a){if(!this.hasOutput(a)){this._internal.outputValues[a]=void 0;var b=this;this.registerOutput(a,{getter:function(){return b._internal.outputValues[a]}})}},registerInputIfNeeded:function(a){if(!this.hasInput(a)){var b=this;this.registerInput(a,{set:function(c){b._internal.inputValues[a]=c}})}},onMessageReceived:function(a){if(!a._nodeIds||-1!==a._nodeIds.indexOf(this.id)){var b=!1;for(var c in a)this.hasOutput(c)&&(this._internal.outputValues[c]=a[c],this.flagOutputDirty(c),b=!0);b&&this.sendSignalOnOutput("newDataReceived")}},onConnected:function(){this._internal.connected!==!0&&(this._internal.connected=!0,this.flagOutputDirty("connected"))},onDisconnected:function(){this._internal.connected!==!1&&(this._internal.connected=!1,this.flagOutputDirty("connected"))}}})},{"../nodedefinition":178,events:6,lodash:117}],255:[function(a,b,c){"use strict";function d(a,b){this.context=a,this.nodes={},this.componentOwner=b,this.noodlJavascriptAPI=f(this),this.componentInstanceChildren={}}function e(a,b){b.forEach(function(b){if(!a[b])throw new Error("Missing "+b)})}var f=a("./noodl-js-api"),g=a("lodash");d.prototype.addConnection=function(a){try{e(a,["sourceId","sourcePort","targetId","targetPort"])}catch(b){throw new Error("Error in connection: "+b.message)}try{var c=this.getNodeWithId(a.sourceId),d=this.getNodeWithId(a.targetId);d.registerInputIfNeeded(a.targetPort),c.registerOutputIfNeeded(a.sourcePort),d.connectInput(a.targetPort,c,a.sourcePort)}catch(b){console.error(b.message)}},d.prototype.setNodeParameters=function(a,b){var c=Object.keys(b);if(this.context.nodeRegister.hasNode(a.name)){var d=this.context.nodeRegister.getNodeMetadata(a.name);c.sort(function(a,b){var c=d.inputs[a],e=d.inputs[b];return(e?e.inputPriority:0)-(c?c.inputPriority:0)})}c.forEach(function(c){function d(){var d=b[c];"object"==typeof d?a.setInputValue(c,d.value,d.unit):a.setInputValue(c,d)}a.registerInputIfNeeded(c),a.hasInput(c)!==!1&&d()})},d.prototype.createNodeFromModel=function(a){if("Component Children"!==a.type){var b;try{b=this.createNode(a.type,a.id),b.setNodeModel(a)}catch(c){return void console.error(c.message,c.stack)}this.setNodeParameters(b,a.parameters),a.parent&&this.insertNodeInTree(b,a)}else if(a.parent){var d=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(d)}},d.prototype.insertNodeInTree=function(a,b){var c=this.getNodeWithId(b.parent.id),d=b.parent.children.indexOf(b);if(!c.addChild)throw new Error("Node "+c.id+" of type "+c.constructor.name+" can't have children");a.getVisualRoot&&c.addChild(a,d)},d.prototype.getNodeWithId=function(a){if(this.nodes.hasOwnProperty(a)===!1)throw new Error("Unknown node id "+a);return this.nodes[a]},d.prototype.hasNodeWithId=function(a){return this.nodes.hasOwnProperty(a)},d.prototype.createNode=function(a,b){if(this.nodes.hasOwnProperty(b))throw Error("duplicate id "+b);var c;return this.context.hasComponentModelWithName(a)?(c=this.context.createComponentInstanceNode(a),c.parentNodeScope=this,this.componentInstanceChildren[b]=c):(c=this.context.nodeRegister.createNode(a),c.nodeScope=this),this.nodes[b]=c,c.id=b,c},d.prototype.getNodesWithIdRecursive=function(b){function c(a,b,e){a.nodes.hasOwnProperty(b)&&e.push(a.nodes[b]);var f=Object.keys(a.nodes).filter(function(b){return a.nodes[b]instanceof d});f.forEach(function(d){c(a.nodes[d].nodeScope,b,e)})}var d=a("./nodes/componentinstance"),e=[];return c(this,b,e),e},d.prototype.getNodesWithType=function(a){var b=this,c=Object.keys(this.nodes).filter(function(c){return b.nodes[c].name===a});return c.map(function(a){return b.nodes[a]})},d.prototype.getNodesWithTypeRecursive=function(b){function c(){f=f.concat(e.getNodesWithType(b));var a=Object.keys(e.nodes).filter(function(a){return e.nodes[a]instanceof d});a.forEach(function(a){var c=e.nodes[a].nodeScope.getNodesWithTypeRecursive(b);f=f.concat(c)})}var d=a("./nodes/componentinstance"),e=this,f=[];return c(f),f},d.prototype.onNodeModelRemoved=function(a){var b=this.getNodeWithId(a.id);if(a.parent){var c=this.getNodeWithId(a.parent.id);c.removeChild(b)}b._onNodeDeleted(),delete this.nodes[b.id],delete this.componentInstanceChildren[b.id]},d.prototype.removeConnection=function(a){var b=this.getNodeWithId(a.targetId);b.removeInputConnection(a.targetPort,a.sourceId,a.sourcePort)},d.prototype.removeNodeFromParent=function(a){if(a.getVisualRoot&&a.getVisualRoot()){var b=a.getVisualRoot()._internal.visualParent;b&&b.removeChild(a)}},d.prototype.setComponentModel=function(a){this.componentModel=a;var b=a.getAllNodes();b.forEach(this.createNodeFromModel.bind(this)),a.getAllConnections().forEach(this.addConnection.bind(this)),a.on("connectionAdded",this.addConnection,this),a.on("connectionRemoved",this.removeConnection,this),a.on("nodeAdded",this.createNodeFromModel,this);var c=this;a.on("nodeParentWillBeRemoved",function(a){if("Component Children"!==a.type){var b=c.getNodeWithId(a.id);c.removeNodeFromParent(b)}else if(a.parent){this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(null)}},this),a.on("nodeParentUpdated",function(a){if("Component Children"===a.type){var b=this.getNodeWithId(a.parent.id);this.componentOwner.setChildRoot(b)}else{var d=c.getNodeWithId(a.id);c.insertNodeInTree(d,a)}},this),a.on("nodeRemoved",function(a){"Component Children"!==a.type&&c.onNodeModelRemoved(a)},this)},d.prototype.reset=function(){if(this.componentModel){this.componentModel.removeListenersWithRef(this);var a=this;Object.keys(this.nodes).forEach(function(b){a.nodes.hasOwnProperty(b)&&a.deleteNode(a.nodes[b])}),this.componentModel=void 0,this.noodlJavascriptAPI.eventEmitter.removeAllListeners()}},d.prototype.deleteNode=function(a){if(this.nodes.hasOwnProperty(a.id)===!1)return void console.error("Node doesn't belong to this scope",this,a);var b=this;this.removeNodeFromParent(a),a.getChildren&&(a.getChildren().forEach(a.removeChild.bind(a)),a.getChildren().forEach(function(a){b.deleteNode(a)}));var c=this.componentModel.getConnectionsFrom(a.id),d=this.componentModel.getConnectionsTo(a.id);c.concat(d).forEach(function(a){b.nodes.hasOwnProperty(a.targetId)&&b.nodes.hasOwnProperty(a.sourceId)&&b.removeConnection(a)}),a._onNodeDeleted(),delete this.nodes[a.id],delete this.componentInstanceChildren[a.id]},d.prototype.sendEventFromThisScope=function(a,b,c,d){if(d){var e=this.getNodesWithType("Event Receiver").filter(function(b){return b.getChannelName()===a});e.forEach(function(a){a.handleEvent(b)})}"parent"===c&&this.componentOwner.parentNodeScope?this.componentOwner.parentNodeScope.sendEventFromThisScope(a,b,c,!0):"children"===c&&g.forIn(this.componentInstanceChildren,function(d){d.nodeScope.sendEventFromThisScope(a,b,c,!0)})},b.exports=d},{"./nodes/componentinstance":185,"./noodl-js-api":256,lodash:117}],256:[function(a,b,c){"use strict";function d(a){function b(b){return b&&b.length>0&&"/"!==b[0]&&(b="/"+b),a.createNode(b,e())}function c(b){a.deleteNode(b)}function d(a,b){l.scheduleAfterUpdate(function(){l.setGlobalValue(a,b)})}function j(a){return l.getGlobalValue(a)}function k(a,b){if(m[a]){var c=m[a].indexOf(b);-1!==c&&m[a].splice(c,1)}}var l=a.context,m={},n={on:function(a,b){var c=l.eventSenderEmitter;c.on(a,b),m[a]=m[a]||[],m[a].push(b),l.eventEmitter.once("applicationDataReloaded",function(){c.removeListener(a,b),k(a,b)})},once:function(a,b){l.eventSenderEmitter.once(a,b)},off:function(a,b){l.eventSenderEmitter.removeListener(a,b),k(a,b)},emit:function(a,b){l.eventSenderEmitter.emit(a,b)},removeAllListeners:function(){Object.keys(m).forEach(function(a){for(var b=m[a],c=b.length-1;c>=0;c--){var d=b[c];l.eventSenderEmitter.removeListener(a,d),k(a,d)}})}};return{createComponent:b,deleteComponent:c,setGlobalValue:d,getGlobalValue:j,eventEmitter:n,Collection:f,Model:g,Item:g,AnimationCurve:h,PubSub:i.pubsub}}var e=a("./guid"),f=a("./nodes/data/collection"),g=a("./nodes/data/model"),h=a("./easecurves"),i=a("./services/services");b.exports=d},{"./easecurves":164,"./guid":170,"./nodes/data/collection":188,"./nodes/data/model":192,"./services/services":262}],257:[function(a,b,c){"use strict";function d(a){if(!a.owner)throw new Error("Owner must be set");this.getter=a.getter,this.connections=[],this.owner=a.owner,this.name=a.name,this._id=void 0}Object.defineProperties(d.prototype,{value:{get:function(){return this.getter.call(this.owner)}},id:{get:function(){return this._id||(this._id=this.owner.id+this.name),this._id}},registerConnection:{value:function(a,b){this.connections.push({node:a,inputPortName:b})}},deregisterConnection:{value:function(a,b){for(var c=0;c<this.connections.length;c++){var d=this.connections[c];if(d.node===a&&d.inputPortName===b){this.connections.splice(c,1);break}}}},flagDependeesDirty:{value:function(a){for(var b=0,c=this.connections.length;c>b;b++)this.connections[b].node.flagDirty()}},sendValue:{value:function(a){for(var b=0,c=this.connections.length;c>b;b++){var d=this.connections[b];d.node.queueInput(d.inputPortName,a)}}},hasConnections:{value:function(){return this.connections.length>0}}}),b.exports=d},{}],258:[function(a,b,c){"use strict";function d(a,b,c){if(!c[a]){if(!g[a])throw new Error("Unknown patch key "+a);var d={nodePatches:[],dismissPatches:[]};for(var e in g[a])d[e]=g[a][e];c[a]=d}c[a].nodePatches.push(b)}function e(a,b){var c=[],e=[h,i,j,k,l];e.forEach(function(b){b.condition(a)&&c.push(b.generatePatch(a))}),c.forEach(function(a){d(a.key,a.patch,b)})}function f(a,b){e(a,b),a.children&&a.children.forEach(function(a){f(a,b)})}var g={LayoutNotSupported:{message:"Group with layout is no longer supported. These have been replaced with the new nodes Stack Layout and Flow Layout",notifyUser:!0,askPermission:!1,key:"LayoutNotSupported"},ImageDefaultUnitChanged:{notifyUser:!1,askPermission:!1,key:"ImageDefaultUnitChanged",message:""},TextMaxLineWidthReplaced:{notifyUser:!0,askPermission:!1,key:"TextMaxLineWidthReplaced",message:"Text max line width is no longer supported. Replaced with size mode content height and explicit width set in pixels"},RemoveValue:{notifyUser:!1,askPermission:!1,key:"RemoveValue",message:""}},h={condition:function(a){return void 0===a.version&&"Group"===a.type&&"none"===a.parameters.layout},generatePatch:function(a){return{key:"RemoveValue",version:2,patch:{nodeId:a.id,params:{layout:null}}}}},i={condition:function(a){return void 0===a.version&&"Group"===a.type&&a.parameters.hasOwnProperty("layout")&&"none"!==a.parameters.layout},generatePatch:function(a){var b,c;if("stackHorizontal"===a.parameters.layout)b="Stack Layout",c="horizontal";else if("stackVertical"===a.parameters.layout)b="Stack Layout",c="vertical";else if("flowHorizontal"===a.parameters.layout)b="Flow Layout",c="horizontal";else{if("flowVertical"!==a.parameters.layout)return void console.error("Can't convert layout",a);b="Flow Layout",c="vertical"}return{key:"LayoutNotSupported",patch:{nodeId:a.id,version:2,typename:b,params:{layout:null,orientation:c}}}}},j={condition:function(a){return void 0!==a.version||"Image"!==a.type?!1:"explicit"!==a.parameters.sizeMode&&"childHeight"!==a.parameters.sizeMode?!1:a.parameters.hasOwnProperty("width")&&"object"==typeof a.parameters.width?!1:!0},generatePatch:function(a){var b=0;return a.parameters.width&&(b=a.parameters.width.value?a.parameters.width.value:a.parameters.width),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{width:{value:b,unit:"px"}}}}}},k={condition:function(a){return void 0!==a.version||"Image"!==a.type?!1:"explicit"!==a.parameters.sizeMode&&"childWidth"!==a.parameters.sizeMode?!1:a.parameters.hasOwnProperty("height")&&"object"==typeof a.parameters.height?!1:!0},generatePatch:function(a){var b=0;return a.parameters.height&&(b=a.parameters.height.value?a.parameters.height.value:a.parameters.height),{key:"ImageDefaultUnitChanged",patch:{nodeId:a.id,version:2,params:{height:{value:b,unit:"px"}}}}}},l={condition:function(a){return void 0===a.version&&"Text"===a.type&&a.parameters.hasOwnProperty("maxWidth")},generatePatch:function(a){return{key:"TextMaxLineWidthReplaced",patch:{nodeId:a.id,version:2,params:{maxWidth:null,sizeMode:"childHeight",width:{value:a.parameters.maxWidth,unit:"px"}}}}}};b.exports={collectPatches:function(a){var b={};return a.components.forEach(function(a){a.nodes.forEach(function(a){f(a,b)})}),b}}},{}],259:[function(a,b,c){"use strict";function d(a,b){var c="Device Settings - "+a;b.ports.push({group:c,type:{name:"enum",enums:[{label:"WebGL",value:"webgl"},{label:"Canvas2D",value:"canvas2d"}]},name:a+".renderer",displayName:"Renderer","default":"webgl"}),b.ports.push({group:c,type:"boolean",name:a+".transparent",displayName:"Transparent","default":!1}),b.ports.push({group:c,type:{name:"component"},name:a+".rootComponent",displayName:"Root Component"}),b.dynamicports.push({name:"conditionalports/basic",condition:"'"+a+".fillMode' = aspectFit OR '"+a+".fillMode' NOT SET",ports:[{group:c,type:"number",name:a+".canvasWidth",displayName:"Width","default":1080},{group:c,type:"number",name:a+".canvasHeight",displayName:"Height","default":1920}]}),b.ports.push({group:c,type:{name:"enum",enums:[{label:"Fill",value:"fill"},{label:"Aspect Fit",value:"aspectFit"}]},name:a+".fillMode",displayName:"Fill Mode","default":"aspectFit"})}function e(a){for(var b=[],c=0;c<__noodl_modules.length;c++){var d=__noodl_modules[c];d.mqttBrokers&&d.mqttBrokers.forEach(function(a){b.push(a)})}if(0===b.length)a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL","default":"mqtt://user:pass@brokerurl.com:1883"}]});else{for(var e=[{value:"default",label:"Default"}],c=0;c<b.length;c++){var f=b[c];e.push({value:f.id,label:f.name})}a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true",ports:[{group:"MQTT",type:{name:"enum",enums:e},"default":"default",displayName:"Type",name:"mqttBrokerType"}]}),a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true AND mqttBrokerType = default OR mqttBrokerType NOT SET",ports:[{group:"MQTT",type:"string",name:"mqttBrokerUrl",displayName:"Broker URL","default":"mqtt://user:pass@brokerurl.com:1883"}]});for(var c=0;c<b.length;c++){var f=b[c];a.dynamicports.push({name:"conditionalports/basic",condition:"mqttUseExternalBroker = true AND mqttBrokerType = "+f.id,ports:f.settings})}}a.ports.push({group:"MQTT",type:"boolean",name:"mqttUseExternalBroker",displayName:"External Broker","default":!1})}function f(a){for(var b=0;b<__noodl_modules.length;b++){var c=__noodl_modules[b];c.settings&&c.settings.forEach(function(b){a.ports.push(b)})}}function g(a){var b={dynamicports:[],ports:[{group:"Devices",type:"stringlist",name:"devices",displayName:"Devices","default":i}]},c=[i];return a.devices&&(c=a.devices.split(",")),c.forEach(function(a){d(a,b)}),e(b),f(b),b}function h(a){var b=["fillMode","canvasWidth","canvasHeight","renderer"],c=b.filter(function(b){return a.hasOwnProperty(b)});if(0!==c.length){var d={fillMode:null,canvasWidth:null,canvasHeight:null,renderer:null,devices:i};return c.forEach(function(b){d[i+"."+b]=a[b]}),{askPermission:!1,notifyUser:!1,settingsPatch:d}}}var i="Default Device";b.exports={generateProjectSettings:g,collectPatch:h}},{}],260:[function(a,b,c){"use strict";function d(){this.subscriptions={},f.call(this)}var e=(a("paho-mqtt"),a("./services")),f=a("../eventsender"),g=a("lodash");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.connect=function(a){if(this.url!==a.url||this.clientId!==a.clientId||!this.client){this.connectArgs=a,this.url=a.url,this.clientId=a.clientId,this.client&&(this.client.disconnect(),this.client=void 0,this.hasClient=!1);var b="function"==typeof this.url?this.url():this.url;if(b){g.endsWith(b,"/")||-1!==b.indexOf("?")||(b+="/"),g.startsWith(b,"mqtt://")?b="ws://"+b.substring(7):g.startsWith(b,"mqtts://")&&(b="wss://"+b.substring(8));var c={useSSL:g.startsWith(b,"wss:")||g.startsWith(b,"mqtts:")},d=b.match(/^(wss?):\/\/((\[(.+)\])|([^\/]+?))(:(\d+))?(\/.*)$/);if(d){var f=d[4]||d[2];if(-1!==f.indexOf("@")){var h=f.split("@"),i=h[0].split(":"),j=i[0],k=i[1];b=b.substring(0,b.indexOf("://")+3)+b.substring(b.indexOf("@")+1),c.userName=j,c.password=k}var l=new Paho.MQTT.Client(b,a.clientId);this.client=l;var m=this;c.onSuccess=function(){function a(){c--,0===c&&m.emit("connected")}console.log("MQTT","Connected to",b);var c=Object.keys(m.subscriptions).length;for(var d in m.subscriptions)m.client.subscribe(d,{onSuccess:a,onFailure:a})},c.onFailure=function(){console.log("MQTT","Failed to connect to",b),m.client=void 0,setTimeout(function(){m.connect(a)},2e3)},l.connect(c),l.onConnectionLost=function(b){console.log("MQTT",JSON.stringify(b)),m.client=void 0,m.emit("connectionClosed"),setTimeout(function(){m.connect(a)},2e3)},l.onMessageArrived=function(a){var b=a.destinationName,c=a.payloadString.toString();try{c=JSON.parse(c)}catch(d){}e.pubsub.routeMessage({topic:b,payload:c})}}}}},d.prototype.reconnect=function(){this.connect(this.connectArgs)},d.prototype.disconnect=function(){this.client&&(this.client.disconnect(),this.client=null)},d.prototype.isConnected=function(){return this.client&&this.client.isConnected()},d.prototype.sendServiceRequest=function(a){if("subscribe"===a.type)this.subscriptions[a.topic]=!0,this.client&&this.client.isConnected()&&this.client.subscribe(a.topic);else if("unsubscribe"===a.type)delete this.subscriptions[a.topic],this.client&&this.client.isConnected()&&this.client.unsubscribe(a.topic);else if("publish"===a.type&&this.client&&this.client.isConnected()){var b=a.payload;"object"==typeof b&&(b=JSON.stringify(a.payload));var c=new Paho.MQTT.Message(b);c.destinationName=a.topic,this.client.send(c)}},b.exports=d},{"../eventsender":168,"./services":262,lodash:117,"paho-mqtt":124}],261:[function(a,b,c){"use strict";function d(){}var e={},f=["connected","connectionClosed"];d.prototype.setConnection=function(a){var b=this;this.connection&&f.forEach(function(a){b.connection.removeAllListeners(a)}),this.connection=a},d.prototype.reconnect=function(){this.connection.reconnect&&this.connection.reconnect()},d.prototype.isConnected=function(){return this.connection.isConnected()},d.prototype.on=function(a,b){-1!==f.indexOf(a)&&this.connection.on(a,b)},d.prototype.getMatchingSubscribers=function(a){function b(a,b){var c=a.split("/"),d=b.split("/");if(c.length!==d.length)return!1;for(var e=0;e<c.length;e++)if("+"!==d[e]&&c[e]!==d[e])return!1;return!0}var c=[];for(var d in e)if(b(a,d))for(var f=e[d],g=0;g<f.length;g++)c.push(f[g]);return c},d.prototype.routeMessage=function(a){for(var b=this.getMatchingSubscribers(a.topic),c=0;c<b.length;c++)b[c](a)},d.prototype.getSubscribers=function(a){return e[a]||(e[a]=[]),e[a]},d.prototype.subscribe=function(a,b){var c=this.getSubscribers(a);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"subscribe",topic:a}),c.push(b)},d.prototype.unsubscribe=function(a,b){for(var c=this.getSubscribers(a),d=0;d<c.length;d++)c[d]===b&&c.splice(d,1);0===c.length&&this.connection.sendServiceRequest({service:"pubsub",type:"unsubscribe",topic:a})},d.prototype.publish=function(a,b){this.connection.sendServiceRequest({service:"pubsub",type:"publish",topic:a,payload:b})},b.exports=d},{}],262:[function(a,b,c){function d(){}var e=a("events").EventEmitter;d.events=new e,b.exports=d},{events:6}],263:[function(a,b,c){var d={};d.StandardUniformNames={texture:!0,u_view:!0,u_projection:!0,u_world:!0,u_opacity:!0,u_color:!0,u_srcRect:!0,u_flipTexCoordY:!0},d.extractStorageQualifier=function(a,b){var c,d=[],e=new RegExp(b+"\\s*([^;]*)","g");do if(c=e.exec(a)){var f=c[1].split(" ");3===f.length&&f.splice(0,1),d.push({type:f[0],name:f[1]})}while(c);return d},d.extractUniforms=function(a,b){function c(a){a.forEach(function(a){e.some(function(b){return b.name===a.name})===!1&&e.push(a)})}var e=[];return c(d.extractStorageQualifier(a,"uniform")),c(d.extractStorageQualifier(b,"uniform")),e},b.exports=d},{}],264:[function(a,b,c){"use strict";function d(a,b){this.duration=b.duration||0,this._isRunning=!1,this._hasCalledOnStart=!1,this.scheduler=a,this.repeatCount=1,this.delay=0;for(var c in b)this[c]=b[c]}function e(a){this.requestFrame=a,this.runningTimers=[],this.newTimers=[]}d.prototype.start=function(){return this._isRunning&&this.stop(),this.scheduler.scheduleTimer(this),this},d.prototype.stop=function(){this.scheduler.stopTimer(this),this._hasCalledOnStart=!1,this._isRunning=!1,this._wasStopped=!0},e.prototype.createTimer=function(a){return new d(this,a)},e.prototype.scheduleTimer=function(a){-1===this.newTimers.indexOf(a)&&(0===a.repeatCount&&(a.repeatCount=1e5),this.newTimers.push(a),this.requestFrame())},e.prototype.stopTimer=function(a){var b;a._isRunning?(b=this.runningTimers.indexOf(a),-1!==b&&this.runningTimers.splice(b,1),a.onStop&&!a._wasStopped&&a.onStop()):(b=this.newTimers.indexOf(a),-1!==b&&this.newTimers.splice(b,1))},e.prototype.runTimers=function(a){var b,c,d=[],e=[],f=[],g=this.runningTimers.length;for(b=0;g>b;++b)f[b]=this.runningTimers[b];for(b=0;g>b;++b)if(c=f[b],c&&a>=c._start){c._hasCalledOnStart===!1&&c.onStart&&(c.onStart(),c._hasCalledOnStart=!0);var h;h=c.duration>0?(a-c._start)/(c.duration*c.repeatCount):1;var i=h*c.repeatCount-Math.floor(h*c.repeatCount);h>=1&&(i=1),c.onRunning&&c.onRunning(i),1>h&&c._isRunning?d.push(c):c._wasStopped||e.push(c)}else d.push(c);for(this.runningTimers=d,b=0;b<e.length;++b)e[b]._isRunning=!1,e[b]._hasCalledOnStart=!1,e[b].onFinish&&e[b].onFinish();if(this.newTimers.length>0){for(b=0;b<this.newTimers.length;++b)c=this.newTimers[b],c._start=a+c.delay,c._isRunning=!0,c._wasStopped=!1,this.runningTimers.push(c),0===c.delay&&(c.onStart&&(c.onStart(),c._hasCalledOnStart=!0),c.onRunning&&c.onRunning(0));this.newTimers.length=0}},e.prototype.hasPendingTimers=function(){return this.runningTimers.length>0||this.newTimers.length>0},b.exports=e},{}],265:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.imageCache=b,this.renderCommand={type:"circle",color:"#ffffff",blendMode:"alpha",arcAngle:2*Math.PI,solid:!0,lineWidth:2,blur:0,image:null,imagePath:null}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d="%"===a.widthUnit?b*(a.width/100):a.width;return{width:d,height:d}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setArcAngle=function(a){this.renderCommand.arcAngle=a,this.setContentDirty(!0)},d.prototype.setSolid=function(a){this.renderCommand.solid=a,this.setContentDirty(!0)},d.prototype.setLineWidth=function(a){this.renderCommand.lineWidth=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.setContentDirty(!0),this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":281}],266:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"])}var e=a("./layoutcontrol"),f=a("../layout/docklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,b.exports=d},{"../layout/docklayout":283,"./layoutcontrol":272}],267:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.renderToFramebuffer=!0,this.imageCache=b,this.frameBufferSettings={renderEffectsToTexture:!1,renderAfterPop:!0,cornerRadius:0,renderScale:1,effect:"none",vertices:null,maskImage:null,requiresExclusiveFBO:!1,maskViewId:null,effectParams:{gaussianBlurRadius:d.StandardGaussianBlurRadius,effectAmount:d.StandardEffectAmount}},this.shaderSource=null,this.secondaryShaderSource=null}var e=(a("./uicontrol"),a("./docklayoutcontrol")),f=a("./layoutcontrol");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setRenderEffectsToTexture=function(a){this.frameBufferSettings.renderEffectsToTexture=a,this.setContentDirty(!0)},d.prototype.setRenderScale=function(a){this.frameBufferSettings.renderScale=a,this.setContentDirty(!0)},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setFrameBufferIsExclusive=function(a){this.frameBufferSettings.requiresExclusiveFBO=a},d.prototype.setMaskImagePath=function(a){if(!a||""===a)return this.frameBufferSettings.maskImage=null,this.frameBufferSettings.maskViewId=null,void this.setContentDirty(!0);if("string"==typeof a){if(0===a.search(d.ImageOutputPrefix)){var b=a.split(d.ImageOutputPrefix)[1];return b=b.split(":")[0],this.frameBufferSettings.maskViewId=b,void this.setContentDirty(!0)}this.frameBufferSettings.maskViewId=null;var c=this;this.imageCache.getImage(a,function(b){c.frameBufferSettings.maskImage={imagePath:a,image:b},c.setContentDirty(!0)})}},d.prototype.setSecondaryShader=function(a){this.secondaryShaderSource=a,this.setContentDirty(!0)},d.prototype.setShader=function(a){this.shaderSource=a,this.setContentDirty(!0)},d.prototype.setUniform=function(a,b,c,d){d?(this.secondaryShaderUniforms||(this.secondaryShaderUniforms={}),this.secondaryShaderUniforms[a]=b):(this.shaderUniforms||(this.shaderUniforms={}),this.shaderUniforms[a]=b),this.setContentDirty(!0)},d.prototype.setCornerRadius=function(a){this.frameBufferSettings.cornerRadius=a,this.setContentDirty(!0)},d.prototype.setEffectAmount=function(a){this.frameBufferSettings.effectParams.effectAmount=a,this.setContentDirty(!0)},d.prototype.setGaussianBlurRadius=function(a){this.frameBufferSettings.effectParams.gaussianBlurRadius=a,this.setContentDirty(!0)},d.prototype.setStandardEffect=function(a){this.frameBufferSettings.effect=a,this.setContentDirty(!0)},d.prototype.setDrawToScreen=function(a){this.frameBufferSettings.renderAfterPop=a,this.setContentDirty(!0)},d.prototype.setVertices=function(a){this.frameBufferSettings.vertices=a,this.setContentDirty(!0)},d.prototype.getOutputImageId=function(){var a=this.layoutRect,b=a.width||0,c=a.height||0;return d.ImageOutputPrefix+this.id+":"+b+":"+c},d.prototype.setClip=function(a){f.prototype.setClip.call(this,a),this.frameBufferSettings.clip=a},d.ImageOutputPrefix="/EffectGroup/:",d.StandardGaussianBlurRadius=30,d.StandardEffectAmount=1,b.exports=d},{"./docklayoutcontrol":266,"./layoutcontrol":272,"./uicontrol":281}],268:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"]),this.verticalItemSpacing=0,this.horizontalItemSpacing=0,this.orientation="horizontal",this.contentAlignX="left",this.contentAlignY="top"}var e=a("./layoutcontrol"),f=a("../layout/flowlayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setVerticalItemSpacing=function(a){this.verticalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHorizontalItemSpacing=function(a){this.horizontalItemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignX=function(a){this.contentAlignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setContentAlignY=function(a){this.contentAlignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/flowlayout":284,"./layoutcontrol":272}],269:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=f,this.domNode=null,this.lastSetContent=null,this.layout.mediaWidth=null,this.layout.mediaHeight=null,this.renderCommand={type:"html",inputEnabled:!0}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d="%"===a.widthUnit?b*(a.width/100):a.width,e="%"===a.heightUnit?c*(a.height/100):a.height;if("explicit"===a.sizeMode||null===this.mediaWidth||null===this.mediaHeight)return{width:d,height:e};if("childWidth"===a.sizeMode){var f=this.mediaWidth/this.mediaHeight;return{width:e*f,height:e}}if("childHeight"===a.sizeMode){var f=this.mediaWidth/this.mediaHeight;return{width:d,height:d/f}}return"childSize"===a.sizeMode?{width:this.mediaWidth,height:this.mediaHeight}:void 0}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setMediaSize=function(a,b){this.layout.mediaWidth=a,this.layout.mediaHeight=b,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this)},d.prototype.setDomNode=function(a){this.domNode=a},d.prototype.dispose=function(){e.prototype.dispose.call(this),this.domNode.dispose(),this.lastSetContent=null},d.prototype.isAttached=function(){return this.domNode.element&&this.domNode.element.parentNode},d.prototype.setClassName=function(a){this.domNode.element.className=a},d.prototype.setContent=function(a){return null!==this.domNode.element.parentNode&&this.lastSetContent!==a?(this.domNode.element.innerHTML=a,this.setContentDirty(!0),this.lastSetContent=a,!0):!1},b.exports=d},{"./uicontrol":281}],270:[function(a,b,c){"use strict";function d(a,b,c,d){var e=c/a,f=d/b,g=Math.min(e,f);return{width:a*g,height:b*g}}function e(a,b,c,d){var e=c/a,f=d/b,g=Math.max(e,f);return{width:a*g,height:b*g}}function f(a,b){h.call(this,a),this.layout=j,this.setAlignX("center"),this.setAlignY("center"),this.setSizeMode("original"),this.imageCache=b,this.layoutSourceRect=[0,0,1,1],this.customSourceRect=[0,0,1,1],this.fillMode="aspectFit",this.renderCommand={type:"image",color:"#ffffff",blendMode:"alpha",image:null,imagePath:null,cornerRadius:0,blur:0,shaderSource:null},this.imageWidth=0,this.imageHeight=0}function g(a){return 0===a[0]&&0===a[1]&&1===a[2]&&1===a[3]}var h=a("../uicontrol"),i=a("../effectcontrol"),j={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var f=b,g=c;if(a.renderCommand.vertices)return{width:f,height:g};"childSize"===a.parent.sizeMode?(f=a.imageWidth,g=a.imageHeight):"childWidth"===a.parent.sizeMode?f=a.imageWidth:"childHeight"===a.parent.sizeMode?g=a.imageHeight:"explicit"===a.parent.sizeMode;var h=a.imageWidth&&a.imageHeight&&f&&g;if("fill"===a.fillMode||!h)return a.setLayoutImageSourceRect([0,0,1,1]),{width:f,height:g};var i={width:a.imageWidth?a.imageWidth:f,height:a.imageHeight?a.imageHeight:g};"aspectFit"===a.fillMode&&h?i=d(a.imageWidth,a.imageHeight,f,g):"aspectFill"===a.fillMode&&h&&(i=e(a.imageWidth,a.imageHeight,f,g));var j=[0,0,1,1];if(i.width>b){var k=b/i.width,l=(1-k)/2,m=l+k;j[0]=l,j[2]=m}if(i.height>c){var n=c/i.height,o=(1-n)/2,p=o+n;j[1]=o,j[3]=p}return a.setLayoutImageSourceRect(j),i={width:Math.min(f,i.width),height:Math.min(g,i.height)}}};f.prototype=Object.create(h.prototype),f.prototype.setImagePath=function(a){if(this.renderCommand.imageTextureControlId=null,this.renderCommand.image=null,this.renderCommand.imagePath=null,a&&0===a.search(i.ImageOutputPrefix)){var b=a.split(i.ImageOutputPrefix)[1].split(":"),c=b[0],d=b[1],e=b[2];return this.renderCommand.imageTextureControlId=c,this.imageWidth=d,this.imageHeight=e,this.setContentDirty(!0),void this.layouter.setNeedsRelayout(this)}if(this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),null!==a)if("string"==typeof a)this.imageCache.getImage(a,this._onImageLoaded.bind(this));else if("object"==typeof a&&"CANVAS"===a.tagName){var f=a;this.imageWidth=f.width,
this.imageHeight=f.height,this.renderCommand.image=f,this.renderCommand.imagePath=f.id||"canvas"}},f.prototype.setFillMode=function(a){this.fillMode=a,this.layouter.setNeedsRelayout(this)},f.prototype.setVideoElement=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a.src,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this),a.videoWidth?this._onVideoLoaded(a):a.addEventListener("canplay",this._onVideoLoaded.bind(this,a))},f.prototype._onVideoLoaded=function(a){a.src===this.path&&(this.imageWidth=a.videoWidth,this.imageHeight=a.videoHeight,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0),this.layouter.setNeedsRelayout(this))},f.prototype._onImageLoaded=function(a){a._path===this.path&&(this.imageWidth=a.width,this.imageHeight=a.height,this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},f.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},f.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},f.prototype.setCornerRadius=function(a){this.renderCommand.cornerRadius=a,this.setContentDirty(!0)},f.prototype.updateSourceRect=function(){var a=this.layoutSourceRect,b=this.customSourceRect,c=b[2]-b[0],d=b[3]-b[1];return g(a)&&g(b)?void delete this.renderCommand.srcRect:(this.renderCommand.srcRect||(this.renderCommand.srcRect=[0,0,1,1]),this.renderCommand.srcRect[0]=b[0]+a[0]*c,this.renderCommand.srcRect[1]=b[1]+a[1]*d,this.renderCommand.srcRect[2]=b[0]+a[2]*c,void(this.renderCommand.srcRect[3]=b[1]+a[3]*d))},f.prototype.setLayoutImageSourceRect=function(a){this.layoutSourceRect=a,this.updateSourceRect()},f.prototype.setImageSourceRect=function(a){this.renderCommand;this.customSourceRect[0]=a[0],this.customSourceRect[1]=a[1],this.customSourceRect[2]=a[2],this.customSourceRect[3]=a[3],this.updateSourceRect()},f.prototype.setShader=function(a){this.renderCommand.shaderSource=a},f.prototype.setUniform=function(a,b,c){this.renderCommand.shaderUniforms||(this.renderCommand.shaderUniforms={}),this.renderCommand.shaderUniforms[a]=b},f.prototype.setVertices=function(a){this.renderCommand.vertices=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=f},{"../effectcontrol":267,"../uicontrol":281}],271:[function(a,b,c){"use strict";function d(a,b){f.call(this,a),this.innerControl=new e(a,b),this.imageCache=b,this.addChild(this.innerControl)}var e=a("./image/imageinnercontrol"),f=a("./docklayoutcontrol");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.innerControl.setImagePath(a)},d.prototype.setVideoElement=function(a){this.innerControl.setVideoElement(a)},d.prototype.setFillMode=function(a){this.innerControl.setFillMode(a)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.setCornerRadius=function(a){this.innerControl.setCornerRadius(a)},d.prototype.setImageSourceRect=function(a){this.innerControl.setImageSourceRect(a)},d.prototype.dispose=function(){this.innerControl.dispose(),f.prototype.dispose.call(this)},d.prototype.setVertices=function(a){this.innerControl.setVertices(a),this.setContentDirty(!0)},d.prototype.setShader=function(a){this.innerControl.setShader(a),this.setContentDirty(!0)},d.prototype.setUniform=function(a,b,c){this.innerControl.setUniform(a,b,c),this.setContentDirty(!0)},b.exports=d},{"./docklayoutcontrol":266,"./image/imageinnercontrol":270}],272:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=b,this.children=[],this.padding={top:0,bottom:0,left:0,right:0},this.clip=!1,this.childAABB=f.create()}var e=a("./uicontrol"),f=a("../math/aabb");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setPaddingTop=function(a){this.padding.top=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingLeft=function(a){this.padding.left=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingRight=function(a){this.padding.right=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPaddingBottom=function(a){this.padding.bottom=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.addChild=function(a,b){void 0===b&&(b=this.children.length-1),this.children.splice(b,0,a),a.parent=this,this.layouter.setNeedsRelayout(this),this.layouter.setNeedsRelayout(a),a.setContentDirty(!0),a.localTransformDirty=!0},d.prototype.removeChild=function(a){var b=this.children.indexOf(a);-1!==b?this.children.splice(b,1):console.error("Node is not a child"),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setClip=function(a){this.clip=a,this.setContentDirty(!0)},d.prototype.getChildren=function(){return this.children},b.exports=d},{"../math/aabb":289,"./uicontrol":281}],273:[function(a,b,c){"use strict";function d(a,b){e.call(this,a),this.layout=f,this.setWidth(100),this.setHeight(100),this.renderCommand={type:"mesh",color:"#ffffff",blendMode:"alpha",mesh:null,shader:null,image:null,imagePath:null,srcRect:[0,0,1,1]},this.imageCache=b}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setImagePath=function(a){this.renderCommand.image=null,this.renderCommand.imagePath=null,this.path=a,this.imageWidth=0,this.imageHeight=0,this.setContentDirty(!0),null!==a&&this.imageCache.getImage(a,this._onImageLoaded.bind(this))},d.prototype._onImageLoaded=function(a){a._path===this.path&&(this.renderCommand.image=a,this.renderCommand.imagePath=this.path,this.setContentDirty(!0))},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setShader=function(a){this.renderCommand.shader=a,this.setContentDirty(!0)},d.prototype.setMesh=function(a){this.renderCommand.mesh=a,this.setContentDirty(!0)},d.prototype.setImageSourceRect=function(a){var b=this.renderCommand;b.srcRect||(b.srcRect=[0,0,1,1]),b.srcRect[0]=a[0],b.srcRect[1]=a[1],b.srcRect[2]=a[2],b.srcRect[3]=a[3]},d.prototype.dispose=function(){this.renderCommand.mesh&&this.renderCommand.mesh.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./uicontrol":281}],274:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=f,this.renderCommand={type:"rectangle",color:"#ffffff",blendMode:"solid",cornerRadius:0,blur:0}}var e=a("./uicontrol"),f={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return{width:"%"===a.widthUnit?b*(a.width/100):a.width,height:"%"===a.heightUnit?c*(a.height/100):a.height}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setCornerRadius=function(a){this.renderCommand.cornerRadius=a,this.setContentDirty(!0)},d.prototype.setBlur=function(a){this.renderCommand.blur=a,this.setContentDirty(!0)},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},d.prototype.setMaskType=function(a){this.renderCommand.maskType=a},b.exports=d},{"./uicontrol":281}],275:[function(a,b,c){"use strict";function d(a,b){e.call(this,a,f["static"]),this.itemSpacing=0,this.orientation="vertical",this.scrollOffset=0;var c=this;this.scroller=new g(b,{scrollThreshold:50,axis:1,scrollEndedAnimationDuration:300,bounceOnPositionEndedOverride:!1,scrollEndedPositionCallback:function(a,b){return c.scrollEndedPositionCallback(a,b)},scrollCallback:function(a){c.setScrollOffset(a)}}),this.contentLengthChanged=function(a){c.scroller.scrollObjectSize=a},this.on("layoutWidthChanged",this._updateScrollViewSize.bind(this)),this.on("layoutHeightChanged",this._updateScrollViewSize.bind(this))}var e=a("./layoutcontrol"),f=a("../layout/scrollviewlayout"),g=a("../touch/scroller");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._updateScrollViewSize=function(){"horizontal"===this.orientation?this.scroller.scrollViewSize=this.layoutRect.width-this.padding.left-this.padding.right:"vertical"===this.orientation&&(this.scroller.scrollViewSize=this.layoutRect.height-this.padding.top-this.padding.bottom)},d.prototype.setPaddingTop=function(a){e.prototype.setPaddingTop.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingLeft=function(a){e.prototype.setPaddingLeft.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingRight=function(a){e.prototype.setPaddingRight.call(this,a),this._updateScrollViewSize()},d.prototype.setPaddingBottom=function(a){e.prototype.setPaddingBottom.call(this,a),this._updateScrollViewSize()},d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.getItemSpacing=function(){return this.itemSpacing},d.prototype.setOrientation=function(a){this.orientation=a,this.scroller.setOrientation(a),this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setScrollOffset=function(a){this.scrollOffset=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0),this.emit("scrollOffsetChanged",a)},d.prototype.setOverscrollEnabled=function(a){this.scroller.shouldRubber=a},d.prototype.setScrollThreshold=function(a){this.scroller.scrollThreshold=a},d.prototype.setScrollDuration=function(a){this.scroller.scrollEndedAnimationDuration=a},d.prototype.getScrollObjectSize=function(){return this.scroller.scrollObjectSize},d.prototype.getScrollViewSize=function(){return this.scroller.scrollViewSize},b.exports=d},{"../layout/scrollviewlayout":287,"../touch/scroller":314,"./layoutcontrol":272}],276:[function(a,b,c){"use strict";function d(a){e.call(this,a,f["static"]),this.orientation="vertical",this.itemSpacing=0}var e=a("./layoutcontrol"),f=a("../layout/stacklayout");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.setItemSpacing=function(a){this.itemSpacing=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setOrientation=function(a){this.orientation=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},b.exports=d},{"../layout/stacklayout":288,"./layoutcontrol":272}],277:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=g,this.renderCommand={type:"text",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",text:"",lineHeight:0,blendMode:"alpha"},this.text="",this.textWidth=0,this.textHeight=0,this.horizontalAlignment="left",this.maxWidth=0,this.lineHeight=0}var e=a("../uicontrol"),f=a("./textlayout"),g={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){return a.contentDirty&&a.layoutText(),{width:a.textWidth,height:a.textHeight}}};d.prototype=Object.create(e.prototype),d.prototype.layoutText=function(){var a=f.layoutText(this.text,this.renderCommand.fontFamily,this.renderCommand.fontSize,this.horizontalAlignment,this.lineHeight,this.maxWidth);this.textWidth=a.width,this.textHeight=a.height,this.renderCommand.lines=a.lines,this.renderCommand.text=a.lines.map(function(a){return a.text}).join("\n"),this.setContentDirty(!0)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setLineHeight=function(a){this.lineHeight=a,this.renderCommand.lineHeight=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setText=function(a){a=String(a),this.text!==a&&(this.text=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0))},d.prototype.getText=function(){return this.text},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.setHorizontalAlignment=function(a){this.horizontalAlignment=a,this.renderCommand.horizontalAlignment=a,this.layouter.setNeedsRelayout(this)},d.prototype.setMaxWidth=function(a){this.maxWidth!==a&&(this.maxWidth=a,this.layouter.setNeedsRelayout(this))},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../uicontrol":281,"./textlayout":278}],278:[function(a,b,c){"use strict";function d(a,b){var c=a+" - "+b;if(void 0===i[c]){var d=document.createElement("span");d.style.fontFamily=a,d.style.fontSize=b+"px",d.innerHTML="yÅq|";var e=document.createElement("div");e.style.display="inline-block",e.style.width="1px",e.style.height="0px";var f=document.createElement("div");f.style.display="inline-block",f.appendChild(d),f.appendChild(e),document.body.appendChild(f),e.style.verticalAlign="bottom";var g=e.offsetTop-d.offsetTop;e.style.verticalAlign="baseline";var h=e.offsetTop-d.offsetTop;document.body.removeChild(f);var j={height:g,baseline:h};i[c]=j}return i[c]}function e(a,b,c){k.font=c+'px "'+b+'"';var e=d(b,c);return{width:k.measureText(a).width,height:e.height,baseline:e.baseline}}function f(a,b){if(k.measureText(a).width<b)return[a];var c=a.split(" ").map(function(a){return a+" "});c[c.length-1]=c[c.length-1].slice(0,-1);for(var d=[],e="";c.length>0;){for(;c[0].length>1&&k.measureText(c[0]).width>=b;){var f=c[0];c[0]=f.slice(0,-1),c.length>1?c[1]=f.slice(-1)+c[1]:c.push(f.slice(-1))}0===e.length||k.measureText(e+c[0]).width<b?e+=c.shift():(d.push(e),e="",c.length&&" "===c[0][0]&&(c[0]=c[0].slice(1),0===c[0].length&&c.shift())),0===c.length&&d.push(e)}return d}function g(a,b,c){return"center"===a?(b-c)/2:"right"===a?b-c:0}function h(a,b,c,e,h,i){k.font=c+'px "'+b+'"';var j=[];0===i?j=a.split("\n"):a.split("\n").forEach(function(a){j=j.concat(f(a,i))});var l=0,m=[];j.forEach(function(a){var b=k.measureText(a).width;l=Math.max(l,b),m.push(b)});var n=d(b,c),o=h?h:n.height,p=n.height+(j.length-1)*o,q=[];return j.forEach(function(a,b){var c=m[b],d=g(e,l,c);q.push({text:a,x:d,y:n.baseline+b*o})}),{width:l,height:p,lines:q}}var i={},j=document.createElement("canvas"),k=j.getContext("2d");b.exports={measureText:e,layoutText:h}},{}],279:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.innerControl=new f(a),this.addChild(this.innerControl)}var e=a("./docklayoutcontrol"),f=a("./text/textinnercontrol");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onLayoutWidthChanged=function(a){e.prototype._onLayoutWidthChanged.call(this,a),"explicit"===this.sizeMode||"childHeight"===this.sizeMode?this.innerControl.setMaxWidth(a):this.innerControl.setMaxWidth(0)},d.prototype.setFontFamily=function(a){this.innerControl.setFontFamily(a)},d.prototype.setFontSize=function(a){this.innerControl.setFontSize(a)},d.prototype.setLineHeight=function(a){this.innerControl.setLineHeight(a)},d.prototype.setText=function(a){this.innerControl.setText(a)},d.prototype.getText=function(){return this.innerControl.getText()},d.prototype.setColor=function(a){this.innerControl.setColor(a)},d.prototype.setHorizontalAlignment=function(a){this.innerControl.setHorizontalAlignment(a),this.innerControl.setAlignX(a)},d.prototype.setVerticalAlignment=function(a){this.innerControl.setAlignY(a)},d.prototype.setBlendMode=function(a){this.innerControl.setBlendMode(a)},d.prototype.dispose=function(){this.innerControl.dispose(),e.prototype.dispose.call(this)},b.exports=d},{"./docklayoutcontrol":266,"./text/textinnercontrol":277}],280:[function(a,b,c){"use strict";function d(a){e.call(this,a),this.layout=h,this.contentWidth=0,this.contentHeight=0,this.renderCommand={type:"textInput",fontFamily:"Helvetica",fontSize:40,color:"#ffffff",focused:!1,text:"",blendMode:"alpha"},this.text="",this.type="text",this.clip=!0}var e=a("./uicontrol"),f=a("./text/textlayout"),g=a("../../useragent-utils"),h={measure:function(a){return this.layoutSize(a,0,0)},layoutSize:function(a,b,c){var d=0,e=0;return d="childSize"===a.sizeMode||"childWidth"===a.sizeMode?a.contentWidth:"%"===a.widthUnit?b*(a.width/100):a.width,e="childSize"===a.sizeMode||"childHeight"===a.sizeMode?a.contentHeight:"%"===a.heightUnit?c*(a.height/100):a.height,{width:d,height:e}}};d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype.updateTextMetrics=function(){var a=f.measureText(this.renderCommand.text,this.renderCommand.fontFamily,this.renderCommand.fontSize);this.contentWidth=a.width,this.contentHeight=a.height,this.renderCommand.baseline=a.baseline,this.renderCommand.textWidth=a.width,this.renderCommand.textHeight=a.height,this.layouter.setNeedsRelayout(this)},d.prototype.setInputField=function(a){this.textInputField=a;var b=this;a.on("confirmed",function(){b.emit("confirmed")}),a.on("inputChanged",function(a){b.setText(a)},this),a.on("blur",this.blur.bind(this),this)},d.prototype.setFontFamily=function(a){this.renderCommand.fontFamily=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.setFontSize=function(a){this.renderCommand.fontSize=a,this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.getRenderText=function(a){if("password"===this.type){var b=g.isMobile.iOS()?"●":"•";a=b.repeat(a.length)}return a},d.prototype.setText=function(a){this.renderCommand.text=this.getRenderText(a),this.updateTextMetrics(),this.setContentDirty(!0),this.text=a,this.emit("textChanged",a)},d.prototype.setColor=function(a){this.renderCommand.color=a,this.setContentDirty(!0)},d.prototype.getText=function(){return this.text},d.prototype.setHorizontalAlignment=function(a){},d.prototype.setVerticalAlignment=function(a){},d.prototype.focus=function(){this.renderCommand.focused!==!0&&(this.renderCommand.focused=!0,this.textInputField.focus(),this.setContentDirty(!0),this.emit("focused",this))},d.prototype.blur=function(){this.renderCommand.focused!==!1&&(this.renderCommand.focused=!1,this.textInputField.blur(),this.setContentDirty(!0),this.emit("blurred",this))},d.prototype.isFocused=function(){return this.renderCommand.focused},d.prototype.setInputType=function(a){this.type=a,this.textInputField.setType(a),this.renderCommand.text=this.getRenderText(this.text),this.updateTextMetrics(),this.setContentDirty(!0)},d.prototype.dispose=function(){e.prototype.dispose.call(this),this.textInputField&&(this.textInputField.removeListenersWithRef(this),this.textInputField.dispose())},d.prototype.setBlendMode=function(a){this.renderCommand.blendMode=a,this.setContentDirty(!0)},b.exports=d},{"../../useragent-utils":319,"./text/textlayout":278,"./uicontrol":281}],281:[function(a,b,c){"use strict";function d(a){f.call(this),this.id=g(),this.layouter=a,this.sizeMode="explicit",this.pivotUnitType=[],this.pivotFactors=[.5,.5],this.parent=null,this.renderOrdering=0,this.positionX=0,this.positionY=0,this.positionZ=0,this.alignX="left",this.alignY="top",this.pivotX=50,this.pivotY=50,this.pivotXUnit="%",this.pivotYUnit="%",this.pivotXPx=0,this.pivotYPx=0,this.pivotZPx=0,this.width=0,this.height=0,this.widthUnit="%",this.heightUnit="%",this.depth=void 0,this.opacity=1,this.visible=!0,this.scaleX=1,this.scaleY=1,this.rotationX=0,this.rotationY=0,this.rotationZ=0,this.blockTouch=!1,this.touchPropagation=!0,this.contentDirty=!0,this.highlightEnabled=!1,this.selectionEnabled=!1,this.layoutRect=new e({xChanged:this._onLayoutPositionChanged.bind(this),yChanged:this._onLayoutPositionChanged.bind(this),widthChanged:this._onLayoutWidthChanged.bind(this),heightChanged:this._onLayoutHeightChanged.bind(this)}),this.screenAABB=i.create(),this.transform=h.create(),this.localTransform=h.create(),this.localTransformDirty=!1}var e=a("./../layout/layoutrect"),f=a("../../eventsender"),g=a("../../guid"),h=a("../math/mat4"),i=a("../math/aabb");d.prototype=Object.create(f.prototype),d.prototype.constructor=d,d.prototype._onLayoutPositionChanged=function(){this.localTransformDirty=!0},d.prototype._onLayoutWidthChanged=function(a){this.emit("layoutWidthChanged",a),"%"===this.pivotXUnit&&this.setPivotX(this.pivotX)},d.prototype._onLayoutHeightChanged=function(a){this.emit("layoutHeightChanged",a),"%"===this.pivotYUnit&&this.setPivotY(this.pivotY)},d.prototype.setPositionX=function(a){this.positionX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionY=function(a){this.positionY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setPositionZ=function(a){this.positionZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setWidth=function(a){a===1/0&&(a=0),this.width=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeight=function(a){a===1/0&&(a=0),this.height=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setWidthUnit=function(a){this.widthUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setHeightUnit=function(a){this.heightUnit=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setSizeMode=function(a){this.sizeMode=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignX=function(a){this.alignX=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setAlignY=function(a){this.alignY=a,this.layouter.setNeedsRelayout(this),this.setContentDirty(!0)},d.prototype.setBlockTouch=function(a){this.blockTouch=a},d.prototype.setTouchPropagation=function(a){this.touchPropagation=a},d.prototype.setDepth=function(a){this.depth=a,this.setContentDirty(!0)},d.prototype.setOpacity=function(a){0===this.opacity&&a>0&&(this.localTransformDirty=!0),this.opacity=a,this.setContentDirty(!0)},d.prototype.setVisible=function(a){this.visible=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setPivotX=function(a){this.pivotX=a;var b=a;if("%"===this.pivotXUnit){var c=void 0===this.layoutRect.width?0:this.layoutRect.width;b=c*a*.01}this.pivotXPx!==b&&(this.pivotXPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotXUnit=function(a){this.pivotXUnit=a,this.setPivotX(this.pivotX),this.setContentDirty(!0)},d.prototype.setPivotY=function(a){this.pivotY=a;var b=a;if("%"===this.pivotYUnit){var c=void 0===this.layoutRect.height?0:this.layoutRect.height;b=c*a*.01}this.pivotYPx!==b&&(this.pivotYPx=b,this.localTransformDirty=!0,this.setContentDirty(!0))},d.prototype.setPivotYUnit=function(a){this.pivotYUnit=a,this.setPivotY(this.pivotY),this.setContentDirty(!0)},d.prototype.setPivotZ=function(a){this.pivotZPx=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationX=function(a){this.rotationX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationY=function(a){this.rotationY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setRotationZ=function(a){this.rotationZ=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleX=function(a){this.scaleX=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setScaleY=function(a){this.scaleY=a,this.localTransformDirty=!0,this.setContentDirty(!0)},d.prototype.setContentDirty=function(a){this.contentDirty!==a&&(this.contentDirty=a,a&&this.parent&&this.parent.setContentDirty(!0))},d.prototype.setSelectionEnabled=function(a){this.selectionEnabled=a,this.setContentDirty(!0)},d.prototype.setHighlightEnabled=function(a){this.highlightEnabled=a,this.setContentDirty(!0)},d.prototype.getScreenX=function(){return this.screenAABB.min[0]},d.prototype.getScreenY=function(){return this.screenAABB.min[1]},d.prototype.dispose=function(){this.emit("disposed",this),this.removeAllListeners()},b.exports=d},{"../../eventsender":168,"../../guid":170,"../math/aabb":289,"../math/mat4":291,"./../layout/layoutrect":286}],282:[function(a,b,c){"use strict";function d(){this.cache={},this.crossOrigin=!1}d.prototype.setCrossOrigin=function(a){this.crossOrigin=a?!0:!1},d.prototype.getImage=function(a,b){var c=this.cache[a];if(c)return void(c.isLoaded?b(c.image):c.callbacks.push(b));this.cache[a]={image:new Image,callbacks:[],isLoaded:!1},c=this.cache[a],c.callbacks.push(b);var d=c.image;this.crossOrigin&&(d.crossOrigin="anonymous"),d.addEventListener("load",function(){c.callbacks.forEach(function(a){a(d)}),c.isLoaded=!0,delete c.callbacks}),d.src=a,d._path=a},d.prototype.clear=function(){this.cache={}},b.exports=d},{}],283:[function(a,b,c){"use strict";function d(){}d.prototype.layoutChildHorizontally=function(a,b,c,d,e){"left"===b.alignX?(a.x=b.positionX+e.left,a.width=c):"right"===b.alignX?(a.x=d.width-e.right+b.positionX-c,a.width=c):"center"===b.alignX&&(a.x=(d.width-e.right-e.left)/2+e.left+b.positionX-c/2,a.width=c),a.x=Math.round(a.x)},d.prototype.layoutChildVertically=function(a,b,c,d,e){"top"===b.alignY?(a.y=b.positionY+e.top,a.height=c):"bottom"===b.alignY?(a.y=d.height-e.bottom+b.positionY-c,a.height=c):"center"===b.alignY&&(a.y=(d.height-e.bottom-e.top)/2+e.top+b.positionY-c/2,a.height=c),a.y=Math.round(a.y)},d.prototype.setChildLayoutRect=function(a,b){var c=a.layoutRect.width!=b.width||a.layoutRect.height!=b.height;a.layoutRect.x=b.x,a.layoutRect.y=b.y,a.layoutRect.width=Math.max(b.width,0),a.layoutRect.height=Math.max(b.height,0),(c||a.needsRelayout)&&(a.layout.layout&&a.layout.layout(a),a.needsRelayout=!1)},d.prototype.layout=function(a){for(var b={x:0,y:0,width:0,height:0},c=0;c<a.children.length;c++){var d=a.children[c],e=a.layoutRect.width-a.padding.left-a.padding.right,f=a.layoutRect.height-a.padding.top-a.padding.bottom,g=d.layout.layoutSize(d,e,f);this.layoutChildHorizontally(b,d,g.width,a.layoutRect,a.padding),this.layoutChildVertically(b,d,g.height,a.layoutRect,a.padding),this.setChildLayoutRect(d,b)}},d.prototype.layoutSize=function(a,b,c){var d=this.measure(a,b,c);return{width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?d.width:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?d.height:this.layoutHeight(a,c)}},d.prototype.measureChildrenWidth=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionX,0)+f.width)}return c},d.prototype.measureChildrenHeight=function(a,b){for(var c=0,d=0;d<a.children.length;d++){var e=a.children[d],f=e.layout.measure(e,b.width,b.height);c=Math.max(c,Math.max(e.positionY,0)+f.height)}return c},d.prototype.layoutWidth=function(a,b){return"%"===a.widthUnit?b*(a.width/100):a.width},d.prototype.layoutHeight=function(a,b){return"%"===a.heightUnit?b*(a.height/100):a.height},d.prototype.measure=function(a,b,c){if(a.measuredSize)return a.measuredSize;var d={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutWidth(a,b),height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?0:this.layoutHeight(a,c)},e={width:"childWidth"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenWidth(a,d)+a.padding.left+a.padding.right:d.width,height:"childHeight"===a.sizeMode||"childSize"===a.sizeMode?this.measureChildrenHeight(a,d)+a.padding.top+a.padding.bottom:d.height};return a.measuredSize=e,e},d["static"]=new d,b.exports=d},{}],284:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.measureChildrenHeightForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.width-a.padding.left-a.padding.right,d=0,e=0,f=0,g=a.children.length,h=0;g>h;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);e+j.width>c&&(d+=f+a.verticalItemSpacing,f=e=0),f=Math.max(f,j.height+i.positionY),e+=j.width+a.horizontalItemSpacing}return d+=f},d.prototype.measureChildrenWidthForHorizontalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return b.width;for(var c=0,d=a.children.length,e=0;d>e;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);c+=g.width+(e!==d-1?a.horizontalItemSpacing:0)}return c},d.prototype.measureChildrenWidthForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childHeight"===this.sizeMode)return dim.width;for(var c="childSize"===a.sizeMode?Number.MAX_VALUE:b.height-a.padding.top-a.padding.left,d=0,e=0,f=0,g=a.children.length,h=0;g>h;h++){var i=a.children[h],j=i.layout.measure(i,b.width,b.height);d+j.height>c&&(e+=f+a.horizontalItemSpacing,f=d=0),f=Math.max(f,j.width+i.positionX),d+=j.height+a.verticalItemSpacing}return e+=f},d.prototype.measureChildrenHeightForVerticalFlow=function(a,b){if("explict"===this.sizeMode||"childWidth"===this.sizeMode)return b.height;for(var c=0,d=a.children.length,e=0;d>e;e++){var f=a.children[e],g=f.layout.measure(f,b.width,b.height);c+=g.height+(e!==d-1?a.verticalItemSpacing:0)}return c},d.prototype.measureChildrenWidth=function(a,b){return"horizontal"===a.orientation?this.measureChildrenWidthForHorizontalFlow(a,b):this.measureChildrenWidthForVerticalFlow(a,b)},d.prototype.measureChildrenHeight=function(a,b){return"horizontal"===a.orientation?this.measureChildrenHeightForHorizontalFlow(a,b):this.measureChildrenHeightForVerticalFlow(a,b)};var f=[];d.prototype.layout=function(a){function b(b,c,d,e,g){var h=0,i=a.layoutRect.width-a.padding.left-a.padding.right;"center"===a.contentAlignX?h=Math.round(.5*(i-g)):"right"===a.contentAlignX&&(h=i-g);for(var k=b;c>k;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,0,e);j.layoutChildVertically(m,l,n.height,{height:e},{top:0,bottom:0,left:0,right:0}),m.x+=h,m.y+=d,j.setChildLayoutRect(l,m)}}function c(b,c,d,e,g){var h=0,i=a.layoutRect.height-a.padding.top-a.padding.bottom;"center"===a.contentAlignY?h=Math.round(.5*(i-g)):"bottom"===a.contentAlignY&&(h=i-g);for(var k=b;c>k;k++){var l=a.children[k],m=f[k],n=l.layout.layoutSize(l,e,0);j.layoutChildHorizontally(m,l,n.width,{width:e},{top:0,bottom:0,left:0,right:0}),m.x+=d,m.y+=h,j.setChildLayoutRect(l,m)}}var d,e,g,h,i,j=this,k=0,l=0,m=0,n=0,o=0,p=a.children.length;if(f.length<p)for(e=0;p>e;e++)f[e]={x:0,y:0,width:0,height:0};if("horizontal"===a.orientation){var q=a.layoutRect.width-a.padding.left-a.padding.right;d=q;var n=0;for(e=0;p>e;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,q,0),k+h.width>d&&(b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing),l+=m+a.verticalItemSpacing,o=e,m=0,n=0,k=0),m=Math.round(Math.max(m,h.height)),i.x=k+a.padding.left+g.positionX,i.width=h.width,k+=Math.round(h.width)+a.horizontalItemSpacing;b(o,e,l+a.padding.top,m,k-a.horizontalItemSpacing)}else{var r=a.layoutRect.height-a.padding.top-a.padding.bottom;for(d=r,e=0;p>e;e++)i=f[e],g=a.children[e],h=g.layout.layoutSize(g,0,r),l+h.height>d&&(c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing),k+=n+a.horizontalItemSpacing,o=e,n=0,l=0),n=Math.round(Math.max(n,h.width)),i.y=l+a.padding.top+g.positionY,i.height=h.height,l+=Math.round(h.height)+a.verticalItemSpacing;c(o,e,k+a.padding.left,n,l-a.verticalItemSpacing)}},d["static"]=new d,b.exports=d},{"./docklayout":283}],285:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype.setWindowSize=function(a,b){this.windowSize={width:a,height:b}},d.prototype.layout=function(a){var b={layoutRect:{x:0,y:0,width:this.windowSize.width,height:this.windowSize.height},padding:{top:0,left:0,bottom:0,right:0},children:[a]};e["static"].layout(b),a.needsRelayout=!1},d.prototype.setNeedsFullRelayout=function(a){function b(a){if(a.measuredSize=void 0,a.needsRelayout=!0,a.children)for(var c=0;c<a.children.length;c++)b(a.children[c])}b(a)},d.prototype.setNeedsRelayout=function(a){a.needsRelayout||(a.measuredSize=void 0,a.needsRelayout=!0,a.parent&&this.setNeedsRelayout(a.parent))},d.prototype.relayout=function(a){this.setNeedsFullRelayout(a),this.layout(a)},b.exports=d},{"./docklayout":283}],286:[function(a,b,c){var d=function(a){this._x=this._y=this._width=this._height=void 0,
this.callbacks=a};Object.defineProperties(d.prototype,{x:{set:function(a){this._x!==a&&(this._x=a,this.callbacks.xChanged(a))},get:function(){return this._x}},y:{set:function(a){this._y!==a&&(this._y=a,this.callbacks.yChanged(a))},get:function(){return this._y}},width:{set:function(a){this._width!==a&&(this._width=a,this.callbacks.widthChanged(a))},get:function(){return this._width}},height:{set:function(a){this._height!==a&&(this._height=a,this.callbacks.heightChanged(a))},get:function(){return this._height}}}),b.exports=d},{}],287:[function(a,b,c){"use strict";function d(){}var e=a("./stacklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=a.children.length,f={x:0,y:0,width:0,height:0},g=a.layoutRect.height-a.padding.top-a.padding.bottom,h=a.layoutRect.width-a.padding.left-a.padding.right;if("horizontal"===a.orientation){var i=a.padding.left;for(d=0;e>d;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),f.x=Math.round(i+a.scrollOffset+b.positionX),f.width=Math.round(c.width),this.layoutChildVertically(f,b,c.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,f),i+=a.itemSpacing+b.layoutRect.width;a.contentLengthChanged&&a.contentLengthChanged(i-(d>0?a.itemSpacing:0)-a.padding.left)}else{var j=a.padding.top;for(d=0;e>d;d++)b=a.children[d],c=b.layout.layoutSize(b,h,g),this.layoutChildHorizontally(f,b,c.width,a.layoutRect,a.padding),f.y=Math.round(j+a.scrollOffset+b.positionY),f.height=Math.round(c.height),this.setChildLayoutRect(b,f),j+=a.itemSpacing+b.layoutRect.height;a.contentLengthChanged&&a.contentLengthChanged(j-(d>0?a.itemSpacing:0)-a.padding.top)}},d["static"]=new d,b.exports=d},{"./stacklayout":288}],288:[function(a,b,c){"use strict";function d(){}var e=a("./docklayout");d.prototype=Object.create(e.prototype),d.prototype.layout=function(a){var b,c,d,e=0,f=0,g=0,h={x:0,y:0,width:0,height:0},i=a.layoutRect.width-a.padding.left-a.padding.right,j=a.layoutRect.height-a.padding.top-a.padding.bottom;if("horizontal"===a.orientation){for(c=a.children.length,d=0;c>d;d++)if(b=a.children[d],"%"!==b.widthUnit||"explicit"!==b.sizeMode&&"childHeight"!==b.sizeMode){var k=b.layout.measure(b,i,j);e+=k.width}else g+=b.width/100;f=Math.max(0,a.layoutRect.width-a.padding.left-a.padding.right-e-a.itemSpacing*(c-1))/g;var l=Math.round(a.padding.left);for(d=0;c>d;d++){b=a.children[d];var m=a.layoutRect.height-a.padding.top-a.padding.bottom;k=b.layout.layoutSize(b,f,m),h.x=l+b.positionX,h.width=Math.round(k.width),this.layoutChildVertically(h,b,k.height,a.layoutRect,a.padding),this.setChildLayoutRect(b,h),l+=a.itemSpacing+b.layoutRect.width}}else{for(c=a.children.length,d=0;c>d;d++)b=a.children[d],"%"!==b.heightUnit||"explicit"!==b.sizeMode&&"childWidth"!==b.sizeMode?(k=b.layout.measure(b,i,j),e+=k.height):g+=b.height/100;f=Math.max(0,a.layoutRect.height-a.padding.top-a.padding.bottom-e-a.itemSpacing*(c-1))/g;var n=Math.round(a.padding.top);for(d=0;c>d;d++){b=a.children[d];var o=a.layoutRect.width-a.padding.left-a.padding.right;k=b.layout.layoutSize(b,o,f),this.layoutChildHorizontally(h,b,k.width,a.layoutRect,a.padding),h.y=n+b.positionY,h.height=Math.round(k.height),this.setChildLayoutRect(b,h),n+=a.itemSpacing+b.layoutRect.height}}a.needsRelayout=!1},d.prototype.measureChildrenWidth=function(a,b){if("horizontal"===a.orientation){for(var c=0,d=a.children.length,f=0;d>f;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.width+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenWidth.call(this,a,b)},d.prototype.measureChildrenHeight=function(a,b){if("vertical"===a.orientation){for(var c=0,d=a.children.length,f=0;d>f;f++){var g=a.children[f],h=g.layout.measure(g,b.width,b.height);c+=h.height+(f!==d-1?a.itemSpacing:0)}return c}return e.prototype.measureChildrenHeight.call(this,a,b)},d["static"]=new d,b.exports=d},{"./docklayout":283}],289:[function(a,b,c){"use strict";var d=a("./mat3"),e=a("./mat4"),f=[[0,0,0],[0,0,0],[0,0,0],[0,0,0]],g={};g.create=function(){return{min:[0,0],max:[0,0]}},g.createFrom=function(a,b,c,d){return{min:[a||0,b||0],max:[c||0,d||0]}},g.set=function(a,b,c,d,e){a.min[0]=b,a.min[1]=c,a.max[0]=d,a.max[1]=e},g.transform3=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],d.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;4>c;++c){var e=f[c];d.transformPoint(b,e),e[0]<a.min[0]&&(a.min[0]=e[0]),e[1]<a.min[1]&&(a.min[1]=e[1]),e[0]>a.max[0]&&(a.max[0]=e[0]),e[1]>a.max[1]&&(a.max[1]=e[1])}},g.transform4=function(a,b){f[0][0]=a.min[0],f[0][1]=a.min[1],f[1][0]=a.min[0],f[1][1]=a.max[1],f[2][0]=a.max[0],f[2][1]=a.min[1],f[3][0]=a.max[0],f[3][1]=a.max[1],e.transformPoint(b,f[0]),a.min[0]=a.max[0]=f[0][0],a.min[1]=a.max[1]=f[0][1];for(var c=1;4>c;++c){var d=f[c];e.transformPoint(b,d),d[0]<a.min[0]&&(a.min[0]=d[0]),d[1]<a.min[1]&&(a.min[1]=d[1]),d[0]>a.max[0]&&(a.max[0]=d[0]),d[1]>a.max[1]&&(a.max[1]=d[1])}},g.copy=function(a,b){a.min[0]=b.min[0],a.min[1]=b.min[1],a.max[0]=b.max[0],a.max[1]=b.max[1]},g.intersects=function(a,b){return a.min[0]>=b.max[0]||a.max[0]<=b.min[0]||a.min[1]>=b.max[1]||a.max[1]<=b.min[1]?!1:!0},g.union=function(a,b){b.min[0]<a.min[0]&&(a.min[0]=b.min[0]),b.min[1]<a.min[1]&&(a.min[1]=b.min[1]),b.max[0]>a.max[0]&&(a.max[0]=b.max[0]),b.max[1]>a.max[1]&&(a.max[1]=b.max[1])},g.width=function(a){return a.max[0]-a.min[0]},g.height=function(a){return a.max[1]-a.min[1]},g.isPointInside=function(a,b){return b[0]>=a.min[0]&&b[0]<=a.max[0]&&b[1]>=a.min[1]&&b[1]<=a.max[1]},g.intersection=function(a,b){a.min[0]=Math.max(a.min[0],b.min[0]),a.min[1]=Math.max(a.min[1],b.min[1]),a.max[0]=Math.min(a.max[0],b.max[0]),a.max[1]=Math.min(a.max[1],b.max[1])},b.exports=g},{"./mat3":290,"./mat4":291}],290:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(9);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=1,a[5]=0,a[6]=0,a[7]=0,a[8]=1,a},e.copy=function(a,b){for(var c=0;9>c;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=c[0],n=c[1],o=c[2],p=c[3],q=c[4],r=c[5],s=c[6],t=c[7],u=c[8];return a[0]=m*d+n*g+o*j,a[1]=m*e+n*h+o*k,a[2]=m*f+n*i+o*l,a[3]=p*d+q*g+r*j,a[4]=p*e+q*h+r*k,a[5]=p*f+q*i+r*l,a[6]=s*d+t*g+u*j,a[7]=s*e+t*h+u*k,a[8]=s*f+t*i+u*l,a},e.translate=function(a,b,c){return a[6]=b*a[0]+c*a[3]+a[6],a[7]=b*a[1]+c*a[4]+a[7],a[8]=b*a[2]+c*a[5]+a[8],a},e.rotate=function(a,b){var c=a[0],d=a[1],e=a[2],f=a[3],g=a[4],h=a[5],i=a[6],j=a[7],k=a[8],l=Math.sin(b),m=Math.cos(b);return a[0]=m*c+l*f,a[1]=m*d+l*g,a[2]=m*e+l*h,a[3]=m*f-l*c,a[4]=m*g-l*d,a[5]=m*h-l*e,a[6]=i,a[7]=j,a[8]=k,a},e.scale=function(b,c,d){return b[0]=c*a[0],b[1]=c*a[1],b[2]=c*a[2],b[3]=d*a[3],b[4]=d*a[4],b[5]=d*a[5],b[6]=a[6],b[7]=a[7],b[8]=a[8],b},e.transformPoint=function(a,b){var c=b[0],d=b[1];b[0]=a[0]*c+a[3]*d+a[6],b[1]=a[1]*c+a[4]*d+a[7]},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=j*f-g*i,l=-j*e+g*h,m=i*e-f*h,n=b*k+c*l+d*m;return n?(n=1/n,a[0]=k*n,a[1]=(-j*c+d*i)*n,a[2]=(g*c-d*f)*n,a[3]=l*n,a[4]=(j*b-d*h)*n,a[5]=(-g*b+d*e)*n,a[6]=m*n,a[7]=(-i*b+c*h)*n,a[8]=(f*b-c*e)*n,a):null},c.exports=e},{}],291:[function(b,c,d){"use strict";var e={};e.create=function(){var a=new Array(16);return e.identity(a),a},e.identity=function(a){return a[0]=1,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=1,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=1,a[11]=0,a[12]=0,a[13]=0,a[14]=0,a[15]=1,a},e.identityMatrix=e.create(),e.copy=function(a,b){for(var c=0;16>c;c++)a[c]=b[c];return a},e.multiply=function(a,b,c){var d=b[0],e=b[1],f=b[2],g=b[3],h=b[4],i=b[5],j=b[6],k=b[7],l=b[8],m=b[9],n=b[10],o=b[11],p=b[12],q=b[13],r=b[14],s=b[15],t=c[0],u=c[1],v=c[2],w=c[3];return a[0]=t*d+u*h+v*l+w*p,a[1]=t*e+u*i+v*m+w*q,a[2]=t*f+u*j+v*n+w*r,a[3]=t*g+u*k+v*o+w*s,t=c[4],u=c[5],v=c[6],w=c[7],a[4]=t*d+u*h+v*l+w*p,a[5]=t*e+u*i+v*m+w*q,a[6]=t*f+u*j+v*n+w*r,a[7]=t*g+u*k+v*o+w*s,t=c[8],u=c[9],v=c[10],w=c[11],a[8]=t*d+u*h+v*l+w*p,a[9]=t*e+u*i+v*m+w*q,a[10]=t*f+u*j+v*n+w*r,a[11]=t*g+u*k+v*o+w*s,t=c[12],u=c[13],v=c[14],w=c[15],a[12]=t*d+u*h+v*l+w*p,a[13]=t*e+u*i+v*m+w*q,a[14]=t*f+u*j+v*n+w*r,a[15]=t*g+u*k+v*o+w*s,a},e.translate=function(a,b,c,d){return a[12]=a[0]*b+a[4]*c+a[8]*d+a[12],a[13]=a[1]*b+a[5]*c+a[9]*d+a[13],a[14]=a[2]*b+a[6]*c+a[10]*d+a[14],a[15]=a[3]*b+a[7]*c+a[11]*d+a[15],a},e.rotateX=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[4],f=a[5],g=a[6],h=a[7],i=a[8],j=a[9],k=a[10],l=a[11];return a[4]=e*d+i*c,a[5]=f*d+j*c,a[6]=g*d+k*c,a[7]=h*d+l*c,a[8]=i*d-e*c,a[9]=j*d-f*c,a[10]=k*d-g*c,a[11]=l*d-h*c,a},e.rotateY=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[8],j=a[9],k=a[10],l=a[11];return a[0]=e*d-i*c,a[1]=f*d-j*c,a[2]=g*d-k*c,a[3]=h*d-l*c,a[8]=e*c+i*d,a[9]=f*c+j*d,a[10]=g*c+k*d,a[11]=h*c+l*d,a},e.rotateZ=function(a,b){var c=Math.sin(b),d=Math.cos(b),e=a[0],f=a[1],g=a[2],h=a[3],i=a[4],j=a[5],k=a[6],l=a[7];return a[0]=e*d+i*c,a[1]=f*d+j*c,a[2]=g*d+k*c,a[3]=h*d+l*c,a[4]=i*d-e*c,a[5]=j*d-f*c,a[6]=k*d-g*c,a[7]=l*d-h*c,a},e.scale=function(b,c,d,e){return b[0]=a[0]*c,b[1]=a[1]*c,b[2]=a[2]*c,b[3]=a[3]*c,b[4]=a[4]*d,b[5]=a[5]*d,b[6]=a[6]*d,b[7]=a[7]*d,b[8]=a[8]*e,b[9]=a[9]*e,b[10]=a[10]*e,b[11]=a[11]*e,b[12]=a[12],b[13]=a[13],b[14]=a[14],b[15]=a[15],b},e.transformPoint=function(a,b){var c=b[0],d=b[1],e=b[2],f=a[3]*c+a[7]*d+a[11]*e+a[15];f=f||1,b[0]=(a[0]*c+a[4]*d+a[8]*e+a[12])/f,b[1]=(a[1]*c+a[5]*d+a[9]*e+a[13])/f,b[2]=(a[2]*c+a[6]*d+a[10]*e+a[14])/f},e.invert=function(a){var b=a[0],c=a[1],d=a[2],e=a[3],f=a[4],g=a[5],h=a[6],i=a[7],j=a[8],k=a[9],l=a[10],m=a[11],n=a[12],o=a[13],p=a[14],q=a[15],r=b*g-c*f,s=b*h-d*f,t=b*i-e*f,u=c*h-d*g,v=c*i-e*g,w=d*i-e*h,x=j*o-k*n,y=j*p-l*n,z=j*q-m*n,A=k*p-l*o,B=k*q-m*o,C=l*q-m*p,D=r*C-s*B+t*A+u*z-v*y+w*x;return D?(D=1/D,a[0]=(g*C-h*B+i*A)*D,a[1]=(d*B-c*C-e*A)*D,a[2]=(o*w-p*v+q*u)*D,a[3]=(l*v-k*w-m*u)*D,a[4]=(h*z-f*C-i*y)*D,a[5]=(b*C-d*z+e*y)*D,a[6]=(p*t-n*w-q*s)*D,a[7]=(j*w-l*t+m*s)*D,a[8]=(f*B-g*z+i*x)*D,a[9]=(c*z-b*B-e*x)*D,a[10]=(n*v-o*t+q*r)*D,a[11]=(k*t-j*v-m*r)*D,a[12]=(g*y-f*A-h*x)*D,a[13]=(b*A-c*y+d*x)*D,a[14]=(o*s-n*u-p*r)*D,void(a[15]=(j*u-k*s+l*r)*D)):null},e.perspective=function(a,b,c,d,e){var f=1/Math.tan(b/2),g=1/(d-e);return a[0]=f/c,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=f,a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=(e+d)*g,a[11]=-1,a[12]=0,a[13]=0,a[14]=2*e*d*g,a[15]=0,a},c.exports=e},{}],292:[function(a,b,c){"use strict";function d(a){h.call(this),this.rendererType=d.TypeWebGL,this.domCache=new n,this.rootElement=document.createElement("div"),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.perspective="1000px",this.rootElement.style.webkitPerspective="1000px",a.appendChild(this.rootElement),this.clipAABB=g.create(),this.rootRendererTransparent=!1,this.renderersToDetach=[],this.clipToViewport=!0,this.renderers=[],this.cachedRenderers=[],this.renderDepthSet={},this._resizeRootElement();var b=this;i.isMobile.Android()&&window.addEventListener("orientationchange",function(){window.setTimeout(b._resizeRootElement.bind(b),100)})}function e(a,b){return a-b}var f=a("./math/mat4"),g=a("./math/aabb"),h=a("../eventsender"),i=a("../useragent-utils"),j=a("lodash"),k=a("./renderers/renderer-dom"),l=a("./renderers/renderer-webgl"),m=a("./renderers/renderer-canvas2d"),n=a("./renderers/dom/domcache");d.TypeWebGL=1,d.TypeCanvas=2,d.TypeDOM=3,d.prototype=Object.create(h.prototype),d.prototype.constructor=d,d.prototype._resizeRootElement=function(){i.isMobile.Android()?(this.rootElement.style.width=window.innerWidth+"px",this.rootElement.style.height=window.innerHeight+"px"):(this.rootElement.style.width="100%",this.rootElement.style.height="100%"),this.renderers.concat(this.cachedRenderers).forEach(function(a){a.resizeRootElement&&a.resizeRootElement()}),this.emit("requestFrame")},d.prototype.setClipToViewport=function(a){this.clipToViewport=a},d.prototype.setRendererType=function(a,b){this.removeAllRenderers(),this.rendererType=a,this.rootRendererTransparent=b,this.renderers.unshift(this.createRendererForType("noodl",!1,!0))},d.prototype.removeAllRenderers=function(){this.renderers.concat(this.cachedRenderers).forEach(function(a){a.detach&&a.detach(),a.onShaderError&&delete a.onShaderError}),this.textInputRenderer=null,this.renderers=[],this.cachedRenderers=[]},d.prototype.configureRenderer=function(a,b){b||!this.textInputRenderer?a.attach&&a.attach(this.rootElement):a.attach&&a.attach(this.rootElement,this.textInputRenderer.rootElement),a.setViewportSize&&a.setViewportSize(this.viewportWidth,this.viewportHeight)},d.prototype.beginLayout=function(){this.renderDepthSet={}},d.prototype.layout=function(a,b){if(a.visible&&0!==a.opacity){a.contentDirty=!1;var c=a.layoutRect,d=a.localTransform,e=b||a.localTransformDirty;if(a.localTransformDirty&&(f.identity(d),d[0]=a.scaleX,d[5]=a.scaleY,d[12]=c.x+a.pivotXPx,d[13]=c.y+a.pivotYPx,d[14]=a.positionZ+a.pivotZPx,a.rotationX&&f.rotateX(d,a.rotationX),a.rotationY&&f.rotateY(d,a.rotationY),a.rotationZ&&f.rotateZ(d,a.rotationZ),f.translate(d,-a.pivotXPx,-a.pivotYPx,-a.pivotZPx),a.localTransformDirty=!1),e){f.multiply(a.transform,a.parent.transform,d);var h=a.screenAABB.min[0],i=a.screenAABB.min[1];g.set(a.screenAABB,0,0,c.width,c.height),g.transform4(a.screenAABB,a.transform),h!==a.screenAABB.min[0]&&a.emit("screenXChanged",a.screenAABB.min[0]),i!==a.screenAABB.min[1]&&a.emit("screenYChanged",a.screenAABB.min[1])}if(a.renderDepth=void 0!==a.depth?a.depth:a.parent.renderDepth||0,this.renderDepthSet[a.renderDepth]=!0,a.children){g.copy(a.childAABB,a.screenAABB);for(var j=0,k=a.children.length;k>j;j++){var l=a.children[j];this.layout(l,e),a.clip||g.union(a.childAABB,l.childAABB||l.screenAABB)}}}},d.prototype._addRenderCommand=function(a,b,c){if(void 0!==c)a[c].push(b);else for(var d=0;d<this.renderDepths.length;d++)a[this.renderDepths[d]].push(b)},d.prototype._collectRenderCommandsRecursive=function(a,b,c,d,e){if(a.visible&&0!==a.opacity&&g.intersects(this.clipAABB,a.childAABB||a.screenAABB)!==!1){var h=!1;if(a.renderToFramebuffer&&(h=!0,this._addRenderCommand(b,{content:{type:"pushFrameBuffer"},id:a.id,frameBufferSettings:a.frameBufferSettings},a.renderDepth)),a.clip){this._addRenderCommand(b,{content:{type:"pushClipRect"},id:a.id+"clip",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height});var i=g.create();g.copy(i,this.clipAABB),g.intersection(this.clipAABB,a.screenAABB)}var k=a.renderCommand;if(k&&!a.renderToFramebuffer&&("image"!==k.type||k.image||k.imageTextureControlId)&&(k.opacity=a.opacity*d,this._addRenderCommand(b,{content:k,id:a.id,transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height},a.renderDepth)),k&&k.maskType&&"none"!==k.maskType){var l=j.clone(k);l.maskType="positive"===k.maskType?"negative":"positive",c.push({content:l,id:a.id+"-undoMask",transform:a.transform,width:a.layoutRect.width,height:a.layoutRect.height})}if(a.renderToFramebuffer&&!a.frameBufferSettings.renderAfterPop&&(e=.1),a.children){for(var m=[],n=0,o=a.children.length;o>n;n++)this._collectRenderCommandsRecursive(a.children[n],b,m,h?1:a.opacity*d,e);for(var n=0,o=m.length;o>n;n++)this._addRenderCommand(b,m[n],a.renderDepth)}if(a.highlightEnabled||a.selectionEnabled){var p=this,q=function(c,d,f,g,h){h=h||0,g=g||"#30C2FF",p._addRenderCommand(b,{id:a.id+"-hl",content:{type:"rectangle",color:g,opacity:e,cornerRadius:h,blur:0},transform:c,width:d,height:f},a.renderDepth)},r=2,s=8,t=Math.max(0,r-a.screenAABB.min[0]),u=Math.max(0,r+a.screenAABB.max[0]-this.viewportWidth),v=Math.max(0,r-a.screenAABB.min[1]),w=Math.max(0,r+a.screenAABB.max[1]-this.viewportHeight),x=f.create();f.copy(x,a.transform),f.translate(x,-r+t,-r+v,0),q(x,r,a.layoutRect.height+2*r),q(x,a.layoutRect.width+2*r,r);var y=f.create();f.copy(y,a.transform),f.translate(y,a.layoutRect.width-u,-r,0),q(y,r,a.layoutRect.height+2*r);var z=f.create();if(f.copy(z,a.transform),f.translate(z,-r,a.layoutRect.height-w,0),q(z,a.layoutRect.width+2*r,r),a.selectionEnabled){var A=f.create();f.copy(A,a.transform),f.translate(A,-s/2-r/2,-s/2-r/2,0),q(A,s,s,"#3f81b0",4);var B=f.create();f.copy(B,y),f.translate(B,-s/2+r/2,-s/2+r/2,0),q(B,s,s,"#3f81b0",4);var C=f.create();f.copy(C,B),f.translate(C,0,a.layoutRect.height+r,0),q(C,s,s,"#3f81b0",4);var D=f.create();f.copy(D,A),f.translate(D,0,a.layoutRect.height+r,0),q(D,s,s,"#3f81b0",4)}}if(a.clip){for(var n=0;n<this.renderDepths.length;n++){var E=b[this.renderDepths[n]];"pushClipRect"===E[E.length-1].content.type?E.length=E.length-1:E.push({content:{type:"popClipRect"}})}g.copy(this.clipAABB,i)}a.renderToFramebuffer&&this._addRenderCommand(b,{content:{type:"popFrameBuffer",transform:a.transform,opacity:a.opacity*d,shaderSource:a.shaderSource,shaderUniforms:a.shaderUniforms,secondaryShaderSource:a.secondaryShaderSource,secondaryShaderUniforms:a.secondaryShaderUniforms},frameBufferSettings:a.frameBufferSettings,width:this.viewportWidth,height:this.viewportHeight,clipWidth:a.layoutRect.width,clipHeight:a.layoutRect.height,id:a.id,transform:f.identityMatrix},a.renderDepth)}},d.prototype._collectRenderCommands=function(a){var b={};this.renderDepths=Object.keys(this.renderDepthSet);for(var c=0;c<this.renderDepths.length;c++)b[this.renderDepths[c]]=[];return this._collectRenderCommandsRecursive(a,b,[],1,1),b},d.prototype.createRendererForType=function(a,b,c){var e=null;if(a&&"html"===a)e=new k(!0,this.domCache),e.setRenderHTMLOnly(!0);else{var f=i.isMobile.any();if(this.rendererType===d.TypeWebGL){e=new l({alpha:!c||this.rootRendererTransparent});var g=this;e.onShaderError=function(a,b,c){g.emit("shaderError",{id:a,error:b,type:c})}}else this.rendererType===d.TypeCanvas?e=new m({alpha:!c||this.rootRendererTransparent,useScreenResolution:f}):this.rendererType===d.TypeDOM?e=new k(!0,this.domCache):"function"==typeof this.rendererType&&(e=this.rendererType(0===this.renderers.length,this.domCache))}return this.configureRenderer(e,b),e},d.prototype.render=function(a){for(var b=0;b<this.renderersToDetach.length;b++){var c=this.renderersToDetach[b];c.detach&&c.detach()}this.renderersToDetach=[];var d=this._collectRenderCommands(a),f=Object.keys(d).sort(e),g={};this.textInputRenderer||(this.textInputRenderer=new k(!0,this.domCache),this.textInputRenderer.setRenderInputFieldsOnly(!0),this.configureRenderer(this.textInputRenderer,!0));for(var h=this.textInputRenderer,i=this.renderers.filter(function(a){return a!==h}),j=[],l=null,m=0,b=0;b<f.length;b++)for(var n=d[f[b]],o=0;o<n.length;o++){var p=n[o],q=p.content.type,r="html"===q?"html":"noodl",s="pushClipRect"===q||"popClipRect"===q;"pushFrameBuffer"===q?m++:"popFrameBuffer"===q&&m--,"html"===r&&m>0||(l||(l={type:r,commands:[],clipCommands:[]}),"html"===q&&(g[p.id]=!0),s?(l.commands.push(p),l.clipCommands.push(p)):r!==l.type?(j.push(l),l={type:r,commands:[p],clipCommands:[]}):l.commands.push(p))}null!==l&&j.push(l);for(var t=!1,b=0;b<j.length;b++){var u=j[b];if(b>=i.length||!i[b].supportsRenderType(u.type,b)){if(t=!0,b<i.length){var v=i[b];this.renderersToDetach.push(v),this.cachedRenderers.push(v)}for(var w=null,o=0;o<this.cachedRenderers.length;o++)if(this.cachedRenderers[o].supportsRenderType(u.type,b)){w=this.cachedRenderers[o],this.cachedRenderers.splice(o,1);var x=this.renderersToDetach.indexOf(w);-1!==x&&this.renderersToDetach.splice(x,1),w.rootElement.style.visibility="hidden",w.attach&&w.attach(this.rootElement,this.textInputRenderer.rootElement);break}i[b]=w||this.createRendererForType(u.type,!1,0===b)}u.renderer=i[b]}if(t=t||j.length>i.length)return this.emit("requestFrame"),i.push(this.textInputRenderer),void(this.renderers=i);for(var y=[],z=[],b=0;b<j.length;b++){var u=j[b];"hidden"===u.renderer.rootElement.style.visibility&&(u.renderer.rootElement.style.visibility="visible"),u.renderer.beginFrame&&u.renderer.beginFrame(),u.renderer.render(y),u.renderer.render(u.commands),y=y.concat(u.clipCommands),z=z.concat(u.commands),u.renderer.endFrame()&&u.renderer.endFrame()}for(this.textInputRenderer.beginFrame(),this.textInputRenderer.render(y),this.textInputRenderer.render(z),this.textInputRenderer.endFrame(),this.domCache.notifyInvisibleHTMLElements(g);i.length>1&&i.length>j.length;){var c=i.pop();this.renderersToDetach.push(c),this.cachedRenderers.push(c)}return 0===j.length&&1===i.length&&(i[0].beginFrame(),i[0].endFrame()),i.push(this.textInputRenderer),this.renderers=i,!0},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.renderers.forEach(function(c){c.setViewportSize&&c.setViewportSize(a,b)})},d.prototype.beginFrame=function(){this.clipToViewport?g.set(this.clipAABB,0,0,this.viewportWidth,this.viewportHeight):g.set(this.clipAABB,Number.MIN_VALUE,Number.MIN_VALUE,Number.MAX_VALUE,Number.MAX_VALUE)},d.prototype.endFrame=function(){},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderers.forEach(function(b){b.setFillMode&&b.setFillMode(a)})},d.prototype.captureScreenShot=function(a,b,c,d){var e=this.rootElement.style.width,f=this.rootElement.style.height;this.rootElement.style.width=b+"px",this.rootElement.style.height=c+"px";for(var g=0;g<this.renderers.length;g++)this.renderers[g].resizeRootElement();this.beginFrame(),this.render(a),this.endFrame();for(var h=[],g=0;g<this.renderers.length;g++){var i=this.renderers[g];if(i.rootElement&&"CANVAS"===i.rootElement.tagName)try{var j=i.rootElement.toDataURL();h.push(j)}catch(k){}}this.rootElement.style.width=e,this.rootElement.style.height=f;for(var g=0;g<this.renderers.length;g++)this.renderers[g].resizeRootElement();if(this.emit("requestFrame"),0===h.length)d(null);else for(var l=[],m=0,g=0;g<h.length;g++){var n=new Image;l.push(n),n.onload=function(){if(m++,m===h.length){var a=document.createElement("canvas");a.width=b,a.height=c;for(var e=a.getContext("2d"),f=0;f<l.length;f++){var g=l[f];e.drawImage(g,0,0,b,c)}d(a.toDataURL())}},n.onerror=function(){d(null),d=null},n.src=h[g]}},d.prototype.onControlDisposed=function(a){this.renderers.forEach(function(b){b.removeResourcesForRenderCommand({id:a.id,content:a.renderCommand})})},d.prototype.clearImageCaches=function(){this.renderers.forEach(function(a){a.clearImageCache&&a.clearImageCache()})},b.exports=d},{"../eventsender":168,"../useragent-utils":319,"./math/aabb":289,"./math/mat4":291,"./renderers/dom/domcache":293,"./renderers/renderer-canvas2d":298,"./renderers/renderer-dom":299,"./renderers/renderer-webgl":300,lodash:117}],293:[function(a,b,c){"use strict";function d(){this.elements={},this.unusedElements={}}var e=a("./htmldomelement"),f=a("./dominputfield");d.prototype.removeElement=function(a){var b=this.elements[a];if(void 0!==b){var c=b.element;null!==c.parentNode&&c.parentNode.removeChild(c)}delete this.elements[a]},d.prototype.getElement=function(a){if(this.elements[a])return this.elements[a];throw new Error("Invalid ID passed to DOMCache.getElement")},d.prototype.notifyInvisibleHTMLElements=function(a){for(var b=Object.keys(this.elements),c=0;c<b.length;c++){var d=b[c];if(this.elements[d]instanceof e&&!(d in a)){var f=this.elements[d],g=f.element;null!==g.parentNode&&(g.parentNode.removeChild(g),f.onNodeRemovedFromParent())}}},d.prototype.createElement=function(a,b,c,d){if(this.elements[b])throw new Error("createElement called multiple times for same ID");if("html"===a){var g=new e(b,c,this,d);return this.elements[b]=g,g}if("textInput"===a){var h=new f(b,this);return this.elements[b]=h,h}},b.exports=d},{"./dominputfield":294,"./htmldomelement":295}],294:[function(a,b,c){"use strict";function d(a,b){e.call(this);var c=document.createElement("input");c.style.position="absolute",c.style.display="block",c.style.transformOrigin="0% 0%",c.style.padding="0px",c.style.margin="0px",c.style.border="none",c.style.outline="none",c.style.background="none",c.style.textAlign="left",c._noodlStyle={},this.element=c,this.inputListener=this.onInput.bind(this),this.blurListener=this.emit.bind(this,"blur"),c.addEventListener("keyup",this.inputListener),c.addEventListener("blur",this.blurListener),this.domCache=b,this.id=a}var e=a("../../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.onInput=function(a){13===a.which&&this.emit("confirmed"),this.emit("inputChanged",this.element.value)},d.prototype.focus=function(){this.element.style.visibility="visible",this.element._noodlStyle.visibility="visible",this.element.focus()},d.prototype.blur=function(){this.element.style.visibility="hidden",this.element._noodlStyle.visibility="hidden",this.element.blur()},d.prototype.setText=function(a){this.element.value=a},d.prototype.setType=function(a){this.element.type=a},d.prototype.dispose=function(){this.element.removeEventListener("input",this.inputListener),this.element.removeEventListener("blur",this.blurListener),this.domCache.removeElement(this.id)},b.exports=d},{"../../../eventsender":168}],295:[function(a,b,c){"use strict";function d(a,b,c,d){e.call(this);var f=document.createElement(d);f.style.position="absolute",f.style.display="block",b||(f.style.pointerEvents="none"),f.style.transformOrigin="0% 0%",f._noodlStyle={},f.style.backgroundSize="100% 100%",f.className="html",this.element=f,this.domCache=c,this.id=a}var e=a("../../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.onNodeRemovedFromParent=function(){this.emit("removedFromParent")},d.prototype.onNodeAddedToParent=function(a){this.emit("addedToParent",a)},d.prototype.dispose=function(){this.domCache.removeElement(this.id)},b.exports=d},{"../../../eventsender":168}],296:[function(a,b,c){"use strict";function d(a){this.rootElement=document.createElement(a.rootElementTag),this.rootElement.style.position="absolute",this.rootElement.style.display="block",this.rootElement.style.overflow="hidden",this.rootElement.style.pointerEvents="none",this.fillMode="aspectFit",this.viewportWidth=0,this.viewportHeight=0,this.onResizeCallback=a.onResize,this.onWindowResizeHandler=this._windowResizeListener.bind(this)}d.prototype._windowResizeListener=function(){"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.moveToTop=function(){if(null!==this.rootElement.parentNode){var a=this.rootElement.parentNode.children;a.length>0&&a[a.length-1]!==this.rootElement&&this.rootElement.parentNode.appendChild(this.rootElement)}},d.prototype.attach=function(a,b){b?a.insertBefore(this.rootElement,b):a.appendChild(this.rootElement),window.addEventListener("resize",this.onWindowResizeHandler),this.resizeRootElement()},d.prototype.detach=function(){window.removeEventListener("resize",this.onWindowResizeHandler),this.rootElement.parentNode&&this.rootElement.parentNode.removeChild(this.rootElement)},d.prototype.setViewportSize=function(a,b){this.viewportWidth=a,this.viewportHeight=b,this.rootElement.parentNode&&"aspectFit"===this.fillMode&&this.resizeRootElement(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.supportsRenderCommand=function(a){return!1},d.prototype.getParentRect=function(){return this.rootElement.parentElement?this.rootElement.parentElement.getBoundingClientRect():this.rootElement.getBoundingClientRect()},d.prototype._calculateAspectFit=function(){var a=this.viewportWidth,b=this.viewportHeight,c=1,d=1,e=a/b,f=this.getParentRect(),g=f.width/f.height;return e/g>1?d=g/e:c=e/g,{width:f.width*c,height:f.height*d}},d.prototype.resizeRootElementAspectFit=function(){var a=this._calculateAspectFit();this.rootElement.style.width=a.width+"px",this.rootElement.style.height=a.height+"px";var b=this.getParentRect(),c=Math.round(b.width-a.width)/2+"px",d=Math.round(b.height-a.height)/2+"px";this.rootElement.style.transform="translate("+c+","+d+")",this.rootElement.style.webkitTransform=this.rootElement.style.transform},d.prototype.resizeRootElementFill=function(){this.rootElement.style.width="100%",this.rootElement.style.height="100%",this.rootElement.style.transform="",this.rootElement.style.webkitTransform=""},d.prototype.resizeRootElement=function(){"aspectFit"===this.fillMode?this.resizeRootElementAspectFit():this.resizeRootElementFill(),this.onResizeCallback&&this.onResizeCallback()},d.prototype.setFillMode=function(a){this.fillMode=a,this.resizeRootElement()},b.exports=d},{}],297:[function(a,b,c){"use strict";function d(a){e.call(this,{rootElementTag:"canvas",onResize:this._onResize.bind(this)}),this.useDeviceScaleForCanvasElement=!0,this.useScreenResolution=a.useScreenResolution?!0:!1}var e=a("./renderer-base");d.prototype=Object.create(e.prototype),d.prototype.constructor=d,d.prototype._onResize=function(){this.resizeCanvasBuffer()},d.prototype.resizeCanvasBuffer=function(){var a=this.rootElement.getBoundingClientRect(),b=0,c=0;if(this.useDeviceScaleForCanvasElement){var d=window.devicePixelRatio||1;if("aspectFit"===this.fillMode){var e=Math.max(a.width*d/this.viewportWidth,a.height*d/this.viewportHeight);this.useScreenResolution===!1&&(e=Math.max(1,Math.round(e))),b=Math.round(this.viewportWidth*e),c=Math.round(this.viewportHeight*e),this.renderScale=b/this.viewportWidth}else b=Math.round(a.width*d),c=Math.round(a.height*d),this.renderScale=d}else"aspectFit"===this.fillMode?(b=Math.round(this.viewportWidth),c=Math.round(this.viewportHeight)):(b=Math.round(a.width),c=Math.round(a.height)),this.renderScale=1;b!==this.rootElement.width&&(this.rootElement.width=b),c!==this.rootElement.height&&(this.rootElement.height=c)},b.exports=d},{"./renderer-base":296}],298:[function(a,b,c){"use strict";function d(a){j.call(this,a),this.rootElement.className="RendererCanvasElement",this.clearWithBlackRect=!a.alpha,this.coloredImagesCache=new k,this.rectangleBlurEdgeCache=new k,this.circleBlurCache=new k,this.circleStrokeBlurCache=new k,this.circleStrokeCache=new k,this.ctx=this.rootElement.getContext("2d",{alpha:a.alpha?!0:!1}),this.usesAlpha=a.alpha,this.clipDepth=0}function e(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)}}function f(a,b,c){var d=Math.max(0,Math.min(1,(c-a)/(b-a)));return d*d*(3-2*d)}function g(a,b){var c=document.createElement("canvas"),d=c.getContext("2d");c.width=1,c.height=a;var g=d.createImageData(1,a);e(l,b);for(var h=0;a>h;h++){var i=f(0,1,h/(a-1));g.data[4*h]=l[0],g.data[4*h+1]=l[1],g.data[4*h+2]=l[2],g.data[4*h+3]=255*i}return d.putImageData(g,0,0),c}function h(a,b,c){var d=document.createElement("canvas"),g=d.getContext("2d");d.width=a+b,d.height=a+b;var h=g.createImageData(a+b,a+b);e(l,c);for(var i=0;i<h.height;i++)for(var j=0;j<h.width;j++){var k=Math.sqrt(j*j+i*i)-a,m=f(1,0,k/b),n=h.width-1-j+(h.height-1-i)*h.width;h.data[4*n]=l[0],h.data[4*n+1]=l[1],h.data[4*n+2]=l[2],h.data[4*n+3]=255*m}return g.putImageData(h,0,0),d}function i(a,b,c,d){var g=document.createElement("canvas"),h=g.getContext("2d");g.width=a+b,g.height=a+b;var i=h.createImageData(a+b,a+b);e(l,d);for(var j=0;j<i.height;j++)for(var k=0;k<i.width;k++){var m=Math.sqrt(k*k+j*j),n=0;m>=a-c-b&&a-c>=m?n=f(a-c-b,a-c,m):m>a-c&&a>m?n=1:m>=a&&(n=1-f(a,a+b,m));var o=i.width-1-k+(i.height-1-j)*i.width;i.data[4*o]=l[0],i.data[4*o+1]=l[1],i.data[4*o+2]=l[2],i.data[4*o+3]=255*n}return h.putImageData(i,0,0),g}var j=a("./renderer-canvas-base"),k=a("../resourcecache");d.prototype=Object.create(j.prototype),d.prototype.constructor=d,d.prototype.supportsRenderType=function(a,b){return"noodl"===a&&(0===b||this.usesAlpha)},d.prototype.beginFrame=function(){this.ctx.setTransform(1,0,0,1,0,0),this.ctx.globalAlpha=1,this.clearWithBlackRect?(this.ctx.fillStyle="#000000",this.ctx.fillRect(0,0,this.toPixel(this.viewportWidth),this.toPixel(this.viewportHeight))):this.ctx.clearRect(0,0,this.toPixel(this.viewportWidth),this.toPixel(this.viewportHeight))},d.prototype.restoreClipState=function(){for(;this.clipDepth>0;)this.popClipRect()},d.prototype.endFrame=function(){this.restoreClipState()},d.prototype.render=function(a){for(var b=0;b<a.length;b++){var c=a[b],d=c.content.type;"pushClipRect"===d?this.pushClipRect(c):"popClipRect"===d?this.popClipRect():"pushFrameBuffer"===d||"popFrameBuffer"===d||this._renderContent(c);
}},d.prototype.drawColoredImage=function(a,b,c){var d=b.src+"."+c;if(this.coloredImagesCache.isInCache(d)===!1){var e=document.createElement("canvas");e.width=b.width,e.height=b.height;var f=e.getContext("2d",{alpha:!0});f.clearRect(0,0,e.width,e.height),f.drawImage(b,0,0,b.width,b.height),f.globalCompositeOperation="source-in",f.fillStyle=c,f.fillRect(0,0,b.width,b.height),this.coloredImagesCache.addResource(d,e)}return this.coloredImagesCache.updateReference(a,d),this.coloredImagesCache.getResource(d)},d.prototype._drawRoundedRect=function(a,b,c,d){2*c>a&&(c=a/2),2*c>b&&(c=b/2),this.ctx.beginPath(),this.ctx.moveTo(c,0),this.ctx.arcTo(a,0,a,b,c),this.ctx.arcTo(a,b,0,b,c),this.ctx.arcTo(0,b,0,0,c),this.ctx.arcTo(0,0,a,0,c),this.ctx.closePath(),"positive"===d?(this.ctx.save(),this.ctx.clip()):this.ctx.fill()};var l=[0,0,0];d.prototype._drawRectangleBlurred=function(a,b,c,d,f,i){2*d>b&&(d=b/2),2*d>c&&(d=c/2),d>0?(this.ctx.fillRect(d,0,b-2*d,d),this.ctx.fillRect(0,d,b,c-2*d),this.ctx.fillRect(d,c-d,b-2*d,d)):this.ctx.fillRect(0,0,b,c),e(l,i);var j=i+f;this.rectangleBlurEdgeCache.isInCache(j)===!1&&this.rectangleBlurEdgeCache.addResource(j,g(f,i)),this.rectangleBlurEdgeCache.updateReference(a,j);var k=i+d+"."+f;this.circleBlurCache.isInCache(k)===!1&&this.circleBlurCache.addResource(k,h(d,f,i)),this.circleBlurCache.updateReference(a,k);var m=this.rectangleBlurEdgeCache.getResource(j),n=this.circleBlurCache.getResource(k);this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.save(),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-c),this.ctx.drawImage(m,d,-f,b-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.rotate(Math.PI/2),this.ctx.translate(0,-b),this.ctx.drawImage(m,d,-f,c-2*d,f),this.ctx.drawImage(n,-f,-f,f+d,f+d),this.ctx.restore()},d.prototype._drawCircleBlurred=function(a,b,c,d,e){var f=d+b+"."+c;this.circleBlurCache.isInCache(f)===!1&&this.circleBlurCache.addResource(f,h(b,c,d)),this.circleBlurCache.updateReference(a,f);var g=this.circleBlurCache.getResource(f);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(g,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype._drawCircleStrokeBlurred=function(a,b,c,d,e,f){var g=d+b+"."+c+"."+f;this.circleStrokeBlurCache.isInCache(g)===!1&&this.circleStrokeBlurCache.addResource(g,i(b,c,f,d)),this.circleStrokeBlurCache.updateReference(a,g);var h=this.circleStrokeBlurCache.getResource(g);this.ctx.save(),e<2*Math.PI&&(this.ctx.beginPath(),this.ctx.arc(b,b,b+c,-Math.PI/2,-Math.PI/2+e,!1),this.ctx.lineTo(b,b),this.ctx.clip()),this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c-2*b,c+b,c+b),e>Math.PI/2&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c-2*b,c+b,c+b),e>Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c-2*b,-c,c+b,c+b),e>1.5*Math.PI&&(this.ctx.rotate(Math.PI/2),this.ctx.drawImage(h,-c,-c,c+b,c+b)))),this.ctx.restore()},d.prototype.toPixel=function(a){return a*this.renderScale},d.prototype._renderContent=function(a){var b=a.content.type;switch(this._setTransform(a.transform),this.ctx.globalAlpha=a.content.opacity,a.content.blendMode){case"alpha":this.ctx.globalCompositeOperation="source-over";break;case"solid":this.ctx.globalCompositeOperation="source-over";break;case"additive":this.ctx.globalCompositeOperation="lighter";break;case"multiply":this.ctx.globalCompositeOperation="multiply"}if("-undoMask"===a.id.slice(-9))return void this.ctx.restore();if("rectangle"===b){this.ctx.fillStyle=a.content.color;var c=Math.floor(this.toPixel(a.content.blur));c>0?this._drawRectangleBlurred(a.id,this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.blur,a.content.color):a.content.cornerRadius>0?this._drawRoundedRect(this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),a.content.maskType):this.ctx.fillRect(0,0,this.toPixel(a.width),this.toPixel(a.height))}else if("image"===b&&a.content.image){var d=a.content.image;if("#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),a.content.cornerRadius&&this._drawRoundedRect(this.toPixel(a.width),this.toPixel(a.height),this.toPixel(a.content.cornerRadius),"positive"),a.content.srcRect){var e=Math.round(a.content.srcRect[0]*d.width),f=Math.round(a.content.srcRect[1]*d.height),g=Math.round((a.content.srcRect[2]-a.content.srcRect[0])*d.width),h=Math.round((a.content.srcRect[3]-a.content.srcRect[1])*d.height);this.ctx.drawImage(d,e,f,g,h,0,0,this.toPixel(a.width),this.toPixel(a.height))}else this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height));a.content.cornerRadius&&this.ctx.restore()}else if("text"===b&&a.content.text){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';for(var i=0;i<a.content.lines.length;i++){var j=a.content.lines[i];this.ctx.fillText(j.text,this.toPixel(j.x),this.toPixel(j.y))}}else if("textInput"===b&&a.content.text&&!a.content.focused){this.ctx.fillStyle=a.content.color,this.ctx.font=this.toPixel(a.content.fontSize)+'px "'+a.content.fontFamily+'"';var k=.5*(a.height-a.content.textHeight);this.ctx.fillText(a.content.text,0,this.toPixel(k+a.content.baseline))}else if("circle"===b){var l=a.width/2,c=Math.floor(this.toPixel(a.content.blur));if(c>1)a.content.solid?this._drawCircleBlurred(a.id,Math.floor(this.toPixel(l)),c,a.content.color,a.content.arcAngle):this._drawCircleStrokeBlurred(a.id,Math.floor(this.toPixel(l)),c,a.content.color,a.content.arcAngle,Math.floor(this.toPixel(a.content.lineWidth)));else{var m=a.width/2,k=a.height/2;if(this.ctx.beginPath(),a.content.solid||(l-=.5*a.content.lineWidth),this.ctx.arc(this.toPixel(m),this.toPixel(k),this.toPixel(l),-Math.PI/2,-Math.PI/2+a.content.arcAngle,!1),a.content.solid)if(a.content.arcAngle<2*Math.PI&&this.ctx.lineTo(this.toPixel(m),this.toPixel(k)),a.content.image){this.ctx.save(),this.ctx.clip();var d=a.content.image;"#ffffff"!==a.content.color&&(d=this.drawColoredImage(a.id,a.content.image,a.content.color)),this.ctx.drawImage(d,0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.restore()}else this.ctx.fillStyle=a.content.color,this.ctx.fill();else this.ctx.strokeStyle=a.content.color,this.ctx.lineWidth=Math.max(1,this.toPixel(a.content.lineWidth)),this.ctx.stroke()}}},d.prototype._setTransform=function(a){this.ctx.setTransform(a[0],a[1],a[4],a[5],this.toPixel(a[12]),this.toPixel(a[13]))},d.prototype.pushClipRect=function(a){this._setTransform(a.transform),this.ctx.save(),this.ctx.beginPath(),this.ctx.rect(0,0,this.toPixel(a.width),this.toPixel(a.height)),this.ctx.clip(),this.clipDepth++},d.prototype.popClipRect=function(){this.ctx.restore(),this.clipDepth--},d.prototype.removeResourcesForRenderCommand=function(a){"image"===a.content.type||"circle"===a.content.type?this.coloredImagesCache.removeReference(a.id):"rectangle"===a.content.type?(this.rectangleBlurEdgeCache.removeReference(a.id),this.circleBlurCache.removeReference(a.id)):"circle"===a.content.type&&(this.circleBlurCache.removeReference(a.id),this.circleStrokeBlurCache.removeReference(a.id),this.circleStrokeCache.removeReference(a.id))},d.prototype.detach=function(){j.prototype.detach.call(this),this.coloredImagesCache.clear(),this.rectangleBlurEdgeCache.clear(),this.circleBlurCache.clear(),this.circleStrokeBlurCache.clear(),this.circleStrokeCache.clear()},b.exports=d},{"../resourcecache":312,"./renderer-canvas-base":297}],299:[function(a,b,c){"use strict";function d(a,b){var c=document.createElement(a);return c.style.position="absolute",c.style.display="block",b||(c.style.pointerEvents="none"),c.style.transformOrigin="0% 0%",c._noodlStyle={},c}function f(a,b){j.call(this,{rootElementTag:"div",onResize:this._onResize.bind(this)}),this.id=k(),this.rootElement.style.transformStyle="preserve-3d",this.rootElement.style.webkitTransformStyle="preserve-3d",this.rootElement.className="RendererDOMRootElement",this.inputEnabled=a,this.elements={},this.clipDepth=0,this.domCache=b,this.unusedElements={},this.transformStack=[],this.textFields={},this.renderHtmlOnly=!1,this.renderTextInputOnly=!1}function g(a,b,c){a._noodlStyle[b]!==c&&(a.style[b]=c,a._noodlStyle[b]=c)}function h(a,b,c){if(a.parentNode===b&&a.index===c)return!1;c<b.children.length-1?b.insertBefore(a,b.children[c+1]):b.appendChild(a);for(var d=0;d<b.children.length;d++)b.children[d].index=d;return!0}var i=a("../math/mat4"),j=(a("./dom/dominputfield"),a("./renderer-base")),k=a("../../guid");f.prototype=Object.create(j.prototype),f.prototype.constructor=f,f.prototype.setRenderHTMLOnly=function(a){this.renderHtmlOnly=a},f.prototype.setRenderInputFieldsOnly=function(a){this.renderTextInputOnly=a},f.prototype.supportsRenderType=function(a,b){return this.renderHtmlOnly?"html"===a:!0},f.prototype._onResize=function(){"aspectFit"===this.fillMode?this.renderScale=this.rootElement.getBoundingClientRect().width/this.viewportWidth:this.renderScale=1},f.prototype.endFrame=function(){this._removeUnusedElements(),this.restoreClipState()},f.prototype._removeUnusedElements=function(){for(var a in this.elements)if(!this.elementsThisFrame[a]){var b=this.elements[a],c=b.parentNode;c.removeChild(b),delete this.elements[a],this.unusedElements[a]=b,b.index=void 0;for(var d=0;d<c.children.length;d++)c.children[d].index=d}},f.prototype._getTextInputCommands=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;("textInput"===e||"pushClipRect"===e||"popClipRect"===e)&&("popClipRect"===d.content.type&&b.length>0&&"pushClipRect"===b[b.length-1].content.type?b.length=b.length-1:b.push(d))}return b},f.prototype.beginFrame=function(){this.elementsThisFrame={},this.nodeIndices=[0],this.parentElement=this.rootElement},f.prototype.render=function(a){var b=this.nodeIndices;this.renderTextInputOnly&&(a=this._getTextInputCommands(a));for(var c=0;c<a.length;c++){var d=a[c],e=d.content.type;"pushClipRect"===e?(this.pushClipRect(d,b[b.length-1]),b[b.length-1]++,b.push(0)):"popClipRect"===e?(this.popClipRect(),b.pop()):(this._renderContent(d,b[b.length-1]),b[b.length-1]++)}};var l=i.create();f.prototype._setTransform=function(a,b){this.transformStack.length&&(i.identity(l),i.multiply(l,this.transformStack[this.transformStack.length-1],l),i.multiply(l,l,b),b=l);var c="matrix3d("+b[0]+","+b[1]+","+b[2]+","+b[3]+","+b[4]+","+b[5]+","+b[6]+","+b[7]+","+b[8]+","+b[9]+","+b[10]+","+b[11]+","+b[12]*this.renderScale+","+b[13]*this.renderScale+","+b[14]*this.renderScale+","+b[15]+")";a._noodlStyle.transform!==c&&(a._noodlStyle.transform=c,a.style.transform=c,a.style.webkitTransform=c)},f.prototype._renderContent=function(a,b){var c,f=a.id,i=a.content.type;if(this.elements[f]?c=this.elements[f]:"html"===i||"textInput"===i?c=this.domCache.getElement(f).element:(this.unusedElements[f]?(c=this.unusedElements[f],delete this.unusedElements[f]):"rectangle"===i?c=d("div"):"image"===i?(c=d("div"),e.style.backgroundSize="100% 100%"):"text"===i?(c=d("div"),e.style.whiteSpace="nowrap"):"circle"===i&&(c=d("div"),e.style.borderRadius="50%"),this.elements[f]=c,c.className=i),this.elementsThisFrame[f]=!0,h(c,this.parentElement,b)&&"html"===i&&this.domCache.getElement(f).onNodeAddedToParent(this.parentElement),this._setTransform(c,a.transform),g(c,"width",a.width*this.renderScale+"px"),g(c,"height",a.height*this.renderScale+"px"),g(c,"opacity",a.content.opacity),"rectangle"===i)g(c,"backgroundColor",a.content.color),g(c,"borderRadius",.5*a.content.cornerRadius+"px");else if("image"===i)g(c,"backgroundImage","url("+a.content.image.src+")"),"#ffffff"!==a.content.color?(g(c,"backgroundColor",a.content.color),g(c,"backgroundBlendMode","overlay"),g(c,"isolation","isolate")):(g(c,"backgroundColor",void 0),g(c,"backgroundBlendMode","normal"));else if("text"===i)g(c,"color",a.content.color),g(c,"fontFamily",a.content.fontFamily),g(c,"fontSize",a.content.fontSize*this.renderScale+"px"),g(c,"textAlign",a.content.horizontalAlignment),g(c,"lineHeight",a.content.lineHeight?a.content.lineHeight*this.renderScale+"px":"normal"),c.innerText!==a.content.text&&(c.innerText=a.content.text);else if("textInput"===i)g(c,"color",a.content.color),g(c,"fontFamily",a.content.fontFamily),g(c,"fontSize",a.content.fontSize*this.renderScale+"px"),a.content.focused||c.value===a.content.text||(c.value=a.content.text),this.renderTextInputOnly&&!a.content.focused&&g(c,"visibility","hidden");else if("circle"===i)a.content.solid?g(c,"backgroundColor",a.content.color):g(c,"border",a.content.lineWidth+"px solid "+a.content.color);else if("html"===i){if("CANVAS"===c.tagName){var j=Math.round(a.width*this.renderScale),k=Math.round(a.height*this.renderScale);c.width!==j&&(c.width=j),c.height!==k&&(c.height=k)}c.style.pointerEvents="auto",c.style.boxSizing="border-box"}},f.prototype.restoreClipState=function(){for(;this.clipDepth>0;)this.popClipRect()},f.prototype.pushClipRect=function(a,b){this.clipDepth++;var c=a.id;if(!this.elements[c]){var e=d("div");e._noodlStyle={},e.style.overflow="hidden",this.elements[c]=e}this.elementsThisFrame[c]=!0;var f=this.elements[c];this._setTransform(f,a.transform),g(f,"width",a.width*this.renderScale+"px"),g(f,"height",a.height*this.renderScale+"px"),f.className="RenderDOMClipControl",h(f,this.parentElement,b);var j=i.create();i.copy(j,a.transform),i.invert(j),this.transformStack.push(j),this.parentElement=f},f.prototype.popClipRect=function(){this.clipDepth--,this.parentElement=this.parentElement.parentNode,this.transformStack.pop()},f.prototype.removeResourcesForRenderCommand=function(a){},b.exports=f},{"../../guid":170,"../math/mat4":291,"./dom/dominputfield":294,"./renderer-base":296}],300:[function(a,b,c){"use strict";function d(a){m.call(this,a);var b={alpha:a.alpha?!0:!1,stencil:!0},c=this.rootElement.getContext("webgl",b);if(c||(c=this.rootElement.getContext("experimental-webgl",b)),!c)throw new Error("WebGL not supported");this.useDeviceScaleForCanvasElement=!1,this.usesAlpha=a.alpha,this.rootElement.className="RendererWebGLCanvas",this.webGLHelper=new p(c,1080,1920),this.defaultShader=this.createShader({vertexSource:this.webGLHelper._defaultVsSource,fragmentSource:this.webGLHelper._defaultFsSource}),this.defaultTextShader=this._createDefaultTextShader(),this.frameBuffers=[],this.clipRects=[o.create()],this.defaultMesh=this.webGLHelper.createMesh(),this.numFloatsThisFrame=0,this.textCache=new q(this.webGLHelper),this.circleCache={},this.meshCache={},this.roundedBlurredRectCache={},this.roundedRectCache={},this.frameBufferCache=[],this.textureCache=new w(this.webGLHelper),this.tempVertices=new Float32Array(y*this.defaultShader.numComponentsPerVertex),this.shaderCache={}}function e(a,b,c,d,e,f,g){a[0]=0,a[1]=0,a[2]=0,b[0]=e,b[1]=0,b[2]=0,c[0]=0,c[1]=f,c[2]=0,d[0]=e,d[1]=f,d[2]=0,n.transformPoint(g,a),n.transformPoint(g,b),n.transformPoint(g,c),n.transformPoint(g,d)}function f(a,b,c,d,e,f,g,h){var i=g.width,j=g.height;a[0]<h.min[0]&&(e[0]=(h.min[0]-a[0])/i,a[0]=h.min[0],c[0]=h.min[0]),a[1]<h.min[1]&&(e[1]=(h.min[1]-a[1])/j,a[1]=h.min[1],b[1]=h.min[1]),b[0]>h.max[0]&&(f[0]=(b[0]-h.max[0])/i,b[0]=h.max[0],d[0]=h.max[0]),c[1]>h.max[1]&&(f[1]=(c[1]-h.max[1])/j,c[1]=h.max[1],d[1]=h.max[1])}function g(a,b,c,d,e,f){var g=Math.min(a[0],b[0],c[0],d[0]),h=Math.min(a[1],b[1],c[1],d[1]),i=Math.max(a[0],b[0],c[0],d[0]),j=Math.max(a[1],b[1],c[1],d[1]),k=g<f.min[0]||h<f.min[1]||i>f.max[0]||j>f.max[1];k&&(e.scissorTest=!0,e.scissorRect[0]=f.min[0],e.scissorRect[1]=f.min[1],e.scissorRect[2]=f.max[0],e.scissorRect[3]=f.max[1])}function h(a){return 1!==a[0]||1!==a[5]||1!==a[10]}function i(a){return 0!==a[1]||0!==a[2]||0!==a[4]||0!==a[6]||0!==a[8]||0!==a[9]}function j(a,b){for(var c=0;3>c;++c){var d=1+2*c;a[c]=parseInt(b.substring(d,d+2),16)/255}}function k(a,b,c,d){var j=b.transform;e(B,C,D,E,b.width,b.height,j),F[0]=0,F[1]=0,G[0]=0,G[1]=0;var k=i(j)||h(j);k||0!==j[14]?g(B,C,D,E,c,d):f(B,C,D,E,F,G,b,d);var l=c.srcRect,m=l[2]-l[0],n=l[3]-l[1],o=c.color;a[0]=B[0],a[1]=B[1],a[2]=B[2],a[3]=l[0]+F[0]*m,a[4]=l[1]+F[1]*n,a[5]=o[0]*b.content.opacity,a[6]=o[1]*b.content.opacity,a[7]=o[2]*b.content.opacity,a[8]=b.content.opacity,a[9]=C[0],a[10]=C[1],a[11]=C[2],a[12]=l[2]-G[0]*m,a[13]=a[4],a[14]=a[5],a[15]=a[6],a[16]=a[7],a[17]=a[8],a[18]=D[0],a[19]=D[1],a[20]=D[2],a[21]=a[3],a[22]=l[3]-G[1]*n,a[23]=a[5],a[24]=a[6],a[25]=a[7],a[26]=a[8],a[27]=E[0],a[28]=E[1],a[29]=E[2],a[30]=a[12],a[31]=a[22],a[32]=a[5],a[33]=a[6],a[34]=a[7],a[35]=a[8],"popFrameBuffer"===b.content.type&&(a[4]=1-a[4],a[13]=1-a[13],a[22]=1-a[22],a[31]=1-a[31])}function l(a,b,c,d,f){d.mesh=a,d.shader=b,b&&-1!==b.standardUniforms.u_world&&(d.worldTransform=c.transform),e(B,C,D,E,c.width,c.height,c.transform),g(B,C,D,E,d,f)}var m=a("./renderer-canvas-base"),n=a("../math/mat4"),o=a("../math/aabb"),p=a("./webgl/webglhelper"),q=a("./webgl/text-cache"),r=a("./webgl/texture"),s=a("./webgl/circle"),t=a("./webgl/mesh"),u=a("./webgl/roundedrect"),v=a("./webgl/roundedrect-standard"),w=a("./webgl/texturecache"),x=a("./webgl/framebuffer-effects"),y=4,z=10;d.prototype=Object.create(m.prototype),d.prototype.constructor=d,d.prototype.createShader=function(a){return this.webGLHelper.createShader(a)},d.prototype._onResize=function(){m.prototype._onResize.call(this),o.set(this.clipRects[0],0,0,this.viewportWidth,this.viewportHeight);for(var a=0;a<this.frameBufferCache.length;a++)this.frameBufferCache[a].dispose();this.frameBufferCache=[],this.webGLHelper.setVirtualSize(this.viewportWidth,this.viewportHeight),this.webGLHelper.setRenderBufferSize(this.rootElement.width,this.rootElement.height)},d.prototype.supportsRenderType=function(a,b){return"noodl"===a&&(0===b||this.usesAlpha)},d.prototype.getFrameBufferForScale=function(a,b,c){var d=this.webGLHelper.renderWidth*a,e=this.webGLHelper.renderHeight*a;if(c)for(var f=0;f<this.frameBufferCache.length;f++){var g=this.frameBufferCache[f];if(g.controlId===b&&c){if(g.width===d&&g.height===e)return g;g.dispose(),this.frameBufferCache.splice(f,1),g=null}}for(var f=0;f<this.frameBufferCache.length;f++){var g=this.frameBufferCache[f];if(g.width===d&&g.height===e&&!g.active&&!g.controlId)return g.unused=!1,c&&(g.controlId=b),g}var g=this.webGLHelper.createFBO({width:d,height:e});return g.scale=a,g.unused=!1,c&&(g.controlId=b),this.frameBufferCache.push(g),g},d.prototype.frameBufferScaleForGaussianBlur=function(a){return a.frameBufferSettings.effectParams.effectAmount>.1?.5:1},d.prototype.pushFrameBuffer=function(a,b){var c=a.frameBufferSettings.renderScale;this.shouldApplyGaussianBlur(a)&&(c=this.frameBufferScaleForGaussianBlur(a));var d=a.frameBufferSettings.requiresExclusiveFBO;a.frameBufferSettings.renderEffectsToTexture&&(d=!1);var e=this.getFrameBufferForScale(c,a.id,d);e.active=!0,this.frameBuffers.push(e),b.push({type:"pushFrameBuffer",fbo:e})},d.prototype.configureFramebufferVertices=function(a,b,c,d,e,f){this.fillVerticesRenderCommand(b,a,b.frameBufferSettings.vertices,b.content.transform,e)},d.prototype.configureFramebufferQuad=function(a,b,c,d,e){a.mesh=this.defaultMesh,j(a.color,"#ffffff"),c?k(this.tempVertices,b,a,e):k(this.tempVertices,b,a,this.clipRects[this.clipRects.length-1]),a.vertexIndex=this.numFloatsThisFrame/this.defaultShader.numComponentsPerVertex,this.appendBufferToDefaultMesh(this.tempVertices)},d.prototype.configureFramebufferRoundedRect=function(a,b,c,d,f,h){a.mesh=this.defaultMesh,j(a.color,"#ffffff"),this.roundedRectCache[b.id]||(this.roundedRectCache[b.id]=new v);var i=this.roundedRectCache[b.id],k=b.frameBufferSettings.cornerRadius,l=(a.texture.size[0],a.texture.size[1],o.width(f)),m=o.height(f);2*k>l&&(k=l/2),2*k>m&&(k=m/2),i.setColor([1,1,1,1]),i.setWidth(l),i.setHeight(m),i.setCornerRadius(k),i.setSourceRect(h),i.updateMesh(),a.vertexIndex=this.numFloatsThisFrame/this.defaultShader.numComponentsPerVertex,this.appendBufferToDefaultMesh(i.vertices),this.transformRoundedRectVertices(a,b.content.transform,i.vertices.length),e(B,C,D,E,b.width,b.height,b.transform),g(B,C,D,E,a,this.clipRects[this.clipRects.length-1]),a.mesh=this.defaultMesh,a.numVertices=i.vertices.length/this.defaultShader.numComponentsPerVertex},d.prototype.shouldApplyGaussianBlur=function(a){return"gaussianBlur"===a.frameBufferSettings.effect&&Math.round(a.frameBufferSettings.effectParams.gaussianBlurRadius)>=1&&0!==a.frameBufferSettings.effectParams.effectAmount},d.prototype.getOrCreateShader=function(a,b){if(a in this.shaderCache)return this.shaderCache[a].shader;var c=b(),d=this.createShader(c);return this.shaderCache[a]={shader:d,error:d.error,vertexSource:c.vertexSource,fragmentSource:c.fragmentSource},d},d.prototype.popFrameBuffer=function(a,b){var c=this.frameBuffers.pop();b.push({type:"popFrameBuffer"});var d=this.glCommandForRc(a,c.texture),e=a.frameBufferSettings.maskImage,f=!0;if(a.frameBufferSettings.maskViewId)for(var g=0;g<this.frameBufferCache.length;g++){var c=this.frameBufferCache[g];if(c.controlId===a.frameBufferSettings.maskViewId){e=c.texture,f=!1;break}}var h=f?"_flip":"",i=a.frameBufferSettings.clip||e,j=o.create();o.set(j,0,0,a.clipWidth,a.clipHeight),o.transform4(j,a.content.transform);var k=[j.min[0]/this.webGLHelper.renderWidth,1-j.min[1]/this.webGLHelper.renderHeight,j.max[0]/this.webGLHelper.renderWidth,1-j.max[1]/this.webGLHelper.renderHeight];c.contentSrcRect=k;var l={maskTexture:e,maskRect:[k[0],k[3],k[2],k[1]],amount:a.frameBufferSettings.effectParams.effectAmount},m=this.webGLHelper;if(this.shouldApplyGaussianBlur(a)){var n=this.frameBufferScaleForGaussianBlur(a),p=1;n>=1&&(p=1/(1+n));var q=Math.round(a.frameBufferSettings.effectParams.gaussianBlurRadius*n*p),r=this.getOrCreateShader("gaussianBlur_"+q+h,function(){return x.generateGaussianBlurShaders(q,m.getMaxVaryingVectors(),!1,!0)}),s=this.getFrameBufferForScale(n,a.id,!1),t=this.glCommandForRc(a,c.texture);this.configureFramebufferQuad(t,a,!1,e,j),t.shader=r,t.shaderUniforms={opacity:1,texelWidthOffset:1/(c.width*p)*a.frameBufferSettings.effectParams.effectAmount,texelHeightOffset:0},d.texture=s.texture,e&&(r=this.getOrCreateShader("gaussianBlur_"+q+"_mask"+h,function(){return x.generateGaussianBlurShaders(q,m.getMaxVaryingVectors(),!0,f)})),d.shader=r,l.opacity=a.content.opacity,l.texelWidthOffset=0,l.texelHeightOffset=1/(c.height*p)*a.frameBufferSettings.effectParams.effectAmount,d.shaderUniforms=this.createGLShaderUniforms(l,d.shader),b.push({type:"pushFrameBuffer",fbo:s}),b.push(t),b.push({type:"popFrameBuffer"})}else if("desaturate"===a.frameBufferSettings.effect){var u=this.getOrCreateShader((e?"desaturate_mask":"desaturate")+h,function(){return x.getDesaturateShaders(e,f)});d.shader=u,d.shaderUniforms=this.createGLShaderUniforms(l,d.shader)}else if(!a.content.shaderSource||a.frameBufferSettings.effect&&"none"!==a.frameBufferSettings.effect)e&&(d.shader=this.getOrCreateShader("maskShader"+h,function(){return x.getMaskShaders(f)}),d.shaderUniforms=this.createGLShaderUniforms(l,d.shader));else{if(a.content.secondaryShaderSource){var s=this.getFrameBufferForScale(a.frameBufferSettings.renderScale,a.id,!1),t=this.glCommandForRc(a,c.texture);this.configureFramebufferQuad(t,a,!1,e,j),this.configureShaderSourceForCommand(t,a.content.secondaryShaderSource,a.content.secondaryShaderUniforms),b.push({type:"pushFrameBuffer",fbo:s}),b.push(t),b.push({type:"popFrameBuffer"}),d.texture=s.texture}this.configureShaderSourceForCommand(d,a.content.shaderSource,a.content.shaderUniforms)}if(a.frameBufferSettings.vertices?this.configureFramebufferVertices(d,a,i,e,j,k):a.frameBufferSettings.clip&&a.frameBufferSettings.cornerRadius>0?this.configureFramebufferRoundedRect(d,a,i,e,j,k):this.configureFramebufferQuad(d,a,i,e,j),a.frameBufferSettings.renderEffectsToTexture){var v=this.getFrameBufferForScale(a.frameBufferSettings.renderScale,a.id,a.frameBufferSettings.requiresExclusiveFBO);b.push({type:"pushFrameBuffer",fbo:v}),b.push(d),b.push({type:"popFrameBuffer"}),v.contentSrcRect=k,d=this.glCommandForRc(a,v.texture),this.configureFramebufferQuad(d,a,!1,null,j),d.texture=v.texture}a.frameBufferSettings.renderAfterPop&&(b.push(d),c.active=!1)},d.prototype.markFrameBuffersUnused=function(){for(var a=0;a<this.frameBufferCache.length;a++)this.frameBufferCache[a].unused=!0},d.prototype.removeUnusedFramebuffers=function(){for(var a=[],b=0;b<this.frameBufferCache.length;b++)this.frameBufferCache[b].unused&&!this.frameBufferCache[b].controlId&&a.push(this.frameBufferCache[b]);for(;a.length>z;){var c=a.shift(),b=this.frameBufferCache.indexOf(c);this.frameBufferCache.splice(b,1),c.dispose()}},d.prototype.render=function(a){for(var b=[],c=0;c<a.length;c++){var d=a[c],e=d.content.type;if("pushClipRect"===e)this.pushClipRect(d);else if("popClipRect"===e)this.popClipRect();else{if("html"===e)throw new Error("Renderer does not support HTML");if("pushFrameBuffer"===e)this.pushFrameBuffer(d,b);else if("popFrameBuffer"===e)this.popFrameBuffer(d,b);else{var f="textInput"===d.content.type&&d.content.focused;f===!1&&this._renderContent(d,b)}}}var g=0;for(c=0;c<b.length;c++){var h=b[c];"pushFrameBuffer"===h.type?(g+=1,this.webGLHelper.bindFbo(h.fbo),this.frameBuffers.push(h.fbo),this.webGLHelper.setScissorTest(!1,[0,0,0,0]),this.webGLHelper.clearScreen(),this.webGLHelper.setBlendMode(p.BlendMode.Alpha)):"popFrameBuffer"===h.type?(this.frameBuffers.pop(),this.frameBuffers.length>0?this.webGLHelper.bindFbo(this.frameBuffers[this.frameBuffers.length-1]):this.webGLHelper.bindScreen()):h.texture&&this.webGLHelper.executeRenderCommand(h)}},d.prototype.pushClipRect=function(a){var b=o.create();o.set(b,0,0,a.width,a.height),o.transform4(b,a.transform),o.intersection(b,this.clipRects[this.clipRects.length-1]),this.clipRects.push(b)},d.prototype.popClipRect=function(){this.clipRects.pop()};var A=[0,0,1,1];d.prototype.createGLShaderUniforms=function(a,b){var c=[],d=this.textureCache;return Object.keys(a).forEach(function(e){var f=b._uniforms[e];if(f)if("sampler2D"===f.type){var g=a[e];if(g&&g.image){var h=d.getTexture(g.imagePath,g.image);h.refCount=1,c[e]=h}else g.constructor===r&&(c[e]=a[e])}else c[e]=a[e]}),c},d.prototype.configureShaderSourceForCommand=function(a,b,c){var d=b.id in this.shaderCache;if(d){var e=this.shaderCache[b.id];(e.vertexSource!==b.vertexShaderSource||e.fragmentSource!==b.fragmentShaderSource)&&(this.webGLHelper.deleteShader(e.shader),delete this.shaderCache[b.id],d=!1)}if(!d){var e=this.createShader({vertexSource:b.vertexShaderSource,fragmentSource:b.fragmentShaderSource});this.shaderCache[b.id]={shader:e,error:e.error,vertexSource:b.vertexShaderSource,fragmentSource:b.fragmentShaderSource}}var e=this.shaderCache[b.id];e.error?this.onShaderError&&this.onShaderError(b.id,e.error.message,e.error.type):(a.shader=e.shader,c&&(a.shaderUniforms=this.createGLShaderUniforms(c,e.shader)))},d.prototype.glCommandForRc=function(a,b){return{texture:b||null,blendMode:p.BlendMode.Alpha,mesh:null,depthTest:!1,vertexIndex:-1,opacity:a.content.opacity||1,scissorTest:!1,scissorRect:[0,0,0,0],srcRect:a.content.srcRect||A,flipTexCoordY:0,writeToStencil:!1,maskIsPositive:!1,shader:this.defaultShader,shaderUniforms:{},worldTransform:null,color:[0,0,0]}},d.prototype._renderContent=function(a,b){var c=this.glCommandForRc(a);switch(a.content.shader?(c.shader=a.content.shader,a.content.shaderUniforms&&(c.shaderUniforms=this.createGLShaderUniforms(a.content.shaderUniforms,a.content.shader))):a.content.shaderSource&&this.configureShaderSourceForCommand(c,a.content.shaderSource,a.content.shaderUniforms),a.content.blendMode){case"alpha":c.blendMode=p.BlendMode.Alpha;break;case"solid":c.blendMode=p.BlendMode.Solid;break;case"additive":c.blendMode=p.BlendMode.Additive;break;case"multiply":c.blendMode=p.BlendMode.Multiply}if("solid"===a.content.blendMode&&a.content.opacity<1&&(c.blendMode=p.BlendMode.Alpha),a.content.maskType&&"none"!==a.content.maskType&&(c.writeToStencil=!0,c.maskIsPositive="positive"===a.content.maskType),j(c.color,a.content.color),a.content.imageTextureControlId)for(var d=0;d<this.frameBufferCache.length;d++){var f=this.frameBufferCache[d];if(f.controlId===a.content.imageTextureControlId&&(c.texture=f.texture,f.contentSrcRect&&c.srcRect)){var h=f.contentSrcRect[0],i=f.contentSrcRect[1],m=f.contentSrcRect[2]-h,n=f.contentSrcRect[3]-i;c.srcRect=[h,i,h+(c.srcRect[2]-c.srcRect[0])*m,i+(c.srcRect[3]-c.srcRect[1])*n]}}else a.content.image?(c.texture=this.textureCache.getTexture(a.content.imagePath,a.content.image),c.texture.refCount=1,c.texture.videoDOMNode&&c.texture.updateVideoTexture()):"text"===a.content.type||"textInput"===a.content.type?(c.texture=this.textCache.getTextTexture(a,this.renderScale,a.content.color),c.shader=this.defaultTextShader):c.texture=this.webGLHelper.whiteTexture();if("circle"===a.content.type){var o=this._getCircle(a);this.circleShader||(this.circleShader=s.createShader(this.webGLHelper)),l(o.getMesh(),this.circleShader,a,c,this.clipRects[this.clipRects.length-1])}else if("image"===a.content.type&&a.content.vertices)this.fillVerticesRenderCommand(a,c,a.content.vertices,a.transform,null);else if("rectangle"===a.content.type&&u.cornerTooSmall(a.content.cornerRadius,a.content.blur)===!1||"image"===a.content.type&&a.content.cornerRadius>0)if(a.content.blur){var q=this._getBlurredRoundedRectangle(a);this.blurredRoundedRectangleShader||(this.blurredRoundedRectangleShader=u.createShader(this.webGLHelper)),l(q.getMesh(),this.blurredRoundedRectangleShader,a,c,this.clipRects[this.clipRects.length-1])}else{this.roundedRectCache[a.id]||(this.roundedRectCache[a.id]=new v);var q=this.roundedRectCache[a.id],r=a.content.cornerRadius;a.width<2*r&&(r=a.width/2),a.height<2*r&&(r=a.height/2);var t=c.color,w=[t[0]*a.content.opacity,t[1]*a.content.opacity,t[2]*a.content.opacity,a.content.opacity];q.setColor(w),q.setWidth(a.width),q.setHeight(a.height),q.setCornerRadius(r),c.srcRect&&q.setSourceRect(c.srcRect),q.updateMesh(),c.vertexIndex=this.numFloatsThisFrame/this.defaultShader.numComponentsPerVertex,this.appendBufferToDefaultMesh(q.vertices),this.transformRoundedRectVertices(c,a.transform,q.vertices.length),e(B,C,D,E,a.width,a.height,a.transform),g(B,C,D,E,c,this.clipRects[this.clipRects.length-1]),c.mesh=this.defaultMesh,c.numVertices=q.vertices.length/this.defaultShader.numComponentsPerVertex}else"mesh"===a.content.type&&a.content.mesh&&a.content.shader&&a.content.mesh.vertices&&a.content.mesh.vertices.length>0?l(a.content.mesh,a.content.shader,a,c,this.clipRects[this.clipRects.length-1]):(k(this.tempVertices,a,c,this.clipRects[this.clipRects.length-1]),c.vertexIndex=this.numFloatsThisFrame/this.defaultShader.numComponentsPerVertex,this.appendBufferToDefaultMesh(this.tempVertices),c.mesh=this.defaultMesh);b.push(c)},d.prototype.fillVerticesRenderCommand=function(a,b,c,d,e){var f=c.data;if(c.range&&(f=f.subarray(c.range[0],c.range[1])),a.id in this.meshCache){var g=this.meshCache[a.id];g.vertices.length!==f.length?g.vertices=new Float32Array(f):g.vertices.set(f),g.indices=c.indices,g.vertexDataDirty=!0}else this.meshCache[a.id]=this.webGLHelper.createMesh({vertices:new Float32Array(f),indices:c.indices,primitiveType:t.PrimitiveTypeFromString(c.format)});var g=this.meshCache[a.id];b.mesh=this.mesh,b.vertexIndex=0;for(var h=null,i=null,j=0;j<b.shader.attributes.length;j++){var k=b.shader.attributes[j];-1!==k.name.search("a_position")?h=k:-1!==k.name.search("a_uv")&&(i=k)}var m=[0,0,0,0];if(h)for(var c=g.vertices,o=h.offset,j=0;j<c.length;j+=b.shader.numComponentsPerVertex){for(var p=0;p<Math.min(4,h.numComponents);p++)m[p]=c[j+p+o];n.transformPoint(d,m);for(var p=0;p<Math.min(4,h.numComponents);p++)c[j+p+o]=m[p]}if(i&&e)for(var o=i.offset,q=e,r=q.min[0]/this.webGLHelper.renderWidth,s=q.max[0]/this.webGLHelper.renderWidth,u=q.min[1]/this.webGLHelper.renderHeight,v=q.max[1]/this.webGLHelper.renderHeight,j=0;j<c.length;j+=b.shader.numComponentsPerVertex){
var w=c[j+o],x=c[j+o+1];w=r+w*(s-r),x=u+x*(v-u),x=1-x,c[j+o]=w,c[j+o+1]=x}l(g,b.shader,a,b,this.clipRects[this.clipRects.length-1]),b.worldTransform=null,b.numVertices=f.length/b.shader.numComponentsPerVertex},d.prototype.transformRoundedRectVertices=function(a,b,c){for(var d=a.vertexIndex*this.defaultShader.numComponentsPerVertex,e=d+c,f=this.defaultMesh.vertices,g=[0,0,0],h=d;e>h;h+=this.defaultShader.numComponentsPerVertex)g[0]=f[h],g[1]=f[h+1],g[2]=f[h+2],n.transformPoint(b,g),f[h]=g[0],f[h+1]=g[1],f[h+2]=g[2]},d.prototype.appendBufferToDefaultMesh=function(a){var b=this.numFloatsThisFrame;this.numFloatsThisFrame+=a.length,this.validateDefaultMeshBufferSize(),this.defaultMesh.vertices.set(a,b),this.defaultMesh.vertexDataDirty=!0},d.prototype.validateDefaultMeshBufferSize=function(){if(this.numFloatsThisFrame>this.defaultMesh.vertices.length){var a=new Float32Array(2*this.numFloatsThisFrame);a.set(this.defaultMesh.vertices,0),this.defaultMesh.vertices=a}},d.prototype.removeResourcesForRenderCommand=function(a){for(var b=0;b<this.frameBufferCache.length;b++){var c=this.frameBufferCache[b];if(c.controlId===a.id){c.dispose(),this.frameBufferCache.splice(b,1),c=null;break}}"rectangle"===a.content.type&&this.roundedBlurredRectCache.hasOwnProperty(a.id)?(this.roundedBlurredRectCache[a.id].dispose(),delete this.roundedBlurredRectCache[a.id]):"image"!==a.content.type&&"rectangle"!==a.content.type||!this.roundedRectCache.hasOwnProperty(a.id)?"circle"===a.content.type&&this.circleCache.hasOwnProperty(a.id)?(this.circleCache[a.id].dispose(),delete this.circleCache[a.id]):this.meshCache.hasOwnProperty(a.id)?(this.meshCache[a.id].dispose(),delete this.meshCache[a.id]):("text"===a.content.type||"textInput"===a.content.type)&&this.textCache.textResourceRemoved(a.id):(this.roundedRectCache[a.id].dispose(),delete this.roundedRectCache[a.id])},d.prototype.beginFrame=function(){this.webGLHelper.beginFrame(),this.webGLHelper.bindRenderTarget(0),this.numFloatsThisFrame=0,this.markFrameBuffersUnused()},d.prototype.restoreClipState=function(){this.clipRects=[o.create()],o.set(this.clipRects[0],0,0,this.viewportWidth,this.viewportHeight)},d.prototype.endFrame=function(){this.restoreClipState(),this.removeUnusedFramebuffers()},d.prototype._getCircle=function(a){this.circleCache[a.id]||(this.circleCache[a.id]=new s(this.webGLHelper));var b=this.circleCache[a.id];return b.setSize(a.width),b.setArcAngle(a.content.arcAngle),b.setSolid(a.content.solid),b.setLineWidth(a.content.lineWidth),b.setBlur(Math.max(1,a.content.blur)),b.updateMesh(),b},d.prototype._getBlurredRoundedRectangle=function(a){this.roundedBlurredRectCache[a.id]||(this.roundedBlurredRectCache[a.id]=new u(this.webGLHelper));var b=this.roundedBlurredRectCache[a.id],c=a.content.cornerRadius;return a.width<2*c&&(c=a.width/2),a.height<2*c&&(c=a.height/2),b.setWidth(a.width),b.setHeight(a.height),b.setBlur(a.content.blur),b.setCornerRadius(c),a.content.srcRect&&b.setSourceRect(a.content.srcRect),b.updateMesh(),b},d.prototype.detach=function(){m.prototype.detach.call(this),this.textCache.clear(),this.textureCache.clear();var a=this.roundedBlurredRectCache;Object.keys(a).forEach(function(b){a[b].dispose()}),this.roundedBlurredRectCache={};var b=this.roundedRectCache;Object.keys(b).forEach(function(a){b[a].dispose()}),this.roundedRectCache={};var c=this.circleCache;Object.keys(c).forEach(function(a){c[a].dispose()}),this.circleCache={};var d=this.meshCache;Object.keys(d).forEach(function(a){d[a].dispose()}),this.meshCache={},this.circleCache={};for(var e=0;e<this.frameBufferCache.length;e++)this.frameBufferCache[e].dispose();this.frameBufferCache=[];var f=this.shaderCache,g=this;Object.keys(f).forEach(function(a){var b=f[a];g.webGLHelper.deleteShader(b.shader)}),this.shaderCache={}},d.prototype.clearImageCache=function(){this.textureCache.clear()};var B=[0,0,0],C=[0,0,0],D=[0,0,0],E=[0,0,0],F=[0,0],G=[0,0];d.prototype._createDefaultTextShader=function(){return this.createShader({vertexSource:["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),fragmentSource:["uniform sampler2D texture;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 texColor = texture2D(texture, uv);","    gl_FragColor = texColor*color.a;","}"].join("\n")})},b.exports=d},{"../math/aabb":289,"../math/mat4":291,"./renderer-canvas-base":297,"./webgl/circle":301,"./webgl/framebuffer-effects":303,"./webgl/mesh":304,"./webgl/roundedrect":306,"./webgl/roundedrect-standard":305,"./webgl/text-cache":308,"./webgl/texture":309,"./webgl/texturecache":310,"./webgl/webglhelper":311}],301:[function(a,b,c){"use strict";function d(a,b,c){return Math.max(a,Math.min(b,c))}function e(a,b){b=b||{},this.solid=b.hasOwnProperty("solid")?b.solid:!0,this.radius=b.size/2||100,this.lineWidth=b.lineWidth||1,this.blurDistance=b.hasOwnProperty("blur")?b.blur:2,this.arcAngle=b.hasOwnProperty("arcAngle")?d(0,2*Math.PI,b.arcAngle):2*Math.PI,this.error=b.error||.075,this.meshDirty=!0,this._calculateVertices(),this.mesh=a.createMesh({vertices:this.vertices,indices:this.indices,primitiveType:g.PrimitiveType.TriangleStrip})}function f(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float aBlur;","attribute float aVertexOpacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = u_srcRect.xy + a_uv * (u_srcRect.zw - u_srcRect.xy);","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = aBlur;","   vertexOpacity = aVertexOpacity;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","varying lowp float vertexOpacity;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur*vertexOpacity);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})}var g=a("./mesh");e.prototype._calculateVertices=function(){function a(a,c,d,e){var f=Math.cos(d-.5*Math.PI),g=Math.sin(d-.5*Math.PI);n[i++]=a+b*f,n[i++]=c+b*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e,n[i++]=a+p*f,n[i++]=c+p*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+j*f,n[i++]=c+j*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=1,n[i++]=e,n[i++]=a+k*f,n[i++]=c+k*g,n[i++]=(n[i-3]+o)/(2*b),n[i++]=(n[i-3]+o)/(2*b),n[i++]=0,n[i++]=e}var b=this.radius+this.blurDistance,c=Math.acos(2*(1-this.error/b)*(1-this.error/b)-1),d=Math.ceil(this.arcAngle/c),e=24,f=this.arcAngle<2*Math.PI;this.arcAngle>0&&4>d&&(d=2);var g=d;f&&(g+=2);var h=g*e;this.vertices&&this.vertices.length===h||(this.vertices=new Float32Array(h));var i=0,j=this.radius-this.lineWidth,k=j-this.blurDistance,l=this.radius,m=this.radius;this.solid&&(j=0,k=0);var n=this.vertices,o=this.blurDistance,p=this.radius;f&&a(l,m-this.blurDistance,0,0);var q;for(q=0;d>q;++q){var r=q/(d-1),s=this.arcAngle*r;a(l,m,s,1)}f&&a(l-Math.sin(this.arcAngle)*o,m+Math.cos(this.arcAngle)*o,this.arcAngle,0);var t=8*(g-1);for(this.indices&&this.indices.length===t||(this.indices=new Uint16Array(t)),i=0,q=0;g-1>q;++q){var u;if(q%2===0)for(u=0;4>u;++u)this.indices[i++]=4*q+u,this.indices[i++]=4*(q+1)+u;else for(u=0;4>u;++u)this.indices[i++]=4*q+3-u,this.indices[i++]=4*(q+1)+3-u}},e.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._calculateVertices(),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0,this.meshDirty=!1)},e.prototype.setSize=function(a){this.radius!==a/2&&(this.radius=a/2,this.meshDirty=!0)},e.prototype.setLineWidth=function(a){this.lineWidth!==a&&(this.lineWidth=a,this.meshDirty=!0)},e.prototype.setSolid=function(a){this.solid!==a&&(this.solid=a,this.meshDirty=!0)},e.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},e.prototype.setArcAngle=function(a){a=d(0,2*Math.PI,a),this.arcAngle!==a&&(this.arcAngle=a,this.meshDirty=!0)},e.prototype.getMesh=function(){return this.mesh},e.prototype.dispose=function(){this.mesh.dispose()},e.createShader=function(a){return f(a)},b.exports=e},{"./mesh":304}],302:[function(a,b,c){"use strict";function d(a,b){this.texture=b.texture;var c,d,e=a.getParameter(a.FRAMEBUFFER_BINDING),f=a.createFramebuffer();a.bindFramebuffer(a.FRAMEBUFFER,f),a.framebufferTexture2D(a.FRAMEBUFFER,a.COLOR_ATTACHMENT0,a.TEXTURE_2D,this.texture.handle,0),b.stencilBuffer?(d=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,d),a.renderbufferStorage(a.RENDERBUFFER,a.STENCIL_INDEX8,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.STENCIL_ATTACHMENT,a.RENDERBUFFER,d)):b.depthBuffer&&(c=a.createRenderbuffer(),a.bindRenderbuffer(a.RENDERBUFFER,c),a.renderbufferStorage(a.RENDERBUFFER,a.DEPTH_COMPONENT16,b.width,b.height),a.framebufferRenderbuffer(a.FRAMEBUFFER,a.DEPTH_ATTACHMENT,a.RENDERBUFFER,c)),this.stencilRenderBuffer=d,this.depthRenderBuffer=c;var g=a.checkFramebufferStatus(a.FRAMEBUFFER);switch(g){case a.FRAMEBUFFER_COMPLETE:break;case a.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT");break;case a.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:console.log("Incomplete framebuffer: FRAMEBUFFER_INCOMPLETE_DIMENSIONS");break;case a.FRAMEBUFFER_UNSUPPORTED:console.log("Incomplete framebuffer: FRAMEBUFFER_UNSUPPORTED");break;default:console.log("Incomplete framebuffer: "+g)}a.bindFramebuffer(a.FRAMEBUFFER,e),this.fbo=f,this.gl=a,this.width=b.width,this.height=b.height}d.prototype.dispose=function(){this.texture&&(this.texture.dispose(),this.texture=null),this.stencilRenderBuffer&&(this.gl.deleteRenderbuffer(this.stencilRenderBuffer),this.stencilRenderBuffer=null),this.depthRenderBuffer&&(this.gl.deleteRenderbuffer(this.depthRenderBuffer),this.depthRenderBuffer=null),this.fbo&&(this.gl.deleteFramebuffer(this.fbo),this.fbo=null)},b.exports=d},{}],303:[function(a,b,c){function d(a,b){for(var c=0;;){for(var d=!0,e=0,f=!1,g=[],h=!1,i=0;i<a.length;i++){var j=a[i];if(-1!==j.search("#ifdef")){if(e++,e>1){g.push(j),h=!0;continue}var k=j.split("#ifdef");k=k[k.length-1].trim(),k in b?(d=!0,f=!0):d=!1}else if(-1!==j.search("#elif ")){if(e>1){g.push(j);continue}if(f)d=!1;else{var k=j.split("#elif");k=k[k.length-1].trim(),k in b&&(d=!0,f=!0)}}else if(-1!==j.search("#else")){if(e>1){g.push(j);continue}f?d=!1:(d=!0,f=!0)}else if(-1!==j.search("#endif")){if(e--,e>0){g.push(j);continue}if(d=!0,f=!1,0>e)throw new Error("Invalid #ifdef syntax")}else d&&g.push(j)}if(!h)break;a=g,g=[],c++}return g.join("\n")}function e(a){a=a||0;var b=""+a;return b=b.replace(",","."),-1===b.indexOf(".")&&(b+=".0"),b}function f(a,b){for(var c=new Float32Array(a+1),d=0,e=0;a+1>e;e++)c[e]=1/Math.sqrt(2*Math.PI*Math.pow(b,2))*Math.exp(-Math.pow(e,2)/(2*Math.pow(b,2))),d+=0==e?c[e]:2*c[e];for(var e=0;a+1>e;e++)c[e]=c[e]/d;return c}function g(a,b,c,d){for(var e=Math.min(a/2+a%2,c-1),f=new Float32Array(e),g=0;e>g;g++){var h=b[2*g+1],i=b[2*g+2],j=h+i;j=j||0,f[g]=(h*(2*g+1)+i*(2*g+2))/j,d&&d(g,j)}return f}function h(a,b,c,h,i){a=Math.floor(a);var j=f(a,b),k=g(a,j,c),l={};h&&(l.USE_MASK=!0),i&&(l.FLIP_MASK=!0);var m=["attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","","uniform highp mat4 u_projection;","uniform highp mat4 u_view;","","uniform lowp float opacity;","uniform lowp float amount;","uniform lowp float texelWidthOffset;","uniform lowp float texelHeightOffset;","#ifdef USE_MASK","uniform lowp vec4 maskRect;","#endif",""];m.push("varying lowp vec4 bc["+(1+k.length)+"];"),m=m.concat(["","void main()","{","    gl_Position = u_projection * u_view * vec4(a_position, 1.0);","    // Force usage of a_color so it's not optimized away. Will","    // always be 1 since blur and tint don't combine","    lowp vec2 offset = vec2(texelWidthOffset * a_color.x, texelHeightOffset);\n","    bc[0].xy = a_uv.xy;","#ifdef USE_MASK","    bc[0].zw = (a_uv.xy - maskRect.xy) / (maskRect.zw - maskRect.xy);","#ifdef FLIP_MASK","    bc[0].w = 1.0 - bc[0].w;","#endif","#endif"]);for(var n=0;n<k.length;n++)m.push("    bc["+(n+1)+"].xy = a_uv.xy + offset * "+e(k[n])+";"),m.push("    bc["+(n+1)+"].zw = a_uv.xy - offset * "+e(k[n])+";");return m.push("}"),d(m,l)}function i(a,b,c,h,i){a=Math.floor(a);var j=f(a,b),k=Math.min(a/2+a%2,c-1),l=a/2+a%2,m={};h&&(m.USE_MASK=!0),i&&(m.FLIP_MASK=!0);var n=["uniform sampler2D texture;","uniform lowp float opacity;","uniform lowp float amount;","uniform lowp float texelWidthOffset;","uniform lowp float texelHeightOffset;","#ifdef USE_MASK","uniform sampler2D maskTexture;","#endif",""];n.push("varying lowp vec4 bc["+(1+k)+"];"),n=n.concat(["","void main()","{","    lowp vec4 sum = vec4(0.0);"]),n.push("    sum += texture2D(texture, bc[0].xy) * "+e(j[0])+";");g(a,j,c,function(a,b){b=e(b),n.push("    sum += texture2D(texture, bc["+(a+1)+"].xy) * "+b+";"),n.push("    sum += texture2D(texture, bc["+(a+1)+"].zw) * "+b+";")});if(l>k){n.push("    lowp vec2 offset = vec2(texelWidthOffset, texelHeightOffset);");for(var o=k;l>o;o++){var p=j[2*o+1],q=j[2*o+2],r=p+q,s=(p*(2*o+1)+q*(2*o+2))/r;s=e(s),r=e(r),n.push("    sum += texture2D(texture, bc[0].xy + offset * "+s+") * "+r+";"),n.push("    sum += texture2D(texture, bc[0].xy - offset * "+s+") * "+r+";")}}return n.push("    sum *= opacity;"),n=n.concat(["#ifdef USE_MASK","    lowp vec4 maskColor = texture2D(maskTexture, bc[0].zw);","    gl_FragColor = sum * maskColor.aaaa;","#else","    gl_FragColor = sum;","#endif"]),n.push("}"),d(n,m)}var j={};j.generateGaussianBlurShaders=function(a,b,c,d){var e=1;if(a>=1){var f=1/256;e=Math.floor(Math.sqrt(-2*Math.pow(a,2)*Math.log(f*Math.sqrt(2*Math.PI*Math.pow(a,2))))),e=Math.round(e),e+=e%2}var g={vertexSource:h(e,a,b,c,d),fragmentSource:i(e,a,b,c,d)};return g},j.getMaskShaders=function(a){var b={};a&&(b.FLIP_MASK=!0);var c=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform lowp vec4 maskRect;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying mediump vec2 maskUv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   maskUv = (a_uv.xy - maskRect.xy) / (maskRect.zw - maskRect.xy);","#ifdef FLIP_MASK","   maskUv.y = 1.0 - maskUv.y;","#endif","   uv = a_uv;","   color = a_color;","}"],e=["uniform sampler2D texture;","uniform sampler2D maskTexture;","varying mediump vec2 uv;","varying mediump vec2 maskUv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 maskColor = texture2D(maskTexture, maskUv);","    lowp vec4 maskVec = vec4(maskColor.a, maskColor.a, maskColor.a, maskColor.a);","    gl_FragColor = texture2D(texture, uv) * color * maskVec;","}"];return{vertexSource:d(c,b),fragmentSource:d(e,b)}},j.getDesaturateShaders=function(a,b){var c={};a&&(c.USE_MASK=!0),b&&(c.FLIP_MASK=!0);var e=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","#ifdef USE_MASK","varying mediump vec2 maskUv;","uniform lowp vec4 maskRect;","#endif","","void main(void) {","    gl_Position = u_projection * u_view * vec4(a_position, 1.0);","    uv = a_uv;","#ifdef USE_MASK","   maskUv = (a_uv.xy - maskRect.xy) / (maskRect.zw - maskRect.xy);","#ifdef FLIP_MASK","   maskUv.y = 1.0 - maskUv.y;","#endif","#endif","    color = a_color;","}"],f=["uniform sampler2D texture;","uniform mediump float amount;","varying mediump vec2 uv;","varying lowp vec4 color;","#ifdef USE_MASK","varying mediump vec2 maskUv;","uniform sampler2D maskTexture;","#endif","void main(void) {","    mediump vec4 tex = texture2D(texture, uv);","    mediump float lum = dot( vec3(tex[0], tex[1], tex[2]), vec3(0.22, 0.707, 0.071) );","#ifdef USE_MASK","    lowp vec4 maskColor = texture2D(maskTexture, maskUv);","    lowp vec4 maskVec = vec4(maskColor.a, maskColor.a, maskColor.a, maskColor.a);","    gl_FragColor = color*vec4(mix(tex[0], lum, amount),","                              mix(tex[1], lum, amount),","                              mix(tex[2], lum, amount),","                              tex[3]) * maskVec;","#else","    gl_FragColor = color*vec4(mix(tex[0], lum, amount),","                              mix(tex[1], lum, amount),","                              mix(tex[2], lum, amount),","                              tex[3]);","#endif","}"];return{vertexSource:d(e,c),fragmentSource:d(f,c)}},b.exports=j},{}],304:[function(a,b,c){"use strict";function d(a,b){b=b||{},void 0===b.vertices&&(b.vertices=new Float32Array(0)),b.vertices instanceof Float32Array==!1&&console.error("Vertices must be of type Float32Array"),b.indices&&b.indices instanceof Uint16Array==!1&&console.error("Indices must be of type Uint16Array"),this.gl=a,this.vertexBuffer=a.createBuffer(),this.vertices=b.vertices,this.indexBuffer=null,this.indices=b.indices,b.primitiveType===d.PrimitiveType.Triangles?this.primitiveType=a.TRIANGLES:b.primitiveType===d.PrimitiveType.Lines?this.primitiveType=a.LINES:b.primitiveType===d.PrimitiveType.LineStrip?this.primitiveType=a.LINE_STRIP:b.primitiveType===d.PrimitiveType.TriangleFan?this.primitiveType=a.TRIANGLE_FAN:this.primitiveType=a.TRIANGLE_STRIP,this.vertexDataDirty=!0}d.prototype.bind=function(a,b){var c=this.gl;this.numComponentsPerVertex=b,c.bindBuffer(c.ARRAY_BUFFER,this.vertexBuffer);var d,e=0;for(d=c.numVertexAttribsEnabled;d<a.length;++d)c.enableVertexAttribArray(d);for(d=a.length;d<c.numVertexAttribsEnabled;++d)c.disableVertexAttribArray(d);for(c.numVertexAttribsEnabled=a.length,d=0;d<a.length;++d){var f=a[d];c.vertexAttribPointer(d,f.numComponents,c.FLOAT,!1,4*b,4*e),e+=f.numComponents}null===this.indexBuffer&&this.indices&&this.indices.length>0&&(this.indexBuffer=c.createBuffer()),c.bindBuffer(c.ELEMENT_ARRAY_BUFFER,this.indexBuffer)},d.prototype.syncVertexData=function(){var a=this.gl;this.vertexDataDirty&&(this.indices&&this.indices.length>0&&a.bufferData(a.ELEMENT_ARRAY_BUFFER,this.indices,a.STATIC_DRAW),a.bufferData(a.ARRAY_BUFFER,this.vertices,a.STREAM_DRAW),this.vertexDataDirty=!1)},d.prototype.draw=function(){this.syncVertexData();var a=this.gl,b=0;this.indexBuffer?a.drawElements(this.primitiveType,this.indices.length,a.UNSIGNED_SHORT,0):(b=this.vertices.length/this.numComponentsPerVertex,a.drawArrays(this.primitiveType,0,b))},d.prototype.drawVertexRange=function(a,b){this.syncVertexData();var c=this.gl;this.indexBuffer?c.drawElements(this.primitiveType,b,c.UNSIGNED_SHORT,2*a):c.drawArrays(this.primitiveType,a,b)},d.prototype.dispose=function(){this.gl.deleteBuffer(this.vertexBuffer),this.indexBuffer&&this.gl.deleteBuffer(this.indexBuffer)},d.PrimitiveType={TriangleStrip:0,Triangles:1,Lines:2,LineStrip:3,TriangleFan:4},d.PrimitiveTypeFromString=function(a){return"triangle_strip"===a?d.PrimitiveType.TriangleStrip:"triangles"===a?d.PrimitiveType.Triangles:"lines"===a?d.PrimitiveType.Lines:"line_strip"===a?d.PrimitiveType.LineStrip:"triangle_fan"===a?d.PrimitiveType.TriangleFan:d.PrimitiveType.Triangles},b.exports=d},{}],305:[function(a,b,c){"use strict";function d(){this.width=0,this.height=0,this.sourceRect=[0,0,1,1],this.dirty=!0,this.color=[1,1,1,1]}var e=(a("./mesh"),9),f=16,g=3;d.prototype._generateMesh=function(){function a(a){return(a.numSegments+1)*g}function b(){var b=0;return j.forEach(function(c){b+=a(c)*e}),b+f*e}function c(a,b,c){a[r++]=b,a[r++]=c,a[r++]=0,a[r++]=o+b/k*m,a[r++]=p+c/l*n,a[r++]=q[0],a[r++]=q[1],a[r++]=q[2],a[r++]=q[3]}function d(a,b,d,e,f){for(var g=t/b.numSegments,h=0;h<=b.numSegments;++h){var i=Math.cos(f+h*g),j=Math.sin(f+h*g);c(a,d,e),c(a,d+b.radius*i,e-b.radius*j),c(a,d+b.radius*i,e-b.radius*j)}}function h(a){d(a,j[0],j[0].radius,j[0].radius,Math.PI/2),c(a,0,j[0].radius),c(a,j[0].radius,j[0].radius),c(a,0,l-j[1].radius),d(a,j[1],j[1].radius,l-j[1].radius,Math.PI),c(a,j[1].radius,l-j[1].radius),c(a,k-j[2].radius,l),c(a,j[1].radius,l-j[1].radius),c(a,j[1].radius,l-j[1].radius),d(a,j[2],k-j[2].radius,l-j[2].radius,3*Math.PI/2),c(a,k,j[3].radius),c(a,k-j[2].radius,l-j[2].radius),c(a,k-j[2].radius,j[3].radius),d(a,j[3],k-j[3].radius,j[3].radius,0),c(a,j[0].radius,0),c(a,k-j[3].radius,0),c(a,j[0].radius,j[0].radius),c(a,k-j[3].radius,j[3].radius),c(a,j[0].radius,l-j[1].radius),c(a,k-j[3].radius,l-j[2].radius)}function i(){j.forEach(function(a){if(0===a.radius)a.numSegments=1;else{var b=1-s/a.radius,c=Math.acos(2*b*b-1);a.numSegments=Math.ceil(t/c)}})}var j=this.corners,k=this.width,l=this.height,m=this.sourceRect[2]-this.sourceRect[0],n=this.sourceRect[3]-this.sourceRect[1],o=this.sourceRect[0],p=this.sourceRect[1],q=this.color,r=0,s=.2,t=Math.PI/2;i();var u=b();(void 0===this.vertices||this.vertices.length!==u)&&(this.vertices=new Float32Array(u)),h(this.vertices)},d.prototype.setCornerRadius=function(a){a=Math.max(0,a),this.corners&&this.corners[0].radius===a&&this.corners[1].radius===a&&this.corners[2].radius===a&&this.corners[3].radius===a||(a=Math.max(1,a),this.corners=[{radius:a},{radius:a},{radius:a},{radius:a}],this.dirty=!0)},d.prototype.setIndividualCornerRadii=function(a,b,c,d){this.corners=[{radius:Math.max(0,a)},{radius:Math.max(0,b)},{radius:Math.max(0,c)},{radius:Math.max(0,d)}],this.dirty=!0},d.prototype.updateMesh=function(){this.dirty!==!1&&(this._generateMesh(),this.dirty=!1)},d.cornerTooSmall=function(a){var b=.1;return b>a},d.prototype.setSourceRect=function(a){(this.sourceRect[0]!==a[0]||this.sourceRect[1]!==a[1]||this.sourceRect[2]!==a[2]||this.sourceRect[3]!==a[3])&&(this.sourceRect=a,this.dirty=!0)},d.prototype.setWidth=function(a){this.width!==a&&(this.width=a,this.dirty=!0)},d.prototype.setColor=function(a){(this.color[0]!==a[0]||this.color[1]!==a[1]||this.color[2]!==a[2]||this.color[3]!==a[3])&&(this.color=a,this.dirty=!0)},d.prototype.setHeight=function(a){this.height!==a&&(this.height=a,this.dirty=!0)},d.prototype.dispose=function(){},b.exports=d},{"./mesh":304}],306:[function(a,b,c){"use strict";function d(a){this.width=0,this.height=0,this.sourceRect=[0,0,1,1],this.mesh=a.createMesh({vertices:new Float32Array(0),indices:new Uint16Array(0),primitiveType:e.PrimitiveType.TriangleStrip})}var e=a("./mesh");d.createShader=function(a){var b=["uniform mat4 u_projection;","uniform mat4 u_view;","uniform mat4 u_world;","uniform mediump vec4 u_srcRect;","uniform lowp float u_flipTexCoordY;","attribute vec2 a_position;","attribute vec2 a_uv;","attribute float a_blur;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   gl_Position = u_projection * u_view * u_world * vec4(a_position, 0.0, 1.0);","   uv = a_uv;","   if(u_flipTexCoordY > 0.0) { uv.y = 1.0 - uv.y; }","   blur = a_blur;","}"].join("\n"),c=["uniform sampler2D texture;","uniform lowp vec3 u_color;","uniform lowp float u_opacity;","varying mediump vec2 uv;","varying lowp float blur;","void main(void) {","   lowp float intensity = smoothstep(0.0, 1.0, blur);","   gl_FragColor = texture2D(texture, uv)*vec4(u_color,1.0)*(u_opacity*intensity);","}"].join("\n");return a.createShader({vertexSource:b,fragmentSource:c})},d.prototype._generateMesh=function(){function a(a){return(a.numSegments+1)*w}function b(){var b=0;return k.forEach(function(c){b+=a(c)*t}),b}function c(){var a=0;k.forEach(function(b){a+=b.numSegments});var b=4,c=6,d=5,e=c*b+d,f=6;return a*f+e}function d(a,b,c,d,e){for(var f=b.radius+n,g=v/b.numSegments,h=0;h<=b.numSegments;++h){var i=Math.cos(e+h*g),j=Math.sin(e+h*g);a[s++]=c,a[s++]=d,a[s++]=q+a[s-3]/l*o,a[s++]=r+a[s-3]/m*p,a[s++]=1,a[s++]=c+b.radius*i,a[s++]=d-b.radius*j,a[s++]=q+a[s-3]/l*o,a[s++]=r+a[s-3]/m*p,a[s++]=1,a[s++]=c+f*i,a[s++]=d-f*j,a[s++]=q+a[s-3]/l*o,a[s++]=r+a[s-3]/m*p,a[s++]=0}}function e(a){d(a,k[0],k[0].radius,k[0].radius,Math.PI/2),d(a,k[1],k[1].radius,m-k[1].radius,Math.PI),d(a,k[2],l-k[2].radius,m-k[2].radius,3*Math.PI/2),d(a,k[3],l-k[3].radius,k[3].radius,0)}function f(a,b,c){for(var d=c.startFromVertexIndex,e=c.startFromInnerEdge===!0?0:1,f=0;f<b.numSegments;++f){var g;if(f%2===e){for(g=0;w>g;++g)a[s++]=f*w+g+d,a[s++]=(f+1)*w+g+d;c.startFromInnerEdge=!1}else{for(g=0;w>g;++g)a[s++]=f*w+(w-1)-g+d,a[s++]=(f+1)*w+(w-1)-g+d;c.startFromInnerEdge=!0}}c.startFromVertexIndex=a[s-1]}function g(a,b){var c,d,e=x/t;b.startFromInnerEdge===!0?(c=b.startFromVertexIndex+w,d=b.startFromVertexIndex,a[s++]=d,a[s++]=c%e,a[s++]=d+1,a[s++]=(c+1)%e,a[s++]=d+2,a[s++]=(c+2)%e,b.startFromInnerEdge=!1):b.startFromInnerEdge===!1&&(c=b.startFromVertexIndex+1,d=b.startFromVertexIndex,a[s++]=d,a[s++]=(c+2)%e,a[s++]=d-1,a[s++]=(c+1)%e,a[s++]=d-2,a[s++]=c%e,b.startFromInnerEdge=!0),b.startFromVertexIndex=c}function h(b){var c=[a(k[0]),a(k[1]),a(k[2]),a(k[3])];b[s++]=0,b[s++]=0,b[s++]=c[0]+c[1]+c[2],b[s++]=c[0],b[s++]=c[0]+c[1]}function i(a){var b={startFromInnerEdge:!0,startFromVertexIndex:0};s=0,f(a,k[0],b),g(a,b),f(a,k[1],b),g(a,b),f(a,k[2],b),g(a,b),f(a,k[3],b),g(a,b),h(a)}function j(){k.forEach(function(a){if(0===a.radius)a.numSegments=1;else{var b=1-u/(a.radius+n),c=Math.acos(2*b*b-1);a.numSegments=Math.ceil(v/c)}})}var k=this.corners,l=this.width,m=this.height,n=this.blurDistance,o=this.sourceRect[2]-this.sourceRect[0],p=this.sourceRect[3]-this.sourceRect[1],q=this.sourceRect[0],r=this.sourceRect[1],s=0,t=5,u=.2,v=Math.PI/2,w=3;j();var x=b();(void 0===this.vertices||this.vertices.length!==x)&&(this.vertices=new Float32Array(x)),e(this.vertices);var y=c();(void 0===this.indices||this.indices.length!==y)&&(this.indices=new Uint16Array(y)),i(this.indices),this.mesh.vertices=this.vertices,this.mesh.indices=this.indices,this.mesh.vertexDataDirty=!0},d.prototype.setCornerRadius=function(a){a=Math.max(0,a),this.corners&&this.corners[0].radius===a&&this.corners[1].radius===a&&this.corners[2].radius===a&&this.corners[3].radius===a||(a=Math.max(1,a),this.corners=[{radius:a},{radius:a},{radius:a},{radius:a}],this.meshDirty=!0)},d.prototype.setIndividualCornerRadii=function(a,b,c,d){this.corners=[{radius:Math.max(0,a)},{radius:Math.max(0,b)},{radius:Math.max(0,c)},{radius:Math.max(0,d)}],this.meshDirty=!0},d.prototype.updateMesh=function(){this.meshDirty!==!1&&(this._generateMesh(),this.meshDirty=!1)},d.cornerTooSmall=function(a,b){var c=.1;return c>a+b},d.prototype.setSourceRect=function(a){(this.sourceRect[0]!==a[0]||this.sourceRect[1]!==a[1]||this.sourceRect[2]!==a[2]||this.sourceRect[3]!==a[3])&&(this.sourceRect=a,this.meshDirty=!0)},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.setWidth=function(a){this.width!==a&&(this.width=a,this.meshDirty=!0)},d.prototype.setHeight=function(a){this.height!==a&&(this.height=a,this.meshDirty=!0)},d.prototype.setBlur=function(a){this.blurDistance!==a&&(this.blurDistance=a,this.meshDirty=!0)},d.prototype.dispose=function(){this.mesh.dispose()},d.prototype.getMesh=function(){return this.mesh},b.exports=d},{"./mesh":304}],307:[function(a,b,c){function d(a,b,c){var d=a.createShader(c);if(a.shaderSource(d,b),a.compileShader(d),!a.getShaderParameter(d,a.COMPILE_STATUS)){var e=a.getShaderInfoLog(d);return console.warn("Shader compilation error:",e),console.log(b),{shader:null,error:{message:e,type:c==a.VERTEX_SHADER?"vertexShader":"fragmentShader"}}}return{shader:d,error:null}}function e(a,b,c){var d=1;switch(b.type){case"float":d=1;break;case"vec2":d=2;break;case"vec3":d=3;break;case"vec4":d=4}return{name:b.name,numComponents:d,offset:c}}function f(a,b,c){var d,e=j.extractStorageQualifier(c,"attribute"),f=a.getProgramParameter(b,a.ACTIVE_ATTRIBUTES),g={};for(d=0;f>d;++d)g[a.getActiveAttrib(b,d).name]=!0;for(d=0;d<e.length;)g[e[d].name]!==!0?e.splice(d,1):d++;return e}function g(a){switch(a){case"float":return 0;case"vec2":return[0,0];case"vec3":return[0,0,0];case"vec4":return[0,0,0,0]}return 0}function h(a,b,c){function d(d,e,f){Object.defineProperty(d,e,{set:function(d){null===c.value&&(c.value=g(b)),c.value[f]=d,a.hasDirtyUniforms=!0},get:function(){return c.value[f]}})}for(var e=Number(b[b.length-1]),f={},h=0;e>h;h++)for(var i=0;i<k[h].length;i++)d(f,k[h][i],h);return Object.defineProperty(f,"array",{get:function(){return c.value},set:function(a){if(a.length!==e)throw new Error("Uniform array: Array must be of size "+e);c.value=a}}),Object.freeze(f)}function i(a,b){if(!b.vertexSource)throw new Error("No vertex shader source");if(!b.fragmentSource)throw new Error("No fragment shader source");if(b.uniforms&&Array.isArray(b.uniforms))throw new Error("WebGLShader: old style uniforms is unsupported");this.program=a.createProgram(),this.attributes=[];var c=d(a,b.vertexSource,a.VERTEX_SHADER);if(c.error)return void(this.error=c.error);var h=b.fragmentSource+"\nvoid _haxAndroidShaderCache() { lowp float hax="+Math.random()+";}",i=d(a,h,a.FRAGMENT_SHADER);if(i.error)return void(this.error=i.error);if(a.attachShader(this.program,c.shader),a.attachShader(this.program,i.shader),this.vs=c.shader,this.fs=i.shader,a.linkProgram(this.program),!a.getProgramParameter(this.program,a.LINK_STATUS))return this.error=a.getProgramInfoLog(this.program),void console.warn("Shader link error:",this.error);var k=0,l=this,m=f(a,this.program,b.vertexSource);m.forEach(function(b,c){a.bindAttribLocation(l.program,c,b.name);var d=e(a,b,k);l.attributes.push(d),k+=d.numComponents}),a.linkProgram(this.program),this.numComponentsPerVertex=k,this.standardUniforms={},this._uniforms={};var n=j.extractUniforms(b.vertexSource,b.fragmentSource);n.forEach(function(b){var c=a.getUniformLocation(l.program,b.name);j.StandardUniformNames[b.name]?l.standardUniforms[b.name]=c:l._uniforms[b.name]={type:b.type,location:c,value:g(b.type)}}),this.uniforms=this.createUniformSetters(this._uniforms),this.uniformNames=Object.keys(this._uniforms),this.hasDirtyUniforms=!0}var j=a("../../../shaderparser"),k=[["x","r","u"],["y","g","v"],["z","b"],["w","a"]];i.prototype.release=function(a){this.vs&&(a.detachShader(this.program,this.vs),a.deleteShader(this.vs)),this.fs&&(a.detachShader(this.program,this.fs),a.deleteShader(this.fs)),this.program&&a.deleteProgram(this.program)},i.prototype.createUniformSetters=function(a){var b={},c=this;return Object.keys(this._uniforms).forEach(function(d){var e=c._uniforms[d];"vec"!==e.type.substring(0,3)?Object.defineProperty(b,d,{set:function(b){a[d].value=b,c.hasDirtyUniforms=!0},get:function(){return a[d].value}}):b[d]=h(c,e.type,a[d])}),b},b.exports=i},{"../../../shaderparser":263}],308:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache=new e({freelistSize:50}),this.canvas=document.createElement("canvas")}var e=a("../../resourcecache");d.prototype._createNewTextTexture=function(a,b,c){var d=this.canvas;d.width=a.width*b,d.height=a.height*b;var e=d.getContext("2d");if(e.clearRect(0,0,d.width,d.height),e.font=a.content.fontSize*b+'px "'+a.content.fontFamily+'"',e.fillStyle=c,"text"===a.content.type)for(var f=0;f<a.content.lines.length;f++){var g=a.content.lines[f];e.fillText(g.text,g.x*b,g.y*b)}else if("textInput"===a.content.type){var h=.5*(a.height-a.content.textHeight);e.fillText(a.content.text,0,b*(h+a.content.baseline))}return this.webGLHelper.createTexture({canvas:d})},d.prototype.getTextTexture=function(a,b,c,d){var e=b+""+a.content.fontSize+a.content.fontFamily+c;return e+="text"===a.content.type?a.content.lines.map(function(a){return a.x+" "+a.text}).join(""):a.content.text,
this.textureCache.isInCache(e)===!1&&this.textureCache.addResource(e,this._createNewTextTexture(a,b,c)),this.textureCache.updateReference(a.id,e),this.textureCache.getResource(e)},d.prototype.textResourceRemoved=function(a){this.textureCache.removeReference(a)},d.prototype.clear=function(){this.textureCache.clear()},b.exports=d},{"../../resourcecache":312}],309:[function(a,b,c){"use strict";function d(a,b){this.handle=0,this.size=[0,0],this.loaded=!1,this.path=null,this.target=null,this.gl=a,this.refCount=0,this.preloadedAndUnused=!1,this.keepForever=!1,this.sizeCallbacks=[],this._pixelDataChangedListeners=[],b.wrapMode=b.wrapMode||d.WrapMode.Clamp,b.filter=b.filter||d.Filter.Linear,b.pixels?this._uploadPixelData(b.pixels,b.width,b.height,b.wrapMode,b.filter):b.path instanceof Array?6==b.path.length?this._uploadCubemap(b.resourceDirectory,b.path,b.wrapMode,b.filter):console.error("Cubemap requries six image paths"):b.path&&b.domElement?this._uploadDomElement(b.domElement,b.path,b.wrapMode,b.filter):b.path?this._uploadImageData(b.resourceDirectory,b.path,b.wrapMode,b.filter):b.canvas?this._uploadCanvas(b.canvas,b.wrapMode,b.filter):b.video?this._uploadVideo(b.video,b.wrapMode,b.filter):this._uploadEmptyTexture(b.width,b.height,b.wrapMode,b.filter)}var e=0;d.prototype._uploadEmptyTexture=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.texImage2D(this.target,0,e.RGBA,a,b,0,e.RGBA,e.UNSIGNED_BYTE,null),this._textureDataLoaded(a,b)},d.prototype._uploadPixelData=function(a,b,c,d,e){if(Array.isArray(a))a=new Uint8Array(a);else if(a instanceof Uint8Array==!1)throw new Error("pixels must be an array or Uint8Array");var f=this.gl;this._createAndBindHandle(f.TEXTURE_2D,d,e),f.bindTexture(this.target,this.handle),f.texImage2D(this.target,0,f.RGBA,b,c,0,f.RGBA,f.UNSIGNED_BYTE,a),this._textureDataLoaded(b,c)},d.prototype._uploadVideo=function(a,b,c){this.videoDOMNode=a,this._createAndBindHandle(this.gl.TEXTURE_2D,b,c)},d.prototype._uploadImageData=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d);var f="http"===b.substring(0,4).toLowerCase(),g=new Image;f&&(g.crossOrigin="anonymous");var h=this;g.onload=function(){e.bindTexture(h.target,h.handle),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(h.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),h._textureDataLoaded(this.width,this.height)},g.src=a+b,this.path=b},d.prototype._uploadDomElement=function(a,b,c,d){if("video"===a.tagName.toLowerCase())this._uploadVideo(a,c,d);else{var e=this.gl;this._createAndBindHandle(e.TEXTURE_2D,c,d),e.pixelStorei(e.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),e.texImage2D(this.target,0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,a),this._textureDataLoaded(a.width,a.height)}this.path=b},d.prototype._uploadCubemap=function(a,b,c,d){var e=this.gl;this._createAndBindHandle(e.TEXTURE_CUBE_MAP,c,d);for(var f=[e.TEXTURE_CUBE_MAP_NEGATIVE_X,e.TEXTURE_CUBE_MAP_NEGATIVE_Y,e.TEXTURE_CUBE_MAP_NEGATIVE_Z,e.TEXTURE_CUBE_MAP_POSITIVE_X,e.TEXTURE_CUBE_MAP_POSITIVE_Y,e.TEXTURE_CUBE_MAP_POSITIVE_Z],g=this,h=0;6>h;++h){var i=new Image;i.crossOrigin="anonymous",i.onload=function(a){return function(){e.bindTexture(g.target,g.handle),e.texImage2D(f[a],0,e.RGBA,e.RGBA,e.UNSIGNED_BYTE,this),g._textureDataLoaded(this.width,this.height)}}(h),i.src=a+b[h]}},d.prototype._uploadCanvas=function(a,b,c){var d=this.gl;this._createAndBindHandle(d.TEXTURE_2D,b,c),d.bindTexture(this.target,this.handle),d.pixelStorei(d.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!0),d.texImage2D(this.target,0,d.RGBA,d.RGBA,d.UNSIGNED_BYTE,a);var e=window.devicePixelRatio||1;this._textureDataLoaded(a.width/e,a.height/e)},d.prototype.updateVideoTexture=function(){var a=this.videoDOMNode;if(a.readyState===a.HAVE_ENOUGH_DATA){var b=this.gl;b.bindTexture(this.target,this.handle),b.texImage2D(this.target,0,b.RGBA,b.RGBA,b.UNSIGNED_BYTE,a),this.loaded===!1&&this._textureDataLoaded(a.videoWidth,a.videoHeight),this._notifyPixleDataChangedListeners()}},d.prototype.addPixelDataChangedListener=function(a){this._pixelDataChangedListeners.push(a)},d.prototype.removePixelDataChangedListener=function(a){var b=this._pixelDataChangedListeners.indexOf(a);if(-1===b)throw new Error("Listener is not added");this._pixelDataChangedListeners.splice(b,1)},d.prototype._notifyPixleDataChangedListeners=function(){for(var a=0;a<this._pixelDataChangedListeners.length;++a)this._pixelDataChangedListeners[a].onTexturePixelDataChanged(this)},d.prototype._createAndBindHandle=function(a,b,c){var e=this.gl;this.handle=e.createTexture(),this.target=a,e.bindTexture(a,this.handle);var f;c===d.Filter.Nearest?f=e.NEAREST:c===d.Filter.Linear&&(f=e.LINEAR),e.texParameteri(a,e.TEXTURE_MAG_FILTER,f),e.texParameteri(a,e.TEXTURE_MIN_FILTER,f),b===d.WrapMode.Repeat?(e.texParameteri(a,e.TEXTURE_WRAP_S,e.REPEAT),e.texParameteri(a,e.TEXTURE_WRAP_T,e.REPEAT)):(e.texParameteri(a,e.TEXTURE_WRAP_S,e.CLAMP_TO_EDGE),e.texParameteri(a,e.TEXTURE_WRAP_T,e.CLAMP_TO_EDGE)),this.wrapMode=b},d.prototype._textureDataLoaded=function(a,b){this.size=[a,b],this.loaded=!0,this._notifySizeCallbacks(this.size),e+=a*b*4},d.prototype._notifySizeCallbacks=function(a){if(0!==this.sizeCallbacks.length){for(var b=0;b<this.sizeCallbacks.length;++b)this.sizeCallbacks[b].callback(a);this.sizeCallbacks.length=0}},d.prototype.dispose=function(){this.gl.deleteTexture(this.handle)},d.WrapMode={Clamp:0,Repeat:1},d.Filter={Nearest:1,Linear:2},b.exports=d},{}],310:[function(a,b,c){"use strict";function d(a){this.webGLHelper=a,this.textureCache={}}d.prototype.getTexture=function(a,b){var c=this.textureCache[a];return c||(c=this.webGLHelper.createTexture({path:a,domElement:b}),this.textureCache[a]=c),c},d.prototype.flushUnused=function(){for(var a in this.textureCache){var b=this.textureCache[a];0===b.refCount&&b.preloadedAndUnused===!1&&b.keepForever===!1&&delete this.textureCache[a]}},d.prototype.evict=function(a){this.textureCache[a]?delete this.textureCache[a]:console.log("WebGLTextureCache.evict: texture doesn't exist: "+a)},d.prototype.clear=function(){this.textureCache={}},b.exports=d},{}],311:[function(a,b,c){"use strict";function d(a){return void 0!==a&&null!==a}function e(a,b,c){this.gl=a,this.gl.numVertexAttribsEnabled=0,this.screenCameraProjection=m.create(),this.screenCameraView=m.create(),this.fieldOfView=25,this._whiteTexture=null,this.identityMatrix=m.create(),this.currentBlendMode=e.BlendMode.Solid,this.currentRenderTarget=0,this.currentShader=0,this.currentUniformValues=null,this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.currentDepthTestState=!1,this.currentScissorTestState=!1,this.currentStencilTestState=!1,this.currentBoundMesh=null,this.maskRenderingEnabled=!1,this.currentViewport={width:0,height:0},a.disable(a.CULL_FACE),a.clearColor(0,0,0,0),a.stencilMask(255),a.clearStencil(128),this.supportsEGLImageExternal=a.TEXTURE_EXTERNAL_OES?!0:!1,this.cameraMatricesDirty=!0,this.activeTexture=0,this.setVirtualSize(b,c),this.resourceDirectory="",this._defaultVsSource=["uniform mat4 u_projection;","uniform mat4 u_view;","attribute vec3 a_position;","attribute vec2 a_uv;","attribute vec4 a_color;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","   gl_Position = u_projection * u_view * vec4(a_position, 1.0);","   uv = a_uv;","   color = a_color;","}"].join("\n"),this._defaultFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._videoFsSource=["#extension GL_OES_EGL_image_external : require","uniform samplerExternalOES texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    gl_FragColor = texture2D(texture, uv)*color;","}"].join("\n"),this._imageMaskFsSource=["uniform sampler2D texture;","varying mediump vec2 uv;","varying lowp vec4 color;","void main(void) {","    lowp vec4 tex = texture2D(texture, uv);","    if (tex.a < 0.5) {","       discard;","    }","    else {","       gl_FragColor = vec4(vec3(tex.a), 1.);","    }","}"].join("\n")}function f(a,b){var c=new window.XMLHttpRequest;c.onreadystatechange=function(){if(4===c.readyState&&200===c.status)b(c.responseText);else if(404===c.status)throw new Error("Failed to read shader file: "+a)},c.open("GET",a,!0),c.send()}function g(a,b,c){var d=h(c,"vertex"),e=h(c,"fragment"),f=b.file;b.file=void 0,b.vertexSource=d,b.fragmentSource=e;var g=a.createShader(b);void 0!==b.onCreated&&b.onCreated(g,f)}function h(a,b){function c(a,b,c,d){void 0===c&&(c=0),void 0===d&&(d=a.length);for(var e=0,f=a.indexOf(b,c);-1!=f&&d>f;)e++,f=a.indexOf(b,f+1);return e}function d(a,b){for(var c="",d=0;b>d;d++)c+=a;return c}var e,f,g="(^|\\n)\\s*\\["+b+"\\]((\\n|.)*?)(\\n\\s*\\[|$)",h=new RegExp(g);if(e=h.exec(a),null!==e){var i=e[2],j=a.indexOf(i),k=c(a,"\n",0,j),l=c(a,"\n",j+i.length);f=d("\n",k),f+=i,f+=d("\n",l)}return f}var i=a("./mesh"),j=a("./shader"),k=a("./texture"),l=a("./fbo"),m=a("../../math/mat4");e.prototype.setVirtualSize=function(a,b){this.virtualWidth=a,this.virtualHeight=b,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},e.prototype.setRenderBufferSize=function(a,b){this.renderWidth=a,this.renderHeight=b,this.gl.viewport(0,0,a,b),this.currentViewport.width=a,this.currentViewport.height=b},e.prototype.deleteShader=function(a){a.release(this.gl)},e.prototype.createShader=function(a){return void 0===a.vertexSource&&(a.vertexSource=this._defaultVsSource),void 0===a.fragmentSource&&(a.fragmentSource=this._defaultFsSource),new j(this.gl,a)},e.prototype.createShaderFromFile=function(a){if(void 0===a.file)throw new Error("createShaderFromFile: no file specified");f(a.file,g.bind(null,this,a))},e.prototype.createMesh=function(a){return new i(this.gl,a)},e.prototype.createTexture=function(a){return new k(this.gl,a)},e.prototype.createFBO=function(a){return a.texture=new k(this.gl,{width:a.width,height:a.height}),new l(this.gl,a)},e.prototype.calculateCamera=function(a,b,c,d){var e=this.fieldOfView*Math.PI/180,f=.5*d/Math.tan(.5*e);m.perspective(b,e,c/d,.05*f,5*f),m.identity(a),m.translate(a,.5*-c,.5*d,-f),a[5]=-1,this.cameraMatricesDirty=!0},e.prototype.bindScreen=function(){var a=this.gl;a.bindFramebuffer(a.FRAMEBUFFER,null),a.viewport(0,0,this.renderWidth,this.renderHeight),this.currentViewport.width=this.renderWidth,this.currentViewport.height=this.renderHeight},e.prototype.setBlendMode=function(a){if(a!==this.currentBlendMode){var b=this.gl;this.currentBlendMode=a,this.currentBlendMode===e.BlendMode.Alpha?(b.blendFunc(b.ONE,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND)):this.currentBlendMode===e.BlendMode.Additive?(b.blendFunc(b.ONE,b.ONE),b.enable(b.BLEND)):this.currentBlendMode===e.BlendMode.Solid?b.disable(b.BLEND):this.currentBlendMode===e.BlendMode.Multiply&&(b.blendFunc(b.DST_COLOR,b.ONE_MINUS_SRC_ALPHA),b.enable(b.BLEND))}},e.prototype.setDepthTest=function(a){if(a!==this.currentDepthTestState){var b=this.gl;a?b.enable(b.DEPTH_TEST):b.disable(b.DEPTH_TEST),this.currentDepthTestState=a}},e.prototype.setStencilTest=function(a){if(a!==this.currentStencilTestState){var b=this.gl;a?b.enable(b.STENCIL_TEST):b.disable(b.STENCIL_TEST),this.currentStencilTestState=a}},e.prototype.setScissorTest=function(a,b){var c=this.gl;if(this.currentScissorTestState!==a&&(a?c.enable(c.SCISSOR_TEST):c.disable(c.SCISSOR_TEST),this.currentScissorTestState=a),a){var d=this.currentViewport.width/this.virtualWidth,e=this.currentViewport.height/this.virtualHeight,f=0!==this.currentRenderTarget;f&&(d=1,e=1);var g=Math.ceil(b[0]*d),h=Math.ceil(this.currentViewport.height-b[3]*e),i=Math.ceil((b[2]-b[0])*d),j=Math.ceil((b[3]-b[1])*e);i=Math.max(0,i),j=Math.max(0,j),c.scissor(g,h,i,j)}},e.prototype.getMaxVaryingVectors=function(){return this.gl.getParameter(this.gl.MAX_VARYING_VECTORS)},e.prototype.clearScreen=function(){this.gl.clear(this.gl.COLOR_BUFFER_BIT|this.gl.DEPTH_BUFFER_BIT|this.gl.STENCIL_BUFFER_BIT)},e.prototype.bindFbo=function(a){var b=this.gl;b.bindFramebuffer(b.FRAMEBUFFER,a.fbo),b.viewport(0,0,a.width,a.height),this.currentViewport.width=a.width,this.currentViewport.height=a.height},e.prototype.bindRenderTarget=function(a){a!==this.currentRenderTarget&&(this.currentRenderTarget=a,0===this.currentRenderTarget||null===this.currentRenderTarget?(this.bindScreen(),this.currentViewMatrix=this.screenCameraView,this.currentProjectionMatrix=this.screenCameraProjection,this.cameraMatricesDirty=!0):(this.bindFbo(this.currentRenderTarget.fbo),this.currentViewMatrix=this.currentRenderTarget.cameraView,this.currentProjectionMatrix=this.currentRenderTarget.cameraProjection,this.cameraMatricesDirty=!0)),this.setScissorTest(!1),this.setMaskRendering(!1),this.gl.stencilMask(255),this.clearScreen()},e.prototype.bindTexture=function(a,b){this.activeTexture!==a&&(this.activeTexture=a,this.gl.activeTexture(this.gl.TEXTURE0+a)),this.gl.bindTexture(b.target,b.handle)},e.prototype.bindShader=function(a,b){var c=this.gl;if(this.currentShader!==a&&(this.currentShader=a,this.currentBoundMesh=null,c.useProgram(this.currentShader.program),d(a.standardUniforms.texture)&&c.uniform1i(a.standardUniforms.texture,0),this.cameraMatricesDirty=!0,a.hasDirtyUniforms=!0),b!==this.currentUniformValues&&(this.currentUniformValues=b,a.hasDirtyUniforms=!0),this.currentShader.hasDirtyUniforms){for(var e=1,f=this.currentShader._uniforms,g=0,h=a.uniformNames.length;h>g;g++){var i=a.uniformNames[g],j=f[i],k=j.value;b&&b.hasOwnProperty(i)&&(k=b[i]),d(j.location)&&("float"===j.type||"f"===j.type?c.uniform1f(j.location,k):"vec2"===j.type?c.uniform2f(j.location,k[0],k[1]):"vec3"===j.type?c.uniform3f(j.location,k[0],k[1],k[2]):"vec4"===j.type?c.uniform4f(j.location,k[0],k[1],k[2],k[3]):"sampler2D"===j.type&&k&&(this.bindTexture(e,k),c.uniform1i(j.location,e),e++))}a.hasDirtyUniforms=!1}this.cameraMatricesDirty&&(d(a.standardUniforms.u_projection)&&c.uniformMatrix4fv(a.standardUniforms.u_projection,!1,this.currentProjectionMatrix),d(a.standardUniforms.u_view)&&c.uniformMatrix4fv(a.standardUniforms.u_view,!1,this.currentViewMatrix),this.cameraMatricesDirty=!1)},e.prototype.bindMesh=function(a){this.currentBoundMesh!==a&&(a.bind(this.currentShader.attributes,this.currentShader.numComponentsPerVertex),this.currentBoundMesh=a)},e.prototype.beginFrame=function(){var a=this.gl;a.stencilMask(255),a.clear(a.STENCIL_BUFFER_BIT)},e.prototype.setMaskRendering=function(a,b){var c=this.gl;this.setStencilTest(!0),a?(this.maskRenderingEnabled===!1&&(c.colorMask(!1,!1,!1,!1),c.depthMask(!1),c.stencilFunc(c.NEVER,1,255),this.maskRenderingEnabled=!0),b?c.stencilOp(c.INCR,c.INCR,c.INCR):c.stencilOp(c.DECR,c.DECR,c.DECR)):this.maskRenderingEnabled===!0&&(c.colorMask(!0,!0,!0,!0),c.depthMask(!0),c.stencilFunc(c.LEQUAL,128,255),c.stencilOp(c.KEEP,c.KEEP,c.KEEP),this.maskRenderingEnabled=!1)},e.prototype.executeRenderCommand=function(a){var b=this.gl;this.setBlendMode(a.blendMode),this.setDepthTest(a.depthTest),this.setMaskRendering(a.writeToStencil,a.maskIsPositive),this.setScissorTest(a.scissorTest,a.scissorRect),this.bindShader(a.shader,a.shaderUniforms),this.bindTexture(0,a.texture);var c=this.currentShader.standardUniforms.u_world;d(c)&&(a.worldTransform?b.uniformMatrix4fv(c,!1,a.worldTransform):b.uniformMatrix4fv(c,!1,this.identityMatrix));var e=this.currentShader.standardUniforms.u_opacity;d(e)&&b.uniform1f(e,a.opacity);var f=this.currentShader.standardUniforms.u_color;d(f)&&b.uniform3f(f,a.color[0],a.color[1],a.color[2]);var g=this.currentShader.standardUniforms.u_srcRect;d(g)&&b.uniform4f(g,a.srcRect[0],a.srcRect[1],a.srcRect[2],a.srcRect[3]);var h=this.currentShader.standardUniforms.u_flipTexCoordY;d(h)&&b.uniform1f(h,a.flipTexCoordY),this.bindMesh(a.mesh),-1===a.vertexIndex?a.mesh.draw():a.mesh.drawVertexRange(a.vertexIndex,a.numVertices?a.numVertices:4)},e.prototype.whiteTexture=function(){return null===this._whiteTexture&&(this._whiteTexture=this.createTexture({pixels:new Uint8Array([255,255,255,255]),width:1,height:1})),this._whiteTexture},e.prototype.setFieldOfView=function(a){this.fieldOfView=a,this.calculateCamera(this.screenCameraView,this.screenCameraProjection,this.virtualWidth,this.virtualHeight)},e.BlendMode={Alpha:0,Solid:1,Additive:2,Multiply:3},b.exports=e},{"../../math/mat4":291,"./fbo":302,"./mesh":304,"./shader":307,"./texture":309}],312:[function(a,b,c){"use strict";function d(a){a=a||{},this.cache={},this.activeReferences={},this.freelist={},this.freelistKeys=[],this.freelistMaxLength=a.freelistSize||0,this.disposeCallback=a.disposeCallback}d.prototype.isInCache=function(a){return this.cache.hasOwnProperty(a)||this.freelist.hasOwnProperty(a)},d.prototype.addResource=function(a,b){this.cache[a]={resource:b,refCount:0}},d.prototype._decreaseRefCount=function(a){var b=this.cache[a];if(b.refCount--,0===b.refCount){if(this.freelistMaxLength>0){if(this.freelistKeys.length===this.freelistMaxLength){var c=this.freelistKeys.shift();this._dispose(this.freelist[c]),delete this.freelist[c]}this.freelistKeys.push(a),this.freelist[a]=b.resource}else this._dispose(b.resource);delete this.cache[a]}},d.prototype.removeReference=function(a){if(this.activeReferences.hasOwnProperty(a)!==!1){var b=this.activeReferences[a];this._decreaseRefCount(b),delete this.activeReferences[a]}},d.prototype.updateReference=function(a,b){if(this.activeReferences[a]!==b){var c=this.activeReferences[a];if(this.freelist.hasOwnProperty(b)){this.cache[b]={resource:this.freelist[b],refCount:0},delete this.freelist[b];var d=this.freelistKeys.indexOf(b);this.freelistKeys.splice(d,1)}this.activeReferences[a]=b,this.cache[b].refCount++,c&&this._decreaseRefCount(c)}},d.prototype.getResource=function(a){return this.cache[a].resource},d.prototype.clear=function(){var a;for(a in this.cache)this._dispose(this.cache[a].resource);for(a in this.freelist)this._dispose(this.freelist[a]);this.cache={},this.freelist={},this.freelistKeys=[],this.activeReferences={}},d.prototype._dispose=function(a){this.disposeCallback?this.disposeCallback(a):a.dispose&&a.dispose()},b.exports=d},{}],313:[function(a,b,c){"use strict";function d(){}function e(a){this.axis=a.axis||0,this.track=a.hasOwnProperty("track")?a.track:!0,this.threshold=a.threshold,this.onDragStart=a.onDragStart||d,this.onDrag=a.onDrag||d,this.onDragEnd=a.onDragEnd||d,this._startPosition=0,this._touchPosition=0,this._hasPressedDown=!1,this._isDragging=!1,this._velocity=0,this._deltaPosition=0}e.prototype=Object.create(e.prototype,{velocity:{get:function(){return this._velocity}},dragDistance:{get:function(){return this._touchPosition-this._startPosition}},dragDelta:{get:function(){return this._deltaPosition}}}),e.prototype.onTouch=function(a){if(a.isDown)this._touchPosition=a.pos[this.axis],this._hasPressedDown=!0,this._velocity=0,this._deltaPosition=0,this._startPosition=this._touchPosition;else if(a.isMove&&this._hasPressedDown){var b=a.pos[this.axis];if(this._isDragging===!1?Math.abs(b-this._touchPosition)>this.threshold&&(this._isDragging=!0,this._startPosition=b,this._touchPosition=b,this.onDragStart()):(a.deltaTime>0&&(this._velocity=(b-this._touchPosition)/a.deltaTime),this._touchPosition=b,this._deltaPosition=a.delta[this.axis],this.onDrag()),this._isDragging&&this.track)return"StartTracking"}else(a.isUp||a.isExit)&&this._isDragging&&(this._isDragging=!1,this._hasPressedDown=!1,this._deltaPosition=0,this.onDragEnd())},b.exports=e},{}],314:[function(a,b,c){"use strict";function d(a,b,c,d,e){var f=1-e;return f*f*f*a+3*f*f*e*b+3*f*e*e*c+e*e*e*d}function e(a,b){this.axis=b.axis,this.scrollCallback=b.scrollCallback,this.scrollThreshold=b.scrollThreshold,this.shouldRubber=void 0!==b.shouldRubber?b.shouldRubber:!0,this.scrollSpeed=void 0!==b.scrollSpeed?b.scrollSpeed:1,this.scrollEndedAnimationDuration=b.scrollEndedAnimationDuration||300,this.scrollEndedPositionCallback=b.scrollEndedPositionCallback,this.trackId=-1,this.animation=null,this.speed=0,this.timerScheduler=a,this.scrollObjectSize=1,this.scrollViewSize=1,this.rubberLength=4}e.prototype.onTouch=function(a,b){if(-1===this.trackId||b.id===this.trackId){var c=0,e=this.axis,f=!0;if(b.isDown||b.isEnter)this.hasMoved=!1,this.downStartPos=b.pos[e],this.animation&&this.animation.stop(),this.speed=0;else if(b.isMove&&(this.hasMoved||Math.abs(b.pos[e]-this.downStartPos)>this.scrollThreshold)){this.hasMoved=!0;var g=0,h=a+b.delta[e],i=Math.min(0,-this.scrollObjectSize+this.scrollViewSize);if(h>0?g=h:i>h&&(g=i-h),g>0&&this.shouldRubber){var j=Math.max(0,1-g/this.scrollViewSize*this.rubberLength);c=b.delta[e]*j}else h>0?(c=-a,this.shouldRubber===!1&&(f=!1)):i>h?(c=i-a,this.shouldRubber===!1&&(f=!1)):c=b.delta[e];b.deltaTime>0&&(this.speed=b.delta[this.axis]/b.deltaTime),0!==c&&(a+=c,this.scrollCallback(a,c))}else if((b.isUp||b.isExit)&&this.hasMoved===!0){this.hasMoved=!1;var k=this.scrollEndedAnimationDuration,l=a+this.speed*k/3,m=a+this.speed*k/3,n=Math.min(0,this.scrollViewSize-this.scrollObjectSize);l>0?(l=0,m=0):n>l&&(l=n,m=l),l=this.scrollEndedPositionCallback(this.speed,l),this.shouldRubber===!1&&(m=l);var o=this.scrollCallback,p=this.onScrollEnded;this.animation=this.timerScheduler.createTimer({duration:k,p0:a,p1:m,p2:l,p3:l,onRunning:function(a){o(d(this.p0,this.p1,this.p2,this.p3,a))},onFinish:function(){p&&p()}}).start()}return this.hasMoved&&f?(this.trackId=b.id,"StartTracking"):void(this.trackId=-1)}},e.prototype.setOrientation=function(a){this.axis="horizontal"===a?0:1},b.exports=e},{}],315:[function(a,b,c){"use strict";function d(a,b){this.scrollThreshold=a,this.startPos=[0,0],this.hasReceivedDownEvent=!1,this.callback=b}d.prototype.onTouch=function(a,b){if(b.isDown)this.startPos[0]=b.pos[0],this.startPos[1]=b.pos[1],this.hasReceivedDownEvent=!0;else if(b.isMove)(Math.abs(b.pos[0]-this.startPos[0])>this.scrollThreshold||Math.abs(b.pos[1]-this.startPos[1])>this.scrollThreshold)&&(this.hasReceivedDownEvent=!1);else if(b.isUp&&this.hasReceivedDownEvent===!0)return this.callback(a,b),this.hasReceivedDownEvent=!1,"StopPropagation"},b.exports=d},{}],316:[function(a,b,c){"use strict";function d(){this.trackedControls=[],this.lastTouch=[],this.prevIntersectedControlsDepthLayers={},this.hoverState={prevIntersectedControlsDepthLayers:{},lastHover:{}},this.depthIndices=[],this.numDepthIndices=0,this.focusedControl=null}function e(a,b){return a-b}function f(a){for(var b=0,c=a.length;c>b;++b)null!==a[b].onTouch&&a[b].onTouch(s)}function g(a){for(var b=0,c=a.length;c>b;++b)null!==a[b].onHover&&a[b].onHover(u)}function h(a,b){return q.intersects(a.childAABB||a.screenAABB,b)}function i(a,b){return q.intersects(a.screenAABB,b)}function j(a,b){return q.isPointInside(a.childAABB||a.screenAABB,b)}function k(a,b){return q.isPointInside(a.screenAABB,b)}function l(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&j(a,b.pos)){(a.onTouch||a.blockTouch)&&k(a,b.pos)&&(a.blockTouch&&(c[d]=[],v=Math.max(v,d)),a.onTouch&&(void 0===c[d]&&(c[d]=[]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)l(e[f],b,c,d)}}function m(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&j(a,b.pos)){(a.onHover||a.blockTouch)&&k(a,b.pos)&&(a.blockTouch&&(c[d]=[],v=Math.max(v,d)),a.onHover&&(void 0===c[d]&&(c[d]=[a]),c[d].push(a)));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)m(e[f],b,c,d)}}function n(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&h(a,b)){(a.onTouch||a.blockTouch)&&i(a,b)&&(void 0===c[d]&&(c[d]=[]),c[d].push(a));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)n(e[f],b,c,d)}}function o(a,b,c,d){if(d=void 0===a.depth?d:a.depth,a.touchPropagation&&a.visible&&a.opacity>0&&j(a,b)){(a.onTouch||a.blockTouch)&&k(a,b)&&(void 0===c[d]&&(c[d]=[]),c[d].push(a));var e=a.children;if(e)for(var f=0,g=e.length;g>f;f++)o(e[f],b,c,d)}}function p(){return{pos:[0,0],delta:[0,0],deltaTime:0,type:"isMove",isMove:!1,isUp:!1,isDown:!1,isEnter:!1,isExit:!1,id:0}}var q=a("../math/aabb"),r=p();r.type="isEnter",r.isEnter=!0;var s=p();s.type="isExit",s.isExit=!0;var t=p();t.type="isHoverEnter",t.isHoverEnter=!0;var u=p();u.type="isHoverExit",u.isHoverExit=!0,d.prototype.processTouchEvent=function(a,b){var c=b.id,d=this.lastTouch[c];d||(this.lastTouch[c]={pos:[0,0],time:0},d=this.lastTouch[c]),b.isMove&&(b.delta[0]=b.pos[0]-d.pos[0],b.delta[1]=b.pos[1]-d.pos[1],b.deltaTime=b.time-d.time),d.time=b.time,d.pos[0]=b.pos[0],d.pos[1]=b.pos[1];var g={0:[]};this.trackedControls[b.id]?g[0].push(this.trackedControls[b.id]):(v=-1e7,l(a,b,g,void 0===a.depth?0:a.depth)),r.id=b.id,r.pos[0]=b.pos[0],r.pos[1]=b.pos[1],r.delta[0]=b.delta[0],r.delta[1]=b.delta[1],r.deltaTime=b.deltaTime,r.force=b.force,r.domEvent=b.domEvent,s.id=b.id,s.pos[0]=b.pos[0],s.pos[1]=b.pos[1],s.delta[0]=b.delta[0],s.delta[1]=b.delta[1],s.deltaTime=b.deltaTime,s.force=0,s.domEvent=b.domEvent;var h,i,j,k,m,n,o=!0;this.numDepthIndices=0;for(n in g)n>=v&&(this.depthIndices[this.numDepthIndices++]=n);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),k=this.numDepthIndices-1;k>=0&&o;--k)for(j=this.depthIndices[k],m=g[j],h=m.length-1;h>=0;--h){var p=m[h],q=!1;for(i in this.prevIntersectedControlsDepthLayers){var t=this.prevIntersectedControlsDepthLayers[i].indexOf(p);if(-1!==t){q=!0,this.prevIntersectedControlsDepthLayers[i].splice(t,1);break}}q===!1&&(p.onTouch(r),this.focusedControl&&p!==this.focusedControl&&(this.focusedControl.blur(),this.focusedControl=null));var u=p.onTouch(b);if("StartTracking"===u){this.trackedControls[b.id]=p,o=!1;break}if(this.trackedControls[b.id]=null,"StopPropagation"===u){o=!1;break}void 0!==u&&console.log("unknown return value from from onTouch "+u)}if(b.isUp){for(k=this.numDepthIndices-1;k>=0;--k)j=this.depthIndices[k],m=g[j],f(m);this.prevIntersectedControlsDepthLayers={}}else{this.numDepthIndices=0;for(n in this.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=n;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),k=this.numDepthIndices-1;k>=0;--k)j=this.depthIndices[k],m=this.prevIntersectedControlsDepthLayers[j],f(m);this.prevIntersectedControlsDepthLayers=g}},d.prototype.processHoverEvent=function(a,b){var c=(b.id,{0:[]});v=-1e7,m(a,b,c,void 0===a.depth?0:a.depth),t.id=b.id,t.pos[0]=b.pos[0],t.pos[1]=b.pos[1],t.delta[0]=b.delta[0],t.delta[1]=b.delta[1],t.deltaTime=b.deltaTime,t.domEvent=b.domEvent,u.id=b.id,u.pos[0]=b.pos[0],u.pos[1]=b.pos[1],u.delta[0]=b.delta[0],u.delta[1]=b.delta[1],u.deltaTime=b.deltaTime,u.domEvent=b.domEvent;var d,f,h,i,j,k,l=!0;this.numDepthIndices=0;for(k in c)k>=v&&(this.depthIndices[this.numDepthIndices++]=k);for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0&&l;--i)for(h=this.depthIndices[i],j=c[h],d=j.length-1;d>=0;--d){var n=j[d],o=!1;for(f in this.hoverState.prevIntersectedControlsDepthLayers){var p=this.hoverState.prevIntersectedControlsDepthLayers[f].indexOf(n);if(-1!==p){o=!0,this.hoverState.prevIntersectedControlsDepthLayers[f].splice(p,1);break}}o===!1&&n.onHover(t);var q=n.onHover(b);if("StopPropagation"===q){l=!1;break}void 0!==q&&console.log("unknown return value from from onhoverEvent "+q)}this.numDepthIndices=0;for(k in this.hoverState.prevIntersectedControlsDepthLayers)this.depthIndices[this.numDepthIndices++]=k;for(this.depthIndices.length=this.numDepthIndices,this.depthIndices.sort(e),i=this.numDepthIndices-1;i>=0;--i)h=this.depthIndices[i],j=this.hoverState.prevIntersectedControlsDepthLayers[h],g(j);this.hoverState.prevIntersectedControlsDepthLayers=c},d.prototype.handleTouchEvent=function(a,b){var c=p();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=b.force,c.domEvent=b.domEvent,this.processTouchEvent(a,c)},d.prototype.handleHoverEvent=function(a,b){var c=p();c.pos[0]=b.x,c.pos[1]=b.y,c.delta[0]=0,c.delta[1]=0,c.time=b.timestamp,c[c.type]=!1,c.type=b.type,c[b.type]=!0,c.id=b.id,c.force=0,c.domEvent=b.domEvent,this.processHoverEvent(a,c)},d.prototype.setFocus=function(a){return a.blur?void(this.focusedControl=a):void console.error("Can't set focus on a control that can't be blurred")};var v;d.prototype.hitTestBox=function(a,b){var c={};return n(a,b,c,0),c},d.prototype.hitTest=function(a,b){var c={};return o(a,b,c,0),c},b.exports=d},{"../math/aabb":289}],317:[function(a,b,c){"use strict";function d(){e.call(this),this.mouseDown=!1,this.lastTouch=[],this.lastMouseMove=void 0;var a=this;this.onMouseMove=function(b){return a.lastMouseMove=b,a.isTouchIntercepted()?(b.preventDefault(),void(a.interceptMouseMove&&a.interceptMouseMove(b))):(a.mouseDown===!0&&a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),0,b.timeStamp,"isMove",b),void a.emitHoverEvent(0,a.getTouchX(b),a.getTouchY(b),b.timeStamp,"isHoverMove",b))},this.onUnhandledInputEvent=function(b){return a.isTouchIntercepted()?void b.preventDefault():void a.emitUnhandledEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"unhandled",b)},this.onTouchMove=function(b){return a.isTouchIntercepted()?void b.preventDefault():void a.onTouchEvent(b,"isMove")},this.onTouchLeave=function(b){if(a.isTouchIntercepted())return void b.preventDefault();var c=a.getTouchX(b),d=a.getTouchY(b);a.mouseDown&&b.target===a.domElement&&(0>c||c>1||0>d||d>1)&&(a.mouseDown=!1,a.emitEvent(0,c,d,b.force,b.timeStamp,"isUp",b))},this.onTouchEnd=function(b){return a.isTouchIntercepted()?void b.preventDefault():void a.onTouchEvent(b,"isUp")},this.onMouseUp=function(b){return a.isTouchIntercepted()?(a.interceptMouseUp&&a.interceptMouseUp(b),void b.preventDefault()):void(0===b.button&&(a.mouseDown=!1,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isUp",b)))},this.onMouseOut=function(b){if(a.isTouchIntercepted())return void b.preventDefault();var c=a.getTouchX(b),d=a.getTouchY(b);a.mouseDown&&b.target===a.domElement&&(0>c||c>1||0>d||d>1)&&(a.mouseDown=!1,a.emitEvent(0,c,d,b.force,b.timeStamp,"isUp",b)),a.emitHoverEvent(0,c,d,b.timeStamp,"isHoverMove",b)},this.onTouchStart=function(b){return a.isTouchIntercepted()?void b.preventDefault():void a.onTouchEvent(b,"isDown")},this.onMouseDown=function(b){return a.isTouchIntercepted()?(b.preventDefault(),void(a.interceptMouseDown&&a.interceptMouseDown(b))):void(0===b.button?(a.mouseDown=!0,a.emitEvent(0,a.getTouchX(b),a.getTouchY(b),b.force,b.timeStamp,"isDown",b)):2===b.button&&a.emit("rightButtonClick",{id:2,x:a.getTouchX(b),y:a.getTouchY(b),force:b.force,timestamp:b.timestamp,type:"isDown",domEvent:b}))}}var e=a("../../eventsender");d.prototype=Object.create(e.prototype),d.prototype.setDOMElement=function(a){this.setTouchEnabled(!1),this.domElement=a,this.setTouchEnabled(!0),this.clientRect=a.getBoundingClientRect()},d.prototype.setTouchEnabled=function(a){var b=this.domElement;b&&(a?(b.addEventListener("click",this.onUnhandledInputEvent,!0),b.addEventListener("dblclick",this.onUnhandledInputEvent,!0),b.addEventListener("mouseover",this.onUnhandledInputEvent,!0),b.addEventListener("mouseenter",this.onUnhandledInputEvent,!0),b.addEventListener("mouseleave",this.onUnhandledInputEvent,!0),b.addEventListener("auxclick",this.onUnhandledInputEvent,!0),b.addEventListener("mousemove",this.onMouseMove,!0),b.addEventListener("touchmove",this.onTouchMove,!0),b.addEventListener("touchleave",this.onTouchLeave,!0),b.addEventListener("touchend",this.onTouchEnd,!0),b.addEventListener("mouseup",this.onMouseUp,!0),b.addEventListener("mouseout",this.onMouseOut,!0),b.addEventListener("touchstart",this.onTouchStart,!0),b.addEventListener("mousedown",this.onMouseDown,!0)):(b.removeEventListener("click",this.onUnhandledInputEvent),b.removeEventListener("dblclick",this.onUnhandledInputEvent),b.removeEventListener("mouseover",this.onUnhandledInputEvent),b.removeEventListener("mouseenter",this.onUnhandledInputEvent),b.removeEventListener("mouseleave",this.onUnhandledInputEvent),b.removeEventListener("auxclick",this.onUnhandledInputEvent),
b.removeEventListener("mousemove",this.onMouseMove),b.removeEventListener("touchmove",this.onTouchMove),b.removeEventListener("touchleave",this.onTouchLeave),b.removeEventListener("touchend",this.onTouchEnd),b.removeEventListener("mouseup",this.onMouseUp),b.removeEventListener("mouseout",this.onMouseOut),b.removeEventListener("touchstart",this.onTouchStart),b.removeEventListener("mousedown",this.onMouseDown)))},d.prototype.setTouchInterceptCallbacks=function(a,b,c){this.interceptMouseMove=a,this.interceptMouseDown=b,this.interceptMouseUp=c},d.prototype.isTouchIntercepted=function(){return this.interceptMouseMove||this.interceptMouseDown||this.interceptMouseUp},d.prototype.onTouchEvent=function(a,b){for(var c=0;c<a.changedTouches.length;++c){var d=a.changedTouches[c];this.emitEvent(d.identifier,this.getTouchX(d),this.getTouchY(d),d.force,a.timeStamp,b,a)}},d.prototype.emitUnhandledEvent=function(a,b,c,d,e,f,g){this.emit("unhandledInputEvent",{id:a,x:b,y:c,force:d,timestamp:e,type:f,domEvent:g})},d.prototype.emitEvent=function(a,b,c,d,e,f,g){this.emit("touchEvent",{id:a,x:b,y:c,force:d,timestamp:e,type:f,domEvent:g})},d.prototype.emitHoverEvent=function(a,b,c,d,e,f){this.emit("hoverEvent",{id:a,x:b,y:c,timestamp:d,type:e,domEvent:f})},d.prototype.getTouchX=function(a){var b=this.clientRect,c=b.right-b.left,d=a.pageX-b.left;return d/c},d.prototype.getTouchY=function(a){var b=this.clientRect,c=b.bottom-b.top,d=a.pageY-b.top;return d/c},b.exports=d},{"../../eventsender":168}],318:[function(a,b,c){"use strict";function d(a,b){i.call(this),this.timerScheduler=a,this.eventSender=new i,this.layouter=new f,this.imageCache=new x,this.renderer=new e(b);var c=this;this.renderer.on("shaderError",function(a){c.emit("shaderError",a)},this),this.renderer.on("requestFrame",function(){c.eventSender.emit("requestFrame")},this),this.touchEnabled=!0,this.root=this.createDockLayoutControl(),this.root.setSizeMode("explicit"),this.root.setWidthUnit("px"),this.root.setHeightUnit("px"),this.touchEngine=new g,this.touchListener=new h,this.touchListener.on("unhandledInputEvent",this.handleAuxillaryEvent.bind(this),this),this.touchListener.on("rightButtonClick",this.handleRightButtonClick.bind(this),this),this.touchListener.on("touchEvent",this.handleTouchEvent.bind(this),this),this.touchListener.on("hoverEvent",this.handleHoverEvent.bind(this),this),this.fillMode="aspectFit",this.setAspectFitViewport(1080,1920),this.root.setContentDirty=function(a){l.prototype.setContentDirty(a),a&&c.eventSender.emit("requestFrame")},window.addEventListener("resize",function(){c._resizeViewport(),c.eventSender.emit("requestFrame")})}var e=a("./renderer"),f=a("./layout/layouter"),g=a("./touch/touchengine"),h=a("./touch/touchlistener"),i=a("../eventsender"),j=(a("./math/aabb"),a("./controls/effectcontrol")),k=a("./controls/circlecontrol"),l=a("./controls/docklayoutcontrol"),m=a("./controls/flowlayoutcontrol"),n=a("./controls/imagecontrol"),o=a("./controls/rectanglecontrol"),p=a("./controls/htmlcontrol"),q=a("./controls/scrollviewcontrol"),r=a("./controls/stacklayoutcontrol"),s=a("./controls/textcontrol"),t=a("./controls/textinputcontrol"),u=a("./controls/meshcontrol"),v=a("./touch/taphandler"),w=a("./touch/draggesturerecognizer"),x=a("./imagecache");d.prototype=Object.create(i.prototype),d.prototype.constructor=d,d.prototype._addListenersToControl=function(a){a.on("disposed",this.renderer.onControlDisposed.bind(this.renderer))},d.prototype.createCircleControl=function(){var a=new k(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createDockLayoutControl=function(){var a=new l(this.layouter);return a},d.prototype.createFlowLayoutControl=function(){return new m(this.layouter)},d.prototype.createEffectControl=function(){var a=new j(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createImageControl=function(){var a=new n(this.layouter,this.imageCache);return this._addListenersToControl(a.innerControl),a},d.prototype.createRectangleControl=function(){var a=new o(this.layouter);return this._addListenersToControl(a),a},d.prototype.createDOMElement=function(a,b,c,d){return this.renderer.domCache.createElement("html",c,d,b)},d.prototype.createHtmlControl=function(){var a=new p(this.layouter);return a},d.prototype.createScrollViewControl=function(){return new q(this.layouter,this.timerScheduler)},d.prototype.createStackLayoutControl=function(){return new r(this.layouter)},d.prototype.createTextControl=function(){var a=new s(this.layouter);return this._addListenersToControl(a.innerControl),a},d.prototype.createTextInputControl=function(){var a=new t(this.layouter);this._addListenersToControl(a);var b=this.renderer.domCache.createElement("textInput",a.id,!0,"input");return b&&a.setInputField(b),a.on("focused",this.touchEngine.setFocus.bind(this.touchEngine)),a},d.prototype.createMeshControl=function(){var a=new u(this.layouter,this.imageCache);return this._addListenersToControl(a),a},d.prototype.createTapHandler=function(a){return new v(50,a)},d.prototype.createDragGestureRecognizer=function(a){return new w(a)},d.prototype.setAspectFitViewport=function(a,b){this.aspectFillViewportSize={width:a,height:b},this._resizeViewport()},d.prototype.getUIScale=function(){var a=this.renderer.rootElement.getBoundingClientRect(),b=this.layouter.windowSize.width,c=this.layouter.windowSize.height,d=b/c,e=a.width/a.height,f=0;return f=e>d?a.height*d:a.width,f/b},d.prototype._resizeViewport=function(){var a,b;if("aspectFit"===this.fillMode)a=this.aspectFillViewportSize.width,b=this.aspectFillViewportSize.height;else{var c=this.renderer.rootElement.getBoundingClientRect();a=c.width,b=c.height}this._setViewportSize(a,b)},d.prototype._setViewportSize=function(a,b){this.renderer.setViewportSize(a,b),this.layouter.setWindowSize(a,b),this.root.setWidth(a),this.root.setHeight(b),this.root.screenAABB.max[0]=a,this.root.screenAABB.max[1]=b,this.root.childAABB.max[0]=a,this.root.childAABB.max[1]=b,this.emit("viewportSizeChanged",{width:a,height:b})},d.prototype.layout=function(){if(this.layouter.layout(this.root),this.root.contentDirty){this.renderer.beginLayout();for(var a=0;a<this.root.children.length;a++)this.renderer.layout(this.root.children[a],!1)}},d.prototype.renderFrame=function(){this.renderer.beginFrame(),this.renderer.render(this.root),this.renderer.endFrame(),this.renderer.rootElement!==this.touchListener.domElement&&this.touchListener.setDOMElement(this.renderer.rootElement);var a=this.renderer.renderers;if(a.length>0){var b=a[a.length-1];this.touchListener.clientRect=b.rootElement.getBoundingClientRect()}},d.prototype.setTouchEnabled=function(a){this.touchEnabled=a},d.prototype.setOverlayNode=function(a){this.overlayNode&&this.root.removeChild(this.overlayNode),this.overlayNode=a,a&&this.root.addChild(a)},d.prototype.touchEventOverlapsHTMLControl=function(a){var b=this.hitTest(a.x,a.y),c=Object.keys(b);c.sort();for(var d=c.length-1;d>=0;d--){var e=c[d];if(b[e].length>0){var f=b[e],g=f[f.length-1];if(g instanceof p)return!0}}return!1},d.prototype.handleRightButtonClick=function(a){this.touchEnabled&&(a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,a.domEvent.preventDefault(),a.domEvent.stopImmediatePropagation(),this.emit("rightButtonClick",a))},d.prototype.handleAuxillaryEvent=function(a){this.touchEnabled&&(a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.touchEventOverlapsHTMLControl(a)||(a.domEvent.preventDefault(),a.domEvent.stopImmediatePropagation()))},d.prototype.handleTouchEvent=function(a){this.touchEnabled&&(a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.touchEventOverlapsHTMLControl(a)||(a.domEvent.preventDefault(),a.domEvent.stopImmediatePropagation(),this.emit("touchEvent",a),this.touchEngine.handleTouchEvent(this.root,a)))},d.prototype.handleHoverEvent=function(a){this.touchEnabled&&(a.x*=this.renderer.viewportWidth,a.y*=this.renderer.viewportHeight,this.emit("hoverEvent",a),this.touchEngine.handleHoverEvent(this.root,a))},d.prototype.removeAllRenderers=function(){this.renderer.removeAllRenderers()},d.prototype.setRendererType=function(a,b){this.renderer.setRendererType(a,b)},d.prototype.setFillMode=function(a){this.fillMode=a,this.renderer.setFillMode(a),this._resizeViewport()},d.prototype.hitTestBox=function(a){return this.touchEngine.hitTestBox(this.root,a)},d.prototype.hitTest=function(a,b){return this.touchEngine.hitTest(this.root,[a,b])},d.prototype.captureScreenShot=function(a,b,c){this.renderer.captureScreenShot(this.root,a,b,c)},d.prototype.getViewportSize=function(){return{width:this.renderer.viewportWidth,height:this.renderer.viewportHeight}},d.prototype.clearImageCache=function(){this.imageCache.clear(),this.renderer.clearImageCaches()},b.exports=d},{"../eventsender":168,"./controls/circlecontrol":265,"./controls/docklayoutcontrol":266,"./controls/effectcontrol":267,"./controls/flowlayoutcontrol":268,"./controls/htmlcontrol":269,"./controls/imagecontrol":271,"./controls/meshcontrol":273,"./controls/rectanglecontrol":274,"./controls/scrollviewcontrol":275,"./controls/stacklayoutcontrol":276,"./controls/textcontrol":279,"./controls/textinputcontrol":280,"./imagecache":282,"./layout/layouter":285,"./math/aabb":289,"./renderer":292,"./touch/draggesturerecognizer":313,"./touch/taphandler":315,"./touch/touchengine":316,"./touch/touchlistener":317}],319:[function(a,b,c){"use strict";var d={Windows:function(){return/IEMobile/i.test(navigator.userAgent)},Android:function(){return/Android/i.test(navigator.userAgent)},BlackBerry:function(){return/BlackBerry/i.test(navigator.userAgent)},iOS:function(){return/iPhone|iPad|iPod/i.test(navigator.userAgent)},any:function(){return d.Android()||d.BlackBerry()||d.iOS()||d.Windows()}};b.exports={isMobile:d}},{}]},{},[163])(163)});